<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title type="text">Blog Bitix</title>
    <subtitle type="text">Blog sobre al lenguaje de programaci√≥n Java y la distribuci√≥n GNU/Linux que uso habitualmente, Arch Linux, lo que aprendo sobre el software libre, la programaci√≥n web y otros temas relacionados con la tecnolog√≠a y la inform√°tica. El contenido puede contener trazas de asuntos fuera de tema.</subtitle>
    <link rel="self" href="https://picodotdev.github.io/blog-bitix/index.xml"/>
    <link href="https://picodotdev.github.io/blog-bitix/" />
    <id>https://picodotdev.github.io/blog-bitix/tags/programacion/</id>
    <updated>2023-01-19T20:00:00+01:00</updated>
    <author><name>picodotdev</name></author>
    <generator>Hugo</generator>
    <icon>https://picodotdev.github.io/blog-bitix/assets/favicon.ico</icon>
    <logo>https://picodotdev.github.io/blog-bitix/assets/images/blog-bitix.svg</logo>
    <rights>https://creativecommons.org/licenses/by-sa/4.0/</rights>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2023/01/construir-desplegar-y-observar-aplicaciones-de-forma-uniforme-con-waypoint/</id>
        <title>Construir, desplegar y observar aplicaciones de forma uniforme con Waypoint</title>
        <updated>2023-01-19T20:00:00+01:00</updated>
        <published>2023-01-19T20:00:00+01:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2023/01/construir-desplegar-y-observar-aplicaciones-de-forma-uniforme-con-waypoint/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Cuando se tienen muchas aplicaciones si no se tienen unos procesos definidos seguramente cada una requerir√° su propio proceso, herramientas de construcci√≥n y despliegue. Estas diferencias a√±aden complejidad y no es deseable para tener un flujo de trabajo √°gil. La herramienta Waypoint de Hashicorp permite construir una aplicaci√≥n independientemente del lenguaje en el que est√© implementada, desplegar en diferentes proveedores de computaci√≥n en la nube y observar las aplicaciones una vez desplegadas, todo con la misma herramienta y de forma uniforme que simplifica en gran medida el flujo de desarrollo.</strong></p>]]>
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/hashicorp-waypoint.svg" width="200" height="205" alt="HashiCorp Waypoint" title="HashiCorp Waypoint" class="" loading="false&#34;"></p>
</div>
<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/hashicorp.svg" width="200" height="200" alt="HashiCorp" title="HashiCorp" class="" loading="false&#34;"></p>
</div>
<p>No son pocas los lenguajes de programaci√≥n actuales y hay varias plataformas de computaci√≥n en la nube. En una organizaci√≥n grande seguramente haya una diversidad de aplicaciones en cuanto a lenguaje de programaci√≥n e incluso quiz√° utiliza varios proveedores de computaci√≥n en la nube, cuanto menos es deseable tratar a todas las aplicaciones igual independientemente de su lenguaje para que el flujo sea uniforme para todas las aplicaciones ni es bueno acoplarse a un determinado proveedor de computaci√≥n para tener la libertad y flexibilidad en un futuro de cambiar a otro si las circunstancias cambian.</p>
<p>Las aplicaciones para se ejecuci√≥n en su ciclo de vida esencialmente necesitan al menos dos operaciones, una es su construcci√≥n a partir de c√≥digo fuente y la segunda es su despliegue en el entorno de ejecuci√≥n. Hay una tercera adicional que es la de publicaci√≥n consistente en enviarle tr√°fico, el despliegue simplemente consiste en ejecutar en el entorno pero sin tr√°fico para la versi√≥n desplegada, esto es, separando el despliegue de la publicaci√≥n.</p>
<p><a href="https://www.hashicorp.com/">Hashicorp</a> ofrece varias herramientas que cada una cubre una necesidad de las aplicaciones, y de las que varias ya he escrito algunos art√≠culos. Algunas de sus herramientas m√°s conocidas son <a href="https://www.terraform.io/">Terraform</a> para tratar la infraestructura como c√≥digo, <a href="https://www.consul.io/">Consul</a> para la conectividad entre servicios y <a href="https://www.vaultproject.io/">Vault</a> centrada en la seguridad como servicio pero tiene otras muy interesantes como <a href="https://www.vagrantup.com/">Vagrant</a> para la virtualizaci√≥n en local, <a href="https://www.packer.io/">Packer</a> para la construcci√≥n de im√°genes de m√°quinas virtuales, <a href="https://www.boundaryproject.io/">Boundary</a> tambi√©n el apartado de seguridad o <a href="https://www.nomadproject.io/">Nomad</a> una alternativa similar a <a href="https://kubernetes.io/">Kubernetes</a> pero mucho m√°s sencilla de ejecutar en local.</p>
<p>En el caso de la construcci√≥n y despliegue, la herramienta que proporciona Hashicorp es <a href="https://www.waypointproject.io/">Waypoint</a>.</p>
<div class="alert alert-warning pt-0 pb-0 tableofcontents"><h2>Contenido del art√≠culo</h2><toc></toc></div>
<h3 id="waypoint">Waypoint</h3>
<p>Waypoint de Hashicorp es una herramienta que permite construir una aplicaci√≥n y realizar el despliegue independientemente del lenguaje empleado por la aplicaci√≥n y la infraestructura de ejecuci√≥n que se utilice.</p>
<p>Con Waypoint es posible construir cualquier aplicaci√≥n ya se trate de una aplicaci√≥n programada en <a href="https://www.oracle.com/java/">Java</a>, <a href="https://nodejs.org/en/">Node</a> o <a href="https://www.python.org/">Python</a> y desplegarla en cualquier proveedor en la nube soportado como <a href="https://aws.amazon.com/es/">Amazon Web Services</a>, <a href="https://cloud.google.com/">Google Cloud Platform</a> o <a href="https://azure.microsoft.com/es-es/">Microsoft Azure</a>.</p>
<p>El utilizar la misma herramienta uniformiza el ciclo de vida de las aplicaciones y tratan a todas por igual simplificando el flujo de desarrollo, de forma similar que una propiedad de los contenedores es que permiten ejecutar procesos independientemente del lenguaje de programaci√≥n en el que est√°n programados, Waypoint uniformiza la construcci√≥n y despliegue.</p>
<p>Waypoint en la <a href="https://developer.hashicorp.com/waypoint/docs/lifecycle/build">fase de construcci√≥n</a> o <em>build</em> en esencia lo que hace es construir una imagen de contenedor que luego es la que es desplegada. La construcci√≥n de la imagen puede ser con un habitual archivo Dockerfile de <a href="https://www.docker.com/">Docker</a> pero tambi√©n a trav√©s de <a href="https://buildpacks.io/">Buildpacks</a>. Una vez construida la imagen es almacenada en un registro de im√°genes. La fase de construcci√≥n suele estar automatizada por una herramienta de CI/CD como <a href="https://jenkins.io/">Jenkins</a>, adem√°s se soportan otras como <a href="https://developer.hashicorp.com/waypoint/docs/automating-execution/github-actions">GitHub Actions</a>.</p>
<p>En la <a href="https://developer.hashicorp.com/waypoint/docs/lifecycle/deploy">fase de despliegue</a> o <em>deploy</em> la imagen es puesta en ejecuci√≥n en la plataforma de despliegue seleccionada, se soportan varias incluyendo las m√°s conocidas como Kubernetes, Nomad, AWS EC2, AWS ECS, AWS Lambdas, Google Cloud Run y Azure Containers Instances incluyendo Docker en local.</p>
<p>Si la plataforma de despliegue lo soporta la <a href="https://developer.hashicorp.com/waypoint/docs/lifecycle/release">fase de publicaci√≥n</a> o <em>release</em> consiste en enviar tr√°fico a la aplicaci√≥n.</p>
<ul>
<li><a href="https://developer.hashicorp.com/waypoint/tutorials/get-started-docker/get-started-docker">Use Waypoint with Docker</a></li>
<li><a href="https://developer.hashicorp.com/waypoint/docs/automating-execution/github-actions">Integrating Waypoint with GitHub Actions</a></li>
</ul>
<div class="media media-video">
  <iframe width="640" height="360" src="https://www.youtube.com/embed/DsZVvv2dlUs" frameborder="0" class="lozad" allowfullscreen></iframe>
</div>
<h4 id="instalaci√≥n-de-waypoint">Instalaci√≥n de Waypoint</h4>
<p>Al igual que muchas de las otras herramientas de Hashicorp que est√°n implementadas con el lenguaje de programaci√≥n <a href="https://golang.org/">Go</a>, Waypoint es un √∫nico binario con lo que basta descargar la √∫ltima versi√≥n disponible y en el caso de <a href="https://www.gnu.org/">GNU</a>/<a href="https://www.linux.com/">Linux</a> copiarla al directorio <em>/usr/local/bin/</em> donde los usuarios pueden instalar programas sin que entren en conflicto con los instalados por los paquetes de la distribuci√≥n.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ls -lh /usr/local/bin/&#10;</span></span><span class="line"><span class="cl">-rwxr-xr-x <span class="m">1</span> picodotdev picodotdev  23M ene <span class="m">10</span> 11:31 pack&#10;</span></span><span class="line"><span class="cl">-rwxr-xr-x <span class="m">1</span> picodotdev picodotdev 180M dic <span class="m">15</span> 18:59 waypoint</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>ls-bin.sh</span>
    </div>
</div>
<h4 id="inicio-del-servidor-de-waypoint">Inicio del servidor de Waypoint</h4>
<p>Waypoint se ejecuta en modo servidor, en este ejemplo se inicia como un contenedor de Docker en local y ejecutar un comando para su inicializaci√≥n.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ waypoint install -platform<span class="o">=</span>docker -accept-tos&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>waypoint-install.sh</span>
    </div>
</div>
<p>Ofrece una interfaz gr√°fica en la que monitorizar trazas, builds, deployment y otros detalles. a la interfaz web se accede con el siguiente comando con la interfaz web accesible en la direcci√≥n <em>https://localhost:9702/</em>.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ waypoint ui -authenticate&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>waypoint-ui-authenticate.sh</span>
    </div>
</div>
<p>Una vez inicializado el servidor se puede iniciar sin necesidad de inicializarlo otra vez.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ waypoint server run -accept-tos&#10;</span></span><span class="line"><span class="cl">$ waypoint server bootstrap -server-addr<span class="o">=</span>127.0.0.1:9701 -server-tls-skip-verify&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>waypoint-server-run.sh</span>
    </div>
</div>
<h4 id="construcci√≥n-de-un-proyecto-con-waypoint-utilizando-buildpacks">Construcci√≥n de un proyecto con Waypoint utilizando Buildpacks</h4>
<p>En un art√≠culo anterior mostraba c√≥mo construir una aplicaci√≥n con el lenguaje Java de <a href="https://projects.spring.io/spring-boot/">Spring Boot</a> con <a href="https://gradle.org/">Gradle</a> y Buildpacks para generar la imagen del contenedor.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2023/01/construir-la-imagen-del-contenedor-de-la-aplicacion-usando-buildpacks/">Construir la imagen del contenedor de la aplicaci√≥n usando Buildpacks</a></li>
</ul>
<p>Para la construcci√≥n con Buildpacks utilizaba el siguiente comando que a trav√©s de argumentos configuraban los <em>buidpacks</em> y construcci√≥n de la aplicaci√≥n.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ pack build spring-injection-point <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--env <span class="s2">&#34;BP_JVM_TYPE=JDK&#34;</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--env <span class="s2">&#34;BP_JVM_VERSION=11&#34;</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--env <span class="s2">&#34;BP_GRADLE_BUILT_ARTIFACT=app/build/distributions/app.zip&#34;</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--builder paketobuildpacks/builder-jammy-base <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--buildpack gcr.io/paketo-buildpacks/ca-certificates <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--buildpack gcr.io/paketo-buildpacks/syft <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--buildpack gcr.io/paketo-buildpacks/procfile <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--buildpack gcr.io/paketo-buildpacks/adoptium <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--buildpack gcr.io/paketo-buildpacks/gradle <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--buildpack gcr.io/paketo-buildpacks/executable-jar <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--buildpack gcr.io/paketo-buildpacks/spring-boot <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--default-process app <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--path .</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>pack-build.sh</span>
    </div>
</div>
<p>Utilizando el soporte de Buildpacks de Waypoint la definici√≥n de la construcci√≥n se especifican los mismos argumentos pero definidos en el archivo configuraci√≥n de Waypoint. El comando <em>init</em> inicializa el proyecto en Waypoint a partir del archivo de su definici√≥n.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ waypoint init&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>waypoint-init.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-hcl" data-lang="hcl"><span class="line"><span class="cl"><span class="n">project</span> <span class="o">=</span> <span class="s2">&#34;Waypoint&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="k">app</span> <span class="s2">&#34;spring-injection-point&#34;</span> {&#10;</span></span><span class="line"><span class="cl">  <span class="k">build</span> {&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">use</span> <span class="s2">&#34;pack&#34;</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  builder</span> <span class="o">=</span> <span class="s2">&#34;paketobuildpacks/builder:base&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  buildpacks</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;gcr.io/paketo-buildpacks/ca-certificates&#34;, &#34;gcr.io/paketo-buildpacks/syft&#34;, &#34;gcr.io/paketo-buildpacks/procfile&#34;, &#34;gcr.io/paketo-buildpacks/adoptium&#34;, &#34;gcr.io/paketo-buildpacks/gradle&#34;, &#34;gcr.io/paketo-buildpacks/executable-jar&#34;, &#34;gcr.io/paketo-buildpacks/spring-boot&#34;</span><span class="p">]</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  process_type</span> <span class="o">=</span> <span class="s2">&#34;app&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  static_environment</span> <span class="o">=</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BP_JVM_TYPE</span> <span class="o">=</span> <span class="s2">&#34;JRE&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BP_JVM_VERSION</span> <span class="o">=</span> <span class="s2">&#34;11&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BP_GRADLE_BUILT_ARTIFACT</span> <span class="o">=</span> <span class="s2">&#34;app/build/distributions/app.zip&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">  }&#10;</span></span><span class="line"><span class="cl">  <span class="k">deploy</span> {&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">use</span> <span class="s2">&#34;docker&#34;</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  service_port</span> <span class="o">=</span> <span class="m">8080</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">  }&#10;</span></span><span class="line"><span class="cl">}&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>waypoint.hcl</span>
    </div>
</div>
<p>En la documentaci√≥n de Waypoint est√°n especificados los argumentos que soporta cada uno de los <em>builders</em>.</p>
<ul>
<li><a href="https://developer.hashicorp.com/waypoint/plugins/pack#pack-builder">pack (builder)</a></li>
<li><a href="https://developer.hashicorp.com/waypoint/plugins/docker#docker-builder">docker (builder)</a></li>
<li><a href="https://developer.hashicorp.com/waypoint/plugins/docker#docker-platform">docker (platform)</a></li>
</ul>
<p>Para lanzar √∫nicamente construcci√≥n se puede lanzar con el siguiente comando.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ waypoint build&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>waypoint-build.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span><span class="lnt">26&#10;</span><span class="lnt">27&#10;</span><span class="lnt">28&#10;</span><span class="lnt">29&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">¬ª Building spring-injection-point...&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">¬ª Performing operation locally&#10;</span></span><span class="line"><span class="cl">‚úì Running build v3&#10;</span></span><span class="line"><span class="cl">Creating new buildpack-based image using builder: paketobuildpacks/builder:base&#10;</span></span><span class="line"><span class="cl">‚úì Creating pack client&#10;</span></span><span class="line"><span class="cl">‚úì Building image&#10;</span></span><span class="line"><span class="cl"> ‚îÇ [exporter] Adding label &#39;io.buildpacks.build.metadata&#39;&#10;</span></span><span class="line"><span class="cl"> ‚îÇ [exporter] Adding label &#39;io.buildpacks.project.metadata&#39;&#10;</span></span><span class="line"><span class="cl"> ‚îÇ [exporter] Setting default process type &#39;app&#39;&#10;</span></span><span class="line"><span class="cl"> ‚îÇ [exporter] Saving spring-injection-point...&#10;</span></span><span class="line"><span class="cl"> ‚îÇ [exporter] *** Images (029d19ed3f4b):&#10;</span></span><span class="line"><span class="cl"> ‚îÇ [exporter]&nbsp;&nbsp;&nbsp;&nbsp;   spring-injection-point&#10;</span></span><span class="line"><span class="cl"> ‚îÇ [exporter] Reusing cache layer &#39;paketo-buildpacks/syft:syft&#39;&#10;</span></span><span class="line"><span class="cl"> ‚îÇ [exporter] Reusing cache layer &#39;paketo-buildpacks/adoptium:jdk&#39;&#10;</span></span><span class="line"><span class="cl"> ‚îÇ [exporter] Adding cache layer &#39;paketo-buildpacks/gradle:application&#39;&#10;</span></span><span class="line"><span class="cl"> ‚îÇ [exporter] Adding cache layer &#39;paketo-buildpacks/gradle:cache&#39;&#10;</span></span><span class="line"><span class="cl">‚úì Injecting entrypoint binary to image&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">Generated new Docker image: spring-injection-point:latest&#10;</span></span><span class="line"><span class="cl">‚úì Running push build v2&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">Created artifact v2&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">¬ª Variables used:&#10;</span></span><span class="line"><span class="cl">  VARIABLE | VALUE | TYPE | SOURCE  &#10;</span></span><span class="line"><span class="cl">-----------+-------+------+---------&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>waypoint-build.out</span>
    </div>
</div>
<p>En este ejemplo donde todo se muestra en local no hace falta especificar una <em>stanza</em> <em>registry</em> ya que Buildpacks de por s√≠ ya a√±ade al Docker local la imagen construida, har√≠a falta en caso de querer enviar la imagen un un registro de im√°genes y artefactos remoto.</p>
<p>La imagen construida no es m√°s que una imagen de Docker normal que se lista con el comando de Docker.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ docker images&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>docker-images.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">REPOSITORY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TAG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMAGE ID&nbsp;&nbsp;&nbsp;&nbsp;   CREATED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  SIZE&#10;</span></span><span class="line"><span class="cl">spring-injection-point&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; latest&nbsp;&nbsp;&nbsp;&nbsp; 8f069f971d7b   10 minutes ago   358MB&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>docker-images.out</span>
    </div>
</div>
<h4 id="despliegue-de-la-aplicaci√≥n-con-waypoint">Despliegue de la aplicaci√≥n con Waypoint</h4>
<p>En este ejemplo el despliegue consiste en ejecutar una instancia del contenedor con Docker en local, su <em>stanza</em> es muy sencilla en la que solo se especifica el puerto en el que arrancar el el contenedor aunque tambi√©n a trav√©s de diferentes propiedades se podr√≠an especificar argumentos distintos.</p>
<p>El comando que realiza el <em>deploy</em> es el siguiente. Y siguiendo la misma l√≥gica hay un comando para el <em>release</em> si fuera necesario.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ waypoint deploy&#10;</span></span><span class="line"><span class="cl">$ waypoint release&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>waypoint-deploy-release.sh</span>
    </div>
</div>
<p>Es posible hacer la construcci√≥n y despliegue con un √∫nico comando.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ waypoint up&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>waypoint-up.sh</span>
    </div>
</div>
<p>El servicio se inicia en la m√°quina y puede ser visto a trav√©s de la consola de Waypoint o con los comandos de Docker ya que en esencia no es m√°s que una instancia de contenedor.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ docker ps&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>docker-ps.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">CONTAINER ID   IMAGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   COMMAND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  CREATED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; STATUS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PORTS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NAMES&#10;</span></span><span class="line"><span class="cl">ce8c73a2f468   spring-injection-point:latest   &#34;/waypoint-entrypoin‚Ä¶&#34;   8 seconds ago   Up 7 seconds   0.0.0.0:32768-&gt;8080/tcp, :::32768-&gt;8080/tcp   spring-injection-point-01GQ5SA9SQ9KZKWJMKSQ1PHAWJ&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>docker-ps.out</span>
    </div>
</div>
<p>La aplicaci√≥n y su <em>endpoint</em> <em>web</em> responden al realizar una petici√≥n.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ curl http://localhost:32768/&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>curl.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">Hello World!&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>curl.out</span>
    </div>
</div>
<h4 id="interfaz-web-y-de-linea-de-comandos">Interfaz web y de linea de comandos</h4>
<p>La interfaz web de Waypoint accesible con un navegador ofrece informaci√≥n de los proyectos, <em>builds</em>, <em>deployments</em> y <em>releases</em> adem√°s de <em>logs</em>.</p>
<p>La linea de comandos tambi√©n ofrece informaci√≥n acerca de la aplicaci√≥n con los comandos de Waypoint sin utilizar la interfaz web. La l√≠nea de comandos soporta m√°s operaciones como destruir los recursos de un proyecto o eliminar el proyecto completamente.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ waypoint deployment list&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>waypoint-deployment-list.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span><span class="lnt">4&#10;</span><span class="lnt">5&#10;</span><span class="lnt">6&#10;</span><span class="lnt">7&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">¬ª spring-injection-point&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp; <span class="p">|</span> ID <span class="p">|</span> PLATFORM <span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DETAILS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;STARTED&nbsp;&nbsp;&nbsp;&nbsp; <span class="p">|</span>   COMPLETED&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;   HEALTH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#10;</span></span><span class="line"><span class="cl">  üöÄ <span class="p">|</span>  <span class="m">1</span> <span class="p">|</span> docker   <span class="p">|</span> image:8f069f9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="p">|</span> <span class="m">33</span> minutes ago <span class="p">|</span> <span class="m">33</span> minutes ago <span class="p">|</span> ‚úî - <span class="m">33</span> minutes ago  &#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp; <span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="p">|</span> languages:ca-certificates,&nbsp;&nbsp;&nbsp;&nbsp;  &#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp; <span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="p">|</span> syft, procfile, adoptium,&nbsp;&nbsp;&nbsp;&nbsp;   &#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp; <span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="p">|</span> gradle, executable-jar,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp; <span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="p">|</span> spring-boo</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>waypoint-deployment-list.out</span>
    </div>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2023/01/construir-desplegar-y-observar-aplicaciones-de-forma-uniforme-con-waypoint/images/waypoint_hu8cdc5af5db3d063a447dbf08d12596c5_63265_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Interfaz web de Waypoint"><img src="https://picodotdev.github.io/blog-bitix/2023/01/construir-desplegar-y-observar-aplicaciones-de-forma-uniforme-con-waypoint/images/waypoint_hu8cdc5af5db3d063a447dbf08d12596c5_63265_650x450_fit_q90_h2_box_3.webp" width="465" height="450" alt="Interfaz web de Waypoint" title="Interfaz web de Waypoint" class="&#34; " loading="lazy"></a></p>
<figcaption>Interfaz web de Waypoint</figcaption>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2023/01/construir-desplegar-y-observar-aplicaciones-de-forma-uniforme-con-waypoint/images/waypoint-builds_hu223ae1c194bb402030d2743562a55f44_116223_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Builds"><img src="https://picodotdev.github.io/blog-bitix/2023/01/construir-desplegar-y-observar-aplicaciones-de-forma-uniforme-con-waypoint/images/waypoint-builds_hu223ae1c194bb402030d2743562a55f44_116223_200x150_fit_q90_h2_box_3.webp" width="155" height="150" alt="Builds" title="Builds" class="&#34; " loading="lazy"></a>
<a href="https://picodotdev.github.io/blog-bitix/2023/01/construir-desplegar-y-observar-aplicaciones-de-forma-uniforme-con-waypoint/images/waypoint-deployments_hu28e10d00ec4f33e8dedeff88520950d4_202768_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Deployments"><img src="https://picodotdev.github.io/blog-bitix/2023/01/construir-desplegar-y-observar-aplicaciones-de-forma-uniforme-con-waypoint/images/waypoint-deployments_hu28e10d00ec4f33e8dedeff88520950d4_202768_200x150_fit_q90_h2_box_3.webp" width="155" height="150" alt="Deployments" title="Deployments" class="&#34; " loading="lazy"></a>
<a href="https://picodotdev.github.io/blog-bitix/2023/01/construir-desplegar-y-observar-aplicaciones-de-forma-uniforme-con-waypoint/images/waypoint-releases_hu956fb436e82f155b792458aa0ea7526a_86031_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Relases"><img src="https://picodotdev.github.io/blog-bitix/2023/01/construir-desplegar-y-observar-aplicaciones-de-forma-uniforme-con-waypoint/images/waypoint-releases_hu956fb436e82f155b792458aa0ea7526a_86031_200x150_fit_q90_h2_box_3.webp" width="155" height="150" alt="Relases" title="Relases" class="&#34; " loading="lazy"></a></p>
<figcaption>Builds, deployments y releases de una aplicaci√≥n en un proyecto</figcaption>
</figure>
</div>
<h3 id="desarrollo-en-local">Desarrollo en local</h3>
<p>Para desarrollar en local todo este proceso de Buildpacks y Waypoint no es necesario, en el caso de la aplicaci√≥n de ejemplo al estar basada en Spring Boot y utilizar Gradle es posible iniciarla con un comando directamente sin necesidad de construir una imagen de contenedor ni iniciar un contenedor en local.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ./gradlew run&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>gradlew-run.sh</span>
    </div>
</div>
<div class="alert alert-secondary sourcecode">
    <img src="https://picodotdev.github.io/blog-bitix/assets/images/icons/terminal.svg" width="64" height="64" alt="Terminal" title="Terminal" class="lozad sourcecode-icon">
    <p>
            El <a href="https://github.com/picodotdev/blog-ejemplos/tree/master/SpringInjectionPoint">c√≥digo fuente completo del ejemplo</a> puedes descargarlo del repositorio de ejemplos de Blog Bitix alojado en GitHub y probarlo en tu equipo ejecutando siguiente comando:<br><code>./gradlew run</code></p>
</div>
]]>
        </content>
        
            
                <category term="gnu-linux"/>
            
                <category term="planeta-codigo"/>
            
                <category term="software"/>
            
                <category term="programacion"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2023/01/construir-la-imagen-del-contenedor-de-la-aplicacion-usando-buildpacks/</id>
        <title>Construir la imagen del contenedor de la aplicaci√≥n usando Buildpacks</title>
        <updated>2023-01-11T20:00:00+01:00</updated>
        <published>2023-01-11T20:00:00+01:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2023/01/construir-la-imagen-del-contenedor-de-la-aplicacion-usando-buildpacks/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Los sistemas y servicios son significativamente complejos por s√≠ mismos, adem√°s en sistemas que se componen de varios de ellos cada uno con sus diferencias a√±ade m√°s complejidad al sistema. Eliminar toda la complejidad posible y simplificar el sistema es algo deseable. La herramienta Buildpacks aplica a la construcci√≥n de las aplicaciones lo que los contenedores aplican en tiempo de ejecuci√≥n de las mismas, uniformizando las aplicaciones independientemente del lenguaje y plataforma que usen.</strong></p>]]>
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/buildpacksio.svg" width="200" height="200" alt="Buildpacks" title="Buildpacks" class="" loading="false&#34;"></p>
</div>
<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/paketo.svg" width="150" height="272" alt="Paketo" title="Paketo" class="" loading="false&#34;"></p>
</div>
<p>Los contenedores son una gran tecnolog√≠a ya que hace muy simple ejecutar servicios independientemente de c√≥mo est√°n implementados y en qu√© lenguaje, uniformizan los procesos a ejecutar y tratarlos a todos de la misma forma y con la misma herramienta.</p>
<p>Al igual que en los barcos los contenedores facilitan transportar mercanc√≠as, en el √°mbito de la tecnolog√≠a los contenedores simplifican mucho la infraestructura en tiempo de ejecuci√≥n permitiendo tratar los servicios de forma uniforme.</p>
<p>Los contendores se basan en una imagen y una herramienta que los ejecuta, una de las herramientas m√°s conocidas para ejecutar contenedores es <a href="https://www.docker.com/">Docker</a> y el archivo con las instrucciones para construir las im√°genes son los archivos <em>Dockerfile</em>.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2014/10/introduccion-y-caracteristicas-de-docker/">Introducci√≥n y caracter√≠sticas de Docker</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2014/11/como-crear-una-imagen-para-docker-usando-un-dockerfile/">C√≥mo crear una imagen para Docker usando un Dockerfile</a></li>
</ul>
<p>Es muy √∫til poder ejecutar procesos de forma uniforme independientemente del lenguaje y de forma aislada con todas las dependencias del entorno dentro de la imagen lo que permite ejecutar tantos servicios como se deseen sin que las dependencias de estos entre en conflicto.</p>
<p>La misma utilidad y propiedades de los contenedores en tiempo de ejecuci√≥n es deseable en el momento de construcci√≥n de las im√°genes de los servicios.</p>
<div class="alert alert-warning pt-0 pb-0 tableofcontents"><h2>Contenido del art√≠culo</h2><toc></toc></div>
<h3 id="la-herramienta-buildpacks">La herramienta Buildpacks</h3>
<p>La herramienta <a href="https://buildpacks.io/">Buildpacks</a> analiza el c√≥digo fuente y permite construir im√°genes de contenedores compatible con OCI con la misma herramienta independientemente del lenguaje o plataforma que utilice y sin utilizar archivos Dockerfile. Adem√°s, permite reutilizar las instrucciones de construcci√≥n sin tener que implementarlas.</p>
<p>Los <em>buildpacks</em> son los m√≥dulos que a√±aden el soporte e implementan las instrucciones para construir las im√°genes. Hay un <em>buildpack</em> espec√≠fico seg√∫n una necesidad de construcci√≥n, una aplicaci√≥n puede necesitar varios <em>buildpacks</em> al mismo tiempo.</p>
<p>Por ejemplo, una aplicaci√≥n Java necesita una versi√≥n de la JVM para ejecutarse que es proporcionado por un <em>buildpack</em>, si la aplicaci√≥n utiliza <a href="https://gradle.org/">Gradle</a> como herramienta de construcci√≥n hay un <em>nuildpack</em> para construir aplicaciones Gradle. Y hay <em>buildpacks</em> para Java, <a href="https://nodejs.org/en/">Node</a>, <a href="https://www.python.org/">Python</a> y otros lenguajes.</p>
<p><a href="https://buildpacks.io/docs/concepts/">Los conceptos que usa Buildpacks</a> son:</p>
<ul>
<li><em>Builder</em>: es la imagen del contenedor con la que se realiza la construcci√≥n, contiene todos los componentes necesarios junto con los <em>buildpacks</em> para ejecutar la construcci√≥n.</li>
<li><em>Buildpack</em>: es el ejecutable que construye y ejecuta la aplicaci√≥n. Al realizar la construcci√≥n contribuye los archivos necesarios a la imagen del contenedor resultante.</li>
<li><em>Lifecycle</em>: orquesta la construcci√≥n con los <em>buildpacks</em> y ensambla los artefactos resultantes en la imagen del contenedor.</li>
<li><em>Stack</em>: se compone de dos im√°genes de contenedor, la imagen <em>builder</em> que proporciona la imagen para realizar la construcci√≥n y la imagen <em>run</em> que proporciona la imagen para la ejecuci√≥n.</li>
</ul>
<p>Buildpacks es extensible y es posible crear y usar <em>builders</em> y <em>buildpaks</em> propios ajustados a las necesidades de la organizaci√≥n o aplicaci√≥n si los existentes no son suficientes.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2023/01/construir-la-imagen-del-contenedor-de-la-aplicacion-usando-buildpacks/images/buildpack-what.svg" data-gallery="" title="Buildpack"><img src="https://picodotdev.github.io/blog-bitix/2023/01/construir-la-imagen-del-contenedor-de-la-aplicacion-usando-buildpacks/images/buildpack-what.svg" width="300" height="200" alt="Buildpack" title="Buildpack" class="&#34; " loading="lazy"></a>
<a href="https://picodotdev.github.io/blog-bitix/2023/01/construir-la-imagen-del-contenedor-de-la-aplicacion-usando-buildpacks/images/buildpack-builder.svg" data-gallery="" title="Buildpack builder"><img src="https://picodotdev.github.io/blog-bitix/2023/01/construir-la-imagen-del-contenedor-de-la-aplicacion-usando-buildpacks/images/buildpack-builder.svg" width="300" height="200" alt="Buildpack builder" title="Buildpack builder" class="&#34; " loading="lazy"></a></p>
<figcaption>Buildpack</figcaption>
</figure>
</div>
<h3 id="el-proyecto-paketo">El proyecto Paketo</h3>
<p><a href="https://paketo.io/">Paketo</a> es un proyecto de c√≥digo abierto que proporciona numerosos <em>buildpacks</em> para diferentes lenguajes de las aplicaciones m√°s populares entre los que por supuesto est√°n Java, Node, Python y Go entre otros.</p>
<p>En el <a href="https://github.com/paketo-buildpacks">proyecto de GitHub de Paketo</a> est√°n los diferentes repositorios de los <em>buildpacks</em> junto con sus opciones de configuraci√≥n y c√≥digo fuente, adem√°s proporciona varios <em>builder</em> basados en diferentes versiones de <a href="https://www.ubuntu.com/">Ubuntu</a>.</p>
<ul>
<li><a href="https://paketo.io/docs/reference/builders-reference/">Paketo Builders Reference</a></li>
</ul>
<h3 id="instalaci√≥n-de-buildpacks">Instalaci√≥n de Buildpacks</h3>
<p>Hay <a href="https://buildpacks.io/docs/tools/pack/">varias formas de instalaci√≥n de Buildpacks</a> seg√∫n el sistema operativo que se use, junto a varias formas de instalaci√≥n usando el gestor de paquetes nativo del sistema operativo o una instalaci√≥n manual en el sistema.</p>
<p>Builpacks es una herramienta programada en el lenguaje Go que una de sus ventajas es que generan un √∫nico binario que incluye todas las dependencias con lo que su instalaci√≥n manual es muy sencilla, basta con descargar y copiar un √∫nico archivo.</p>
<p>En <a href="https://www.gnu.org/">GNU</a>/<a href="https://www.linux.com/">Linux</a> basta descargar el paquete de distribuci√≥n para este sistema operativo, descomprimirlo e instalar el binario en el <em>path</em> del sistema de modo que al ejecutar el comando el int√©rprete del <em>shell</em> lo encuentre. En GNU/Linux el directorio <em>/usr/local/bin</em> permite a√±adir al sistema comandos adicionales sin que entren en conflicto con los que se instalan a trav√©s de paquetes de la distribuci√≥n.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ls -lh /usr/local/bin/&#10;</span></span><span class="line"><span class="cl">-rwxr-xr-x <span class="m">1</span> picodotdev picodotdev  23M ene <span class="m">10</span> 11:31 pack&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>ls-bin.sh</span>
    </div>
</div>
<h3 id="construcci√≥n-de-la-imagen-del-contenedor">Construcci√≥n de la imagen del contenedor</h3>
<p>Utilizando una aplicaci√≥n escrita con Java con Gradle como herramienta de construcci√≥n y que usa <a href="https://projects.spring.io/spring-boot/">Spring Boot</a>, el comando para construir la imagen OCI del contenedor es el siguiente.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ pack build spring-injection-point <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--env <span class="s2">&#34;BP_JVM_TYPE=JDK&#34;</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--env <span class="s2">&#34;BP_JVM_VERSION=11&#34;</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--env <span class="s2">&#34;BP_GRADLE_BUILT_ARTIFACT=app/build/distributions/app.zip&#34;</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--builder paketobuildpacks/builder-jammy-base <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--buildpack gcr.io/paketo-buildpacks/ca-certificates <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--buildpack gcr.io/paketo-buildpacks/syft <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--buildpack gcr.io/paketo-buildpacks/procfile <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--buildpack gcr.io/paketo-buildpacks/adoptium <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--buildpack gcr.io/paketo-buildpacks/gradle <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--buildpack gcr.io/paketo-buildpacks/executable-jar <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--buildpack gcr.io/paketo-buildpacks/spring-boot <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--default-process app <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;--path .</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>pack-build.sh</span>
    </div>
</div>
<p>Los <em>builpacks</em> permiten ser configurados a trav√©s de las variables de entorno, en el comando es posible configurar el <em>buildpack</em> de <em>adoptioum</em> para que use la versi√≥n de Java que se desee o el tipo de m√°quina virtual, distribuci√≥n JDK o JRE. En el archivo README.md de cada uno de los <em>buildpacks</em> est√°n documentados las variables de entorno con su descripci√≥n y en algunos casos sus valores.</p>
<ul>
<li><a href="https://github.com/paketo-buildpacks/adoptium">paketo-buildpacks/adoptium README.md</a></li>
<li><a href="https://github.com/paketo-buildpacks/gradle">paketo-buildpacks/gradle README.md</a></li>
</ul>
<p>El comando especifica los <em>buildpacks</em> ya que el <em>builder</em> utilizado no incluye ninguno. En el par√°metro <em>path</em> se indica la ruta al c√≥digo fuente de la aplicaci√≥n.</p>
<p>El <em>buildpack</em> <em>paketo-buildpacks/procfile</em> permite especificar diferentes comandos de ejecuci√≥n en un archivo. El <em>entrypoint</em> que a√±ade el <em>builder</em> en la imagen permite especificar el proceso a iniciar en el comando de ejecuci√≥n del contenedor.</p>
<h3 id="ejecuci√≥n-del-contenedor-con-docker">Ejecuci√≥n del contenedor con Docker</h3>
<p>Docker permite almacenar en local y ejecutar las im√°genes construidas con Buildpacks como un contenedor normal. El comando para iniciar la aplicaci√≥n es el siguiente que inicia el proceso por defecto de la imagen.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ docker run -it --rm -p 8080:8080 spring-injection-point&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>docker-run.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span><span class="lnt">26&#10;</span><span class="lnt">27&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">Setting Active Processor Count to 8&#10;</span></span><span class="line"><span class="cl">Calculating JVM memory based on 13813724K available memory&#10;</span></span><span class="line"><span class="cl">For more information on this calculation, see https://paketo.io/docs/reference/java-reference/#memory-calculator&#10;</span></span><span class="line"><span class="cl">Calculated JVM Memory Configuration: -XX:MaxDirectMemorySize=10M -Xmx13215722K -XX:MaxMetaspaceSize=86001K -XX:ReservedCodeCacheSize=240M -Xss1M (Total Memory: 13813724K, Thread Count: 250, Loaded Class Count: 12770, Headroom: 0%)&#10;</span></span><span class="line"><span class="cl">Enabling Java Native Memory Tracking&#10;</span></span><span class="line"><span class="cl">Adding 124 container CA certificates to JVM truststore&#10;</span></span><span class="line"><span class="cl">Picked up JAVA_TOOL_OPTIONS: -Djava.security.properties=/layers/paketo-buildpacks_adoptium/java-security-properties/java-security.properties -XX:+ExitOnOutOfMemoryError -XX:ActiveProcessorCount=8 -XX:MaxDirectMemorySize=10M -Xmx13215722K -XX:MaxMetaspaceSize=86001K -XX:ReservedCodeCacheSize=240M -Xss1M -XX:+UnlockDiagnosticVMOptions -XX:NativeMemoryTracking=summary -XX:+PrintNMTStatistics&#10;</span></span><span class="line"><span class="cl">Property (app.property): value&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">  .   ____&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  _&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__ _ _&#10;</span></span><span class="line"><span class="cl"> /\\ / ___&#39;_ __ _ _(_)_ __  __ _ \ \ \ \&#10;</span></span><span class="line"><span class="cl">( ( )\___ | &#39;_ | &#39;_| | &#39;_ \/ _` | \ \ \ \&#10;</span></span><span class="line"><span class="cl"> \\/  ___)| |_)| | | | | || (_| |  ) ) ) )&#10;</span></span><span class="line"><span class="cl">  &#39;  |____| .__|_| |_|_| |_\__, | / / / /&#10;</span></span><span class="line"><span class="cl"> =========|_|==============|___/=/_/_/_/&#10;</span></span><span class="line"><span class="cl"> :: Spring Boot ::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(v2.7.6)&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">2023-01-11 19:53:33,542 INFO  [main]&nbsp;&nbsp;&nbsp;&nbsp; io.github.picodotdev.blogbitix.springinjectionpoint.Main Starting Main using Java 11.0.17 on d5713708092f with PID 1 (/workspace/app/lib/app.jar started by cnb in /workspace)&#10;</span></span><span class="line"><span class="cl">2023-01-11 19:53:33,550 INFO  [main]&nbsp;&nbsp;&nbsp;&nbsp; io.github.picodotdev.blogbitix.springinjectionpoint.Main No active profile set, falling back to 1 default profile: &#34;default&#34;&#10;</span></span><span class="line"><span class="cl">2023-01-11 19:53:34,402 INFO  [main] org.springframework.boot.web.embedded.tomcat.TomcatWebServer Tomcat initialized with port(s): 8080 (http)&#10;</span></span><span class="line"><span class="cl">2023-01-11 19:53:34,423 INFO  [main]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; org.apache.catalina.core.StandardService Starting service [Tomcat]&#10;</span></span><span class="line"><span class="cl">2023-01-11 19:53:34,424 INFO  [main]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  org.apache.catalina.core.StandardEngine Starting Servlet engine: [Apache Tomcat/9.0.69]&#10;</span></span><span class="line"><span class="cl">2023-01-11 19:53:34,524 INFO  [main] .apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] Initializing Spring embedded WebApplicationContext&#10;</span></span><span class="line"><span class="cl">2023-01-11 19:53:34,524 INFO  [main] .boot.web.servlet.context.ServletWebServerApplicationContext Root WebApplicationContext: initialization completed in 931 ms&#10;</span></span><span class="line"><span class="cl">2023-01-11 19:53:34,932 INFO  [main] org.springframework.boot.web.embedded.tomcat.TomcatWebServer Tomcat started on port(s): 8080 (http) with context path &#39;&#39;&#10;</span></span><span class="line"><span class="cl">2023-01-11 19:53:34,944 INFO  [main]&nbsp;&nbsp;&nbsp;&nbsp; io.github.picodotdev.blogbitix.springinjectionpoint.Main Started Main in 1.858 seconds (JVM running for 2.534)&#10;</span></span><span class="line"><span class="cl">2023-01-11 19:53:34,946 INFO  [main]  io.github.picodotdev.blogbitix.springinjectionpoint.Service Hello World!</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>System.out</span>
    </div>
</div>
<p>Los <em>buildpacks</em> a√±aden un <em>launcher</em> que permite <a href="https://buildpacks.io/docs/app-developer-guide/run-an-app/">varias formas de ejecutar el contenedor de la aplicaci√≥n</a>. Tambi√©n es posible especificar otro proceso de la imagen con la opci√≥n <em>&ndash;entrypoint</em> y el nombre del proceso.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ docker run -it --rm --entrypoint app -p 8080:8080 spring-injection-point&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>docker-run-entrypoint.sh</span>
    </div>
</div>
<p>A veces interesa iniciar una <em>shell</em> para inspeccionar el sistema de archivos del contenedor y ejecutar procesos manualmente. En este ejemplo se muestra la versi√≥n de Ubuntu que forma la imagen base del contenedor y se aprecia que est√° basada en la versi√≥n 22.04.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ docker run -it --rm --entrypoint launcher -p 8080:8080 spring-injection-point bash&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>docker-run-entrypoint-bash.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">$ cat /etc/issue&#10;</span></span><span class="line"><span class="cl">Ubuntu 22.04.1 LTS&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>issue.out</span>
    </div>
</div>
<p>Finalmente, es posible inspeccionar la imagen del contenedor sin iniciarlo para obtener informaci√≥n acerca de c√≥mo se ha construido.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ pack inspect-image spring-injection-point&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>pack-inspect-image.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span><span class="lnt">26&#10;</span><span class="lnt">27&#10;</span><span class="lnt">28&#10;</span><span class="lnt">29&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">Inspecting image: spring-injection-point&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">REMOTE:&#10;</span></span><span class="line"><span class="cl">(not present)&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">LOCAL:&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">Stack: io.buildpacks.stacks.jammy&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">Base Image:&#10;</span></span><span class="line"><span class="cl">  Reference: 9460382ca7aa20a60d1dcb756dbeb1535fe3e2eeb3e0c01a85ad7a60eaa091ad&#10;</span></span><span class="line"><span class="cl">  Top Layer: sha256:5853f77d360cc55683c2896aa9fd14bf47430731ad6fec18d9511f56656c232f&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">Run Images:&#10;</span></span><span class="line"><span class="cl">  index.docker.io/paketobuildpacks/run-jammy-base:latest&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">Buildpacks:&#10;</span></span><span class="line"><span class="cl">  ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   VERSION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOMEPAGE&#10;</span></span><span class="line"><span class="cl">  paketo-buildpacks/ca-certificates&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.5.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  https://github.com/paketo-buildpacks/ca-certificates&#10;</span></span><span class="line"><span class="cl">  paketo-buildpacks/syft&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   1.23.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; https://github.com/paketo-buildpacks/syft&#10;</span></span><span class="line"><span class="cl">  paketo-buildpacks/procfile&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   5.5.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  https://github.com/paketo-buildpacks/procfile&#10;</span></span><span class="line"><span class="cl">  paketo-buildpacks/adoptium&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   10.8.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; https://github.com/paketo-buildpacks/adoptium&#10;</span></span><span class="line"><span class="cl">  paketo-buildpacks/gradle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6.10.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; https://github.com/paketo-buildpacks/gradle&#10;</span></span><span class="line"><span class="cl">  paketo-buildpacks/executable-jar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6.5.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  https://github.com/paketo-buildpacks/executable-jar&#10;</span></span><span class="line"><span class="cl">  paketo-buildpacks/spring-boot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.22.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; https://github.com/paketo-buildpacks/spring-boot&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">Processes:&#10;</span></span><span class="line"><span class="cl">  TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHELL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMAND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ARGS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WORK DIR&#10;</span></span><span class="line"><span class="cl">  app (default)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bash&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JAVA_HOME=/layers/paketo-buildpacks_adoptium/jre app/bin/app&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/workspace</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>pack-inspect-image.out</span>
    </div>
</div>
<div class="alert alert-secondary sourcecode">
    <img src="https://picodotdev.github.io/blog-bitix/assets/images/icons/terminal.svg" width="64" height="64" alt="Terminal" title="Terminal" class="lozad sourcecode-icon">
    <p>
            El <a href="https://github.com/picodotdev/blog-ejemplos/tree/master/SpringInjectionPoint">c√≥digo fuente completo del ejemplo</a> puedes descargarlo del repositorio de ejemplos de Blog Bitix alojado en GitHub y probarlo en tu equipo ejecutando siguiente comando:<br><code>./pack-build.sh</code></p>
</div>
]]>
        </content>
        
            
                <category term="java"/>
            
                <category term="planeta-codigo"/>
            
                <category term="programacion"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2022/12/radar-tecnologico-y-otras-fuentes-de-informacion-sobre-programacion/</id>
        <title>Radar tecnol√≥gico y otras fuentes de informaci√≥n sobre programaci√≥n</title>
        <updated>2022-12-15T21:00:00+02:00</updated>
        <published>2022-12-15T21:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2022/12/radar-tecnologico-y-otras-fuentes-de-informacion-sobre-programacion/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Conocer que herramientas hay disponibles permite elegir aquellas que m√°s apropiadas sean para resolver un problema, las herramientas no son el fin pero si un medio determinante. Las herramientas usadas diariamente en el trabajo no permiten experimentar y conocer otras nuevas herramientas que en alg√∫n momento puedan pasar a considerarse una mejor opci√≥n. El radar tecnol√≥gico de Thoughtworks hace un resumen al menos dos veces al a√±o a tener en cuenta con los cambios en las herramientas, adem√°s permite conocer nuevas herramientas.</strong></p>]]>
        <![CDATA[<p>Con el paso del tiempo surgen nuevas herramientas que pretenden sustituir a otras existentes, proporcionando algunas nuevas funcionalidades o no teniendo algunos defectos. Algunas de estas nuevas herramientas no ganan la suficiente popularidad, otras con el tiempo consiguen ser usadas por un n√∫mero mayor de usuarios y llegan a considerarse la mejor herramienta y est√°ndar para su nicho de funcionalidad, hasta que al cabo de otros a√±os es sustituida por otra herramienta nueva.</p>
<p>Es recomendable seguir las novedades que van surgiendo en la tecnolog√≠a y herramientas de desarrollo. Aunque las herramientas no son el principal factor para desarrollar un buen programa o un producto bien utilizadas y utilizando las adecuadas si contribuyen a evitar problemas y facilitar su desarrollo por no mencionar que utilizar tecnolog√≠as que ya se consideran obsoletas tienen otras consideraciones como un motivo de decisi√≥n para trabajar o no en una empresa simplemente porque es una consideraci√≥n para la evoluci√≥n profesional de los empleados.</p>
<h3 id="qu√©-necesitan-las-aplicaciones">Qu√© necesitan las aplicaciones</h3>
<p>Las funcionalidades que necesitan las aplicaciones no cambian tanto como las herramientas. Una aplicaci√≥n monol√≠tica es muy diferente de otra basada en microservicios y sus necesidades de herramientas son muy distintas pero comparten algunas necesidades. Ambas con seguridad necesitan herramientas de integraci√≥n continua, una base de datos y monitorizaci√≥n y observabilidad, las aplicaciones basadas en microservicios al ser m√°s complejas necesitar√°n m√°s herramientas a√∫n.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2020/09/funcionalidades-que-necesitan-las-aplicaciones-basadas-en-microservicios-y-herramientas-que-las-proporcionan/">Funcionalidades que necesitan las aplicaciones basadas en microservicios y herramientas que las proporcionan</a></li>
</ul>
<h3 id="el-radar-tecnol√≥gico-de-thoughtworks">El radar tecnol√≥gico de Thoughtworks</h3>
<p><a href="https://www.thoughtworks.com/radar">El radar tecnol√≥gico de Thoughtworks</a> hace un resumen de las novedades que se producen en la tecnolog√≠a relacionadas con el desarrollo de aplicaciones. Se publica m√°s o menos cada seis meses con las novedades de ese periodo de tiempo y mantiene un archivo para consultar las ediciones anteriores. Este radar es una fuente de informaci√≥n muy interesante para conocer herramientas y novedades que se producen en la tecnolog√≠a, no todos los meses pero cada a√±o es posible que surjan novedades interesantes que hay que evaluar si adoptar.</p>
<p>El radar tecnol√≥gico se divide en cuatro aspectos o cuadrantes de t√©cnicas, plataformas, herramientas y lenguajes y <em>frameworks</em>. A su vez cada aspecto se divide en varios anillos de resistir, evaluar, probar y adoptar seg√∫n su grado de recomendaci√≥n. Dentro de cada cuadrante y anillo se posicionan los puntos o <em>blips</em> que el radar ha detectado con cambios para estar informado.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2022/12/radar-tecnologico-y-otras-fuentes-de-informacion-sobre-programacion/images/thoughtworks-radar_hu0d14f8df1656918a3069cd7fb443e5f6_272571_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="El radar tecnol√≥gico de Thoughtworks"><img src="https://picodotdev.github.io/blog-bitix/2022/12/radar-tecnologico-y-otras-fuentes-de-informacion-sobre-programacion/images/thoughtworks-radar_hu0d14f8df1656918a3069cd7fb443e5f6_272571_650x450_fit_q90_h2_box_3.webp" width="447" height="450" alt="El radar tecnol√≥gico de Thoughtworks" title="El radar tecnol√≥gico de Thoughtworks" class="&#34; " loading="lazy"></a></p>
<figcaption>El radar tecnol√≥gico de Thoughtworks</figcaption>
</figure>
</div>
<h3 id="otras-fuentes-de-informaci√≥n">Otras fuentes de informaci√≥n</h3>
<p>En el caso de Java con su nuevo calendario de publicaci√≥n cada seis meses hace que las nuevas versiones y novedades que incorpora sean m√°s numerosas. Las notas de publicaci√≥n de Java incluyen todas las novedades que va incorporando el lenguaje y la plataforma.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/series/java-platform/">Novedades del lenguaje y la plataforma Java</a></li>
</ul>
<p>Es posible seguir varias p√°ginas de informaci√≥n con novedades en tecnolog√≠a, desarrollo y programaci√≥n <a href="https://www.infoq.com/">InfoQ</a>, <a href="https://dzone.com/">DZone</a>, <a href="https://www.theserverside.com/">TheServerSide</a>, <a href="https://martinfowler.com/">Martin Fowler</a>, <a href="http://developer.com/">Developer.com</a>, <a href="https://blog.jetbrains.com/">JetBrains Blog</a>, <a href="https://www.oreilly.com/radar/">OReilly Radar</a>, <a href="https://increment.com/">Increment</a>, <a href="https://leaddev.com/">LeadDev</a>, <a href="https://sreweekly.com/">SRE Weekly</a>, <a href="https://www.javacodegeeks.com/">Java Code Geeks</a> son solo algunos, ¬øconoces alg√∫n sitio m√°s de informaci√≥n sobre programaci√≥n y desarrollo que ofrezca art√≠culos interesantes y de gran calidad?</p>
]]>
        </content>
        
            
                <category term="planeta-codigo"/>
            
                <category term="programacion"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2022/12/base-de-datos-de-paises-regiones-ciudades-codigos-postales-y-otra-informacion-geografica/</id>
        <title>Base de datos de pa√≠ses, regiones, ciudades, c√≥digos postales y otra informaci√≥n geogr√°fica</title>
        <updated>2022-12-01T19:30:00+01:00</updated>
        <published>2022-12-01T19:30:00+01:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2022/12/base-de-datos-de-paises-regiones-ciudades-codigos-postales-y-otra-informacion-geografica/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Entre las funcionalidades habituales en una aplicaci√≥n est√° un formulario para introducir una direcci√≥n. El formulario de direcci√≥n consta de varios campos en el que suele ser recomendable realizar unas m√≠nimas validaciones como que el c√≥digo postal o ciudad sea correcto para evitar errores inadvertidos del usuario o intencionados con informaci√≥n incorrecta. La base de datos de GeoNames proporciona informaci√≥n geogr√°fica muy √∫til y de forma gratuita que incluye pa√≠ses, ciudades, subdivisiones administrativas, c√≥digos postales, nombres en diferentes idiomas y mucha otra informaci√≥n de todos los paises del mundo.</strong></p>]]>
        <![CDATA[<p>No todo son microservicios es m√°s ni siquiera estos son la mejor opci√≥n en muchos casos, las cosas mundanas tienen tambi√©n mucha importancia en la aplicaci√≥n c√≥mo ordenar alfab√©ticamente cadenas o introducir una direcci√≥n postal. Es habitual un formulario en el que haya que introducir direcciones lo que incluye c√≥digos postales, ciudad, pa√≠s y quiz√° adicionalmente un tel√©fono.</p>
<p>Lo que parece un simple formulario con varios campos de datos se complica cuando hay que validar los c√≥digos postales, ciudad de un pa√≠s o al incluir informaci√≥n de las diferentes subdivisiones administrativas. M√°s si en el formulario hay que tener en cuenta las diferentes variaciones seg√∫n cada pa√≠s, los c√≥digos postales de Espa√±a son muy diferentes de los de Reino Unido lo que significa que la expresi√≥n regular es muy diferente y seg√∫n la normativa del pa√≠s.</p>
<p>Estas tareas que parecen sencillas realmente tienen su dificultad, ordenar caracteres alfab√©ticamente se complica ya que hay que tener en cuenta las tildes o may√∫sculas y min√∫sculas y validar direcciones para recibir datos correctos requiere validaciones y conocer cuales son los valores v√°lidos.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/11/la-forma-correcta-de-ordenar-alfabeticamente-cadenas-en-java/">La forma correcta de ordenar alfab√©ticamente cadenas en Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2016/06/ofrecer-contenido-personalizado-al-usuario-basado-en-su-ubicacion/">Ofrecer contenido personalizado al usuario basado en su ubicaci√≥n</a></li>
</ul>
<p>El listado de pa√≠ses, unidades administrativas como comunidades aut√≥nomas, ciudades y c√≥digos postales adem√°s del c√≥digo del prefijo telef√≥nico del pa√≠s o zona horaria es habitual configurarlo como informaci√≥n m√°s o menos est√°tica en las aplicaciones ya sea en una base de datos o en archivos de configuraci√≥n.</p>
<div class="alert alert-warning pt-0 pb-0 tableofcontents"><h2>Contenido del art√≠culo</h2><toc></toc></div>
<h3 id="la-base-de-datos-de-informaci√≥n-geogr√°fica-de-geonames">La base de datos de informaci√≥n geogr√°fica de GeoNames</h3>
<p>Una fuente que permite obtener esta informaci√≥n geogr√°fica es la p√°gina de <a href="https://www.geonames.org/">GeoNames</a> que tiene una <a href="https://creativecommons.org/">licencia de Creative Commons</a>. La base de datos de informaci√≥n est√° compuesta por varios archivos CSV muchos separados por tabuladores con las varias columnas de informaci√≥n. En el <a href="https://download.geonames.org/export/dump/readme.txt">archivo README</a> hay una lista de los archivos de los que consta la base de datos.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">XX.zip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   : features for country with iso code XX, see &#39;geoname&#39; table for columns. &#39;no-country&#39; for features not belonging to a country.&#10;</span></span><span class="line"><span class="cl">allCountries.zip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : all countries combined in one file, see &#39;geoname&#39; table for columns&#10;</span></span><span class="line"><span class="cl">cities500.zip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: all cities with a population &gt; 500 or seats of adm div down to PPLA4 (ca 185.000), see &#39;geoname&#39; table for columns&#10;</span></span><span class="line"><span class="cl">cities1000.zip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   : all cities with a population &gt; 1000 or seats of adm div down to PPLA3 (ca 130.000), see &#39;geoname&#39; table for columns&#10;</span></span><span class="line"><span class="cl">cities5000.zip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   : all cities with a population &gt; 5000 or PPLA (ca 50.000), see &#39;geoname&#39; table for columns&#10;</span></span><span class="line"><span class="cl">cities15000.zip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  : all cities with a population &gt; 15000 or capitals (ca 25.000), see &#39;geoname&#39; table for columns&#10;</span></span><span class="line"><span class="cl">alternateNamesV2.zip&nbsp;&nbsp;&nbsp;&nbsp; : alternate names with language codes and geonameId, file with iso language codes, with new columns from and to&#10;</span></span><span class="line"><span class="cl">alternateNames.zip&nbsp;&nbsp;&nbsp;&nbsp;   : obsolete use V2, this file does not have the new columns to and from and will be removed in the future&#10;</span></span><span class="line"><span class="cl">admin1CodesASCII.txt&nbsp;&nbsp;&nbsp;&nbsp; : names in English for admin divisions. Columns: code, name, name ascii, geonameid&#10;</span></span><span class="line"><span class="cl">admin2Codes.txt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  : names for administrative subdivision &#39;admin2 code&#39; (UTF8), Format : concatenated codes &lt;tab&gt;name &lt;tab&gt; asciiname &lt;tab&gt; geonameId&#10;</span></span><span class="line"><span class="cl">iso-languagecodes.txt&nbsp;&nbsp;&nbsp;&nbsp;: iso 639 language codes, as used for alternate names in file alternateNames.zip&#10;</span></span><span class="line"><span class="cl">featureCodes.txt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : name and description for feature classes and feature codes &#10;</span></span><span class="line"><span class="cl">timeZones.txt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: countryCode, timezoneId, gmt offset on 1st of January, dst offset to gmt on 1st of July (of the current year), rawOffset without DST&#10;</span></span><span class="line"><span class="cl">countryInfo.txt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  : country information : iso codes, fips codes, languages, capital ,...</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>archives.txt</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">The main &#39;geoname&#39; table has the following fields :&#10;</span></span><span class="line"><span class="cl">---------------------------------------------------&#10;</span></span><span class="line"><span class="cl">geonameid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : integer id of record in geonames database&#10;</span></span><span class="line"><span class="cl">name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  : name of geographical point (utf8) varchar(200)&#10;</span></span><span class="line"><span class="cl">asciiname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : name of geographical point in plain ascii characters, varchar(200)&#10;</span></span><span class="line"><span class="cl">alternatenames&nbsp;&nbsp;&nbsp;&nbsp;: alternatenames, comma separated, ascii names automatically transliterated, convenience attribute from alternatename table, varchar(10000)&#10;</span></span><span class="line"><span class="cl">latitude&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  : latitude in decimal degrees (wgs84)&#10;</span></span><span class="line"><span class="cl">longitude&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : longitude in decimal degrees (wgs84)&#10;</span></span><span class="line"><span class="cl">feature class&nbsp;&nbsp;&nbsp;&nbsp; : see http://www.geonames.org/export/codes.html, char(1)&#10;</span></span><span class="line"><span class="cl">feature code&nbsp;&nbsp;&nbsp;&nbsp;  : see http://www.geonames.org/export/codes.html, varchar(10)&#10;</span></span><span class="line"><span class="cl">country code&nbsp;&nbsp;&nbsp;&nbsp;  : ISO-3166 2-letter country code, 2 characters&#10;</span></span><span class="line"><span class="cl">cc2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   : alternate country codes, comma separated, ISO-3166 2-letter country code, 200 characters&#10;</span></span><span class="line"><span class="cl">admin1 code&nbsp;&nbsp;&nbsp;&nbsp;   : fipscode (subject to change to iso code), see exceptions below, see file admin1Codes.txt for display names of this code; varchar(20)&#10;</span></span><span class="line"><span class="cl">admin2 code&nbsp;&nbsp;&nbsp;&nbsp;   : code for the second administrative division, a county in the US, see file admin2Codes.txt; varchar(80) &#10;</span></span><span class="line"><span class="cl">admin3 code&nbsp;&nbsp;&nbsp;&nbsp;   : code for third level administrative division, varchar(20)&#10;</span></span><span class="line"><span class="cl">admin4 code&nbsp;&nbsp;&nbsp;&nbsp;   : code for fourth level administrative division, varchar(20)&#10;</span></span><span class="line"><span class="cl">population&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: bigint (8 byte int) &#10;</span></span><span class="line"><span class="cl">elevation&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : in meters, integer&#10;</span></span><span class="line"><span class="cl">dem&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   : digital elevation model, srtm3 or gtopo30, average elevation of 3&#39;&#39;x3&#39;&#39; (ca 90mx90m) or 30&#39;&#39;x30&#39;&#39; (ca 900mx900m) area in meters, integer. srtm processed by cgiar/ciat.&#10;</span></span><span class="line"><span class="cl">timezone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  : the iana timezone id (see file timeZone.txt) varchar(40)&#10;</span></span><span class="line"><span class="cl">modification date : date of last modification in yyyy-MM-dd format</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>table-geoname.txt</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">The table &#39;alternate names&#39; :&#10;</span></span><span class="line"><span class="cl">-----------------------------&#10;</span></span><span class="line"><span class="cl">alternateNameId   : the id of this alternate name, int&#10;</span></span><span class="line"><span class="cl">geonameid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : geonameId referring to id in table &#39;geoname&#39;, int&#10;</span></span><span class="line"><span class="cl">isolanguage&nbsp;&nbsp;&nbsp;&nbsp;   : iso 639 language code 2- or 3-characters; 4-characters &#39;post&#39; for postal codes and &#39;iata&#39;,&#39;icao&#39; and faac for airport codes, fr_1793 for French Revolution names,  abbr for abbreviation, link to a website (mostly to wikipedia), wkdt for the wikidataid, varchar(7)&#10;</span></span><span class="line"><span class="cl">alternate name&nbsp;&nbsp;&nbsp;&nbsp;: alternate name or name variant, varchar(400)&#10;</span></span><span class="line"><span class="cl">isPreferredName   : &#39;1&#39;, if this alternate name is an official/preferred name&#10;</span></span><span class="line"><span class="cl">isShortName&nbsp;&nbsp;&nbsp;&nbsp;   : &#39;1&#39;, if this is a short name like &#39;California&#39; for &#39;State of California&#39;&#10;</span></span><span class="line"><span class="cl">isColloquial&nbsp;&nbsp;&nbsp;&nbsp;  : &#39;1&#39;, if this alternate name is a colloquial or slang term. Example: &#39;Big Apple&#39; for &#39;New York&#39;.&#10;</span></span><span class="line"><span class="cl">isHistoric&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: &#39;1&#39;, if this alternate name is historic and was used in the past. Example &#39;Bombay&#39; for &#39;Mumbai&#39;.&#10;</span></span><span class="line"><span class="cl">from		  : from period when the name was used&#10;</span></span><span class="line"><span class="cl">to		  : to period when the name was used</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>table-alternate-names.txt</span>
    </div>
</div>
<h4 id="countryinfotxt">countryInfo.txt</h4>
<p>Este archivo contiene la lista de pa√≠ses. Entre su informaci√≥n est√° el c√≥digo del pa√≠s, las expresiones regulares de los c√≥digos postales, el prefijo del tel√©fono, c√≥digo de la divisa, lenguaje entre otra informaci√≥n como poblaci√≥n, superficie y la capital adem√°s de los pa√≠ses vecinos.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">ES	ESP	724	SP	Spain	Madrid	504782	46723749	EU	.es	EUR	Euro	34	#####	^(\d{5})$	es-ES,ca,gl,eu,oc	2510769	AD,PT,GI,FR,MA	&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>country-es.txt</span>
    </div>
</div>
<h4 id="allcountrieszip-y-xxzip">allCountries.zip y XX.zip</h4>
<p>El archivo <em>allCountries.zip</em> contiene las ciudades de todos los pa√≠ses (todos los archivos <em>XX.zip</em>) y en los archivos <em>XX.zip</em> est√°n las ciudades de un pa√≠s en concreto, <em>ES.zip</em> para las ciudades de Espa√±a. Contienen el c√≥digo ciudad, latitud y longitud, zona horaria y los c√≥digos de las unidades administrativas junto con su poblaci√≥n, elevaci√≥n e identificador <em>geonameid</em></p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">3128026	Bilbao	Bilbao	BIO,Bil&#39;baa,Bil&#39;bao,Bilbao,Bilbau,Bilbaum,Bilbaw,Bilbo,Bilbo / Bilbao,Bilmpao,El Bocho,bi er ba e,bil ba xo,bilba&#39;o,bilbao,birubao,blbaw,bylbaw,bylbayw,ŒúœÄŒπŒªŒºœÄŒ¨Œø,–ë–∏–ª–±–∞–æ,–ë–∏–ª—å–±–∞–æ,–ë—ñ–ª—å–±–∞–∞,–ë—ñ–ª—å–±–∞–æ,‘≤’´’¨’¢’°’∏,◊ë◊ô◊ú◊ë◊ê◊ï,ÿ®ŸÑÿ®ÿßŸà,ÿ®€åŸÑÿ®ÿßÿ¶Ÿà,ÿ®€åŸÑÿ®ÿßŸà,‡§¨‡§ø‡§≤‡•ç‡§¨‡§æ‡§ì,‡∏ö‡∏¥‡∏•‡∏ö‡∏≤‡πÇ‡∏≠,·Éë·Éò·Éö·Éë·Éê·Éù,„Éì„É´„Éê„Ç™,ÊØïÂ∞îÂ∑¥ÈÑÇ,ÎπåÎ∞îÏò§&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>es-bilbao.txt</span>
    </div>
</div>
<p>Hay varios archivos de ciudades filtrados seg√∫n si superan una cantidad de poblaci√≥n, <em>cities500.zip</em>, <em>cities1000.zip</em>, <em>cities5000.zip</em>, <em>cities15000.zip</em>. Las columnas son las mismas que las del archivo anterior donde est√°n agrupadas por pa√≠s pero en este est√°n agrupadas por poblaci√≥n.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">3128026	Bilbao	Bilbao	BIO,Bil&#39;baa,Bil&#39;bao,Bilbao,Bilbau,Bilbaum,Bilbaw,Bilbo,Bilbo / Bilbao,Bilmpao,El Bocho,bi er ba e,bil ba xo,bilba&#39;o,bilbao,birubao,blbaw,bylbaw,bylbayw,ŒúœÄŒπŒªŒºœÄŒ¨Œø,–ë–∏–ª–±–∞–æ,–ë–∏–ª—å–±–∞–æ,–ë—ñ–ª—å–±–∞–∞,–ë—ñ–ª—å–±–∞–æ,‘≤’´’¨’¢’°’∏,◊ë◊ô◊ú◊ë◊ê◊ï,ÿ®ŸÑÿ®ÿßŸà,ÿ®€åŸÑÿ®ÿßÿ¶Ÿà,ÿ®€åŸÑÿ®ÿßŸà,‡§¨‡§ø‡§≤‡•ç‡§¨‡§æ‡§ì,‡∏ö‡∏¥‡∏•‡∏ö‡∏≤‡πÇ‡∏≠,·Éë·Éò·Éö·Éë·Éê·Éù,„Éì„É´„Éê„Ç™,ÊØïÂ∞îÂ∑¥ÈÑÇ,ÎπåÎ∞îÏò§&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>cities15000-bilbao.txt</span>
    </div>
</div>
<h4 id="alternatenamesv2zip">alternateNamesV2.zip</h4>
<p>Contiene diversa informaci√≥n m√°s extendida de cada uno de los <em>geonames</em>, incluyendo su nombre en diferentes idiomas, el conjunto de c√≥digos postales asociados, identificador del aeropuerto y enlaces a la wikipedia.</p>
<p>El archivo <em>alternateNamesV2.txt</em> es tan grande que ocupa varios cientos de megabytes descomprimido de modo que casi no se puede abrir con un editor y hay que recurrir al comando <em>grep</em> para buscar dado el <em>geonameid</em>.</p>
<p>El <em>geonameid</em> de la ciudad de Bilbao es <em>3128026</em> y buscando en el archivo se encuentran estas referencias que incluyen los diferentes nombres en diferentes lenguajes, c√≥digos postales, <em>iata</em> y <em>uncl</em> para la denominaci√≥n del aeropuerto adem√°s de otra informaci√≥n como enlaces a la wikipedia. En casi de en un mismo lenguaje haber varios nombres el 1 indica cual es la denominaci√≥n preferida.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ grep <span class="s2">&#34;3128026&#34;</span> alternateNamesV2.txt&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>grep-alternate-names-bilbao.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span><span class="lnt">26&#10;</span><span class="lnt">27&#10;</span><span class="lnt">28&#10;</span><span class="lnt">29&#10;</span><span class="lnt">30&#10;</span><span class="lnt">31&#10;</span><span class="lnt">32&#10;</span><span class="lnt">33&#10;</span><span class="lnt">34&#10;</span><span class="lnt">35&#10;</span><span class="lnt">36&#10;</span><span class="lnt">37&#10;</span><span class="lnt">38&#10;</span><span class="lnt">39&#10;</span><span class="lnt">40&#10;</span><span class="lnt">41&#10;</span><span class="lnt">42&#10;</span><span class="lnt">43&#10;</span><span class="lnt">44&#10;</span><span class="lnt">45&#10;</span><span class="lnt">46&#10;</span><span class="lnt">47&#10;</span><span class="lnt">48&#10;</span><span class="lnt">49&#10;</span><span class="lnt">50&#10;</span><span class="lnt">51&#10;</span><span class="lnt">52&#10;</span><span class="lnt">53&#10;</span><span class="lnt">54&#10;</span><span class="lnt">55&#10;</span><span class="lnt">56&#10;</span><span class="lnt">57&#10;</span><span class="lnt">58&#10;</span><span class="lnt">59&#10;</span><span class="lnt">60&#10;</span><span class="lnt">61&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">1325769	3128026	eu	Bilbo						&#10;</span></span><span class="line"><span class="cl">1565386	3128026	es	El Bocho						&#10;</span></span><span class="line"><span class="cl">1968272	3128026	es	Bilbao	1					&#10;</span></span><span class="line"><span class="cl">1968273	3128026		Bilbao						&#10;</span></span><span class="line"><span class="cl">2039076	3128026	eu	Bilbao	1					&#10;</span></span><span class="line"><span class="cl">2039077	3128026	pt	Bilbau						&#10;</span></span><span class="line"><span class="cl">2039078	3128026	eo	Bilbao						&#10;</span></span><span class="line"><span class="cl">2148428	3128026	post	48080						&#10;</span></span><span class="line"><span class="cl">2148598	3128026	post	48002						&#10;</span></span><span class="line"><span class="cl">2148599	3128026	post	48003						&#10;</span></span><span class="line"><span class="cl">2148600	3128026	post	48004						&#10;</span></span><span class="line"><span class="cl">2148601	3128026	post	48070						&#10;</span></span><span class="line"><span class="cl">2148602	3128026	post	48071						&#10;</span></span><span class="line"><span class="cl">2148614	3128026	post	48006						&#10;</span></span><span class="line"><span class="cl">2148615	3128026	post	48014						&#10;</span></span><span class="line"><span class="cl">2148618	3128026	post	48008						&#10;</span></span><span class="line"><span class="cl">2148619	3128026	post	48015						&#10;</span></span><span class="line"><span class="cl">2148621	3128026	post	48007						&#10;</span></span><span class="line"><span class="cl">2148622	3128026	post	48005						&#10;</span></span><span class="line"><span class="cl">2148623	3128026	post	48012						&#10;</span></span><span class="line"><span class="cl">2148650	3128026	post	48001						&#10;</span></span><span class="line"><span class="cl">2148652	3128026	post	48009						&#10;</span></span><span class="line"><span class="cl">2148653	3128026	post	48013						&#10;</span></span><span class="line"><span class="cl">2148655	3128026	post	48010						&#10;</span></span><span class="line"><span class="cl">2148670	3128026	post	48011						&#10;</span></span><span class="line"><span class="cl">2426128	3128026	ru	–ë–∏–ª—å–±–∞–æ						&#10;</span></span><span class="line"><span class="cl">2920566	3128026	link	https://en.wikipedia.org/wiki/Bilbao						&#10;</span></span><span class="line"><span class="cl">3055848	3128026	link	https://ru.wikipedia.org/wiki/%D0%91%D0%B8%D0%BB%D1%8C%D0%B1%D0%B0%D0%BE						&#10;</span></span><span class="line"><span class="cl">5882689	3128026	ja	„Éì„É´„Éê„Ç™						&#10;</span></span><span class="line"><span class="cl">5882690	3128026	cy	Bilbo						&#10;</span></span><span class="line"><span class="cl">5882691	3128026	os	–ë–∏–ª—å–±–∞–æ						&#10;</span></span><span class="line"><span class="cl">5882692	3128026	ce	–ë–∏–ª–±–∞–æ						&#10;</span></span><span class="line"><span class="cl">5882693	3128026	fa	ÿ®€åŸÑÿ®ÿßÿ¶Ÿà						&#10;</span></span><span class="line"><span class="cl">5882694	3128026	sr	–ë–∏–ª–±–∞–æ						&#10;</span></span><span class="line"><span class="cl">5882695	3128026	uk	–ë—ñ–ª—å–±–∞–æ						&#10;</span></span><span class="line"><span class="cl">5882696	3128026	br	Bilbo						&#10;</span></span><span class="line"><span class="cl">5882697	3128026	ug	Bilbaw						&#10;</span></span><span class="line"><span class="cl">5882698	3128026	ext	Bilbau						&#10;</span></span><span class="line"><span class="cl">5882699	3128026	el	ŒúœÄŒπŒªŒºœÄŒ¨Œø						&#10;</span></span><span class="line"><span class="cl">5882700	3128026	ko	ÎπåÎ∞îÏò§						&#10;</span></span><span class="line"><span class="cl">5882701	3128026	bg	–ë–∏–ª–±–∞–æ						&#10;</span></span><span class="line"><span class="cl">5882702	3128026	he	◊ë◊ô◊ú◊ë◊ê◊ï						&#10;</span></span><span class="line"><span class="cl">5882703	3128026	be	–ë—ñ–ª—å–±–∞–∞						&#10;</span></span><span class="line"><span class="cl">5882704	3128026	la	Bilbaum						&#10;</span></span><span class="line"><span class="cl">5882705	3128026	an	Bilbau						&#10;</span></span><span class="line"><span class="cl">5882706	3128026	ka	·Éë·Éò·Éö·Éë·Éê·Éù						&#10;</span></span><span class="line"><span class="cl">5882707	3128026	th	‡∏ö‡∏¥‡∏•‡∏ö‡∏≤‡πÇ‡∏≠						&#10;</span></span><span class="line"><span class="cl">5882708	3128026	zh	ÊØïÂ∞îÂ∑¥ÈÑÇ						&#10;</span></span><span class="line"><span class="cl">5882709	3128026	ar	ÿ®ŸÑÿ®ÿßŸà						&#10;</span></span><span class="line"><span class="cl">5882710	3128026	mr	‡§¨‡§ø‡§≤‡•ç‡§¨‡§æ‡§ì						&#10;</span></span><span class="line"><span class="cl">5882711	3128026	gl	Bilbo						&#10;</span></span><span class="line"><span class="cl">5882712	3128026	pms	Bilbo / Bilbao						&#10;</span></span><span class="line"><span class="cl">5882713	3128026	mhr	–ë–∏–ª—å–±–∞–æ						&#10;</span></span><span class="line"><span class="cl">6634068	3128026	iata	BIO						&#10;</span></span><span class="line"><span class="cl">8183693	3128026	hy	‘≤’´’¨’¢’°’∏						&#10;</span></span><span class="line"><span class="cl">8183694	3128026	mn	–ë–∏–ª—å–±–∞–æ						&#10;</span></span><span class="line"><span class="cl">8183695	3128026	xmf	·Éë·Éò·Éö·Éë·Éê·Éù						&#10;</span></span><span class="line"><span class="cl">8183696	3128026	ckb	ÿ®€åŸÑÿ®ÿßŸà						&#10;</span></span><span class="line"><span class="cl">8183697	3128026	kk	–ë–∏–ª—å–±–∞–æ						&#10;</span></span><span class="line"><span class="cl">13750954	3128026	unlc	ESBIO						&#10;</span></span><span class="line"><span class="cl">3128026	134091	fa	GerakƒÅn</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>grep-alternate-names-bilbao.out</span>
    </div>
</div>
<h4 id="admin1codesasciitxt">admin1CodesASCII.txt</h4>
<p>Contiene las unidades administrativas del primer nivel, en el caso de Espa√±a son las comunidades aut√≥nomas. El archivo incluye el <em>geonameid</em> asociado a la comunidad aut√≥noma.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">ES.31	Murcia	Murcia	2513413&#10;</span></span><span class="line"><span class="cl">ES.CE	Ceuta	Ceuta	2519582&#10;</span></span><span class="line"><span class="cl">ES.07	Balearic Islands	Balearic Islands	2521383&#10;</span></span><span class="line"><span class="cl">ES.51	Andalusia	Andalusia	2593109&#10;</span></span><span class="line"><span class="cl">ES.53	Canary Islands	Canary Islands	2593110&#10;</span></span><span class="line"><span class="cl">ES.54	Castille-La Mancha	Castille-La Mancha	2593111&#10;</span></span><span class="line"><span class="cl">ES.57	Extremadura	Extremadura	2593112&#10;</span></span><span class="line"><span class="cl">ES.60	Valencia	Valencia	2593113&#10;</span></span><span class="line"><span class="cl">ES.34	Asturias	Asturias	3114710&#10;</span></span><span class="line"><span class="cl">ES.32	Navarre	Navarre	3115609&#10;</span></span><span class="line"><span class="cl">ES.29	Madrid	Madrid	3117732&#10;</span></span><span class="line"><span class="cl">ES.27	La Rioja	La Rioja	3336897&#10;</span></span><span class="line"><span class="cl">ES.39	Cantabria	Cantabria	3336898&#10;</span></span><span class="line"><span class="cl">ES.52	Aragon	Aragon	3336899&#10;</span></span><span class="line"><span class="cl">ES.55	Castille and Le√≥n	Castille and Leon	3336900&#10;</span></span><span class="line"><span class="cl">ES.56	Catalonia	Catalonia	3336901&#10;</span></span><span class="line"><span class="cl">ES.58	Galicia	Galicia	3336902&#10;</span></span><span class="line"><span class="cl">ES.59	Basque Country	Basque Country	3336903&#10;</span></span><span class="line"><span class="cl">ES.ML	Melilla	Melilla	6362988</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>admin1-es.txt</span>
    </div>
</div>
<h4 id="admin2codestxt">admin2Codes.txt</h4>
<p>Contiene las unidades administrativas del segundo nivel, en el caso de Espa√±a son las provincias. El archivo incluye el <em>geonameid</em> asociado a la provincia.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span><span class="lnt">26&#10;</span><span class="lnt">27&#10;</span><span class="lnt">28&#10;</span><span class="lnt">29&#10;</span><span class="lnt">30&#10;</span><span class="lnt">31&#10;</span><span class="lnt">32&#10;</span><span class="lnt">33&#10;</span><span class="lnt">34&#10;</span><span class="lnt">35&#10;</span><span class="lnt">36&#10;</span><span class="lnt">37&#10;</span><span class="lnt">38&#10;</span><span class="lnt">39&#10;</span><span class="lnt">40&#10;</span><span class="lnt">41&#10;</span><span class="lnt">42&#10;</span><span class="lnt">43&#10;</span><span class="lnt">44&#10;</span><span class="lnt">45&#10;</span><span class="lnt">46&#10;</span><span class="lnt">47&#10;</span><span class="lnt">48&#10;</span><span class="lnt">49&#10;</span><span class="lnt">50&#10;</span><span class="lnt">51&#10;</span><span class="lnt">52&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">ES.60.V	Prov√≠ncia de Val√®ncia	Provincia de Valencia	2509951&#10;</span></span><span class="line"><span class="cl">ES.54.TO	Province of Toledo	Province of Toledo	2510407&#10;</span></span><span class="line"><span class="cl">ES.51.SE	Provincia de Sevilla	Provincia de Sevilla	2510910&#10;</span></span><span class="line"><span class="cl">ES.53.TF	Provincia de Santa Cruz de Tenerife	Provincia de Santa Cruz de Tenerife	2511173&#10;</span></span><span class="line"><span class="cl">ES.51.MA	Provincia de M√°laga	Provincia de Malaga	2514254&#10;</span></span><span class="line"><span class="cl">ES.53.GC	Provincia de Las Palmas	Provincia de Las Palmas	2515271&#10;</span></span><span class="line"><span class="cl">ES.51.J	Provincia de Ja√©n	Provincia de Jaen	2516394&#10;</span></span><span class="line"><span class="cl">ES.51.H	Provincia de Huelva	Provincia de Huelva	2516547&#10;</span></span><span class="line"><span class="cl">ES.51.GR	Provincia de Granada	Provincia de Granada	2517115&#10;</span></span><span class="line"><span class="cl">ES.54.CU	Provincia de Cuenca	Provincia de Cuenca	2519034&#10;</span></span><span class="line"><span class="cl">ES.51.CO	Province of C√≥rdoba	Province of Cordoba	2519239&#10;</span></span><span class="line"><span class="cl">ES.54.CR	Provincia de Ciudad Real	Provincia de Ciudad Real	2519401&#10;</span></span><span class="line"><span class="cl">ES.51.CA	Provincia de C√°diz	Provincia de Cadiz	2520597&#10;</span></span><span class="line"><span class="cl">ES.57.CC	Provincia de C√°ceres	Provincia de Caceres	2520610&#10;</span></span><span class="line"><span class="cl">ES.57.BA	Provincia de Badajoz	Provincia de Badajoz	2521419&#10;</span></span><span class="line"><span class="cl">ES.51.AL	Almer√≠a	Almeria	2521883&#10;</span></span><span class="line"><span class="cl">ES.60.A	Provincia de Alicante	Provincia de Alicante	2521976&#10;</span></span><span class="line"><span class="cl">ES.54.AB	Provincia de Albacete	Provincia de Albacete	2522257&#10;</span></span><span class="line"><span class="cl">ES.52.Z	Provincia de Zaragoza	Provincia de Zaragoza	3104323&#10;</span></span><span class="line"><span class="cl">ES.55.ZA	Provincia de Zamora	Provincia de Zamora	3104341&#10;</span></span><span class="line"><span class="cl">ES.59.BI	Bizkaia	Bizkaia	3104469&#10;</span></span><span class="line"><span class="cl">ES.55.VA	Provincia de Valladolid	Provincia de Valladolid	3106671&#10;</span></span><span class="line"><span class="cl">ES.52.TE	Provincia de Teruel	Provincia de Teruel	3108125&#10;</span></span><span class="line"><span class="cl">ES.56.T	Prov√≠ncia de Tarragona	Provincia de Tarragona	3108287&#10;</span></span><span class="line"><span class="cl">ES.55.SO	Provincia de Soria	Provincia de Soria	3108680&#10;</span></span><span class="line"><span class="cl">ES.55.SG	Provincia de Segovia	Provincia de Segovia	3109254&#10;</span></span><span class="line"><span class="cl">ES.39.S	Provincia de Cantabria	Provincia de Cantabria	3109716&#10;</span></span><span class="line"><span class="cl">ES.55.SA	Provincia de Salamanca	Provincia de Salamanca	3111107&#10;</span></span><span class="line"><span class="cl">ES.58.PO	Provincia de Pontevedra	Provincia de Pontevedra	3113208&#10;</span></span><span class="line"><span class="cl">ES.55.P	Provincia de Palencia	Provincia de Palencia	3114530&#10;</span></span><span class="line"><span class="cl">ES.58.OR	Provincia de Ourense	Provincia de Ourense	3114964&#10;</span></span><span class="line"><span class="cl">ES.58.LU	Provincia de Lugo	Provincia de Lugo	3117813&#10;</span></span><span class="line"><span class="cl">ES.55.LE	Provincia de Le√≥n	Provincia de Leon	3118528&#10;</span></span><span class="line"><span class="cl">ES.58.C	Provincia da Coru√±a	Provincia da Coruna	3119840&#10;</span></span><span class="line"><span class="cl">ES.52.HU	Provincia de Huesca	Provincia de Huesca	3120513&#10;</span></span><span class="line"><span class="cl">ES.59.SS	Gipuzkoa	Provincia de Guipuzcoa	3120935&#10;</span></span><span class="line"><span class="cl">ES.54.GU	Provincia de Guadalajara	Provincia de Guadalajara	3121069&#10;</span></span><span class="line"><span class="cl">ES.60.CS	Prov√≠ncia de Castell√≥	Provincia de Castello	3125881&#10;</span></span><span class="line"><span class="cl">ES.55.BU	Provincia de Burgos	Provincia de Burgos	3127460&#10;</span></span><span class="line"><span class="cl">ES.56.B	Prov√≠ncia de Barcelona	Provincia de Barcelona	3128759&#10;</span></span><span class="line"><span class="cl">ES.55.AV	Provincia de √Åvila	Provincia de Avila	3129138&#10;</span></span><span class="line"><span class="cl">ES.59.VI	Araba / √Ålava	Araba / Alava	3130717&#10;</span></span><span class="line"><span class="cl">ES.56.GI	Prov√≠ncia de Girona	Provincia de Girona	6355230&#10;</span></span><span class="line"><span class="cl">ES.56.L	Prov√≠ncia de Lleida	Provincia de Lleida	6355231&#10;</span></span><span class="line"><span class="cl">ES.27.LO	Provincia de La Rioja	Provincia de La Rioja	6355232&#10;</span></span><span class="line"><span class="cl">ES.29.M	Provincia de Madrid	Provincia de Madrid	6355233&#10;</span></span><span class="line"><span class="cl">ES.31.MU	Murcia	Murcia	6355234&#10;</span></span><span class="line"><span class="cl">ES.32.NA	Provincia de Navarra	Provincia de Navarra	6355235&#10;</span></span><span class="line"><span class="cl">ES.34.O	Province of Asturias	Province of Asturias	6355236&#10;</span></span><span class="line"><span class="cl">ES.07.PM	Illes Balears	Illes Balears	6424360&#10;</span></span><span class="line"><span class="cl">ES.CE.CE	Ceuta	Ceuta	8335119&#10;</span></span><span class="line"><span class="cl">ES.ML.ME	Melilla	Melilla	8335120</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>admin2-es.txt</span>
    </div>
</div>
<h4 id="featurecodestxt-timezonestxt-y-hierarchyzip">featureCodes.txt, timeZones.txt y hierarchy.zip</h4>
<p>Los <em>geonames</em> pueden tener un metadato asociado con varios identificadores que en la documentaci√≥n se denominan <em>features</em>, hay varias categor√≠as de identificadores y varios identificadores dentro de cada categor√≠a. Por ejemplo, la feature <em>P</em> se utiliza para ciudades y villas y <em>PPLA1</em>, <em>PPLA2</em>, <em>PPLA3</em>, <em>PPLA4</em>, <em>PPLA5</em> indica el nivel de unidad administrativa. Las <em>features</em> permiten conocer a qu√© representa el <em>geoname</em> por ejemplo si es un aeropuerto o una universidad entre muchos otros elementos.</p>
<p>El archivo <em>hierarchy.zip</em> permite reconstruir la relaci√≥n jer√°rquica de los diferentes <em>geonames</em></p>
<h4 id="shapes_all_lowzip">shapes_all_low.zip</h4>
<p>Contiene el pol√≠gono del <em>geoname</em> que permite una representaci√≥n gr√°fica de su superficie, por ejemplo del pa√≠s.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">337996	{&#34;type&#34;:&#34;Polygon&#34;,&#34;coordinates&#34;:[[[37.916,14.894],[38.045,14.72],[38.258,14.679],[38.455,14.413],[38.797,14.467],[38.978,14.545],[39.032,14.639],[39.154,14.653],[39.261,14.516],[39.252,14.409],[39.346,14.466],[39.373,14.54],[39.538,14.491],[39.508,14.55],[39.587,14.609],[39.77,14.546],[39.93,14.415],[40.127,14.547],[40.213,14.387],[40.26,14.411],[40.942,14.082],[41.249,13.61],[41.644,13.386],[42.056,12.801],[42.218,12.765],[42.404,12.469],[41.973,11.839],[41.835,11.733],[41.771,11.493],[41.81,11.278],[41.787,10.979],[41.947,10.913],[42.066,10.927],[42.146,10.983],[42.42,10.982],[42.634,11.096],[42.689,11.055],[42.752,11.08],[42.79,10.988],[42.967,10.997],[42.67,10.624],[42.799,10.452],[42.854,10.219],[43.009,10.086],[43.087,9.903],[43.255,9.847],[43.299,9.606],[43.396,9.554],[43.46,9.419],[43.643,9.357],[43.995,9.003],[47.001,8.001],[48.001,8.001],[44.97,4.913],[44.01,4.959],[43.635,4.855],[43.082,4.607],[42.844,4.284],[42.541,4.211],[42.079,4.179],[41.945,4.01],[41.833,3.947],[41.718,3.994],[41.677,3.958],[41.551,3.983],[41.197,3.937],[40.756,4.285],[39.866,3.871],[39.773,3.672],[39.553,3.405],[39.493,3.471],[39.192,3.483],[39.079,3.545],[38.903,3.517],[38.712,3.577],[38.684,3.629],[38.576,3.609],[38.536,3.659],[38.446,3.607],[38.127,3.61],[37.029,4.388],[36.843,4.452],[36.05,4.457],[35.94,4.551],[35.949,4.631],[35.809,4.791],[35.862,5.32],[35.538,5.424],[35.316,5.335],[35.315,5.498],[35.126,5.624],[35.13,5.687],[34.998,5.897],[35.005,6.075],[34.95,6.247],[35.022,6.447],[34.939,6.558],[34.864,6.611],[34.768,6.594],[34.64,6.74],[34.531,6.745],[34.543,6.817],[34.471,6.919],[34.293,6.948],[34.305,6.978],[34.192,7.041],[34.19,7.132],[34.022,7.246],[34.002,7.421],[33.716,7.663],[33.542,7.694],[33.47,7.752],[33.323,7.708],[33.247,7.779],[33.046,7.79],[32.998,7.944],[33.121,8.111],[33.193,8.129],[33.17,8.296],[33.219,8.435],[33.618,8.472],[33.7,8.378],[33.769,8.368],[33.876,8.411],[33.903,8.486],[34.024,8.489],[34.145,8.607],[34.102,9.557],[34.224,9.887],[34.233,10.049],[34.334,10.119],[34.295,10.585],[34.466,10.814],[34.603,10.906],[34.795,10.754],[34.786,10.706],[34.868,10.731],[34.869,10.805],[34.987,10.89],[34.953,10.949],[35.001,11.187],[34.928,11.241],[35.077,11.535],[35.044,11.734],[35.27,11.944],[35.662,12.637],[36.009,12.724],[36.16,12.697],[36.176,12.904],[36.143,12.948],[36.497,13.835],[36.466,13.978],[36.556,14.284],[36.866,14.322],[37.018,14.252],[37.097,14.275],[37.135,14.41],[37.312,14.448],[37.523,14.182],[37.916,14.894]]]}&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>shape-es.txt</span>
    </div>
</div>
<h4 id="informaci√≥n-de-la-base-de-datos">Informaci√≥n de la base de datos</h4>
<p>Cada uno de los elementos geogr√°ficos tiene asociado un identificador de <em>geonameid</em>, con este identificador es posible obtener m√°s informaci√≥n en el archivo <em>alternateNamesV2.zip</em> y relacionar la informaci√≥n de unos archivos con la informaci√≥n de otros archivos. La informaci√≥n que incluyen est√°n en columnas separadas por tabuladores, las columnas son las indicadas en estructura de la tabla <em>geoname</em> y <em>alternate names</em>.</p>
<p>Los archivos contienen mucha informaci√≥n, posiblemente en una aplicaci√≥n solo interese parte de toda esa informaci√≥n y se puede ignorar el resto. Por ejemplo, en la informaci√≥n de los pa√≠ses se incluye su extensi√≥n de superficie, poblaci√≥n, continente moneda, lenguaje o la capital del pa√≠s que para validar direcciones no es necesaria pero la moneda o lenguajes es √∫til para mostrar precios o textos seg√∫n el idioma del pa√≠s.</p>
<p>Hay otra informaci√≥n muy √∫til como los nombres de las ciudades en diferentes idiomas e incluso las abreviaturas de los aeropuertos. Por supuesto est√°n las expresiones regulares de los c√≥digos postales o los c√≥digos de prefijo de los tel√©fonos, los propios del pa√≠s conoceremos pero la de muchos otros pa√≠ses seguro que no.</p>
<p>La expresi√≥n regular de Espa√±a es esta.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">^(\d{5})$&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>regexp-es.txt</span>
    </div>
</div>
<p>La de Reino Unido es esta otra.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">^([Gg][Ii][Rr]\s?0[Aa]{2})|((([A-Za-z][0-9]{1,2})|(([A-Za-z][A-Ha-hJ-Yj-y][0-9]{1,2})|(([A-Za-z][0-9][A-Za-z])|([A-Za-z][A-Ha-hJ-Yj-y][0-9]?[A-Za-z]))))\s?[0-9][A-Za-z]{2})$&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>regexp-uk.txt</span>
    </div>
</div>
<h3 id="c√≥mo-acceder-a-la-informaci√≥n">C√≥mo acceder a la informaci√≥n</h3>
<p>Los archivos son muy grandes, seguramente no sea necesaria toda la informaci√≥n y no est√° en el formato adecuado para un r√°pido acceso al dato que se necesita en una aplicaci√≥n, con lo que hay que procesarlos para adaptarlos. Los archivos son archivos de texto con los datos de las columnas separados por tabuladores, una librer√≠a para procesar los archivos con el lenguaje Java es <a href="http://opencsv.sourceforge.net/">OpenCSV</a>.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2018/10/ejemplo-sencillo-de-como-leer-datos-de-un-archivo-excel-o-csv-en-java/">Ejemplo sencillo de c√≥mo leer datos de un archivo Excel o CSV en Java</a></li>
</ul>
<p>Es necesario procesar los archivos de alguna forma para extraer y transformar la informaci√≥n de los archivos de GeoNames a un formato adecuado para la aplicaci√≥n posiblemente con un <em>script</em> en el lenguaje <a href="https://www.groovy-lang.org/">Groovy</a>, Java, <a href="https://kotlinlang.org/">Kotlin</a> u otro lenguaje. La informaci√≥n geogr√°fica quiz√° no cambie muy habitualmente pero seguramente hay que procesar los archivos cada cierto tiempo o si por alguna circunstancia se produce un cambio significativo que requiera una actualizaci√≥n.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2015/11/java-para-tareas-de-scripting-con-jbang-y-gradle/">Java para tareas de scripting con JBang y Gradle</a></li>
</ul>
<p>Una vez disponible la informaci√≥n en la aplicaci√≥n conviene crear una serie de clases que hagan de fachada en el acceso a la informaci√≥n de tal forma que el resto del c√≥digo no se acople a la implementaci√≥n interna de los datos que puede cambiar en el futuro. Hay varias formas de implementaci√≥n, una en que las clases de informaci√≥n geogr√°fica ser√≠an un m√≥dulo en la aplicaci√≥n y propietaria de los datos geogr√°ficos. Otra opci√≥n es que las tablas est√©n en una base de datos y sea compartida por varias aplicaciones, en este caso las tablas o vistas se convierten en una interfaz para las aplicaciones.</p>
]]>
        </content>
        
            
                <category term="programacion"/>
            
                <category term="planeta-codigo"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2022/11/realizar-peticiones-a-apis-con-herramientas-de-linea-comandos-e-interfaz-grafica/</id>
        <title>Realizar peticiones a APIs con herramientas de l√≠nea comandos e interfaz gr√°fica</title>
        <updated>2022-11-03T23:00:00+02:00</updated>
        <published>2022-11-03T23:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2022/11/realizar-peticiones-a-apis-con-herramientas-de-linea-comandos-e-interfaz-grafica/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>El comando curl es la herramienta de l√≠nea de comandos para realizar cualquier petici√≥n que requiera probar un <em>endpoint</em> de una API o web que utilice el protocolo HTTP, tiene opciones para cualquier petici√≥n que sea requerida. Aunque curl es muy vers√°til y completa es una herramienta de l√≠nea de comandos sin algunas otras funcionalidades que las aplicaciones con interfaz gr√°fica son capaces de proporcionar. Postman es una aplicaci√≥n con interfaz gr√°fica que cubre parte de las funcionalidades de curl y la mayor√≠a que habitualmente un desarrollador necesita para probar una API, permite guardar colecciones y compartirlas con otros miembros de equipo de desarrollo asi como entornos y otras funcionalidades. Postman es la herramienta m√°s conocida en su categor√≠a y tiene una licencia comercial en base al numero de miembros de equipo que no es barata. Finalmente, Hoppscotch es una herramienta alternativa y equivalente a Postman de c√≥digo abierto que no tiene coste de licencia y ofrece la mayor√≠a de funcionalidades importantes como para sustituir a Postman.</strong></p>]]>
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/hoppscotch.svg" width="200" height="200" alt="Hoppscotch" title="Hoppscotch" class="" loading="false&#34;"></p>
</div>
<p>Las aplicaciones monol√≠ticas son m√°s simples y m√°s sencillas de programar, la llamada de un m√≥dulo a otro de una aplicaci√≥n consiste simplemente en una invocaci√≥n de un m√©todo, sin embargo tiene sus propios problemas.</p>
<p>Las aplicaciones compuestas por m√∫ltiples microservicios, algunos de esos microservicios publica una API para que la invoquen otros microservicios. Los microservicios se comunican mediante llamadas remotas a trav√©s de la red, habitualmente utilizando el protocolo HTTP y REST aunque tambi√©n es posible utilizar <a href="https://graphql.org/">GraphQL</a> y si se prefiere una API m√°s RPC con <a href="https://grpc.io/">gRPC</a>.</p>
<p>Para desarrollar y probar pero tambi√©n para conocer los datos devueltos por un microservicio en alguna de sus <em>endpoints</em> que expone en su API es muy √∫til utilizar alguna de las siguientes herramientas para hacer peticiones directamente al servicio sin tener que usar la interfaz web que utiliza el usuario hasta llegar al punto donde se realiza la petici√≥n.</p>
<div class="alert alert-warning pt-0 pb-0 tableofcontents"><h2>Contenido del art√≠culo</h2><toc></toc></div>
<h3 id="el-comando-curl">El comando curl</h3>
<p>La herramienta de l√≠nea de comandos curl permite realizar cualquier operaci√≥n y obtener cualquier detalle tanto de la petici√≥n como de la respuesta del servidor del protocolo HTTP. Permite ver los certificados cuando se utiliza el protocolo HTTPS, las cabeceras enviadas y de respuesta de la petici√≥n, as√≠ como realizar peticiones utilizando cualquier verbo del protocolo HTTP.</p>
<p>El comando curl permite realizar una petici√≥n sin tener que implementar en c√≥digo la llamada que se quiera probar. C√≥mo es un comando, no una aplicaci√≥n, no permite guardar la colecci√≥n de peticiones ni compartir con otros miembros del equipo de desarrollo una colecci√≥n de peticiones ni mantener sincronizadas las colecciones y variables para los diferentes entornos de una aplicaci√≥n.</p>
<p>Es posible utilizar un repositorio de c√≥digo fuente como <a href="https://git-scm.com/">Git</a> para guardar, compartir y mantener sincronizadas las colecciones peticiones pero el comando curl no ofrece ning√∫n soporte para esto ni para utilizar variables y datos para diferentes entornos.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ curl -v https://picodotdev.github.io/blog-bitix/&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>curl.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span><span class="lnt">26&#10;</span><span class="lnt">27&#10;</span><span class="lnt">28&#10;</span><span class="lnt">29&#10;</span><span class="lnt">30&#10;</span><span class="lnt">31&#10;</span><span class="lnt">32&#10;</span><span class="lnt">33&#10;</span><span class="lnt">34&#10;</span><span class="lnt">35&#10;</span><span class="lnt">36&#10;</span><span class="lnt">37&#10;</span><span class="lnt">38&#10;</span><span class="lnt">39&#10;</span><span class="lnt">40&#10;</span><span class="lnt">41&#10;</span><span class="lnt">42&#10;</span><span class="lnt">43&#10;</span><span class="lnt">44&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">...&#10;</span></span><span class="line"><span class="cl">&gt; GET /blog-bitix/ HTTP/2&#10;</span></span><span class="line"><span class="cl">&gt; Host: picodotdev.github.io&#10;</span></span><span class="line"><span class="cl">&gt; user-agent: curl/7.86.0&#10;</span></span><span class="line"><span class="cl">&gt; accept: */*&#10;</span></span><span class="line"><span class="cl">&gt; &#10;</span></span><span class="line"><span class="cl">* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):&#10;</span></span><span class="line"><span class="cl">&lt; HTTP/2 200 &#10;</span></span><span class="line"><span class="cl">&lt; server: GitHub.com&#10;</span></span><span class="line"><span class="cl">&lt; content-type: text/html; charset=utf-8&#10;</span></span><span class="line"><span class="cl">&lt; permissions-policy: interest-cohort=()&#10;</span></span><span class="line"><span class="cl">&lt; last-modified: Sat, 29 Oct 2022 03:46:53 GMT&#10;</span></span><span class="line"><span class="cl">&lt; access-control-allow-origin: *&#10;</span></span><span class="line"><span class="cl">&lt; etag: &#34;635ca22d-88fd&#34;&#10;</span></span><span class="line"><span class="cl">&lt; expires: Thu, 03 Nov 2022 22:08:53 GMT&#10;</span></span><span class="line"><span class="cl">&lt; cache-control: max-age=600&#10;</span></span><span class="line"><span class="cl">&lt; x-proxy-cache: MISS&#10;</span></span><span class="line"><span class="cl">&lt; x-github-request-id: 8B94:479F:70D593:739994:6364399D&#10;</span></span><span class="line"><span class="cl">&lt; accept-ranges: bytes&#10;</span></span><span class="line"><span class="cl">&lt; date: Thu, 03 Nov 2022 21:58:53 GMT&#10;</span></span><span class="line"><span class="cl">&lt; via: 1.1 varnish&#10;</span></span><span class="line"><span class="cl">&lt; age: 0&#10;</span></span><span class="line"><span class="cl">&lt; x-served-by: cache-mad22067-MAD&#10;</span></span><span class="line"><span class="cl">&lt; x-cache: MISS&#10;</span></span><span class="line"><span class="cl">&lt; x-cache-hits: 0&#10;</span></span><span class="line"><span class="cl">&lt; x-timer: S1667512734.552326,VS0,VE132&#10;</span></span><span class="line"><span class="cl">&lt; vary: Accept-Encoding&#10;</span></span><span class="line"><span class="cl">&lt; x-fastly-request-id: 3c819d3e28b1a87d6c2f80b4606c3530bcc35fbe&#10;</span></span><span class="line"><span class="cl">&lt; content-length: 35069&#10;</span></span><span class="line"><span class="cl">&lt; &#10;</span></span><span class="line"><span class="cl">&lt;!DOCTYPE html&gt;&#10;</span></span><span class="line"><span class="cl">&lt;html lang=&#34;es&#34;&gt;&#10;</span></span><span class="line"><span class="cl">&lt;head&gt;&#10;</span></span><span class="line"><span class="cl">	&lt;meta name=&#34;generator&#34; content=&#34;Hugo 0.102.3&#34; /&gt;&#10;</span></span><span class="line"><span class="cl">  &lt;meta name=&#34;base&#34; href=&#34;https://picodotdev.github.io/blog-bitix/blog-bitix/&#34;&gt;&#10;</span></span><span class="line"><span class="cl">  &lt;meta http-equiv=&#34;content-type&#34; content=&#34;text/html; charset=utf-8&#34;&gt;&#10;</span></span><span class="line"><span class="cl">  &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1&#34;&gt;&#10;</span></span><span class="line"><span class="cl">  &lt;meta name=&#34;author&#34; content=&#34;picodotdev&#34;&gt;&#10;</span></span><span class="line"><span class="cl">  &lt;meta name=&#34;keywords&#34; content=&#34;java, programacion, software, hardware, tapestry, software libre, gnu, linux, gnu/linux, unix, arch, arch linux, web, html, css, javascript, tutorial, gu√≠a, b√°sico, avanzado, an√°lisis, tecnolog√≠a, juegos, productos&#34;&gt;&#10;</span></span><span class="line"><span class="cl">  &lt;meta name=&#34;description&#34; content=&#34;Blog sobre al lenguaje de programaci√≥n Java y la distribuci√≥n GNU/Linux que uso habitualmente, Arch Linux, lo que aprendo sobre el software libre, la programaci√≥n web y otros temas relacionados con la tecnolog√≠a y la inform√°tica. El contenido puede contener trazas de asuntos fuera de tema.&#34;&gt;&#10;</span></span><span class="line"><span class="cl">  &lt;meta name=&#34;theme-color&#34; content=&#34;#FFFFFF&#34;/&gt;&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">  &lt;title&gt;Blog Bitix&lt;/title&gt;&#10;</span></span><span class="line"><span class="cl">...</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>curl.out</span>
    </div>
</div>
<h3 id="postman">Postman</h3>
<p>La aplicaci√≥n con interfaz gr√°fica <a href="https://www.postman.com/">Postman</a> realiza en gran medida las mismas funciones que el comando curl pero con una aplicaci√≥n de escritorio y con interfaz gr√°fica. Permite crear peticiones, a√±adir cabeceras en las peticiones y ver los resultados, cabeceras y c√≥digo de estado devueltos en las peticiones HTTP.</p>
<p>Adicionalmente ofrece otras funcionalidades como soporte para trabajar en equipos compuesto por varios desarrolladores para compartir colecciones y entornos y mantenerlos sincronizados entre los diferentes miembros del equipo. Otras funciones que tiene es la de poder ejecutar <em>scripts</em> de c√≥digo antes de realizar la petici√≥n para calcular alg√∫n dato y enviarlo en la petici√≥n. Los entornos permiten crear colecciones de variables y cambiando de un entorno a otro utilizando en las peticiones diferentes valores, por ejemplo las credenciales de autorizaci√≥n para invocar un <em>endpoint</em>.</p>
<p>Postman es una herramienta muy conocida y utilizada, ofrece una aplicaci√≥n de escritorio para los diferentes sistemas operativos incluyendo <a href="https://www.gnu.org/">GNU</a>/<a href="https://www.linux.com/">Linux</a> como una aplicaci√≥n <a href="https://flatpak.org/">Flatpak</a>. Sin embargo, no es gratuita y en entornos profesionales requiere una licencia de uso que est√° en funci√≥n del n√∫mero de usuarios que la utilizan. Es cara y tiene un coste significativo para una herramienta aunque √∫til cuando se usa es una herramienta que se usa ocasionalmente.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2022/11/realizar-peticiones-a-apis-con-herramientas-de-linea-comandos-e-interfaz-grafica/images/postman_hu96ea76b13850717ac94d4c1d6cc66d76_133523_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Postman"><img src="https://picodotdev.github.io/blog-bitix/2022/11/realizar-peticiones-a-apis-con-herramientas-de-linea-comandos-e-interfaz-grafica/images/postman_hu96ea76b13850717ac94d4c1d6cc66d76_133523_650x450_fit_q90_h2_box_3.webp" width="583" height="450" alt="Postman" title="Postman" class="&#34; " loading="lazy"></a></p>
<figcaption>Postman</figcaption>
</figure>
</div>
<h3 id="hoppscotch-alternativa-a-postman">Hoppscotch, alternativa a Postman</h3>
<p>Alternativas a Postman hay varias algunas como complementos para el editor de texto y c√≥digo <a href="https://code.visualstudio.com/">Visual Studio Code</a>. De las alternativas a Postman la m√°s parecida y que tiene funcionalidades equivalentes y suficiente como para reemplazarla es <a href="https://hoppscotch.io/">Hoppscotch</a>.</p>
<p>Al igual que Postman la aplicaci√≥n Hoppscotch es una aplicaci√≥n destinada a realizar peticiones a servicios utilizando HTTP y soportando otros protocolos como GraphQL, Websockets y MQTT. Una de las ventajas de Hoppscotch sobre Postman est√° en su licencia ya que es de c√≥digo abierto y sin coste de licencia. La interfaz de usuario de Hoppscotch est√° muy cuidada y es similar a la de Postman permitiendo crear peticiones junto a sus cabeceras as√≠ como ver el resultado devuelto, cabeceras y c√≥digo de estado.</p>
<p>Entre las funcionalidades que ofrece Hoppscotch est√°n:</p>
<ul>
<li>Posibilidad de trabajar en equipos y compartir colecciones</li>
<li>Scripts previos a la petici√≥n</li>
<li>Soporta m√∫ltiples m√©todos de autenticaci√≥n</li>
<li>Entornos y variables</li>
<li>Posibilidad de mostrar el curl e importar el curl</li>
<li>Importar desde OpenAPI y Postman, exportar como JSON</li>
<li>Posibilidad de ejecutarlo desde su web, en local como un contenedor <a href="https://www.docker.com/">Docker</a> o paquete npm</li>
</ul>
<p>Aunque Hoppscotch tiene una licencia sin coste los desarrolladores ofrecen ser patrocinados en <a href="https://github.com/hoppscotch/hoppscotch">su repositorio de GitHub</a> para seguir realizando cambios e implementando mejoras. Si es √∫til y se utiliza en un entorno profesional se anima a realizar en la medida de lo posible una contribuci√≥n econ√≥mica a los desarrolladores.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2022/11/realizar-peticiones-a-apis-con-herramientas-de-linea-comandos-e-interfaz-grafica/images/hoppscotch_hu5acee9062fc6b8ef34cd56148770b1cc_170461_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Hoppscotch"><img src="https://picodotdev.github.io/blog-bitix/2022/11/realizar-peticiones-a-apis-con-herramientas-de-linea-comandos-e-interfaz-grafica/images/hoppscotch_hu5acee9062fc6b8ef34cd56148770b1cc_170461_650x450_fit_q90_h2_box_3.webp" width="584" height="450" alt="Hoppscotch" title="Hoppscotch" class="&#34; " loading="lazy"></a></p>
<figcaption>Hoppscotch</figcaption>
</figure>
</div>
]]>
        </content>
        
            
                <category term="planeta-codigo"/>
            
                <category term="programacion"/>
            
                <category term="software"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/</id>
        <title>Las funcionalidades de un service mesh en una arquitectura de microservicios</title>
        <updated>2022-10-21T20:00:00+02:00</updated>
        <published>2022-10-21T20:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Los monolitos son la opci√≥n m√°s sencilla y mejor en la mayor√≠a de casos, los microservicios solo son recomendables cuando los problemas que resuelven compensan los problemas asociados que generan, entre ellos una mayor complejidad en la infraestructura y de comunicaci√≥n entre servicios que utilizan un medio con fallos, la red de comunicaciones entre diferentes computadoras. Esta mayor complejidad, mayor n√∫mero de servicios y mayor probabilidad de que alguna falle requiere utilizar herramientas para en el sistema tener seguridad, observabilidad, resiliencia y control de tr√°fico. Estas son funcionalidades que como una capa de red para los servicios proporciona un <em>service mesh</em>.</strong></p>]]>
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/hashicorp-consul.svg" width="200" height="278" alt="HashiCorp Consul" title="HashiCorp Consul" class="" loading="false&#34;"></p>
</div>
<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/hashicorp.svg" width="200" height="200" alt="HashiCorp" title="HashiCorp" class="" loading="false&#34;"></p>
</div>
<p>Los sistemas basados en microservicios tienen sus ventajas como utilizar servicios independientes que pueden ser desarrollados y desplegados de forma independiente incluso por distintos equipos de desarrolladores al menos mientras solo se cambien sus detalles de implementaci√≥n y mientras sus interfaces de comunicaci√≥n no cambien. Otras ventajas son una mejor escalabilidad y mejor tolerancia a errores.</p>
<p>Un monolito es m√°s que suficiente en muchos casos y los microservicios solo son necesarios en sistemas grandes y complejos formados por varios equipos de desarrollo, escalabilidad y tolerancia a fallos. Cuando tiene sentido utilizar un sistema basado en los microservicios se resuelve algunos problemas de los monolitos pero surgen otros propios de los microservicios tan o m√°s complicados que los de los monolitos.</p>
<p>Uno de los mayores problemas de los microservicios es que el sistema es m√°s complejo, formado por un conjunto mayor de piezas individuales que han de colaborar para proporcionar la funcionalidad global, han de tener en cuenta problemas que en las aplicaciones monol√≠ticas no tienen, los microservicios son independientes pero se relacionan entre ellos a trav√©s de la red un medio de comunicaci√≥n que es poco fiable comparado con la llamada a una funci√≥n dentro de la misma computadora en un monolito.</p>
<p>Para tener bajo control las complicaciones de los microservicios son necesarias herramientas que hagan del sistema m√°s f√°cil de mantener y desarrollar. Una de las herramientas espec√≠ficamente desarrollada para los microservicios es <a href="https://www.consul.io/">Consul</a> de <a href="https://www.hashicorp.com/">HashiCorp</a> que proporciona varias funcionalidades como descubrimiento de servicios y un almac√©n compartido de informaci√≥n. Otra de las funcionalidades que implementa y provee Consul es el concepto de <em>service mesh</em> que proporciona seguridad, observabilidad, resiliencia y control de tr√°fico.</p>
<div class="alert alert-warning pt-0 pb-0 tableofcontents"><h2>Contenido del art√≠culo</h2><toc></toc></div>
<h3 id="qu√©-es-un-_service-mesh_">Qu√© es un <em>service mesh</em></h3>
<p><a href="https://developer.hashicorp.com/consul/docs/concepts/service-mesh">La definici√≥n de Consul de un <em>service mesh</em></a> es una capa de red dedicada que proporciona seguridad en la comunicaci√≥n de servicio a servicio dentro y a trav√©s de la infraestructura, incluyendo el sistemas propios y entornos en la nube. Un <em>service mesh</em> es utilizado habitualmente en arquitecturas basadas en microservicios pero son √∫tiles en cualquier escenario en que hay una comunicaci√≥n por red compleja.</p>
<p>Los microservicios se comunican entre ellos formado una red distribuida, un <em>service mesh</em> es el nombre que se le da a este tipo de comunicaci√≥n. En el aspecto de las herramientas de infraestructura para facilitar y dar soluci√≥n a varios de los problemas de la comunicaci√≥n por red un <em>service mesh</em> trata todos estos problemas y aporta soluciones.</p>
<p>En gran medida la soluci√≥n a los problemas de los microservicios en un <em>service mesh</em> es implementada estableciendo un intermediario <em>proxy</em> en la comunicaci√≥n entre los servicios siendo en este intermediario denominado <em>sidecar proxy</em> el que implementa la soluci√≥n. Se denomina <em>sidecar proxy</em> ya que al mismo tiempo que se despliega el servicio se despliega el intermediario adicionalmente para la comunicaci√≥n entre los diferentes servicios que usa y los servicios en vez de comunicarse entre ellos directamente se comunican con el <em>sidecar proxy</em>.</p>
<p>El <em>service mesh</em> a trav√©s de los <em>proxy sidecar</em> permiten delegar en la infraestructura y no en las aplicaciones varios aspectos que son necesarios resolver en un sistema basado en microservicios y todo ello de forma trasnparente y sin tener que hacer modificaciones en los microservicios m√°s a ll√° de configuraci√≥n de puertos.</p>
<h4 id="seguridad">Seguridad</h4>
<p>La computaci√≥n en la nube de los proveedores de infraestructura como <a href="https://aws.amazon.com/es/">Amazon AWS</a>, <a href="https://cloud.google.com/">Google Cloud</a> y <a href="https://azure.microsoft.com/es-es/">Microsoft Azure</a> no dejan de ser entornos compartidos de computaci√≥n donde todos aun con las medidas de seguridad y l√≥gicas utilizan los mismos medios de red y computaci√≥n. Por eso se considera que la computaci√≥n en la nube utiliza un medio no confiable en el que el descubrimiento de un fallo de seguridad tan importante como <a href="https://picodotdev.github.io/blog-bitix/2018/01/explicacion-del-fallo-de-seguridad-meltdown-y-spectre-en-los-microprocesadores-intel/">el fallo de seguridad Meltdown y Spectre de los procesadores</a> a√∫n con las medidas de mitigaci√≥n implementadas es un grave problema.</p>
<p>Para proporcionar mayor seguridad en las comunicaciones de los microservicios en un medio no confiable Consul ofrece una forma de comunicaci√≥n cifrada, con autenticaci√≥n mutua entre ambos servicios y la gesti√≥n de la autorizaci√≥n en un plano l√≥gico a nivel de servicio con el mecanismo de intenciones y no de m√°s bajo nivel de direcciones IP, puertos y reglas de <em>firewall</em>.</p>
<p>La seguridad entre los servicios en Consul es implementada mediante el componente denominado <em>sidecar proxy</em> que hace de intermediario o <em>proxy</em> entre los dos servicios. Consul administra el <em>sidecar proxy</em> y este proporciona las funcionalidades comentadas de cifrado, autenticaci√≥n mutua y autorizaci√≥n. Toda comunicaci√≥n se realiza de forma cifrada y con autenticaci√≥n mutua ning√∫n servicio ajeno al <em>service mesh</em> puede comunicarse con sus servicios, para que un servicio externo al <em>service mesh</em> pueda comunicarse con un servicio del <em>service mesh</em> el tr√°fico entra por un <em>ingress gateway</em> que es un servicio dedicado a esta funci√≥n.</p>
<p>Una gran caracter√≠stica es que todas estas funcionalidades son proporcionadas sin que los servicios sean conscientes de que realmente la comunicaci√≥n la est√°n realizando a trav√©s de los <em>sidecar proxy</em>.</p>
<p>En <a href="https://www.gnu.org/">GNU</a>/<a href="https://www.linux.com/">Linux</a> la seguridad a nivel de red en la misma m√°quina en la comunicaci√≥n entre el servicio y el <em>sidecar proxy</em> se protege con <em>namespaces</em> de red que proporciona Linux.</p>
<h4 id="observabilidad">Observabilidad</h4>
<p>Dado el gran n√∫mero de elementos de una arquitectura de microservicios es imprescindible tener visibilidad del estado y comportamiento de cada uno de ellos. Se necesitan m√©tricas que permitan conocer el estado normal de los servicios y en caso de obtener unas m√©tricas diferentes saber que est√° ocurriendo en el sistema en su conjunto y en cada pieza individual.</p>
<p>Varias medidas de observabilidad es posible implementarlas en los propios microservicios como parte de su implementaci√≥n de c√≥digo, sin embargo, a√±adir c√≥digo a cada uno de los microservicios requiere hacerlo individualmente, los hace m√°s complicados y dependientes del lenguaje de implementaci√≥n para cada uno de ellos para una funcionalidad de infraestructura que no est√° relacionada con la l√≥gica de negocio que proporcionan los microservicios.</p>
<p>Por ello en la medida de lo posible es mejor delegar la observabilidad a la infraestructura que adem√°s permite aplicar la observabilidad de forma homog√©nea y con las mismas herramientas para todos los microservicios. Algunas m√©tricas de observabilidad son el n√∫mero de peticiones que est√° recibiendo un servicio por unidad de tiempo, la tasa de errores o la latencia de red en diferente percentiles.</p>
<p>Dado que todo el tr√°fico entre los microservicios fluye a trav√©s de los <em>sidecar</em> que hacen de <em>proxy</em> Consul es capaz de proporcionar estas m√©tricas de forma independiente a los microservicios. Consul exporta el formato de <a href="https://prometheus.io/">Prometheus</a> las m√©tricas, proporciona una visualizaci√≥n b√°sica de las mismas y con <a href="https://grafana.com/">Grafana</a> es posible obtener visualizaciones de los datos m√°s detalladas y complejas.</p>
<p>Para obtener el flujo completo desde que entra en el <em>service mesh</em> y fluye entre las diferentes llamadas entre los microservicios <a href="https://www.jaegertracing.io/">Jaeger</a> con <a href="https://zipkin.io/">Zipkin</a> o <a href="https://opentelemetry.io/">OpenTelemetry</a> permite obtener una foto de todos los pasos y saltos que ha tenido una petici√≥n entre los diferentes servicios.</p>
<h4 id="resiliencia">Resiliencia</h4>
<p>Dado el n√∫mero de servicios y el n√∫mero de instancias de cada uno de ellos y la no completa fiabilidad de un medio de red que puede fallar es necesario que los microservicios sean resilientes ante la aparici√≥n de estos fallos.</p>
<p>La resiliencia se puede implementar de forma activa donde Consul comprueba que cada servicio mediante un <em>health check</em> est√© funcionando ya sea realizando una petici√≥n HTTP o TCP al servicio que si responde correctamente se considera que el servicio tiene un buen estado de funcionamiento.</p>
<p>Los <em>health check</em> no son infalibles y los microservicios para aumentar su resiliencia pueden implementar otras medidas adicionales como reintentos o <em>retries</em> realizando peticiones con la esperanza de que sean problemas temporales y en un siguiente intento funcione. Otra medida son los <em>timeout</em> para poner l√≠mites a los tiempos de espera de modo que si un microservicio tarda en responder no ocasiones fallos en otros microservicios y el sistema caiga en cascada. Estas son medidas pasivas que implementan cada microservicio.</p>
<p>Consul implementa medidas de resiliencia tanto activas como pasivas, y en caso de que una instancia de un servicio falle redirigir el tr√°fico a otras instancias con buen estado de salud, este enrutamiento se realiza mediante el control de tr√°fico.</p>
<h4 id="control-de-tr√°fico">Control de tr√°fico</h4>
<p>Al ser los microservicios independientes estos se despliegan de forma independiente mientras los cambios sean solo de implementaci√≥n. Al desplegar una nueva versi√≥n de un microservicio es muy √∫til tener la capacidad del enrutamiento de las peticiones entre los microservicios para usar diferentes estrategias de despliegue como <em>rollout</em>, <em>canary</em>, <em>blue/green</em> y cambiar el enrutamiento.</p>
<p>Consul proporciona tres conceptos para controlar el enrutamiento entre los servicios los <em>resolvers</em> que identifican las instancias de los servicios en grupos, <em>splitters</em> que permite establecer la cantidad de tr√°fico que es enviada a los grupos de servicios y finalmente los <em>routers</em> que permiten mediante reglas de la petici√≥n o de la instancia del servicio a que servicio se le env√≠a el tr√°fico.</p>
<h3 id="ejemplo-pr√°ctico-del-_service-mesh_-de-consul">Ejemplo pr√°ctico del <em>service mesh</em> de Consul</h3>
<p>En el libro Consul: Up &amp; Running se explica m√°s detalladamente los puntos anteriores junto con un ejemplo con los necesarias configuraciones para Consul de cada uno de ellos utilizando <a href="https://kubernetes.io/">Kubernetes</a> y m√°quinas virtuales.</p>
<p>En el libro se usa simplemente Consul, en este art√≠culo muestro la misma configuraci√≥n y pr√°ctica de los conceptos comentados pero usando <a href="https://www.nomadproject.io/">Nomad</a> el orquestador de procesos de HashiCorp equivalente a Kubernetes pero m√°s simple de usar aunque no tan nombrado como Kuberntes. Lo ejecuto dentro de una m√°quina virtual de <a href="https://www.virtualbox.org/">VirtualBox</a> aprovisionada y creada con <a href="https://www.vagrantup.com/">Vagrant</a> otro producto de HashiCorp.</p>
<p>El ejemplo consiste en dos procesos uno <em>frontend</em> que muestra la informaci√≥n de una gu√≠a de aves y un servicio de <em>backend</em> que devuelve los datos de las aves. Los procesos est√°n empaquetados en sus im√°genes de <a href="https://www.docker.com/">Docker</a>. Ambas aplicaciones se comunican mediante una API REST y permiten probar en la pr√°ctica todos los conceptos comentados.</p>
<h4 id="creaci√≥n-de-la-m√°quina-virtual">Creaci√≥n de la m√°quina virtual</h4>
<p>Docker es un software desarrollado para GNU/Linux que en otros sistemas no funciona de forma nativa y requiere adaptaciones y virtualizaci√≥n, para poder ejecutar el ejemplo en cualquier sistema operativo y no instalar nada en la m√°quina local m√°s all√° de VirtualBox y Vagrant se utiliza una m√°quina virtual que permiten crear estas dos herramientas de forma f√°cil.</p>
<p>El siguiente es el archivo de configuraci√≥n para Vagrant de la m√°quina virtual que aprovisiona una distribuci√≥n Ubuntu con las herramientas utilizadas en el ejemplo entre ellas Consul, Nomad, <a href="https://www.envoyproxy.io/">Envoy</a> y Docker. Tambi√©n se configura la cantidad de memoria asignada a la m√°quina virtual y la direcci√≥n IP que se le asigna.</p>
<p>Al iniciar la m√°quina virtual se aprovisiona, con Vagrant simplemente consiste en ejecutar el siguiente comando. Una vez iniciada se puede hacer SSH para iniciar una sesi√≥n de terminal dentro de la m√°quina virtual.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ vagrant up&#10;</span></span><span class="line"><span class="cl">$ vagrant ssh&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>vagrant.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span><span class="lnt">26&#10;</span><span class="lnt">27&#10;</span><span class="lnt">28&#10;</span><span class="lnt">29&#10;</span><span class="lnt">30&#10;</span><span class="lnt">31&#10;</span><span class="lnt">32&#10;</span><span class="lnt">33&#10;</span><span class="lnt">34&#10;</span><span class="lnt">35&#10;</span><span class="lnt">36&#10;</span><span class="lnt">37&#10;</span><span class="lnt">38&#10;</span><span class="lnt">39&#10;</span><span class="lnt">40&#10;</span><span class="lnt">41&#10;</span><span class="lnt">42&#10;</span><span class="lnt">43&#10;</span><span class="lnt">44&#10;</span><span class="lnt">45&#10;</span><span class="lnt">46&#10;</span><span class="lnt">47&#10;</span><span class="lnt">48&#10;</span><span class="lnt">49&#10;</span><span class="lnt">50&#10;</span><span class="lnt">51&#10;</span><span class="lnt">52&#10;</span><span class="lnt">53&#10;</span><span class="lnt">54&#10;</span><span class="lnt">55&#10;</span><span class="lnt">56&#10;</span><span class="lnt">57&#10;</span><span class="lnt">58&#10;</span><span class="lnt">59&#10;</span><span class="lnt">60&#10;</span><span class="lnt">61&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="c1"># -*- mode: ruby -*-</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># vi: set ft=ruby :</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="no">Vagrant</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&#34;2&#34;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">define</span> <span class="s2">&#34;ubuntu&#34;</span> <span class="k">do</span> <span class="o">|</span><span class="n">instance</span><span class="o">|</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">instance</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box</span> <span class="o">=</span> <span class="s2">&#34;ubuntu/jammy64&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">instance</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="s2">&#34;private_network&#34;</span><span class="p">,</span> <span class="ss">ip</span><span class="p">:</span> <span class="s2">&#34;192.168.56.10&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">instance</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">synced_folder</span> <span class="s2">&#34;.&#34;</span><span class="p">,</span> <span class="s2">&#34;/home/vagrant/ConsulServiceMesh/&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">instance</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provider</span> <span class="ss">:virtualbox</span> <span class="k">do</span> <span class="o">|</span><span class="n">vb</span><span class="o">|</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">vb</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Ubuntu 22.04 (Vagrant)&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">vb</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="s2">&#34;4096&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">instance</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provision</span> <span class="s2">&#34;shell&#34;</span><span class="p">,</span> <span class="ss">inline</span><span class="p">:</span> <span class="vg">$consul_role_script</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">end</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">end</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="vg">$consul_role_script</span> <span class="o">=</span> <span class="s">&lt;&lt;-SCRIPT&#10;</span></span></span><span class="line"><span class="cl"><span class="s"></span>&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">echo</span> <span class="s2">&#34;Updating...&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">upgrade</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">echo</span> <span class="s2">&#34;Installing Consul...&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">wget</span> <span class="o">-</span><span class="n">O</span><span class="o">-</span> <span class="ss">https</span><span class="p">:</span><span class="sr">//</span><span class="n">apt</span><span class="o">.</span><span class="n">releases</span><span class="o">.</span><span class="n">hashicorp</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">gpg</span> <span class="o">|</span> <span class="n">gpg</span> <span class="o">--</span><span class="n">dearmor</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">tee</span> <span class="sr">/usr/s</span><span class="n">hare</span><span class="o">/</span><span class="n">keyrings</span><span class="o">/</span><span class="n">hashicorp</span><span class="o">-</span><span class="n">archive</span><span class="o">-</span><span class="n">keyring</span><span class="o">.</span><span class="n">gpg</span> <span class="o">&gt;</span> <span class="sr">/dev/nu</span><span class="n">ll</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">echo</span> <span class="s2">&#34;deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com $(lsb_release -cs) main&#34;</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">tee</span> <span class="sr">/etc/</span><span class="n">apt</span><span class="o">/</span><span class="n">sources</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">hashicorp</span><span class="o">.</span><span class="n">list</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span> <span class="o">&amp;&amp;</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">consul</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">echo</span> <span class="s2">&#34;Installing Nomad...&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">wget</span> <span class="o">-</span><span class="n">O</span><span class="o">-</span> <span class="ss">https</span><span class="p">:</span><span class="sr">//</span><span class="n">apt</span><span class="o">.</span><span class="n">releases</span><span class="o">.</span><span class="n">hashicorp</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">gpg</span> <span class="o">|</span> <span class="n">gpg</span> <span class="o">--</span><span class="n">dearmor</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">tee</span> <span class="sr">/usr/s</span><span class="n">hare</span><span class="o">/</span><span class="n">keyrings</span><span class="o">/</span><span class="n">hashicorp</span><span class="o">-</span><span class="n">archive</span><span class="o">-</span><span class="n">keyring</span><span class="o">.</span><span class="n">gpg</span>  <span class="o">&gt;</span> <span class="sr">/dev/nu</span><span class="n">ll</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">echo</span> <span class="s2">&#34;deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com $(lsb_release -cs) main&#34;</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">tee</span> <span class="sr">/etc/</span><span class="n">apt</span><span class="o">/</span><span class="n">sources</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">hashicorp</span><span class="o">.</span><span class="n">list</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span> <span class="o">&amp;&amp;</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">nomad</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">echo</span> <span class="s2">&#34;Installing Envoy...&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">curl</span> <span class="o">-</span><span class="n">L</span> <span class="ss">https</span><span class="p">:</span><span class="sr">//</span><span class="n">func</span><span class="o">-</span><span class="n">e</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">install</span><span class="o">.</span><span class="n">sh</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">bash</span> <span class="o">-</span><span class="n">s</span> <span class="o">--</span> <span class="o">-</span><span class="n">b</span> <span class="sr">/usr/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span> <span class="o">&amp;&amp;</span> <span class="n">func</span><span class="o">-</span><span class="n">e</span> <span class="n">use</span> <span class="mi">1</span><span class="o">.</span><span class="mi">23</span><span class="o">.</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">sudo</span> <span class="n">cp</span> <span class="o">~</span><span class="sr">/.func-e/</span><span class="n">versions</span><span class="o">/</span><span class="mi">1</span><span class="o">.</span><span class="mi">23</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">envoy</span> <span class="sr">/usr/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">echo</span> <span class="s2">&#34;Installing cni plugins...&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">curl</span> <span class="o">-</span><span class="n">L</span> <span class="o">-</span><span class="n">o</span> <span class="n">cni</span><span class="o">-</span><span class="n">plugins</span><span class="o">.</span><span class="n">tgz</span> <span class="ss">https</span><span class="p">:</span><span class="sr">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">containernetworking</span><span class="o">/</span><span class="n">plugins</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">v1</span><span class="o">.</span><span class="mi">1</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">cni</span><span class="o">-</span><span class="n">plugins</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">amd64</span><span class="o">-</span><span class="n">v1</span><span class="o">.</span><span class="mi">1</span><span class="o">.</span><span class="mi">1</span><span class="o">.</span><span class="n">tgz</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">-</span><span class="nb">p</span> <span class="sr">/opt/</span><span class="n">cni</span><span class="o">/</span><span class="n">bin</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">sudo</span> <span class="n">tar</span> <span class="o">-</span><span class="n">C</span> <span class="sr">/opt/</span><span class="n">cni</span><span class="o">/</span><span class="n">bin</span> <span class="o">-</span><span class="n">xzf</span> <span class="n">cni</span><span class="o">-</span><span class="n">plugins</span><span class="o">.</span><span class="n">tgz</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">echo</span> <span class="mi">1</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">tee</span> <span class="sr">/proc/s</span><span class="n">ys</span><span class="o">/</span><span class="n">net</span><span class="o">/</span><span class="n">bridge</span><span class="o">/</span><span class="n">bridge</span><span class="o">-</span><span class="n">nf</span><span class="o">-</span><span class="n">call</span><span class="o">-</span><span class="n">arptables</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">echo</span> <span class="mi">1</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">tee</span> <span class="sr">/proc/s</span><span class="n">ys</span><span class="o">/</span><span class="n">net</span><span class="o">/</span><span class="n">bridge</span><span class="o">/</span><span class="n">bridge</span><span class="o">-</span><span class="n">nf</span><span class="o">-</span><span class="n">call</span><span class="o">-</span><span class="n">ip6tables</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">echo</span> <span class="mi">1</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">tee</span> <span class="sr">/proc/s</span><span class="n">ys</span><span class="o">/</span><span class="n">net</span><span class="o">/</span><span class="n">bridge</span><span class="o">/</span><span class="n">bridge</span><span class="o">-</span><span class="n">nf</span><span class="o">-</span><span class="n">call</span><span class="o">-</span><span class="n">iptables</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">sudo</span> <span class="n">cat</span> <span class="o">&lt;&lt;</span> <span class="no">EOF</span> <span class="o">&gt;</span> <span class="sr">/etc/s</span><span class="n">ysctl</span><span class="o">.</span><span class="n">d</span><span class="o">/</span>&#10;</span></span><span class="line"><span class="cl">  <span class="n">net</span><span class="o">.</span><span class="n">bridge</span><span class="o">.</span><span class="n">bridge</span><span class="o">-</span><span class="n">nf</span><span class="o">-</span><span class="n">call</span><span class="o">-</span><span class="n">arptables</span> <span class="o">=</span> <span class="mi">1</span>&#10;</span></span><span class="line"><span class="cl">  <span class="n">net</span><span class="o">.</span><span class="n">bridge</span><span class="o">.</span><span class="n">bridge</span><span class="o">-</span><span class="n">nf</span><span class="o">-</span><span class="n">call</span><span class="o">-</span><span class="n">ip6tables</span> <span class="o">=</span> <span class="mi">1</span>&#10;</span></span><span class="line"><span class="cl">  <span class="n">net</span><span class="o">.</span><span class="n">bridge</span><span class="o">.</span><span class="n">bridge</span><span class="o">-</span><span class="n">nf</span><span class="o">-</span><span class="n">call</span><span class="o">-</span><span class="n">iptables</span> <span class="o">=</span> <span class="mi">1</span>&#10;</span></span><span class="line"><span class="cl">  <span class="no">EOF</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">echo</span> <span class="s2">&#34;Installing Docker...&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">curl</span> <span class="o">-</span><span class="n">fsSL</span> <span class="ss">https</span><span class="p">:</span><span class="sr">//</span><span class="n">download</span><span class="o">.</span><span class="n">docker</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">gpg</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">gpg</span> <span class="o">--</span><span class="n">dearmor</span> <span class="o">-</span><span class="n">o</span> <span class="sr">/usr/s</span><span class="n">hare</span><span class="o">/</span><span class="n">keyrings</span><span class="o">/</span><span class="n">docker</span><span class="o">.</span><span class="n">gpg</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">echo</span> <span class="p">\</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="s2">&#34;deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \&#10;</span></span></span><span class="line"><span class="cl"><span class="s2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  $(lsb_release -cs) stable&#34;</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">tee</span> <span class="sr">/etc/</span><span class="n">apt</span><span class="o">/</span><span class="n">sources</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">docker</span><span class="o">.</span><span class="n">list</span> <span class="o">&gt;</span> <span class="sr">/dev/nu</span><span class="n">ll</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span> <span class="o">&amp;&amp;</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">docker</span><span class="o">-</span><span class="n">ce</span> <span class="n">docker</span><span class="o">-</span><span class="n">ce</span><span class="o">-</span><span class="n">cli</span> <span class="n">containerd</span><span class="o">.</span><span class="n">io</span> <span class="n">docker</span><span class="o">-</span><span class="n">compose</span><span class="o">-</span><span class="n">plugin</span> <span class="o">&amp;&amp;</span> <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">docker</span><span class="o">.</span><span class="n">service</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">sudo</span> <span class="n">usermod</span> <span class="o">-</span><span class="n">aG</span> <span class="n">docker</span> <span class="n">vagrant</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="no">SCRIPT</span>&#10;</span></span><span class="line"><span class="cl">  <span class="k">end</span>&#10;</span></span><span class="line"><span class="cl">  </span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>Vagrantfile</span>
    </div>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/virtualbox_hu7a2a034edbf495f255b69302d89bf1d6_176833_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="VirtualBox"><img src="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/virtualbox_hu7a2a034edbf495f255b69302d89bf1d6_176833_650x450_fit_q90_h2_box_3.webp" width="582" height="450" alt="VirtualBox" title="VirtualBox" class="&#34; " loading="lazy"></a></p>
<figcaption>VirtualBox</figcaption>
</figure>
</div>
<h4 id="inicio-de-consul-y-nomad-y-microservicios-del-ejemplo">Inicio de Consul y Nomad y microservicios del ejemplo</h4>
<p>Una de las ventajas de Consul y Nomad es que son muy simples de usar ya que sus programas son simplemente un √∫nico binario. Consul y Nomad se inician con los siguientes comandos en modo desarrollo con sus archivos de configuraci√≥n.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ consul agent -dev -config-dir<span class="o">=</span>consul.d/&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>consul.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ sudo nomad agent -dev-connect -config<span class="o">=</span>nomad.d/&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>nomad.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-hcl" data-lang="hcl"><span class="line"><span class="cl"><span class="n">server</span> <span class="o">=</span> <span class="kt">true</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">bootstrap_expect</span> <span class="o">=</span> <span class="m">1</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">bind_addr</span> <span class="o">=</span> <span class="s2">&#34;127.0.0.1&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">client_addr</span> <span class="o">=</span> <span class="s2">&#34;0.0.0.0&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">ports</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;grpc</span> <span class="o">=</span> <span class="m">8502</span>&#10;</span></span><span class="line"><span class="cl">}&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">connect</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;enabled</span> <span class="o">=</span> <span class="kt">true</span>&#10;</span></span><span class="line"><span class="cl">}&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">ui_config</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;enabled</span> <span class="o">=</span> <span class="kt">true</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;metrics_provider</span> <span class="o">=</span> <span class="s2">&#34;prometheus&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">metrics_proxy</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_url</span> <span class="o">=</span> <span class="s2">&#34;http://localhost:9090&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">}&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>consul.d/consul.hcl</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-hcl" data-lang="hcl"><span class="line"><span class="cl"><span class="k">plugin</span> <span class="s2">&#34;docker&#34;</span> {&#10;</span></span><span class="line"><span class="cl">  <span class="k">config</span> {&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">volumes</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  enabled</span> <span class="o">=</span> <span class="kt">true</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">  }&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">  <span class="k">volumes</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;enabled</span> <span class="o">=</span> <span class="kt">true</span>&#10;</span></span><span class="line"><span class="cl">  }&#10;</span></span><span class="line"><span class="cl">}&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>nomad.d/nomad.hcl</span>
    </div>
</div>
<p>Consul requiere la definici√≥n del servicio <em>ingress gateway</em> que permite que entre tr√°fico al <em>service mesh</em>, en esta configuraci√≥n a trav√©s del puerto 8080, el tr√°fico entrante es redirigido al servicio <em>frontend</em>. Esta configuraci√≥n se proporciona como un <a href="https://developer.hashicorp.com/consul/docs/connect/config-entries">Config Entry</a> de Consul y se proporciona a Consul con un comando.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ consul config write consul.d/config-entries/proxy-defaults.hcl&#10;</span></span><span class="line"><span class="cl">$ consul config write consul.d/config-entries/ingress-gateway.hcl&#10;</span></span><span class="line"><span class="cl">$ consul connect envoy -gateway<span class="o">=</span>ingress -service ingress-gateway -admin-bind 127.0.0.1:19002 -address 127.0.0.1:20000</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>consul-ingress-gateway.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-hcl" data-lang="hcl"><span class="line"><span class="cl"><span class="n">Kind</span> <span class="o">=</span> <span class="s2">&#34;ingress-gateway&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">Name</span> <span class="o">=</span> <span class="s2">&#34;ingress-gateway&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="n">Listeners</span> <span class="o">=</span> <span class="p">[</span>{&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;Port</span> <span class="o">=</span> <span class="m">8080</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;Protocol</span> <span class="o">=</span> <span class="s2">&#34;http&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;Services</span> <span class="o">=</span> <span class="p">[</span>{&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name</span> <span class="o">=</span> <span class="s2">&#34;frontend&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hosts</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;localhost&#34;, &#34;192.168.56.10&#34;</span><span class="p">]</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;}<span class="p">]</span>&#10;</span></span><span class="line"><span class="cl">}<span class="p">]</span>&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>consul.d/config-entries/ingress-gateway.hcl</span>
    </div>
</div>
<p>La configuraci√≥n de los <em>sidecar proxy</em> que crear Consul en este ejemplo es necesario para exportar m√©tricas de Prometheus y enviar la trazabilidad a Jaeger usando Zipkin.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span><span class="lnt">26&#10;</span><span class="lnt">27&#10;</span><span class="lnt">28&#10;</span><span class="lnt">29&#10;</span><span class="lnt">30&#10;</span><span class="lnt">31&#10;</span><span class="lnt">32&#10;</span><span class="lnt">33&#10;</span><span class="lnt">34&#10;</span><span class="lnt">35&#10;</span><span class="lnt">36&#10;</span><span class="lnt">37&#10;</span><span class="lnt">38&#10;</span><span class="lnt">39&#10;</span><span class="lnt">40&#10;</span><span class="lnt">41&#10;</span><span class="lnt">42&#10;</span><span class="lnt">43&#10;</span><span class="lnt">44&#10;</span><span class="lnt">45&#10;</span><span class="lnt">46&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-hcl" data-lang="hcl"><span class="line"><span class="cl"><span class="n">Kind</span> <span class="o">=</span> <span class="s2">&#34;proxy-defaults&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">Name</span> <span class="o">=</span> <span class="s2">&#34;global&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">Config</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;protocol</span> <span class="o">=</span> <span class="s2">&#34;http&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;envoy_tracing_json</span> <span class="o">=</span> <span class="err">&lt;&lt;</span><span class="k">EOF</span>&#10;</span></span><span class="line"><span class="cl">{&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;http&#34;</span><span class="err">:</span>{&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;name&#34;:&#34;envoy.tracers.zipkin&#34;</span><span class="p">,</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;typedConfig&#34;</span><span class="err">:</span>{&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;@type&#34;:&#34;type.googleapis.com/envoy.config.trace.v3.ZipkinConfig&#34;</span><span class="p">,</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;collector_cluster&#34;:&#34;jaeger_collector&#34;</span><span class="p">,</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;collector_endpoint_version&#34;:&#34;HTTP_JSON&#34;</span><span class="p">,</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;collector_endpoint&#34;:&#34;/api/v2/spans&#34;</span><span class="p">,</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;shared_span_context&#34;</span><span class="err">:</span><span class="kt">false</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">}&#10;</span></span><span class="line"><span class="cl"><span class="k">EOF</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp; envoy_extra_static_clusters_json</span> <span class="o">=</span> <span class="err">&lt;&lt;</span><span class="k">EOF</span>&#10;</span></span><span class="line"><span class="cl">{&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp; <span class="s2">&#34;connect_timeout&#34;:&#34;3.000s&#34;</span><span class="p">,</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp; <span class="s2">&#34;dns_lookup_family&#34;:&#34;V4_ONLY&#34;</span><span class="p">,</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp; <span class="s2">&#34;lb_policy&#34;:&#34;ROUND_ROBIN&#34;</span><span class="p">,</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp; <span class="s2">&#34;load_assignment&#34;</span><span class="err">:</span> {&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="s2">&#34;cluster_name&#34;:&#34;jaeger_collector&#34;</span><span class="p">,</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="s2">&#34;endpoints&#34;</span><span class="err">:</span><span class="p">[</span>{&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="s2">&#34;lb_endpoints&#34;</span> <span class="err">:</span><span class="p">[</span>{&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <span class="s2">&#34;endpoint&#34;</span><span class="err">:</span> {&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;address&#34;</span><span class="err">:</span> {&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;socket_address&#34;</span><span class="err">:</span> {&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;address&#34;:&#34;localhost&#34;</span><span class="p">,</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;port_value&#34;</span><span class="err">:</span><span class="m">9411</span><span class="p">,</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;protocol&#34;:&#34;TCP&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   }&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   }&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<span class="p">]</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<span class="p">]</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;}<span class="p">,</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;name&#34;:&#34;jaeger_collector&#34;</span><span class="p">,</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;type&#34;:&#34;STRICT_DNS&#34;</span>&#10;</span></span><span class="line"><span class="cl">}&#10;</span></span><span class="line"><span class="cl"><span class="k">EOF</span>&#10;</span></span><span class="line"><span class="cl">}&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>consul.d/config-entries/proxy-defaults.hcl</span>
    </div>
</div>
<p>Tanto Consul como Nomad ofrecen una interfaz web para consultar el estado de los servicios y realizar tareas de forma m√°s intuitiva que utilizando la l√≠nea de comandos. La interfaz de Consul se inicia en el puerto 8500 y la de Nomad en el puerto 4646 la direcci√≥n IP es la de la m√°quina virtual.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/consul_hu38ca79e125ea90732c98801666d94a1c_114012_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Consul"><img src="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/consul_hu38ca79e125ea90732c98801666d94a1c_114012_300x200_fit_q90_h2_box_3.webp" width="246" height="200" alt="Consul" title="Consul" class="&#34; " loading="lazy"></a>
<a href="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/nomad_hu9bbb57e399b7a2dffb0f8e1e395e2194_140021_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Nomad"><img src="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/nomad_hu9bbb57e399b7a2dffb0f8e1e395e2194_140021_300x200_fit_q90_h2_box_3.webp" width="246" height="200" alt="Nomad" title="Nomad" class="&#34; " loading="lazy"></a></p>
<figcaption>Consul y Nomad</figcaption>
</figure>
</div>
<h4 id="inicio-de-prometheus-y-jaeger">Inicio de Prometheus y Jaeger</h4>
<p>Prometheus es una base de datos temporal que permite guardar los datos de m√©tricas y monitorizaci√≥n que generan las aplicaciones, los <em>sidecar proxy</em> generan m√©tricas que Prometheus recolecta y Consul permite mostrar algunos datos b√°sicos de m√©tricas como n√∫mero de peticiones, tasa de fallos de las peticiones y percentiles de latencia.</p>
<p>Jaeger es una herramienta de trazabilidad que permite correlacionar todas las peticiones que se realizan entre los servicios, de esta forma es posible relacionar la petici√≥n del servicio <em>frontend</em> con la petici√≥n del servicio <em>backend</em> y mostrar ambas al mismo tiempo como si estuvieran relacionadas, esta relaci√≥n se establece mediante un <em>traceId</em> que identifica al conjunto de las peticiones individuales.</p>
<p>En el ejemplo Prometheus y Jaeger se inician como contenedores de Docker con los siguientes comandos. Tambi√©n se podr√≠an haber iniciado como servicios de Nomad. La configuraci√≥n de Prometheus es necesaria para recolectar las m√©tricas de Consul.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ docker run --rm -p 9090:9090 --name prometheus --network host -v <span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/prometheus.yml:/etc/prometheus/prometheus.yml prom/prometheus&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>prometheus.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">global</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">scrape_interval</span><span class="p">:</span><span class="w"> </span><span class="l">10s</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">scrape_configs</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">job_name</span><span class="p">:</span><span class="w"> </span><span class="l">consul</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">metrics_path</span><span class="p">:</span><span class="w"> </span><span class="l">/metrics</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">consul_sd_configs</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;localhost:8500&#39;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">relabel_configs</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">source_labels</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span>- <span class="l">__meta_consul_tagged_address_lan</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span>- <span class="l">__meta_consul_service_metadata_prometheus_port</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">regex</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;(.*);(.*)&#39;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">replacement</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;${1}:${2}&#39;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">target_label</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;__address__&#39;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;replace&#39;</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>prometheus.yml</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ docker run --rm --name jaeger <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -e <span class="nv">COLLECTOR_ZIPKIN_HOST_PORT</span><span class="o">=</span>:9411 <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -e <span class="nv">COLLECTOR_OTLP_ENABLED</span><span class="o">=</span><span class="nb">true</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -p <span class="s2">&#34;6831:6831/udp&#34;</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -p <span class="s2">&#34;6832:6832/udp&#34;</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -p <span class="s2">&#34;5778:5778&#34;</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -p <span class="s2">&#34;16686:16686&#34;</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -p <span class="s2">&#34;4317:4317&#34;</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -p <span class="s2">&#34;4318:4318&#34;</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -p <span class="s2">&#34;14250:14250&#34;</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -p <span class="s2">&#34;14268:14268&#34;</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -p <span class="s2">&#34;14269:14269&#34;</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>  -p <span class="s2">&#34;9411:9411&#34;</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>  jaegertracing/all-in-one:1.38</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>jaeger.sh</span>
    </div>
</div>
<p>Jaeger ofrece una interfaz web en el puerto 16686 para visualizar la trazabilidad de una petici√≥n y buscar una traza en concreto a trav√©s de su <em>traceId</em> y otros filtros.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/jaeger_hu33e6a5ea76c78b45612ee7e8a8666ca6_100673_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Jaeger"><img src="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/jaeger_hu33e6a5ea76c78b45612ee7e8a8666ca6_100673_650x450_fit_q90_h2_box_3.webp" width="553" height="450" alt="Jaeger" title="Jaeger" class="&#34; " loading="lazy"></a></p>
<figcaption>Jaeger</figcaption>
</figure>
</div>
<h4 id="inicio-de-los-servicios-_frontend_-y-_backend_">Inicio de los servicios <em>frontend</em> y <em>backend</em></h4>
<p>La aplicaci√≥n de ejemplo que muestra informaci√≥n de aves est√° compuesta de dos microservicios el <em>frontend</em> que muestra la informaci√≥n mediante una interfaz web y el servicio de <em>backend</em> que proporciona la informaci√≥n al <em>frontend</em>.</p>
<p>En el libro Consul: Up &amp; Running los servicios se inician utilizando √∫nicamente Consul que es en lo que se centra el libro, pero en este ejemplo inicio estos servicios utilizando el orquestador Nomad, Nomad permite definir la misma configuraci√≥n incluyendo la configuraci√≥n para los <em>sidecar proxy</em> y se integra con Consul.</p>
<p>La definici√≥n del job de Nomad que engloba ambos servicios es la siguiente. Con esta definici√≥n declarativa Nomad se encarga de iniciarlos seg√∫n la descripci√≥n indicada, del servicio de <em>backend</em> se inician dos instancias una la de la versi√≥n <em>v1</em> y otra de la <em>v2</em>.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ nomad run birds.nomad&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>nomad-birds.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">  1&#10;</span><span class="lnt">  2&#10;</span><span class="lnt">  3&#10;</span><span class="lnt">  4&#10;</span><span class="lnt">  5&#10;</span><span class="lnt">  6&#10;</span><span class="lnt">  7&#10;</span><span class="lnt">  8&#10;</span><span class="lnt">  9&#10;</span><span class="lnt"> 10&#10;</span><span class="lnt"> 11&#10;</span><span class="lnt"> 12&#10;</span><span class="lnt"> 13&#10;</span><span class="lnt"> 14&#10;</span><span class="lnt"> 15&#10;</span><span class="lnt"> 16&#10;</span><span class="lnt"> 17&#10;</span><span class="lnt"> 18&#10;</span><span class="lnt"> 19&#10;</span><span class="lnt"> 20&#10;</span><span class="lnt"> 21&#10;</span><span class="lnt"> 22&#10;</span><span class="lnt"> 23&#10;</span><span class="lnt"> 24&#10;</span><span class="lnt"> 25&#10;</span><span class="lnt"> 26&#10;</span><span class="lnt"> 27&#10;</span><span class="lnt"> 28&#10;</span><span class="lnt"> 29&#10;</span><span class="lnt"> 30&#10;</span><span class="lnt"> 31&#10;</span><span class="lnt"> 32&#10;</span><span class="lnt"> 33&#10;</span><span class="lnt"> 34&#10;</span><span class="lnt"> 35&#10;</span><span class="lnt"> 36&#10;</span><span class="lnt"> 37&#10;</span><span class="lnt"> 38&#10;</span><span class="lnt"> 39&#10;</span><span class="lnt"> 40&#10;</span><span class="lnt"> 41&#10;</span><span class="lnt"> 42&#10;</span><span class="lnt"> 43&#10;</span><span class="lnt"> 44&#10;</span><span class="lnt"> 45&#10;</span><span class="lnt"> 46&#10;</span><span class="lnt"> 47&#10;</span><span class="lnt"> 48&#10;</span><span class="lnt"> 49&#10;</span><span class="lnt"> 50&#10;</span><span class="lnt"> 51&#10;</span><span class="lnt"> 52&#10;</span><span class="lnt"> 53&#10;</span><span class="lnt"> 54&#10;</span><span class="lnt"> 55&#10;</span><span class="lnt"> 56&#10;</span><span class="lnt"> 57&#10;</span><span class="lnt"> 58&#10;</span><span class="lnt"> 59&#10;</span><span class="lnt"> 60&#10;</span><span class="lnt"> 61&#10;</span><span class="lnt"> 62&#10;</span><span class="lnt"> 63&#10;</span><span class="lnt"> 64&#10;</span><span class="lnt"> 65&#10;</span><span class="lnt"> 66&#10;</span><span class="lnt"> 67&#10;</span><span class="lnt"> 68&#10;</span><span class="lnt"> 69&#10;</span><span class="lnt"> 70&#10;</span><span class="lnt"> 71&#10;</span><span class="lnt"> 72&#10;</span><span class="lnt"> 73&#10;</span><span class="lnt"> 74&#10;</span><span class="lnt"> 75&#10;</span><span class="lnt"> 76&#10;</span><span class="lnt"> 77&#10;</span><span class="lnt"> 78&#10;</span><span class="lnt"> 79&#10;</span><span class="lnt"> 80&#10;</span><span class="lnt"> 81&#10;</span><span class="lnt"> 82&#10;</span><span class="lnt"> 83&#10;</span><span class="lnt"> 84&#10;</span><span class="lnt"> 85&#10;</span><span class="lnt"> 86&#10;</span><span class="lnt"> 87&#10;</span><span class="lnt"> 88&#10;</span><span class="lnt"> 89&#10;</span><span class="lnt"> 90&#10;</span><span class="lnt"> 91&#10;</span><span class="lnt"> 92&#10;</span><span class="lnt"> 93&#10;</span><span class="lnt"> 94&#10;</span><span class="lnt"> 95&#10;</span><span class="lnt"> 96&#10;</span><span class="lnt"> 97&#10;</span><span class="lnt"> 98&#10;</span><span class="lnt"> 99&#10;</span><span class="lnt">100&#10;</span><span class="lnt">101&#10;</span><span class="lnt">102&#10;</span><span class="lnt">103&#10;</span><span class="lnt">104&#10;</span><span class="lnt">105&#10;</span><span class="lnt">106&#10;</span><span class="lnt">107&#10;</span><span class="lnt">108&#10;</span><span class="lnt">109&#10;</span><span class="lnt">110&#10;</span><span class="lnt">111&#10;</span><span class="lnt">112&#10;</span><span class="lnt">113&#10;</span><span class="lnt">114&#10;</span><span class="lnt">115&#10;</span><span class="lnt">116&#10;</span><span class="lnt">117&#10;</span><span class="lnt">118&#10;</span><span class="lnt">119&#10;</span><span class="lnt">120&#10;</span><span class="lnt">121&#10;</span><span class="lnt">122&#10;</span><span class="lnt">123&#10;</span><span class="lnt">124&#10;</span><span class="lnt">125&#10;</span><span class="lnt">126&#10;</span><span class="lnt">127&#10;</span><span class="lnt">128&#10;</span><span class="lnt">129&#10;</span><span class="lnt">130&#10;</span><span class="lnt">131&#10;</span><span class="lnt">132&#10;</span><span class="lnt">133&#10;</span><span class="lnt">134&#10;</span><span class="lnt">135&#10;</span><span class="lnt">136&#10;</span><span class="lnt">137&#10;</span><span class="lnt">138&#10;</span><span class="lnt">139&#10;</span><span class="lnt">140&#10;</span><span class="lnt">141&#10;</span><span class="lnt">142&#10;</span><span class="lnt">143&#10;</span><span class="lnt">144&#10;</span><span class="lnt">145&#10;</span><span class="lnt">146&#10;</span><span class="lnt">147&#10;</span><span class="lnt">148&#10;</span><span class="lnt">149&#10;</span><span class="lnt">150&#10;</span><span class="lnt">151&#10;</span><span class="lnt">152&#10;</span><span class="lnt">153&#10;</span><span class="lnt">154&#10;</span><span class="lnt">155&#10;</span><span class="lnt">156&#10;</span><span class="lnt">157&#10;</span><span class="lnt">158&#10;</span><span class="lnt">159&#10;</span><span class="lnt">160&#10;</span><span class="lnt">161&#10;</span><span class="lnt">162&#10;</span><span class="lnt">163&#10;</span><span class="lnt">164&#10;</span><span class="lnt">165&#10;</span><span class="lnt">166&#10;</span><span class="lnt">167&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-hcl" data-lang="hcl"><span class="line"><span class="cl"><span class="k">job</span> <span class="s2">&#34;app-birds&#34;</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">  datacenters</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;dc1&#34;</span><span class="p">]</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">  <span class="k">group</span> <span class="s2">&#34;frontend&#34;</span> {&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">network</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  mode</span> <span class="o">=</span> <span class="s2">&#34;bridge&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">port</span> <span class="s2">&#34;http&#34;</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static</span> <span class="o">=</span> <span class="m">21000</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to</span>&nbsp;&nbsp;&nbsp;&nbsp; <span class="o">=</span> <span class="m">21000</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">port</span> <span class="s2">&#34;envoy_metrics&#34;</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static</span> <span class="o">=</span> <span class="m">20200</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to</span> <span class="o">=</span> <span class="m">20200</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">service</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  name</span> <span class="o">=</span> <span class="s2">&#34;frontend&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  port</span> <span class="o">=</span> <span class="m">6060</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">meta</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prometheus_port</span> <span class="o">=</span> <span class="s2">&#34;20200&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">connect</span> {&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">sidecar_service</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  port</span> <span class="o">=</span> <span class="m">21000</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">proxy</span> {&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">upstreams</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  destination_name</span> <span class="o">=</span> <span class="s2">&#34;backend&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  local_bind_port</span> <span class="o">=</span> <span class="m">6001</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">config</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  envoy_prometheus_bind_addr</span> <span class="o">=</span> <span class="s2">&#34;0.0.0.0:20200&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">task</span> <span class="s2">&#34;frontend&#34;</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  driver</span> <span class="o">=</span> <span class="s2">&#34;docker&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">env</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BIND_ADDR</span><span class="o">=</span><span class="s2">&#34;0.0.0.0:6060&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BACKEND_URL</span><span class="o">=</span><span class="s2">&#34;http://localhost:6001&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRACING_URL</span><span class="o">=</span><span class="s2">&#34;http://192.168.56.10:9411&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">resources</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cpu</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">=</span> <span class="m">350</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memory</span> <span class="o">=</span> <span class="m">1024</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">config</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image</span> <span class="o">=</span> <span class="s2">&#34;ghcr.io/consul-up/birdwatcher-frontend:1.0.0&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memory_hard_limit</span> <span class="o">=</span> <span class="s2">&#34;1024&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">  }&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">  <span class="k">group</span> <span class="s2">&#34;backend&#34;</span> {&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">network</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  mode</span> <span class="o">=</span> <span class="s2">&#34;bridge&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">port</span> <span class="s2">&#34;envoy_metrics&#34;</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static</span> <span class="o">=</span> <span class="m">20201</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to</span> <span class="o">=</span> <span class="m">20201</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">service</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  name</span> <span class="o">=</span> <span class="s2">&#34;backend&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  port</span> <span class="o">=</span> <span class="m">7000</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">meta</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prometheus_port</span> <span class="o">=</span> <span class="s2">&#34;20201&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version</span> <span class="o">=</span> <span class="s2">&#34;v1&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">connect</span> {&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">sidecar_service</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  port</span> <span class="o">=</span> <span class="m">22000</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">proxy</span> {&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">config</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  envoy_prometheus_bind_addr</span> <span class="o">=</span> <span class="s2">&#34;0.0.0.0:20201&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">task</span> <span class="s2">&#34;backend&#34;</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  driver</span> <span class="o">=</span> <span class="s2">&#34;docker&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">env</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BIND_ADDR</span><span class="o">=</span><span class="s2">&#34;0.0.0.0:7000&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRACING_URL</span><span class="o">=</span><span class="s2">&#34;http://192.168.56.10:9411&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">resources</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cpu</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">=</span> <span class="m">350</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memory</span> <span class="o">=</span> <span class="m">1024</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">config</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image</span> <span class="o">=</span> <span class="s2">&#34;ghcr.io/consul-up/birdwatcher-backend:1.0.0&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memory_hard_limit</span> <span class="o">=</span> <span class="s2">&#34;1024&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">  }&#10;</span></span><span class="line"><span class="cl">  &#10;</span></span><span class="line"><span class="cl">  <span class="k">group</span> <span class="s2">&#34;backend-v2&#34;</span> {&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">network</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  mode</span> <span class="o">=</span> <span class="s2">&#34;bridge&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">port</span> <span class="s2">&#34;envoy_metrics&#34;</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static</span> <span class="o">=</span> <span class="m">20202</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to</span> <span class="o">=</span> <span class="m">20202</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">service</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  name</span> <span class="o">=</span> <span class="s2">&#34;backend&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  port</span> <span class="o">=</span> <span class="m">7001</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">meta</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prometheus_port</span> <span class="o">=</span> <span class="s2">&#34;20202&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version</span> <span class="o">=</span> <span class="s2">&#34;v2&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">connect</span> {&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">sidecar_service</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  port</span> <span class="o">=</span> <span class="m">22001</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">proxy</span> {&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">config</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  envoy_prometheus_bind_addr</span> <span class="o">=</span> <span class="s2">&#34;0.0.0.0:20202&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">task</span> <span class="s2">&#34;backend&#34;</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  driver</span> <span class="o">=</span> <span class="s2">&#34;docker&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">env</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BIND_ADDR</span><span class="o">=</span><span class="s2">&#34;0.0.0.0:7001&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRACING_URL</span><span class="o">=</span><span class="s2">&#34;http://192.168.56.10:9411&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VERSION</span><span class="o">=</span><span class="s2">&#34;v2&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">resources</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cpu</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">=</span> <span class="m">350</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memory</span> <span class="o">=</span> <span class="m">1024</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="k">config</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image</span> <span class="o">=</span> <span class="s2">&#34;ghcr.io/consul-up/birdwatcher-backend:1.0.0&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memory_hard_limit</span> <span class="o">=</span> <span class="s2">&#34;1024&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">  }&#10;</span></span><span class="line"><span class="cl">}&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>birds.nomad</span>
    </div>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/birds-v1-1_hu7f6d488877be14f859eccdaea4f48797_553771_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Frontend con datos de la versi√≥n v1 del backend"><img src="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/birds-v1-1_hu7f6d488877be14f859eccdaea4f48797_553771_650x450_fit_q90_h2_box_3.webp" width="553" height="450" alt="Frontend con datos de la versi√≥n v1 del backend" title="Frontend con datos de la versi√≥n v1 del backend" class="&#34; " loading="lazy"></a></p>
<figcaption>Frontend con datos de la versi√≥n v1 del backend</figcaption>
</figure>
</div>
<h4 id="demostraciones-de-las-funcionalidades-del-_service-mesh_">Demostraciones de las funcionalidades del <em>service mesh</em></h4>
<p>A la aplicaci√≥n se accede a trav√©s del servicio de <em>ingress-gateway</em> en el puerto 8080 de la m√°quina virtual. El servicio de <em>ingress-gateway</em> simplemente redirige el tr√°fico a la aplicaci√≥n de <em>frontend</em>. Esta es la topolog√≠a de comunicaci√≥n para el servicio de <em>frontend</em> proporcionada por Consul, recibe peticiones del <em>ingress-gateway</em> y a su vez realiza peticiones al servicio de <em>backend</em>.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/consul-topology-1_hu285775030b5ed09f425118c0971ef68e_151608_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Toppolog√≠a de un servicio y m√©tricas en Consul"><img src="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/consul-topology-1_hu285775030b5ed09f425118c0971ef68e_151608_650x450_fit_q90_h2_box_3.webp" width="554" height="450" alt="Toppolog√≠a de un servicio y m√©tricas en Consul" title="Toppolog√≠a de un servicio y m√©tricas en Consul" class="&#34; " loading="lazy"></a></p>
<figcaption>Toppolog√≠a de un servicio y m√©tricas en Consul</figcaption>
</figure>
</div>
<p>Al arrancar Consul en modo desarrollo el comportamiento por defecto es permitir la comunicaci√≥n entre los servicios, en una configuraci√≥n en grado de producci√≥n por el contrario por defecto no se permite.</p>
<p>Creando una intenci√≥n es posible denegar el tr√°fico entre el servicio de <em>frontend</em> al de <em>backend</em>. Las intenciones sirven para permitir o denegar el tr√°fico en un plano de servicio y no de direcciones IP y cortafuegos lo que lo hace mucho m√°s sencillo de administrar, adem√°s de que cualquier cambio es posible hacerlo desde la interfaz web y se aplica de forma instant√°nea.</p>
<p>El tr√°fico entre los servicios a trav√©s de los <em>sidecar proxy</em> realizan la comunicaci√≥n cifrada y utilizando autenticaci√≥n mutua.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/consul-intentions_hu9f977235bd6c24c164cf620de1a0ce87_76378_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Intenciones en Consul"><img src="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/consul-intentions_hu9f977235bd6c24c164cf620de1a0ce87_76378_650x450_fit_q90_h2_box_3.webp" width="553" height="450" alt="Intenciones en Consul" title="Intenciones en Consul" class="&#34; " loading="lazy"></a></p>
<figcaption>Intenciones en Consul</figcaption>
</figure>
</div>
<p>Consul exporta m√©tricas en formato Prometheus que el servidor de Prometheus recolecta de forma peri√≥dica, esta informaci√≥n puede ser visualizada con una herramienta como Grafana. Tambi√©n el propio Consul permite obtener una m√©tricas b√°sicas del servicio como el n√∫mero de peticiones que se est√°n realizando, tasa de errores y latencia agrupadas por percentiles. Esta informaci√≥n es muy valiosa ya que permite monitorizar el estado del servicio.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/consul-topology-2_hu285775030b5ed09f425118c0971ef68e_151608_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="M√©tricas de Prometheus en Consul"><img src="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/consul-topology-2_hu285775030b5ed09f425118c0971ef68e_151608_650x450_fit_q90_h2_box_3.webp" width="554" height="450" alt="M√©tricas de Prometheus en Consul" title="M√©tricas de Prometheus en Consul" class="&#34; " loading="lazy"></a></p>
<figcaption>M√©tricas de Prometheus en Consul</figcaption>
</figure>
</div>
<p>Consul y los <em>sidecar proxy</em> de Envoy ofrecen soporte para trazabilidad con Zipkin junto con cierto soporte de los propios servicios la trazabilidad es enviada a un servidor como Jaeger que permite visualizar y relacionar las llamadas entre los diferentes servicios. Desde que entra por el <em>ingress-gateway</em> hasta que llega al <em>backend</em> pasando por el servicio de <em>frontend</em> asi como el tiempo empleado en cada uno de ellos.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/jaeger_hu33e6a5ea76c78b45612ee7e8a8666ca6_100673_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Trazabilidad en Jarger"><img src="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/jaeger_hu33e6a5ea76c78b45612ee7e8a8666ca6_100673_650x450_fit_q90_h2_box_3.webp" width="553" height="450" alt="Trazabilidad en Jarger" title="Trazabilidad en Jarger" class="&#34; " loading="lazy"></a></p>
<figcaption>Trazabilidad en Jarger</figcaption>
</figure>
</div>
<p>Consul conoce y monitoriza el estado de todos los servicios, a los servicios que presenten un mal funcionamiento no se les env√≠a tr√°fico para evitar errores y tener resiliencia a√∫n con fallos parciales. Consul realiza peticiones de estado de salud de forma activa de forma peri√≥dica generalmente cada pocos segundos, para comprobar el estado de cada servicio. En la consola de administraci√≥n muestra el estado de cada uno de ellos que tambi√©n es una valiosa informaci√≥n de observabilidad.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/consul_hu38ca79e125ea90732c98801666d94a1c_114012_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Salud de los servicios en Consul"><img src="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/consul_hu38ca79e125ea90732c98801666d94a1c_114012_650x450_fit_q90_h2_box_3.webp" width="554" height="450" alt="Salud de los servicios en Consul" title="Salud de los servicios en Consul" class="&#34; " loading="lazy"></a></p>
<figcaption>Salud de los servicios en Consul</figcaption>
</figure>
</div>
<p>Como son los <em>sidecar proxy</em> los que hacen las peticiones de red entre servicios estos tienen capacidad de realizar reintentos y <em>timeouts</em>. Con los reintentos se mitigan los errores temporales y con los <em>timeouts</em> se evita que un servicio que est√© tardando en responder afecte a otros servicios.</p>
<p>El control de tr√°fico es utilizado para diferentes funciones una de ellas para el despliegue de una nueva versi√≥n de forma controlada utilizando diferentes estrategias de despliegue. El servicio de <em>backend</em> tiene dos versiones la <em>v1</em> que da informaci√≥n de aves y la <em>v2</em> que da informaci√≥n de aves pero solo de la familia de canarios.</p>
<p>Con el control de tr√°fico es posible distribuir el n√∫mero de peticiones que va a cada servicio en funci√≥n de un peso o porcentaje. En una repartici√≥n al 50 la mitad de las peticiones van a la <em>v1</em> y la otra mitad a la <em>v2</em>, en el <em>frontend</em> se muestra la informaci√≥n del ave y la versi√≥n del servicio que la ha proporcionado. Cada vez que se cambia un archivo de configuraci√≥n y se quiere aplicar hay que escribir la configuraci√≥n en Consul.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ consul config write consul.d/config-entries/backend-service-resolver.hcl&#10;</span></span><span class="line"><span class="cl">$ consul config write consul.d/config-entries/backend-service-splitter.hcl&#10;</span></span><span class="line"><span class="cl">$ consul config write consul.d/config-entries/backend-service-router.hcl</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>consul-traffic-control.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-hcl" data-lang="hcl"><span class="line"><span class="cl"><span class="n">Kind</span> <span class="o">=</span> <span class="s2">&#34;service-resolver&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">Name</span> <span class="o">=</span> <span class="s2">&#34;backend&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">Subsets</span> <span class="o">=</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">  v1</span> <span class="o">=</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;Filter</span> <span class="o">=</span><span class="n"> &#34;Service.Meta.version</span> <span class="o">==</span> <span class="k">v1</span><span class="err">&#34;</span>&#10;</span></span><span class="line"><span class="cl">  }&#10;</span></span><span class="line"><span class="cl"><span class="n">  v2</span> <span class="o">=</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;Filter</span> <span class="o">=</span><span class="n"> &#34;Service.Meta.version</span> <span class="o">==</span> <span class="k">v2</span><span class="err">&#34;</span>&#10;</span></span><span class="line"><span class="cl">  }&#10;</span></span><span class="line"><span class="cl">}&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>consul.d/config-entries/backend-service-resolver.hcl</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-hcl" data-lang="hcl"><span class="line"><span class="cl"><span class="n">Kind</span> <span class="o">=</span> <span class="s2">&#34;service-router&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">Name</span> <span class="o">=</span> <span class="s2">&#34;backend&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="n">Routes</span> <span class="o">=</span> <span class="p">[</span>{&#10;</span></span><span class="line"><span class="cl"><span class="n">  Match</span> <span class="o">=</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;HTTP</span> <span class="o">=</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;  QueryParam</span> <span class="o">=</span> <span class="p">[</span>{&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name</span> <span class="o">=</span> <span class="s2">&#34;canary&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exact</span> <span class="o">=</span> <span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  }<span class="p">]</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span><span class="line"><span class="cl">  }&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="n">  Destination</span> <span class="o">=</span> {&#10;</span></span><span class="line"><span class="cl"><span class="n">&nbsp;&nbsp;&nbsp;&nbsp;ServiceSubset</span> <span class="o">=</span> <span class="s2">&#34;v2&#34;</span>&#10;</span></span><span class="line"><span class="cl">  }&#10;</span></span><span class="line"><span class="cl">}<span class="p">]</span>&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>consul.d/config-entries/backend-service-router.hcl</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-hcl" data-lang="hcl"><span class="line"><span class="cl"><span class="n">Kind</span> <span class="o">=</span> <span class="s2">&#34;service-splitter&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">Name</span> <span class="o">=</span> <span class="s2">&#34;backend&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="n">Splits</span> <span class="o">=</span> <span class="p">[</span>{&#10;</span></span><span class="line"><span class="cl"><span class="n">  Weight</span> <span class="o">=</span> <span class="m">75</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">  ServiceSubset</span> <span class="o">=</span> <span class="s2">&#34;v1&#34;</span>&#10;</span></span><span class="line"><span class="cl">}<span class="p">,</span>&#10;</span></span><span class="line"><span class="cl">{&#10;</span></span><span class="line"><span class="cl"><span class="n">  Weight</span> <span class="o">=</span> <span class="m">25</span>&#10;</span></span><span class="line"><span class="cl"><span class="n">  ServiceSubset</span> <span class="o">=</span> <span class="s2">&#34;v2&#34;</span>&#10;</span></span><span class="line"><span class="cl">}<span class="p">]</span>&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>consul.d/config-entries/backend-service-splitter.hcl</span>
    </div>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/birds-v1-2_hu7f6d488877be14f859eccdaea4f48797_553771_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Frontend con datos de la versi√≥n v1 del backend"><img src="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/birds-v1-2_hu7f6d488877be14f859eccdaea4f48797_553771_300x200_fit_q90_h2_box_3.webp" width="246" height="200" alt="Frontend con datos de la versi√≥n v1 del backend" title="Frontend con datos de la versi√≥n v1 del backend" class="&#34; " loading="lazy"></a>
<a href="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/birds-v2_huc7de3cba34bed59e33cf30928c44081b_548732_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Frontend con datos de la versi√≥n v2 del backend"><img src="https://picodotdev.github.io/blog-bitix/2022/10/las-funcionalidades-de-un-service-mesh-en-una-arquitectura-de-microservicios/images/birds-v2_huc7de3cba34bed59e33cf30928c44081b_548732_300x200_fit_q90_h2_box_3.webp" width="246" height="200" alt="Frontend con datos de la versi√≥n v2 del backend" title="Frontend con datos de la versi√≥n v2 del backend" class="&#34; " loading="lazy"></a></p>
<figcaption>Frontend con datos de la versi√≥n v1 y v2 del backend</figcaption>
</figure>
</div>
<h3 id="libros-sobre-consul">Libros sobre Consul</h3>
<p>Este art√≠culo es pr√°cticamente un resumen del libro <a href="https://amzn.to/3F0SmjY">Consul: Up &amp; Running</a> que muestra y explica todo esto de forma m√°s detallada y extensa adem√°s de mostrarlo usando Kubernetes. Est√° bien explicado y su ejemplo es muy f√°cil de seguir y probar adem√°s de muy did√°ctico para experimentar con los conceptos y funcionalidades comentadas de Consul. Otros libros sobre Consul y <em>service mesh</em> son <a href="https://amzn.to/3seULzU">Simplifying Service Management with Consul</a> y <a href="https://amzn.to/3DiIiS6">Mastering Service Mesh</a>.</p>
<div class="media media-amazon">
  <iframe style="width:120px;height:240px;" width="120" height="240" scrolling="no" frameborder="0" src="https://rcm-eu.amazon-adsystem.com/e/cm?lt1=_blank&amp;bc1=000000&amp;IS2=1&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;t=blobit-21&amp;language=es_ES&amp;o=30&amp;p=8&amp;l=as4&amp;m=amazon&amp;f=ifr&amp;ref=as_ss_li_til&amp;asins=1098106148&amp;linkId=e909576440e5503d3c2fd4009a91dc61" title="Amazon" class="lozad"></iframe>
  <iframe style="width:120px;height:240px;" width="120" height="240" scrolling="no" frameborder="0" src="https://rcm-eu.amazon-adsystem.com/e/cm?lt1=_blank&amp;bc1=000000&amp;IS2=1&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;t=blobit-21&amp;language=es_ES&amp;o=30&amp;p=8&amp;l=as4&amp;m=amazon&amp;f=ifr&amp;ref=as_ss_li_til&amp;asins=1800202628&amp;linkId=0d74c8c655bfda8294f77b83a43ea5eb" title="Amazon" class="lozad"></iframe>
  <iframe style="width:120px;height:240px;" width="120" height="240" scrolling="no" frameborder="0" src="https://rcm-eu.amazon-adsystem.com/e/cm?lt1=_blank&amp;bc1=000000&amp;IS2=1&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;t=blobit-21&amp;language=es_ES&amp;o=30&amp;p=8&amp;l=as4&amp;m=amazon&amp;f=ifr&amp;ref=as_ss_li_til&amp;asins=1789615798&amp;linkId=bfdecdefc368de25311d26426c4f7bdd" title="Amazon" class="lozad"></iframe>
</div>
<div class="alert alert-secondary sourcecode">
    <img src="https://picodotdev.github.io/blog-bitix/assets/images/icons/terminal.svg" width="64" height="64" alt="Terminal" title="Terminal" class="lozad sourcecode-icon">
    <p>
            El <a href="https://github.com/picodotdev/blog-ejemplos/tree/master/ConsulServiceMesh">c√≥digo fuente completo del ejemplo</a> puedes descargarlo del repositorio de ejemplos de Blog Bitix alojado en GitHub.</p>
</div>
]]>
        </content>
        
            
                <category term="programacion"/>
            
                <category term="planeta-codigo"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2022/09/introduccion-al-protocolo-oauth-2-para-delegar-la-autorizacion/</id>
        <title>Introducci√≥n al protocolo OAuth 2 para delegar la autorizaci√≥n</title>
        <updated>2022-09-08T11:00:00+02:00</updated>
        <published>2022-09-08T11:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2022/09/introduccion-al-protocolo-oauth-2-para-delegar-la-autorizacion/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>El protocolo OAuth es un protocolo en el √°mbito de la seguridad que permite que el due√±o de los recursos conceda permisos a un cliente sin necesidad de compartir las credenciales, el servidor de recursos unicamente necesita un <em>token</em> que certifique el cliente tiene permisos para acceder a los recursos, el <em>token</em> es emitido por el servidor de autorizaci√≥n en el que el usuario se autentica y en el que servidor de recursos conf√≠a en los <em>tokens</em> de autorizaci√≥n que emite. Gracias a la flexibilidad del protocolo OAuth y estar basado en la ubicuidad del protocolo HTTP este es el mecanismo de autorizaci√≥n adoptado predominantemente en la web por los diferentes servicios que ofrecen sus APIs mediante REST sin limitarse a este tipo de APIs. OAuth se compone de varias especificaciones que permiten delegar la autorizaci√≥n, OpenID Connect construido sobre OAuth proporciona otro aspecto de la seguridad, la autenticaci√≥n.</strong></p>]]>
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/oauth.svg" width="200" height="200" alt="OAuth" title="OAuth" class="" loading="false&#34;"></p>
</div>
<p>La web se compone de una multitud de p√°ginas desarrolladas y bajo el control de m√∫ltiples organizaciones no relacionadas. Los usuarios almacenan sus datos y recursos en un servicio, en una web interconectada compuesta de m√∫ltiples servicios surge la necesidad de que un servicio pueda acceder de forma segura a los recursos de un usuario en otro servicio.</p>
<p>Este es el caso de una aplicaci√≥n de un tercero que por ejemplo desea acceder a los documentos,  fotos o datos de un usuario alojada en otro servicio pero sin tener que compartir las credenciales del servicio donde est√°n alojadas las fotos.</p>
<div class="alert alert-warning pt-0 pb-0 tableofcontents"><h2>Contenido del art√≠culo</h2><toc></toc></div>
<h3 id="el-protocolo-oauth">El protocolo OAuth</h3>
<p>El protocolo OAuth permite al usuario delegar la autorizaci√≥n a un cliente para el acceso a sus recursos proporcionado por un servidor de recursos, permite delegar la autorizaci√≥n de forma segura y sin que el usuario comparta sus credenciales de acceso en el servicio donde est√°n los recursos al mismo tiempo que mantiene la posibilidad de revocar el acceso u otorgarlo de forma temporal.</p>
<p>Esta definici√≥n se compone de cuatro elementos:</p>
<ul>
<li>El usuario: que es propietario de los recursos almacenados en el servidor de recursos.</li>
<li>El servidor de recursos: que contiene los recursos del usuario.</li>
<li>El cliente: la aplicaci√≥n a la que el usuario quiere otorgar acceso a los recursos del servidor.</li>
<li>El servidor de autorizaci√≥n: es el que proporciona el <em>token</em> (entre otras cosas) a modo de credencial al cliente y que el servidor de recurso utiliza para verificar el acceso al recurso o no. El servidor de recurso conf√≠a en el servidor de autorizaci√≥n.</li>
</ul>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2022/09/introduccion-al-protocolo-oauth-2-para-delegar-la-autorizacion/images/oauth-components_hu3c2c677b1ec95532986d9daafc565f04_69661_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Componentes de OAuth 2.0"><img src="https://picodotdev.github.io/blog-bitix/2022/09/introduccion-al-protocolo-oauth-2-para-delegar-la-autorizacion/images/oauth-components_hu3c2c677b1ec95532986d9daafc565f04_69661_650x450_fit_q90_h2_box_3.webp" width="545" height="450" alt="Componentes de OAuth 2.0" title="Componentes de OAuth 2.0" class="&#34; " loading="lazy"></a></p>
<figcaption>Componentes de OAuth 2.0 <br>Fuente: Libro OAuth 2 in Action</figcaption>
</figure>
</div>
<p>El protocolo OAuth define varios flujos de autorizaci√≥n que un cliente puede emplear para obtener un <em>token</em> pero deja otros aspectos sin definir como cu√°l es el formato o contenido del <em>token</em>, tampoco define como el servidor de autorizaci√≥n debe realizar la autenticaci√≥n del usuario. Esta no definici√≥n de algunos aspectos del protocolo le permite ser flexible y adaptarse a diferentes contextos.</p>
<p>El protocolo OAuth en esencia consiste b√°sicamente en una forma que emplea el cliente para obtener un <em>token</em> y que este env√≠a en sus peticiones para el acceso al recurso en el servidor de recursos.</p>
<p>Es el mecanismo de autorizaci√≥n m√°s empleado para proteger servicios que utilizan una API con interfaz REST. En las peticiones REST que el cliente realiza al servidor de recurso env√≠a el <em>access token</em> en una cabecera que el servidor de recurso v√°lida ya sea por s√≠ mismo o validando el <em>access token</em> haciendo una petici√≥n al servidor de autorizaci√≥n.</p>
<p>El servidor de autorizaci√≥n junto al <em>access token</em> emite el <em>refresh token</em>, los <em>tokens</em> tienen un tiempo de expiraci√≥n relativamente corto u que por motivos de seguridad en caso de que sean filtrados han de ser renovados para reducir el tiempo en el que un atacante pueda hacer uso de ellos. Cuando to <em>access token</em> expira el cliente puede obtener un nuevo <em>access token</em> solicit√°ndoselo al servidor de autorizaci√≥n y haciendo uso del <em>refresh token</em>. Dado que los <em>refresh token</em> solo se usan en las peticiones para obtener un nuevo <em>access token</em> hay menos posibilidades de que sean filtrados al contrario que los <em>access token</em> que son enviados en cada petici√≥n.</p>
<ul>
<li><a href="https://oauth.net/2/">OAuth 2.0</a></li>
<li><a href="https://oauth.net/specs/">Especificaciones de OAuth 2.0</a></li>
</ul>
<h3 id="flujos-de-autorizaci√≥n">Flujos de autorizaci√≥n</h3>
<p>El protocolo OAuth define varios flujos o <em>grant types</em> que un cliente puede seguir para la obtenci√≥n del <em>access token</em> que le permite acceder los recursos. Para el servidor de recursos la forma que el cliente emplee para obtener el <em>token</em> y para el cliente el contenido o formato del <em>token</em> si tiene alguno no tiene relevancia.</p>
<p>El flujo por defecto, m√°s completo, seguro y recomendado es el flujo de <em>authorization code</em>. Los otros flujos son variaciones adaptadas a algunas limitaciones de otros contextos o casos de uso.</p>
<ul>
<li><a href="https://oauth.net/2/grant-types/">OAuth Grant Types</a></li>
</ul>
<h4 id="_authorization-code-grant_"><em>Authorization code grant</em></h4>
<p>El flujo de <em>authorization code</em> es el m√°s completo y por ello m√°s recomendado de usar siempre que se pueda. De forma simplificada en cuanto a la informaci√≥n que se utiliza en las peticiones los pasos de este flujo son los siguientes:</p>
<ol>
<li>El cliente solicita al usuario autorizaci√≥n para el acceso a un recurso, para ello construye una URL entre cuya informaci√≥n est√° el identificativo del cliente que redirige al usuario al servidor de autorizaci√≥n para la obtenci√≥n de un <em>token</em>.</li>
<li>El servidor de autorizaci√≥n autentica al usuario si es necesario, informa y permite al usuario de cambiar los permisos que desea otorgar al cliente. Una vez el usuario otorga el acceso el servidor genera un <em>authorization code</em> que el cliente utiliza para intercambiar por el <em>token</em>. El servidor de autorizaci√≥n env√≠a al agente del usuario una redirecci√≥n a un <em>endpoint</em> del cliente con el <em>authorization code</em>.</li>
<li>El cliente recibe el <em>callback</em> del servidor de autorizaci√≥n con el <em>authorization code</em> que junto con las credenciales del cliente utiliza para intercambiarlos por el <em>token</em> con una nueva petici√≥n al servidor de autorizaci√≥n.</li>
<li>El servidor de autorizaci√≥n recibe la petici√≥n del cliente con sus credenciales y el <em>authorization code</em>, si son correctos el servidor de autorizaci√≥n genera un <em>token</em> o <em>access token</em> que el cliente utiliza para obtener acceso al recurso del usuario.</li>
<li>Una vez el cliente tiene el <em>token</em> o <em>access token</em> realiza una petici√≥n al servidor de recurso para obtener acceso al recurso.</li>
<li>El servidor de recurso valida el <em>access token</em> y en funci√≥n de la autorizaci√≥n otorgada en el <em>token</em> concede o no acceso al recurso.</li>
</ol>
<p>En estos pasos desde el 1 al 4 hay una comunicaci√≥n a trav√©s del agente o navegador del usuario entre el cliente y el servidor de autorizaci√≥n, en el contexto de OAuth a este canal de comunicaci√≥n se le denomina <em>front channel</em> y como es a trav√©s del navegador del usuario es p√∫blico. En estos pasos el <em>authorization code</em> se env√≠a a trav√©s del agente del usuario.</p>
<p>Los pasos 4 y 5 componen lo que en el contexto de OAuth se les denomina <em>back channel</em> y se realiza de forma privada y directa entre el cliente y el servidor de autorizaci√≥n. En estos pasos las credenciales del cliente se mantienen privadas.</p>
<p>Otro aspecto importante es que el usuario en caso de tener que autenticarse √∫nicamente proporciona las credenciales al servidor de autenticaci√≥n, el cliente no tiene acceso a las credenciales del usuario que √∫nicamente recibe un <em>authorization code</em> y <em>access token</em>, el agente del usuario no tiene acceso al <em>access token</em>.</p>
<ul>
<li><a href="https://www.rfc-editor.org/rfc/rfc6749#section-4.1">The OAuth 2.0 Authorization Framework, Authorization Code Grant</a></li>
</ul>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">+----------+&#10;</span></span><span class="line"><span class="cl">| Resource |&#10;</span></span><span class="line"><span class="cl">|   Owner  |&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&#10;</span></span><span class="line"><span class="cl">+----------+&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp; ^&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp; |&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;(B)&#10;</span></span><span class="line"><span class="cl">+----|-----+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Client Identifier&nbsp;&nbsp;&nbsp;&nbsp;  +---------------+&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -+----(A)-- &amp; Redirection URI ----&gt;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   |&#10;</span></span><span class="line"><span class="cl">|  User-   |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | Authorization |&#10;</span></span><span class="line"><span class="cl">|  Agent  -+----(B)-- User authenticates ---&gt;|&nbsp;&nbsp;&nbsp;&nbsp; Server&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   |&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -+----(C)-- Authorization Code ---&lt;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   |&#10;</span></span><span class="line"><span class="cl">+-|----|---+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +---------------+&#10;</span></span><span class="line"><span class="cl">  |&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ^&nbsp;&nbsp;&nbsp;&nbsp;  v&#10;</span></span><span class="line"><span class="cl"> (A)  (C)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;  |&#10;</span></span><span class="line"><span class="cl">  |&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;  |&#10;</span></span><span class="line"><span class="cl">  ^&nbsp;&nbsp;&nbsp;&nbsp;v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;  |&#10;</span></span><span class="line"><span class="cl">+---------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;  |&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&gt;---(D)-- Authorization Code ---------&#39;&nbsp;&nbsp;&nbsp;&nbsp;  |&#10;</span></span><span class="line"><span class="cl">|  Client |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &amp; Redirection URI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&lt;---(E)----- Access Token -------------------&#39;&#10;</span></span><span class="line"><span class="cl">+---------+&nbsp;&nbsp;&nbsp;&nbsp;   (w/ Optional Refresh Token)</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>authorization-code-grant.txt</span>
    </div>
</div>
<h4 id="_client-credentials-grant_"><em>Client credentials grant</em></h4>
<p>El flujo <em>client credentials</em> se usa cuando el cliente accede a los recursos en su propia representaci√≥n sin la intervenci√≥n de un usuario.</p>
<p>Para obtener el <em>token</em> el cliente proporciona sus credenciales al servidor de autorizaci√≥n que obtiene como respuesta directamente el <em>access token</em>.</p>
<ul>
<li><a href="https://www.rfc-editor.org/rfc/rfc6749#section-4.4">The OAuth 2.0 Authorization Framework, Client Credentials Grant</a></li>
</ul>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span><span class="lnt">4&#10;</span><span class="lnt">5&#10;</span><span class="lnt">6&#10;</span><span class="lnt">7&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">+---------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  +---------------+&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   |&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&gt;--(A)- Client Authentication ---&gt;| Authorization |&#10;</span></span><span class="line"><span class="cl">| Client  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp; Server&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&lt;--(B)---- Access Token ---------&lt;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   |&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   |&#10;</span></span><span class="line"><span class="cl">+---------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  +---------------+</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>client-credentials-grant.txt</span>
    </div>
</div>
<h4 id="_device-grant_"><em>Device grant</em></h4>
<p>Este flujo se utiliza en caso de que el dispositivo no tenga posibilidad de utilizar un agente de usuario. En vez de ello el dispositivo simplemente presenta un c√≥digo que el usuario utilizando otro dispositivo se autentica con sus credenciales y junto al c√≥digo realiza la autorizaci√≥n. El dispositivo comprueba peri√≥dicamente si el usuario ha realizado la autorizaci√≥n al servidor de autorizaci√≥n que en caso de ser correcta le devuelve el <em>access token</em>.</p>
<ul>
<li><a href="https://www.rfc-editor.org/rfc/rfc8628">OAuth 2.0 Device Authorization Grant</a></li>
</ul>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">+----------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+----------------+&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&gt;---(A)-- Client Identifier ---&gt;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&lt;---(B)-- Device Code,&nbsp;&nbsp;&nbsp;&nbsp;  ---&lt;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  User Code,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">|  Device  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &amp; Verification URI&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">|  Client  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |  [polling]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&gt;---(E)-- Device Code&nbsp;&nbsp;&nbsp;&nbsp;   ---&gt;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &amp; Client Identifier   |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|  Authorization |&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&lt;---(F)-- Access Token&nbsp;&nbsp;&nbsp;&nbsp;  ---&lt;|&nbsp;&nbsp;&nbsp;&nbsp; Server&nbsp;&nbsp;&nbsp;&nbsp; |&#10;</span></span><span class="line"><span class="cl">+----------+   (&amp; Optional Refresh Token)   |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp; (C) User Code &amp; Verification URI&nbsp;&nbsp;&nbsp;&nbsp;   |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">+----------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">| End User |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;at&nbsp;&nbsp;&nbsp;&nbsp;|&lt;---(D)-- End user reviews  ---&gt;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">|  Browser |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  authorization request |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">+----------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+----------------+</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>device-grant.txt</span>
    </div>
</div>
<h4 id="_implicit-grant_"><em>Implicit grant</em></h4>
<p>El uso del flujo <em>implicit</em> est√° desaconsejado y se recomienda utilizar el flujo <em>authorization code</em> en caso de ser posible. En este flujo se utiliza cuando el cliente se ubica en el propio agente del usuario. En la redirecci√≥n del <em>front channel</em> el servidor responde con una redirecci√≥n que incluyen el fragmento de la URL el <em>access token</em>.</p>
<p>Dado que el agente del usuario tiene acceso al <em>access token</em> se considera menos seguro.</p>
<ul>
<li><a href="https://www.rfc-editor.org/rfc/rfc6749#section-4.2">The OAuth 2.0 Authorization Framework, Implicit Grant</a></li>
</ul>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span><span class="lnt">26&#10;</span><span class="lnt">27&#10;</span><span class="lnt">28&#10;</span><span class="lnt">29&#10;</span><span class="lnt">30&#10;</span><span class="lnt">31&#10;</span><span class="lnt">32&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">+----------+&#10;</span></span><span class="line"><span class="cl">| Resource |&#10;</span></span><span class="line"><span class="cl">|  Owner   |&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&#10;</span></span><span class="line"><span class="cl">+----------+&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp; ^&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp; |&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;(B)&#10;</span></span><span class="line"><span class="cl">+----|-----+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Client Identifier&nbsp;&nbsp;&nbsp;&nbsp; +---------------+&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -+----(A)-- &amp; Redirection URI ---&gt;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   |&#10;</span></span><span class="line"><span class="cl">|  User-   |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| Authorization |&#10;</span></span><span class="line"><span class="cl">|  Agent  -|----(B)-- User authenticates --&gt;|&nbsp;&nbsp;&nbsp;&nbsp; Server&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   |&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&lt;---(C)--- Redirection URI ----&lt;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   |&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  with Access Token&nbsp;&nbsp;&nbsp;&nbsp; +---------------+&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in Fragment&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+---------------+&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |----(D)--- Redirection URI ----&gt;|   Web-Hosted  |&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  without Fragment&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp; Client&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;Resource   |&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp; (F)  |&lt;---(E)------- Script ---------&lt;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   |&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+---------------+&#10;</span></span><span class="line"><span class="cl">+-|--------+&#10;</span></span><span class="line"><span class="cl">  |&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl"> (A)  (G) Access Token&#10;</span></span><span class="line"><span class="cl">  |&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">  ^&nbsp;&nbsp;&nbsp;&nbsp;v&#10;</span></span><span class="line"><span class="cl">+---------+&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&#10;</span></span><span class="line"><span class="cl">|  Client |&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&#10;</span></span><span class="line"><span class="cl">+---------+</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>implicit-grant.txt</span>
    </div>
</div>
<h4 id="_resource-owner-password-credentials-grant_"><em>Resource owner password credentials grant</em></h4>
<p>Antes de OAuth para que un servicio pudiera acceder a los recursos de otro servicio una posibilidad era que el usuario compartiera las credenciales del servicio del recurso con el cliente. Compartir las credenciales del usuario entre servicios es una de las cosas que trata de evitar OAuth ya que cualquier cliente inseguro compromete las credenciales del usuario.</p>
<p>En el flujo <em>resource owner password</em> el cliente solicita las credenciales al usuario, una vez las obtiene las utiliza para obtener un <em>access token</em> en el servidor de autorizaci√≥n. Para su funcionamiento el cliente tiene acceso a las credenciales del usuario por eso tambi√©n est√° desaconsejado su uso pero al menos una vez el cliente obtiene el <em>access token</em> no tiene que enviar las credenciales del usuario en cada petici√≥n al servidor de recursos lo que reduce las posibilidades de que las credenciales sean filtradas.</p>
<ul>
<li><a href="https://www.rfc-editor.org/rfc/rfc6749#section-4.3">The OAuth 2.0 Authorization Framework, Resource Owner Password Credentials Grant</a></li>
</ul>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">+----------+&#10;</span></span><span class="line"><span class="cl">| Resource |&#10;</span></span><span class="line"><span class="cl">|  Owner   |&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&#10;</span></span><span class="line"><span class="cl">+----------+&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp; v&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;Resource Owner&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;(A) Password Credentials&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp; |&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp; v&#10;</span></span><span class="line"><span class="cl">+---------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  +---------------+&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&gt;--(B)---- Resource Owner -------&gt;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   |&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Password Credentials&nbsp;&nbsp;&nbsp;&nbsp; | Authorization |&#10;</span></span><span class="line"><span class="cl">| Client  |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp; Server&nbsp;&nbsp;&nbsp;&nbsp;|&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&lt;--(C)---- Access Token ---------&lt;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   |&#10;</span></span><span class="line"><span class="cl">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;(w/ Optional Refresh Token)   |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   |&#10;</span></span><span class="line"><span class="cl">+---------+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  +---------------+&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>resource-owner-password-credentials-grant.txt</span>
    </div>
</div>
<h3 id="casos-de-uso">Casos de uso</h3>
<p>De forma preferente los clientes han de utilizar el flujo <em>authorization code</em> por ser el m√°s seguro de los flujos que define OAuth 2. La flexibilidad de OAuth le permite ser usado en m√∫ltiples dispositivos y protocolos.</p>
<h4 id="web">Web</h4>
<p>En los servicios y aplicaciones web las arquitecturas de las aplicaciones se componen de una parte cliente que se ejecuta en el navegador del usuario y una parte servidor. En esta arquitectura la parte que hace de servidor para el cliente del navegador web a su vez hace de cliente para el servidor del recurso.</p>
<p>En este caso dado el flujo de autorizaci√≥n OAuth que se utiliza es el de <em>authorization code</em>.</p>
<h4 id="servicio-_backend_">Servicio <em>backend</em></h4>
<p>Algunos clientes no dependen de ning√∫n usuario, esto es el caso de servicios que √∫nicamente tienen una parte de <em>backend</em> En este caso dado el flujo de autorizaci√≥n OAuth que se utiliza es el de <em>client credentials</em>.</p>
<h4 id="aplicaci√≥n-nativa">Aplicaci√≥n nativa</h4>
<p>Los clientes actuales incluyen dispositivos con capacidades de c√≥mputo como los tel√©fonos inteligentes y tabletas que se ejecutan como aplicaciones nativas de estos dispositivos sin utilizar un navegador.</p>
<p>Este tipo de dispositivos pueden utilizar tambi√©n el flujo de autenticaci√≥n <em>authorization code</em>, sin embargo, como se ejecutan en un dispositivo del usuario no pueden mantener la confidencialidad de las credenciales de modo que han de utilizar mecanismos adicionales para obtener unas credenciales √∫nicas del cliente.</p>
<p>El protocolo OAuth en algunas especificaciones relacionadas del protocolo permite el registro de forma din√°mica de los clientes que en esencia proporciona unas credenciales √∫nicas para cada instalaci√≥n de la aplicaci√≥n de forma que si las credenciales de un cliente son filtradas el problema no afecte al resto de clientes, solo exclusivamente a las credenciales del cliente afectado que puedan ser revocadas sin afectar al resto de clientes.</p>
<h4 id="dispositivo">Dispositivo</h4>
<p>Los televisores inteligentes tambi√©n tienen capacidades para acceder a servicios de terceros pero son unos dispositivos especiales por su limitaci√≥n de m√©todos de entrada y de entorno de ejecuci√≥n que limitan el poder utilizar el flujo de <em>authorization code</em>. Para cubrir las necesidades de estos dispositivos est√° el flujo <em>device</em>.</p>
<h3 id="especificaciones">Especificaciones</h3>
<p>El protocolo OAuth est√° definido en una colecci√≥n de especificaciones que son bastante cortas, componen la teor√≠a del protocolo y bastante clarificadoras en varios puntos.</p>
<p>Algunas de las especificaciones definen el protocolo y otras elementos relacionados con OAuth como el registro de clientes de forma din√°mica que se utiliza para el caso concreto o las especificaciones que permiten implementar un protocolo de autenticaci√≥n sobre el protocolo de autorizaci√≥n OAuth como lo es <a href="https://openid.net/connect/">OpenID Connect</a>, OpenID Connect a su vez define otro conjunto de especificaciones.</p>
<h4 id="openid-connect">OpenID Connect</h4>
<p>La autorizaci√≥n permite aceptar o rechazar una petici√≥n en base a algunos criterios de la petici√≥n, tambi√©n en funci√≥n del usuario o cliente que realiza la acci√≥n o los permisos concedidos.</p>
<p>La autenticaci√≥n es utilizada para identificar que un usuario es quien dice ser, para identificar a un usuario normalmente se utiliza algo que conoce como una contrase√±a y m√°s reciente con algo que posee como un segundo factor de autenticaci√≥n que proporciona un c√≥digo o un dispositivo hardware f√≠sico que identifica al usuario.</p>
<p>OAuth es un protocolo para delegar la autorizaci√≥n pero normalmente se utiliza en combinaci√≥n con un protocolo para realizar la autenticaci√≥n, en el √°mbito de OAuth el protocolo est√°ndar para la autenticaci√≥n es OpenID Connect.</p>
<p>OpenID Connect define m√°s claramente algunos puntos que OAuth no entra en su definici√≥n. Un punto que define es el formato, contenido y qu√© informaci√≥n contienen los <em>tokens</em>, para los clientes el <em>token</em> sigue siguiendo un valor opaco pero con esta definici√≥n los servidores de recursos pueden utilizar el contenido del <em>token</em> para tomar algunas decisiones de autorizaci√≥n sin necesidad de realizar una petici√≥n al proveedor de identidad.</p>
<p>Otro aspecto que modifica OpenID Connect es la introducci√≥n de algunos elementos para adecuarlos al √°mbito de la autenticaci√≥n, el cliente se denomina <em>reliying party</em> o RP, el servidor de autorizaci√≥n hacer tambi√©n las funciones de servidor de recursos y se denomina <em>identity provider</em> o IdP, OpenID connect adem√°s emite al mismo tiempo que el <em>access token</em> un nuevo _oken_que identifica al usuario, el <em>identity token</em> y la sesi√≥n de este.</p>
<ul>
<li><a href="https://openid.net/connect/">OpenID Connect</a></li>
<li><a href="https://openid.net/developers/specs/">OpenID Connect Specifications</a></li>
</ul>
<h4 id="_discovery_"><em>Discovery</em></h4>
<p>Hay m√∫ltiples proveedores que proporcionan identidad, el est√°ndar de OpenID Connect define un archivo que los proveedores hacen accesible en una URL y que los clientes pueden utilizar para utilizarlo independientemente de del proveedor mientras cumpla con el est√°ndar, este archivo forma parte.</p>
<p>Muchos de los grandes actores de internet como <a href="https://www.google.es/">Google</a>, <a href="https://www.microsoft.com/">Microsoft</a>, <a href="https://www.apple.com/">Apple</a>, <a href="https://www.facebook.com/">Facebook</a> o <a href="https://github.com/">GitHub</a> entre muchos otros permiten a los usuarios que tienen una cuenta en esos servicios iniciar sesi√≥n en otros servicios y p√°ginas web sin tener que crear una cuenta nueva en el servicio que se quiere iniciar sesi√≥n, esto para los usuarios tiene la ventaja de no necesitar recordar o generar m√∫ltiples contrase√±as ni crear una cuenta en cada servicio.</p>
<p>En el caso de Google por ejemplo hace p√∫blico su definici√≥n de OpenID Connect en la siguiente ubicaci√≥n y forma parte del descubrimiento de OpenID Connect.</p>
<ul>
<li><a href="https://accounts.google.com/.well-known/openid-configuration">Gogle OpenID Connect Configuration</a></li>
</ul>
<h4 id="jose-y-jwt">JOSE y JWT</h4>
<p>En OpenID Connect tanto el <em>identity token</em> como el <em>access token</em> son en realidad un JSON codificado en base64, el cliente no necesita conocer ni analizar su contenido pero el servidor de recursos puede analizarlo para tomar alguna decisi√≥n de autorizaci√≥n. El servidor de recurso tiene dos posibilidades, analizar el contenido de <em>token</em> lo que requiere conocer qu√© formato contiene o hacer una petici√≥n al <em>identity provider</em> para que este le devuelva su contenido, ambas tienen alguna ventaja pero si es suficiente para evitar una llamada adicional y latencia en las llamadas se evita hacer peticiones al <em>identity provider</em>.</p>
<p>El formato de los <em>tokens</em> seg√∫n lo define OpenID Connect normalmente es un texto en formato JSON codificado en base64 que aparentemente parece algo aleatorio. Se compone de tres partes separadas por un punto, una cabecera en la que se especifica el algoritmo de firma empleado y formato, un cuerpo que contiene varios campos o <em>claims</em> definidos en el est√°ndar y una firma digital que el servidor de recursos utiliza para validar que ha sido emitido por el servidor de autorizaci√≥n y garantizar que su contenido no ha sido modificado.</p>
<p>El formato de los <em>tokens</em> se engloban en una serie de colecci√≥n de siglas relacionadas para cada una de las partes los definen:</p>
<ul>
<li>JSON Object Signing and Encryption (JOSE)</li>
<li>JSON Web Token (JWT, RFC 7519): son dos documentos JSON en base64 separados por un punto.</li>
<li>JSON Web Signature (JWS, RFC 7515): a√±ade una forma digital a los <em>token</em>, siendo el tercer documento de un <em>token</em>.</li>
<li>JSON Web Encryption (JWE, RFC 7516): permite el cifrado del cuerpo de los tokens para que su contenido aunque firmado no sea analizable sin la correspondiente clave de descifrado.</li>
<li>JSON Web Algorithms (JWA, RFC 7518): define los algoritmos de cifrado que deben usar JWS y JWE.</li>
<li>JSON Web Key (JWK, RFC 7517): define el formato para representar una clave criptogr√°fica en formato JSON.</li>
</ul>
<p>Otra t√©rmino mencionado es <em>proof key for code exchange</em> o PKCE que evita algunos problemas de seguridad al enviar servidor de autorizaci√≥n un dato que solo conoce el cliente de modo que solo el cliente leg√≠timo pueda intercambiar el <em>autorization code</em> por el <em>access token</em>, √∫til principalmente para las aplicaciones nativas que no pueden garantizar el secreto de sus credenciales.</p>
<h3 id="implementar-oauth-y-openid-connect">Implementar OAuth y OpenID Connect</h3>
<p>Dado que los protocolos OAuth y OpenID Connect se basan en el protocolo HTTP cualquier herramienta que utilice este protocolo es capaz de utilizar OAuth incluso de forma transparente sin que el servicio protegido sea consciente de ello con un <em>proxy</em> y un servidor en el que delegar la autenticaci√≥n y autorizaci√≥n.</p>
<p>Tanto el servidor web <a href="https://httpd.apache.org/">Apache HTTPD</a> como <a href="https://nginx.org/">Nginx</a> ofrecen <em>plugins</em> para el uso de OAuth y OpenID Connect, cualquier lenguaje de programaci√≥n capaz de realizar peticiones HTTP y trabajar con JSON como son la mayor√≠a de lenguajes de prop√≥sito general poseen librer√≠as de modo que su uso sea f√°cil empezar a usarlos simplemente incluyendo una dependencia.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2020/11/autenticacion-con-openid-oauth-en-cualquier-web-con-nginx-y-de-forma-nativa-con-spring-boot/">Autenticaci√≥n con OpenID/OAuth en cualquier web con Nginx y de forma nativa con Spring Boot</a></li>
</ul>
<h3 id="servidor-openid-connect">Servidor OpenID Connect</h3>
<p><a href="https://www.keycloak.org/">Keycloak</a> es un servidor implementado en el lenguaje Java desarrollado por <a href="https://www.redhat.com/es">RedHat</a> y publicado con una licencia de c√≥digo abierto que proporciona la funcionalidad de servidor de autorizaci√≥n y OpenID Connect para cualquier aplicaci√≥n incluso aquellas no implementadas en Java. Keycloak se caracteriza por implementar las especificaciones con los diferentes flujos de autorizaci√≥n del protocolo OAuth y OpenID Connect.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2016/10/integrar-autenticacion-oauth-con-keycloak-shiro-apache-tapestry-y-spring-boot/">Integrar autenticaci√≥n OAuth con Keycloak, Shiro, Apache Tapestry y Spring Boot</a></li>
</ul>
<h3 id="cliente-de-oauth-con-spring">Cliente de OAuth con Spring</h3>
<p>En Java el framework <a href="https://spring.io/">Spring</a> que proporciona dependencias para pr√°cticamente cualquier funcionalidad com√∫n que un desarrollador necesite tambi√©n proporciona soporte para OAuth y OpenID Connect a√±adiendo unas pocas l√≠neas de configuraci√≥n e integr√°ndose con el framework de seguridad <a href="https://spring.io/projects/spring-security">Spring Security</a>.</p>
<p>Dado que los <em>access tokens</em> tienen un tiempo de expiraci√≥n relativamente corto estos han de ser renovados utilizando el <em>refresh token</em>, la librer√≠a <a href="https://square.github.io/okhttp/">OkHttp</a> proporciona soporte para realizar la renovaci√≥n de forma transparente a trav√©s de la clase <a href="https://square.github.io/okhttp/4.x/okhttp/okhttp3/-authenticator/">Authenticator</a> explicada en <a href="https://square.github.io/okhttp/3.x/okhttp/okhttp3/Authenticator.html">su Javadoc</a>.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2016/10/cliente-de-un-servicio-rest-autenticado-con-oauth-en-java/">Cliente de un servicio REST autenticado con OAuth en Java</a></li>
</ul>
<h3 id="servidor-de-recurso">Servidor de recurso</h3>
<p>Al igual que Spring proporciona soporte para la utilizaci√≥n de OpenID Connect el framework de seguridad Spring Security ofrece soporte para la integraci√≥n de autorizaci√≥n con OAuth de modo que un <em>endpoint</em> de una API REST o funcionalidad de un servicio pueda implementar la l√≥gica para permitir o denegar una petici√≥n.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2016/09/autenticacion-con-oauth-y-keycloak-en-un-servicio-rest-con-jax-rs-y-spring-boot/">Autenticaci√≥n con OAuth y Keycloak en un servicio REST con JAX-RS y Spring Boot</a></li>
</ul>
<h2 id="libros-sobre-oauth">Libros sobre OAuth</h2>
<p>Las especificaciones de OAuth y OpenID Connect son cortas y explican el protocolo en detalle con descripciones f√°ciles de entender, incluso a veces es mejor leer las especificaciones directamente que cualquier otro material.</p>
<p>A√∫n as√≠, los libros explican de otra forma m√°s guiada y paso a paso el funcionamiento del protocolo, dos libros que he le√≠do y me han parecido una buena introducci√≥n al protoclo ha sido por un lado <a href="https://amzn.to/3D444JO">OAuth 2 in Action</a> que explica la teor√≠a de OAuth con varios ejemplos de c√≥digo y aplicaciones con el que probar el protocolo, por otro lado el libro <a href="https://amzn.to/3RGHriy">Keycloak - Identity and Access Management for Modern Applications</a> que explica el uso y repasa la teor√≠a de OAuth de la implementaci√≥n del protocolo OpenID Connect y OAuth en el servidor Keycloak.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2019/02/servidor-oauth-gateway-y-servicio-rest-utilizando-tokens-jwt-con-spring/">Servidor OAuth, gateway y servicio REST utilizando tokens JWT con Spring</a></li>
</ul>
<div class="media media-amazon">
  <iframe style="width:120px;height:240px;" width="120" height="240" scrolling="no" frameborder="0" src="https://rcm-eu.amazon-adsystem.com/e/cm?lt1=_blank&amp;bc1=000000&amp;IS2=1&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;t=blobit-21&amp;language=es_ES&amp;o=30&amp;p=8&amp;l=as4&amp;m=amazon&amp;f=ifr&amp;ref=as_ss_li_til&amp;asins=161729327X&amp;linkId=38b33d0ec3ca9855c0a981d1e2154b63" title="Amazon" class="lozad"></iframe>
  <iframe style="width:120px;height:240px;" width="120" height="240" scrolling="no" frameborder="0" src="https://rcm-eu.amazon-adsystem.com/e/cm?lt1=_blank&amp;bc1=000000&amp;IS2=1&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;t=blobit-21&amp;language=es_ES&amp;o=30&amp;p=8&amp;l=as4&amp;m=amazon&amp;f=ifr&amp;ref=as_ss_li_til&amp;asins=1800562497&amp;linkId=eb189e8a81b21d362b31f7b08f4b9f4e" title="Amazon" class="lozad"></iframe>
</div>
]]>
        </content>
        
            
                <category term="planeta-codigo"/>
            
                <category term="programacion"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2022/07/opciones-de-arquitectura-para-emitir-trazas-en-una-aplicacion-java/</id>
        <title>Opciones de arquitectura para emitir trazas en una aplicaci√≥n Java</title>
        <updated>2022-07-28T19:30:00+02:00</updated>
        <published>2022-07-28T19:30:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2022/07/opciones-de-arquitectura-para-emitir-trazas-en-una-aplicacion-java/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Incluso para emitir trazas que en principio es algo sencillo y que se da por hecho surgen varias opciones de arquitectura o dise√±o. Dos de esas decisiones son acoplarse o no a la librer√≠a de <em>logging</em> que se use e inyectar de forma est√°tica o por el constructor la instancia de la clase con la que se emiten trazas. Estas decisiones conviene recogerlas en un documento de <em>Architecture Decision Record</em> por si en un futuro hay que revisar las decisiones tomadas con anterioridad o para que una persona en un futuro tenga el contexto y un registro de las decisiones que se han tomado, el contexto, opciones evaluadas, argumentos y decisiones tomadas.</strong></p>]]>
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/java.svg" width="200" height="366" alt="Java" title="Java" class="" loading="false&#34;"></p>
</div>
<p>Una de las cosas m√°s esenciales de una aplicaci√≥n es generar trazas para tener observabilidad de que est√° realizando la aplicaci√≥n y un registro que permita consultar qu√© ha pasado en cualquier momento que sea necesario, que lo ser√°. Las trazas no son solo por observabilidad a veces tambi√©n por cumplimiento de requerimientos de seguridad y auditor√≠a.</p>
<p>Por tanto, usar una librer√≠a de <em>logging</em> es una de las dependencias b√°sicas, en Java las librer√≠as de logging m√°s utilizadas son <a href="https://logging.apache.org/log4j/2.x/">log4j 2</a>, <a href="https://www.slf4j.org/">SLF4J</a> y las propias <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.logging/java/util/logging/package-summary.html">clases del JDK para logging</a> del paquete conocido como JUL.</p>
<p>Adem√°s de la librer√≠a en concreto que usada hay otras decisiones de arquitectura que tomar al aplicar en una aplicaci√≥n. Independientemente de la opci√≥n que se use de todas estas opciones, argumentos y decisiones lo ideal es registrar en un documento que se suele denominar <em>Architecture Decision Record</em> de modo que en un futuro u otra persona pueda tener el contexto de qu√© y por qu√© se tomaron en su momento algunas decisiones.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2020/09/funcionalidades-que-necesitan-las-aplicaciones-basadas-en-microservicios-y-herramientas-que-las-proporcionan/">Funcionalidades que necesitan las aplicaciones basadas en microservicios y herramientas que las proporcionan</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2022/01/las-clases-para-logging-del-paquete-jul-incluidas-en-la-api-de-java/">Las clases para logging del paquete JUL incluidas en la API de Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2021/01/documentacion-para-registrar-las-decisiones-de-arquitectura-en-software-e-infraestructura/">Documentaci√≥n para registrar las decisiones de arquitectura en software e infraestructura</a></li>
</ul>
<p>En un <a href="https://martinfowler.com/articles/domain-oriented-observability.html">art√≠culo publicado en el sitio web de Martin Fowller sobre la observabilidad en el dominio</a> hablan sobre c√≥mo dise√±ar las clases para a√±adir esta funcionalidad al c√≥digo. En este art√≠culo comento sobre la trazabilidad de una aplicaci√≥n pero lo mismo es aplicable a las m√©tricas como se comenta en el sitio web de Fowller.</p>
<p>Despu√©s de leer el art√≠culo de Fowller y este art√≠culo, ¬øqu√© opci√≥n usas? ¬øalguna otra opci√≥n o variante? ¬øqu√© opinas?</p>
<div class="alert alert-warning pt-0 pb-0 tableofcontents"><h2>Contenido del art√≠culo</h2><toc></toc></div>
<h3 id="opciones">Opciones</h3>
<p>Estas cuatro opciones tratan dos asuntos diferentes. Las dos primeras tratan de si crear una abstracci√≥n o usar la librer√≠a de <em>logging</em> directamente sin ninguna abstracci√≥n.</p>
<p>La tercera y la cuarta tratan otro aspecto que es como inyectar el <em>logger</em> en las clases que emitan trazas, en realidad no son excluyentes y como comento se puede optar por una u otra forma de inyectar el <em>logger</em> seg√∫n la clase.</p>
<h4 id="acoplarse-a-la-librer√≠a-que-emite-los-_logs_">Acoplarse a la librer√≠a que emite los <em>logs</em></h4>
<p>En esta opci√≥n las clases de la librer√≠a de <em>logging</em> se consideran como parte de la plataforma y el c√≥digo se acopla a ellas.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.logging.log4j.Logger</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.logging.log4j.LogManager</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">Service</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">LogManager</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">Service</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="nf">Service</span><span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="kt">void</span> <span class="nf">method</span><span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;Message&#34;</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>Service-1.java</span>
    </div>
</div>
<h4 id="abstracci√≥n-sobre-la-librer√≠a-que-emite-los-_logs_">Abstracci√≥n sobre la librer√≠a que emite los <em>logs</em></h4>
<p>Para no acoplarse a una librer√≠a en concreto de <em>logging</em> se crea una abstracci√≥n que independice de la librer√≠a de modo que si esta cambia no haga falta el c√≥digo sino simplemente la implementaci√≥n de la abstracci√≥n.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">io.github.picodotdev.blogbitix.platform.logging.Logger</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">io.github.picodotdev.blogbitix.platform.logging.LogManager</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">Service</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">LogManager</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">Service</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="nf">Service</span><span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="kt">void</span> <span class="nf">method</span><span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;Message&#34;</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>Service-2.java</span>
    </div>
</div>
<h4 id="inyecci√≥n-est√°tica-del-_logger_">Inyecci√≥n est√°tica del <em>logger</em></h4>
<p>La forma habitual que ponen de ejemplo las librer√≠as de <em>logging</em> para inyectar la instancia de la clase de <em>logger</em> se realizan mediante una factor√≠a e inicializaci√≥n est√°tica.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">io.github.picodotdev.blogbitix.platform.logging.Logger</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">io.github.picodotdev.blogbitix.platform.logging.LogManager</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">Service</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">LogManager</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">Service</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="nf">Service</span><span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="kt">void</span> <span class="nf">method</span><span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;Message&#34;</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>Service-3.java</span>
    </div>
</div>
<h4 id="inyecci√≥n-por-constructor-del-_logger_">Inyecci√≥n por constructor del <em>logger</em></h4>
<p>En vez de inyectar de forma est√°tica el <em>logger</em>, la instancia se inyecta en el constructor como cualquier otro colaborador de la clase.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">io.github.picodotdev.blogbitix.platform.logging.Logger</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">Service</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">private</span> <span class="n">Logger</span> <span class="n">logger</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="nf">Service</span><span class="o">(</span><span class="n">Logger</span> <span class="n">logger</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">this</span><span class="o">.</span><span class="na">logger</span> <span class="o">=</span> <span class="n">logger</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="kt">void</span> <span class="nf">method</span><span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;Message&#34;</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>Service-4.java</span>
    </div>
</div>
<h3 id="argumentos">Argumentos</h3>
<p>Evitar el acoplamiento es algo deseable dado que permite flexibilidad y realizar cambios afectando a una una peque√±a parte del c√≥digo. Con una abstracci√≥n es posible cambiar de una implementaci√≥n a otra y los cambios solo afectan a la abstracci√≥n y no al resto del c√≥digo.</p>
<p>El inconveniente de la abstracci√≥n es que requiere crearla y mantenerla y que posiblemente esa abstracci√≥n ofrece un subconjunto peque√±o de toda la funcionalidad que ofrece la librer√≠a de <em>logging</em> que se use. A√∫n as√≠ el subconjunto de la funcionalidad es aquel que realmente se usa.</p>
<p>Incluso aunque el JDK incluye clases de <em>logging</em> y el acoplamiento sea con las clases del JDK por flexibilidad se puede desear crea la abstracci√≥n por la posibilidad de cambiar la librer√≠a de <em>logging</em> a otra.</p>
<p>La librer√≠a SL4J precisamente es una fachada o abstracci√≥n sobre otras librer√≠as de <em>logging</em> que permite cambiar de una implementaci√≥n de librer√≠a a <em>logging</em> a otra sin necesidad de cambios en el c√≥digo de modo que en vez de crear una abstracci√≥n propia la abstracci√≥n a la que acoplarse puede ser esta.</p>
<p>Otro aspecto a considerar es c√≥mo inyectar la dependencia del logger, esto es independiente de si usa o no una abstracci√≥n propia o de otra librer√≠a como la de SLF4J.</p>
<p>La inyecci√≥n est√°tica es simple pero no permite o dificulta hacer pruebas unitarias sobre el logger que es un aspecto de la observabilidad que tal vez se desea probar, por ejemplo por motivos de seguridad se desea que el c√≥digo emita trazas de inicios de sesi√≥n o acciones relevantes que permite tener un log en caso de querer auditar con posterioridad. A veces el √∫nico efecto observable de un flujo de c√≥digo es que se emite una traza.</p>
<p>La inyecci√≥n como una dependencia del <em>logger</em> como cualquier otro colaborador permite realizar teses unitarios de forma m√°s f√°cil. La dependencia se a√±ade simplemente en el constructor de la clase. Para las clases que son construidas con el contenedor de dependencias es simple y no requiere m√°s que a√±adir de forma expl√≠cita el colaborador en el constructor, crear una variable y realizar la asignaci√≥n en la implementaci√≥n del constructor, estos algo m√°s complejo que la inyecci√≥n est√°tica pero aporta otras ventajas.</p>
<p>Para las clases que no son construidas con el contenedor de dependencias tener que pasar de forma expl√≠cita el <em>logger</em> es una molestia, posiblemente hace el c√≥digo m√°s complicado adem√°s de ser un aspecto de la aplicaci√≥n no relacionado con la l√≥gica de negocio.</p>
<p>Estas opciones no son excluyentes, en aquellas clases que son creadas por el contenedor dejar al contenedor inyectar la dependencia del <em>logger</em> y el aquellos puntos de la aplicaci√≥n como clases de dominio no construidas por el contenedor o en clases con m√©todos est√°ticos utilizar una inyecci√≥n est√°tica, sabiendo que en la inyecci√≥n est√°tica las pruebas unitarias con m√°s complicadas.</p>
<h3 id="implementaci√≥n-de-inyecci√≥n-por-constructor-con-spring">Implementaci√≥n de inyecci√≥n por constructor con Spring</h3>
<p>Utilizando <a href="https://spring.io/">Spring</a> y <a href="https://projects.spring.io/spring-boot/">Spring Boot</a> la inyecci√≥n por constructor es posible conseguirla f√°cilmente con la posibilidad de <a href="https://picodotdev.github.io/blog-bitix/2022/12/crear-un-bean-segun-el-contexto-donde-se-inyecte-con-spring/">Crear un bean seg√∫n el contexto donde se inyecte con Spring</a> de modo que para las clases que est√°n gestionadas por el contenedor de dependencias se aprovechan sus funcionalidades en la implementaci√≥n.</p>
<div class="reference">
    Referencia:<br>
<ul>
<li><a href="https://www.javacodegeeks.com/2019/03/logging-without-static-logger.html">Logging Without a Static Logger</a></li>
</ul>
</div>
]]>
        </content>
        
            
                <category term="java"/>
            
                <category term="planeta-codigo"/>
            
                <category term="programacion"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2022/04/como-usar-el-comando-git-bisect-para-descubrir-el-primer-commit-con-un-error/</id>
        <title>C√≥mo usar el comando git bisect para descubrir el primer commit con un error</title>
        <updated>2022-04-28T19:00:00+02:00</updated>
        <published>2022-04-28T19:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2022/04/como-usar-el-comando-git-bisect-para-descubrir-el-primer-commit-con-un-error/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>El comando <em>git bisect</em> es muy √∫til cuando se desea encontrar en que <em>commit</em> se ha introducido un error en un rango de <em>commits</em> ya que permite automatizar la b√∫squeda sin tener que hacerlo manualmente el desarrollador que simplemente se limita a indicar a Git si el <em>commit</em> a analizar en cada prueba es correcto o incorrecto. Una vez descubierto en que <em>commit</em> se ha introducido el error es cuesti√≥n de revisar los cambios de ese <em>commit</em>, analizar sus cambios e identificadas las l√≠neas de c√≥digo err√≥neas aplicar la soluci√≥n.</strong></p>]]>
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/git.svg" width="200" height="200" alt="Git" title="Git" class="" loading="false&#34;"></p>
</div>
<p>Una herramienta de control de versiones para el c√≥digo fuente de las aplicaciones es esencial, para guardar todos los cambios realizados en el c√≥digo y permitir compartir c√≥digo entre los desarrolladores aparte de otras funcionalidades proporcionadas. Una de las herramientas de control de versiones m√°s populares es <a href="https://git-scm.com/">Git</a>, desarrollado por <a href="https://en.wikipedia.org/wiki/Linus_Torvalds">Linus Torvalds</a> tambi√©n autor original de n√∫cleo <a href="https://www.linux.com/">Linux</a> entre otros colaboradores.</p>
<p>Una situaci√≥n habitual al realizar cambios en el c√≥digo fuente de un programa es pasado un tiempo descubrir un error y no conocer en que cambio lo ha producido y en que <em>commit</em>. Si no se tiene una pista de cual es el cambio que ha introducido error una soluci√≥n es probar cada <em>commit</em> y para ver si esa versi√≥n de la aplicaci√≥n tiene el error o no. Una vez probados varios <em>commit</em> al final se descubre que <em>commit</em> es el que ha introducido el error. Conociendo el <em>commit</em> que introduce el error hay que revisar los cambios de ese <em>commit</em> para conocer y cambiar las l√≠neas de c√≥digo err√≥neas.</p>
<h3 id="el-comando-_git-bisect_">El comando <em>git bisect</em></h3>
<p>Una de las funcionalidades que proporciona la herramienta de control de versiones Git es el subcomando <em>bisect</em>. <a href="https://git-scm.com/docs/git-bisect">El comando <em>git bisect</em></a> automatiza encontrar que <em>commit</em> ha introducido un error dado un rango de <em>commits</em> en el que se sospecha est√° el <em>commit</em> con el error.</p>
<p>El comando <em>git bisect</em> aplica un algoritmo de b√∫squeda al rango de <em>commits</em>, en funci√≥n de la indicaci√≥n que se le proporcione de si el commit tiene o no el error al final del n√∫mero de comprobaciones que sean necesarias proporciona el primer <em>commit</em> con el error en el rango analizado.</p>
<p>El comando <em>git bisect</em> no se utiliza tan habitualmente como <em>git stash</em> o <em>git commit</em> pero cuando cuando es necesario es muy √∫til conocer como se usa y usarlo.</p>
<p>El primer paso del comando <em>git bisect</em> es iniciar la bisecci√≥n y proporcionar el rango de <em>commits</em> a analizar. Una vez proporcionado el rango de <em>commits</em> <em>git</em> cambia el <em>commit</em> del espacio de trabajo seg√∫n su algoritmo de b√∫squeda. El siguiente paso suele consistir en arrancar la aplicaci√≥n y comprobar si el <em>commit</em> tiene o no el error. Una vez conocido si el <em>commit</em> es correcto o tiene el error se le indica a Git con el comando <em>git bisect good</em> o <em>git bisect bad</em> respectivamente. Git a continuaci√≥n selecciona otro <em>commit</em> teniendo que comprobar de nuevo si el nuevo <em>commit</em> seleccionado es correcto o incorrecto. Despu√©s de varias repeticiones de estos pasos se descubre el <em>commit</em> en el que se introdujo el error.</p>
<p>Una vez terminada la bisecci√≥n o en cualquier momento se puede dar por terminada con el comando <em>git bisect reset</em> y volver a un espacio de trabajo fuera del <em>bisect</em>. El comando <em>git bisect view</em> permite ver el estado de la bisecci√≥n y los <em>commits</em> analizados.</p>
<p>Estos con los comandos b√°sicos y un ejemplo de uso.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span><span class="lnt">4&#10;</span><span class="lnt">5&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ git bisect start&#10;</span></span><span class="line"><span class="cl">$ git bisect good&#10;</span></span><span class="line"><span class="cl">$ git bisect bad&#10;</span></span><span class="line"><span class="cl">$ git bisect reset&#10;</span></span><span class="line"><span class="cl">$ git bisect <span class="o">(</span>visualize<span class="p">|</span>view<span class="o">)</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>git-bisect-1.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ git log --pretty<span class="o">=</span>oneline 63575c4f1824c360dbf60aafaaec17401ea604bd..master&#10;</span></span><span class="line"><span class="cl">022c1b295804bf810743f175358607a0a3bb7307 <span class="o">(</span>HEAD -&gt; master, origin/master<span class="o">)</span> Remove Universal Analytics&#10;</span></span><span class="line"><span class="cl">a07d1af345907016e19778feb064e08d17f36ed9 Add print_step <span class="k">for</span> display_manager step&#10;</span></span><span class="line"><span class="cl">39320076b996e4d582bf535f74d1f0b238b3768a Reorder packages&#10;</span></span><span class="line"><span class="cl">d5233aa726c2626d52de8981bee65dcfbf69ae61 Merge pull request <span class="c1">#209 from shuriken1812/master</span>&#10;</span></span><span class="line"><span class="cl">f7a4790992f859aac6fde86b3b18a72e259545bd Added pipewire-alsa and wireplumber&#10;</span></span><span class="line"><span class="cl">0b0a1ddca33814e254b3bc395af476156559aac4 Allow to choose display manager&#10;</span></span><span class="line"><span class="cl">0aeacbab0fe55b71b272d670c76ab52fa2b206c4 Support LightDM autologin&#10;</span></span><span class="line"><span class="cl">ff01de4f91ff10c6b99b5b6275623ea93ec412ba Update Hugo  ndadd Google Analytics <span class="m">4</span>&#10;</span></span><span class="line"><span class="cl">f3038ae0195dddcd98660ebd81721aa5645a8597 Merge pull request <span class="c1">#194 from MauroSoli/patch-1</span>&#10;</span></span><span class="line"><span class="cl">20c5f7a12bbbc372e77187cae7ccd4a1c64c8a1b Change provision configuration description&#10;</span></span><span class="line"><span class="cl">219f4ab9232b5537364d8b9a0e969520917f3230 add !tpm module</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>git-log.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>picodotdev@archlinux alis <span class="o">(</span>master $<span class="o">=)]</span>$ git bisect start master 63575c4f1824c360dbf60aafaaec17401ea604bd&#10;</span></span><span class="line"><span class="cl">Biseccionando: faltan <span class="m">5</span> revisiones por probar despu√©s de esta <span class="o">(</span>aproximadamente <span class="m">3</span> pasos<span class="o">)</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">[</span>0aeacbab0fe55b71b272d670c76ab52fa2b206c4<span class="o">]</span> Support LightDM autologin&#10;</span></span><span class="line"><span class="cl"><span class="o">[</span>picodotdev@archlinux alis <span class="o">((</span>0aeacba...<span class="o">)</span> $<span class="p">|</span>BISECTING<span class="o">)]</span>$ git bisect good&#10;</span></span><span class="line"><span class="cl">Biseccionando: faltan <span class="m">2</span> revisiones por probar despu√©s de esta <span class="o">(</span>aproximadamente <span class="m">2</span> pasos<span class="o">)</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">[</span>d5233aa726c2626d52de8981bee65dcfbf69ae61<span class="o">]</span> Merge pull request <span class="c1">#209 from shuriken1812/master</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">[</span>picodotdev@archlinux alis <span class="o">((</span>d5233aa...<span class="o">)</span> $<span class="p">|</span>BISECTING<span class="o">)]</span>$ git bisect bad&#10;</span></span><span class="line"><span class="cl">Biseccionando: faltan <span class="m">0</span> revisiones por probar despu√©s de esta <span class="o">(</span>aproximadamente <span class="m">1</span> paso<span class="o">)</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">[</span>f7a4790992f859aac6fde86b3b18a72e259545bd<span class="o">]</span> Added pipewire-alsa and wireplumber&#10;</span></span><span class="line"><span class="cl"><span class="o">[</span>picodotdev@archlinux alis <span class="o">((</span>f7a4790...<span class="o">)</span> $<span class="p">|</span>BISECTING<span class="o">)]</span>$ git bisect bad&#10;</span></span><span class="line"><span class="cl">Biseccionando: faltan <span class="m">0</span> revisiones por probar despu√©s de esta <span class="o">(</span>aproximadamente <span class="m">0</span> pasos<span class="o">)</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">[</span>0b0a1ddca33814e254b3bc395af476156559aac4<span class="o">]</span> Allow to choose display manager&#10;</span></span><span class="line"><span class="cl"><span class="o">[</span>picodotdev@archlinux alis <span class="o">((</span>0b0a1dd...<span class="o">)</span> $<span class="p">|</span>BISECTING<span class="o">)]</span>$ git bisect bad&#10;</span></span><span class="line"><span class="cl">0b0a1ddca33814e254b3bc395af476156559aac4 is the first bad commit&#10;</span></span><span class="line"><span class="cl">commit 0b0a1ddca33814e254b3bc395af476156559aac4&#10;</span></span><span class="line"><span class="cl">Author: pico.dev &lt;pico.dev@gmail.com&gt;&#10;</span></span><span class="line"><span class="cl">Date:   Sat Apr <span class="m">23</span> 14:48:22 <span class="m">2022</span> +0200&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;Allow to choose display manager&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"> alis.conf <span class="p">|</span>   <span class="m">4</span> +-&#10;</span></span><span class="line"><span class="cl"> alis.sh   <span class="p">|</span> <span class="m">148</span> +++++++++++++++++++++++++++++++++++++++++++++-----------------&#10;</span></span><span class="line"><span class="cl"> <span class="m">2</span> files changed, <span class="m">112</span> insertions<span class="o">(</span>+<span class="o">)</span>, <span class="m">40</span> deletions<span class="o">(</span>-<span class="o">)</span>&#10;</span></span><span class="line"><span class="cl"> <span class="o">[</span>picodotdev@archlinux alis <span class="o">((</span>0b0a1dd...<span class="o">)</span> $<span class="p">|</span>BISECTING<span class="o">)]</span>$ git bisect reset&#10;</span></span><span class="line"><span class="cl"> <span class="o">[</span>picodotdev@archlinux alis <span class="o">(</span>master $<span class="o">=)]</span>$ </span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>git-bisect-example.sh</span>
    </div>
</div>
]]>
        </content>
        
            
                <category term="gnu-linux"/>
            
                <category term="planeta-codigo"/>
            
                <category term="programacion"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2022/04/aplicacion-con-interfaz-grafica-para-repositorios-git/</id>
        <title>Aplicaci√≥n con interfaz gr√°fica para repositorios Git</title>
        <updated>2022-04-19T00:00:00+02:00</updated>
        <published>2022-04-19T00:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2022/04/aplicacion-con-interfaz-grafica-para-repositorios-git/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Una herramienta con interfaz gr√°fica hace m√°s f√°cil algunas tareas que usar la l√≠nea de comandos directamente. Este tambi√©n es el caso al trabajar con repositorios de c√≥digo fuente con la herramienta de control de versiones Git. Usar la linea de comandos tiene sus propias ventajas como permitir automatizar tareas con <em>scripts</em> o realizar operaciones sin tener que usar la interfaz gr√°fica. La interfaz gr√°fica y la linea de comandos no son excluyentes, se pueden usar seg√∫n convenga en cada ocasi√≥n. Al trabajar con m√∫ltiples repositorios de Git, para realizar operaciones comunes como <em>commits</em>, analizar el historial y ver las diferencias en un archivo entre dos versiones una herramienta gr√°fica tambi√©n facilita la tarea.</strong></p>]]>
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/linux.svg" width="200" height="232" alt="Linux" title="Linux" class="" loading="false&#34;"></p>
</div>
<p>El sistema de control de versiones <a href="https://git-scm.com/">Git</a> posee una l√≠nea de comandos con la que se realizan todas las acciones para clonar repositorios, para hacer commits, para ver diferencias, para explorar el historial, para crear ramas y cualquier otra acci√≥n. La l√≠nea de comandos es muy potente y adem√°s es <a href="https://picodotdev.github.io/blog-bitix/2016/07/guia-basica-del-interprete-de-comandos-bash/">automatizable con un <em>script</em></a> pero como cualquier otra l√≠nea de comandos no es intuitiva y dif√≠cil de aprender y en alg√∫n caso lenta al teclear un comando, sus opciones y argumentos.</p>
<p>Es aconsejable conocer los comandos b√°sicos de l√≠nea de comandos pero en el uso diario o para algunas acciones las aplicaciones con interfaz gr√°fica son m√°s r√°pidas, m√°s f√°ciles de aprender y sin necesidad de recordar las opciones de cada comando. En <a href="https://www.gnu.org/">GNU</a>/<a href="https://www.linux.com/">Linux</a> y <a href="https://www.gnome.org/">GNOME</a> una aplicaci√≥n cliente de Git es <a href="https://wiki.gnome.org/Apps/Gitg">gitg</a>.</p>
<h3 id="la-aplicaci√≥n-gitg">La aplicaci√≥n gitg</h3>
<p><a href="https://wiki.gnome.org/Apps/Gitg">Gitg</a> es una aplicaci√≥n de escritorio con interfaz gr√°fica que permite visualizar un repositorio de Git, su historial y el contenido de los diferentes archivos en sus versiones. No tiene todas las opciones disponibles de la l√≠nea de comandos pero si muchos incluyendo los m√°s comunes. Usar una herramienta con interfaz gr√°fica puede mejorar la productividad al trabajar con varios repositorios de control de versiones en Git y permite a los usuarios que est√©n empezando a usar Git una forma de usarlo m√°s intuitiva.</p>
<p>Est√° adaptada a la gu√≠a de estilos de las aplicaciones de GNOME, es una aplicaci√≥n de software libre, est√° disponible tanto para GNU/Linux, <a href="https://www.apple.com/macos/">macOS</a> como <a href="https://www.microsoft.com/es-es/windows/">Windows</a> y en GNU/Linux se puede instalar como paquete de la distribuci√≥n o como <a href="https://picodotdev.github.io/blog-bitix/2018/11/flatpak-distribucion-e-instalacion-de-programas-de-escritorio-en-las-distribuciones-gnu-linux/">una aplicaci√≥n en formato Flatpak</a> independiente de la distribuci√≥n <a href="https://flathub.org/apps/details/org.gnome.gitg">disponible en Flathub con su paquete de gitg</a>.</p>
<div class="media">
<figure>
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/gitg.svg" width="200" height="150" alt="gitg" title="gitg" class="&#34; " loading="lazy"></p>
</figure>
</div>
<p>Las operaciones que permite son:</p>
<ul>
<li>Ver el historial.</li>
<li>Ver el contenido de archivos.</li>
<li>Gestionar el √°rea de <em>staging</em> para componer el <em>commit</em>.</li>
<li>A√±adir y clonar un repositorio.</li>
<li>Actualizar la informaci√≥n del usuario.</li>
<li>Cambiar varias opciones de preferencias.</li>
</ul>
<p>En esta capturas se muestran los <em>commits</em>, historial y <em>merges</em> en una linea de tiempo gr√°fica, adem√°s de poder ver las ramas locales, las ramas remotas, los or√≠genes de las ramas as√≠ como los archivos modificados en cada <em>commit</em> y las diferencias y cambios realizados en cada archivo.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2022/04/aplicacion-con-interfaz-grafica-para-repositorios-git/images/gitg-1_hufc6c7212bf1f460f3fa6607e19248b9a_29524_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Aplicaci√≥n gitg"><img src="https://picodotdev.github.io/blog-bitix/2022/04/aplicacion-con-interfaz-grafica-para-repositorios-git/images/gitg-1_hufc6c7212bf1f460f3fa6607e19248b9a_29524_300x200_fit_q90_h2_box_3.webp" width="238" height="200" alt="Aplicaci√≥n gitg" title="Aplicaci√≥n gitg" class="&#34; " loading="lazy"></a>
<a href="https://picodotdev.github.io/blog-bitix/2022/04/aplicacion-con-interfaz-grafica-para-repositorios-git/images/gitg-2_hu2a9b977282670e3858193850017f09b7_19224_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Aplicaci√≥n gitg"><img src="https://picodotdev.github.io/blog-bitix/2022/04/aplicacion-con-interfaz-grafica-para-repositorios-git/images/gitg-2_hu2a9b977282670e3858193850017f09b7_19224_300x200_fit_q90_h2_box_3.webp" width="238" height="200" alt="Aplicaci√≥n gitg" title="Aplicaci√≥n gitg" class="&#34; " loading="lazy"></a></p>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2022/04/aplicacion-con-interfaz-grafica-para-repositorios-git/images/gitg-3_hu5b15d53ed39308162b8db2645ba363df_242593_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Aplicaci√≥n gitg"><img src="https://picodotdev.github.io/blog-bitix/2022/04/aplicacion-con-interfaz-grafica-para-repositorios-git/images/gitg-3_hu5b15d53ed39308162b8db2645ba363df_242593_650x400_fit_q90_h2_box_3.webp" width="419" height="400" alt="Aplicaci√≥n gitg" title="Aplicaci√≥n gitg" class="&#34; " loading="lazy"></a></p>
<figcaption>Aplicaci√≥n gitg</figcaption>
</figure>
</div>
<p>Otras aplicaciones cliente de Git que tiene caracter√≠sticas similares son <a href="https://github.com/desktop/desktop">Github Desktop</a> y <a href="https://www.syntevo.com/smartgit/">SmartGit</a> esta √∫ltima tiene una licencia propietaria y no es gratuita, ambas tienen su versi√≥n de Flatpak en el repositorio de <a href="https://flathub.org/">Flathub</a>.</p>
]]>
        </content>
        
            
                <category term="gnu-linux"/>
            
                <category term="planeta-codigo"/>
            
                <category term="programacion"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2021/12/buenas-practicas-de-programacion-sencillas-en-el-codigo-fuente/</id>
        <title>Buenas pr√°cticas de programaci√≥n sencillas en el c√≥digo fuente</title>
        <updated>2021-12-09T23:00:00+01:00</updated>
        <published>2021-12-09T23:00:00+01:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2021/12/buenas-practicas-de-programacion-sencillas-en-el-codigo-fuente/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Al escribir c√≥digo uno de las principales objetivos adem√°s de que funcione es tan importante que sea c√≥digo legible ya que la mayor parte del tiempo en la programaci√≥n generalmente no se emplea a escribir c√≥digo nuevo sino a mantener c√≥digo existente. Las pr√°cticas de este art√≠culo para escribir c√≥digo m√°s legible son sencillas de comprender y de aplicar en cualquier lenguaje de programaci√≥n.</strong></p>]]>
        <![CDATA[<p>Tan importante que un programa funcione y est√© libre de errores es que el c√≥digo fuente del programa sea legible y f√°cil de entender. Esto permite que en caso de un error el an√°lisis del c√≥digo fuente sea m√°s sencillo, incluso si es c√≥digo escrito por uno mismo, cuando pasan varios meses e incluso a√±os desde que se escribi√≥ el c√≥digo uno ya no se acuerda de ninguno de sus detalles y hay que analizarlo como si lo hubiese escrito otra persona.</p>
<p>La legibilidad afecta a la facilidad de cambio del c√≥digo fuente y a la facilidad de correcci√≥n de errores y tiempo que se tarda en resolverlos. En realidad la mayor parte del tiempo dedicado a la programaci√≥n no es a la escritura de nuevas l√≠neas de c√≥digo fuente si no a la lectura de las existentes, por ello al escribir c√≥digo este deber√≠a ser optimizado para la lectura para la mayor√≠a de √°mbitos y aplicaciones m√°s que a la eficiencia. Que un programa tenga menos l√≠neas de c√≥digo fuente o un lenguaje necesite menos l√≠neas para expresar lo mismo no implica que sea m√°s legible.</p>
<p>A veces para escribir un buen c√≥digo fuente y c√≥digo legible no es necesario ni tiene que ver con utilizar patrones de dise√±o que en realidad a√±aden complejidad o complejas arquitecturas de software por capas o hexagonal, para escribir buen c√≥digo fuente bastan unas pocas t√©cnicas y pr√°cticas  muy sencillas y f√°cilmente comprensibles. Adem√°s, estas pr√°cticas son aplicables a cualquier lenguaje de programaci√≥n, los patrones de dise√±o y las arquitecturas de software aunque √∫tiles resuelven problemas de complejidad y extensibilidad que son problemas en primera instancia diferentes a la legibilidad del c√≥digo fuente.</p>
<p>Est√°s pr√°cticas son simplemente recomendaciones a seguir como normal general, no son reglas estrictas que si no se aplican en todos los casos y siempre significa que el c√≥digo est√© completamente mal. Todas estas pr√°cticas son sencillas y aplicables a cualquier lenguaje de programaci√≥n.</p>
<div class="alert alert-warning pt-0 pb-0 tableofcontents"><h2>Contenido del art√≠culo</h2><toc></toc></div>
<h3 id="un-nivel-de-indentaci√≥n-por-m√©todo">Un nivel de indentaci√≥n por m√©todo</h3>
<p>Que un m√©todo tenga varios niveles de indentaci√≥n anidados normalmente significa que las varias anidaciones realizan una tarea cuyo objetivo hay que inferir analizando el c√≥digo. Adem√°s, los varios niveles de anidaci√≥n al leer el c√≥digo exige recordar la tarea de cada uno de los bloques. Un simple bucle anidado con dos <em>for</em> ya exige un esfuerzo significativo para analizar qu√© hace. Para facilitar la lectura y evitar los niveles de anidaci√≥n se recomienda que cada m√©todo tenga como m√°ximo un √∫nico nivel de anidaci√≥n.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Board</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">private</span> <span class="n">String</span><span class="o">[]</span> <span class="n">data</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="n">String</span> <span class="nf">board</span><span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">StringBuilder</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">result</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">data</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]);</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">result</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&#34;\n&#34;</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>NestedLoop.java</span>
    </div>
</div>
<p>El <em>refactor</em> a aplicar es crear tantos m√©todos como sea necesario para que cada uno solo tenga un nivel de indentaci√≥n. Esto tiene dos ventajas, por un lado el n√∫mero de l√≠neas de cada m√©todo ser√° m√°s peque√±o que el √∫nico m√©todo original y por tanto m√°s f√°cil de comprender, y por otro lado al tener que asignar un nombre al m√©todo hacer que este describa qu√© funci√≥n realiza el c√≥digo.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Board</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">private</span> <span class="n">String</span><span class="o">[]</span> <span class="n">data</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="n">String</span> <span class="nf">board</span><span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">StringBuilder</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">collectRows</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">private</span> <span class="kt">void</span> <span class="nf">collectRows</span><span class="o">(</span><span class="n">StringBuilder</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">collectRow</span><span class="o">(</span><span class="n">result</span><span class="o">,</span> <span class="n">i</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">private</span> <span class="kt">void</span> <span class="nf">collectRow</span><span class="o">(</span><span class="n">StringBuilder</span> <span class="n">result</span><span class="o">,</span> <span class="kt">int</span> <span class="n">row</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">result</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">data</span><span class="o">[</span><span class="n">row</span><span class="o">][</span><span class="n">i</span><span class="o">]);</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">result</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&#34;\n&#34;</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>UnnestedLoop.java</span>
    </div>
</div>
<h3 id="no-usar-la-palabra-clave-del-condicional-_else_">No usar la palabra clave del condicional <em>else</em></h3>
<p>Las sentencias condicionales son sentencias de control de flujo del programa que permiten ejecutar uno u otro bloque de c√≥digo en funci√≥n de una condici√≥n. Tener dos bloques de c√≥digo que hacen cosas diferentes ofuscan cual es el camino que sigue el programa, cuando en el flujo del programa se a√±aden m√°s combinaciones el n√∫mero de caminos posible capaz de tomar el programa crece r√°pidamente, simplemente con dos sentencias <em>if</em> anidadas el n√∫mero de combinaciones son cuatro. Por otro lado, si el c√≥digo de los bloques <em>if</em> y <em>else</em> son grandes impide visualizar ambos bloques al mismo tiempo lo que obliga a ejercitar la mente para recordar las l√≠neas de c√≥digo de cada uno en el an√°lisis.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/10/evitar-niveles-de-anidacion-de-sentencias-condicionales-con-guard-clauses/">Evitar niveles de anidaci√≥n de sentencias condicionales con ¬´guard clauses¬ª</a></li>
</ul>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">BigDecimal</span> <span class="nf">getValue</span><span class="o">(</span><span class="n">Car</span> <span class="n">car</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">   <span class="n">BigDecimal</span> <span class="n">result</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">   <span class="k">if</span> <span class="o">(</span><span class="n">car</span><span class="o">.</span><span class="na">isNew</span><span class="o">())</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;   <span class="n">result</span> <span class="o">=</span> <span class="n">car</span><span class="o">.</span><span class="na">getNewValue</span><span class="o">();</span>&#10;</span></span><span class="line"><span class="cl">   <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;   <span class="k">if</span> <span class="o">(!</span><span class="n">car</span><span class="o">.</span><span class="na">isOlderThanYears</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">car</span><span class="o">.</span><span class="na">hasLessKilimetersThan</span><span class="o">(</span><span class="mi">10000</span><span class="o">))</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">result</span> <span class="o">=</span> <span class="n">car</span><span class="o">.</span><span class="na">getAlmostNewValue</span><span class="o">();</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;   <span class="k">else</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <span class="k">if</span> <span class="o">(!</span><span class="n">car</span><span class="o">.</span><span class="na">isOlderThanYears</span><span class="o">(</span><span class="mi">5</span><span class="o">))</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">result</span> <span class="o">=</span> <span class="n">car</span><span class="o">.</span><span class="na">getSemiNewValue</span><span class="o">();</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <span class="k">else</span> &#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="n">result</span> <span class="o">=</span> <span class="n">car</span><span class="o">.</span><span class="na">getOldValue</span><span class="o">();</span>&nbsp;&nbsp;&nbsp;&nbsp;&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;   <span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">   <span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">   <span class="k">return</span> <span class="n">result</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">};</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>IfElse.java</span>
    </div>
</div>
<p>Algunos bloques <em>else</em> de las sentencias condicionales <em>if</em> son evitables usando cl√°usulas de guarda o <em>guard clauses</em>.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span><span class="lnt">4&#10;</span><span class="lnt">5&#10;</span><span class="lnt">6&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">BigDecimal</span> <span class="nf">getValue</span><span class="o">(</span><span class="n">Car</span> <span class="n">car</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">(</span><span class="n">car</span><span class="o">.</span><span class="na">isNew</span><span class="o">())</span> <span class="k">return</span> <span class="n">car</span><span class="o">.</span><span class="na">getNewValue</span><span class="o">();</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">(!</span><span class="n">car</span><span class="o">.</span><span class="na">isOlderThanYears</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">car</span><span class="o">.</span><span class="na">hasLessKilimetersThan</span><span class="o">(</span><span class="mi">10000</span><span class="o">))</span> <span class="k">return</span> <span class="n">car</span><span class="o">.</span><span class="na">getAlmostNewValue</span><span class="o">();</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">(!</span><span class="n">car</span><span class="o">.</span><span class="na">isOlderThanYears</span><span class="o">(</span><span class="mi">5</span><span class="o">))</span> <span class="k">return</span> <span class="n">car</span><span class="o">.</span><span class="na">getSemiNewValue</span><span class="o">();</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="n">car</span><span class="o">.</span><span class="na">getOldValue</span><span class="o">();</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">};</span> </span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>GuardClause.java</span>
    </div>
</div>
<h3 id="encapsular-los-datos-primitivos">Encapsular los datos primitivos</h3>
<p>En un lenguaje orientado a objetos todos los m√©todos han de estar encapsulados en una clase. Los m√©todos manipulan los datos de la instancia de la clase lo que proporciona la encapsulaci√≥n y los beneficios de la orientaci√≥n a objetos. Cuando no existe una clase en la que a√±adir un m√©todo surgen los m√©todos que se insertan en una clase de utilidades, estos m√©todos suelen definirse como est√°ticos y est√° junto a otros lo que ocasiona baja cohesi√≥n y una agrupaci√≥n de m√©todos no relacionados.</p>
<p>Para evitar crear m√©todos de utilidad y proporcionar una clase en la que insertar los m√©todos que manipulan datos la opci√≥n es crear una clase. En vez de trabajar con tipos primitivos de datos como un <em>String</em> o un <em>Long</em> que no proporcionan informaci√≥n del dominio del que trata la aplicaci√≥n la opci√≥n es crear una clase <em>Address</em>, <em>Telephone</em>, <em>Identifier</em>,  <em>Email</em>, &hellip;</p>
<p>Estas clases de dominio proporcionan dos ventajas, una que es el lugar en el que insertar los m√©todos que manipulan las propiedades y proporcionan validaci√≥n de tipos. En la clase <em>Email</em> se insertan los m√©todos que manipulan direcciones y el compilador valida que un m√©todo recibe una direcci√≥n en vez de un <em>String</em> que podr√≠a ser cualquier dato como un nombre.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span><span class="lnt">26&#10;</span><span class="lnt">27&#10;</span><span class="lnt">28&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span><span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">private</span> <span class="n">Email</span> <span class="n">email</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="nf">User</span><span class="o">(</span><span class="n">Email</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">this</span><span class="o">.</span><span class="na">email</span> <span class="o">=</span> <span class="n">email</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Email</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">private</span> <span class="n">String</span> <span class="n">value</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">private</span> <span class="nf">Email</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">this</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="kd">static</span> <span class="n">Email</span> <span class="nf">of</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">(!</span><span class="n">isValid</span><span class="o">(</span><span class="n">value</span><span class="o">))</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">throw</span> <span class="k">new</span> <span class="n">Exception</span><span class="o">();</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="k">new</span> <span class="n">Email</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">...</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>EncapsulatedPrimitives.java</span>
    </div>
</div>
<h3 id="encapsular-las-colecciones">Encapsular las colecciones</h3>
<p>En el mismo sentido que encapsular datos primitivos en clases que representan conceptos del lenguaje de dominio, es a√±adir las colecciones en una clase sin ning√∫n otro dato de instancia para insertar los m√©todos que manipulan la colecci√≥n.</p>
<p>En este ejemplo teniendo una colecci√≥n de direcciones y teniendo la necesidad de conocer cu√°l de ellas representa la direcci√≥n principal, en el caso de que la colecci√≥n no tenga su propia clase el m√©todo para obtener la direcci√≥n principal si se ubica la clase <em>User</em> el m√©todo queda enlazado con la clase <em>User</em> cuando deber√≠a estar asociado a la colecci√≥n de direcciones.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span><span class="lnt">4&#10;</span><span class="lnt">5&#10;</span><span class="lnt">6&#10;</span><span class="lnt">7&#10;</span><span class="lnt">8&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">User</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">private</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">Address</span><span class="o">&gt;</span> <span class="n">adresses</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="n">Address</span> <span class="nf">getMainAddress</span><span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">...</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>Collections.java</span>
    </div>
</div>
<p>La soluci√≥n es crear una clase que represente la colecci√≥n y entonces s√≠ es posible crear el m√©todo asociado a la colecci√≥n de direcciones.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">User</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">private</span> <span class="n">Addresses</span> <span class="n">addresses</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Addresses</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">private</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">Adresss</span><span class="o">&gt;</span> <span class="n">collection</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="n">Address</span> <span class="nf">getMainAddress</span><span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">...</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>FirstClassCollections.java</span>
    </div>
</div>
<h3 id="un-punto-por-l√≠nea-de-c√≥digo">Un punto por l√≠nea de c√≥digo</h3>
<p>En los lenguajes de programaci√≥n como Java el operador punto permite encapsular y acceder a miembros de una clase como propiedades y m√©todos. Cuando una misma l√≠nea de c√≥digo utiliza varias veces el operador punto es posible que haya un problema de encapsulaci√≥n de datos.</p>
<p>En vez de permitir que un tercero manipule un dato propio de la clase, para mantener la encapsulaci√≥n la manipulaci√≥n se ha de hacer a trav√©s de la clase. En este ejemplo la clase <em>User</em> no encapsula correctamente las direcciones como se refleja en la clase controlador.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">private</span> <span class="n">Addresses</span> <span class="n">addresses</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="n">Addresses</span> <span class="nf">getAddresses</span><span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="n">addresses</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserController</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateUser</span><span class="o">(</span><span class="n">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">user</span><span class="o">.</span><span class="na">getAddress</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">address</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>MultipleDot.java</span>
    </div>
</div>
<p>Esto se consigue evitando los m√©todos <em>getter</em> y <em>setter</em> proporcionando m√©todos m√°s espec√≠ficos para las operaciones.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">private</span> <span class="n">Addresses</span> <span class="n">addresses</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="n">Addresses</span> <span class="nf">addAddress</span><span class="o">(</span><span class="n">Address</span> <span class="n">address</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="n">addresses</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">address</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserController</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateUser</span><span class="o">(</span><span class="n">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">user</span><span class="o">.</span><span class="na">addAddress</span><span class="o">(</span><span class="n">address</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>OneDot.java</span>
    </div>
</div>
<h3 id="evitar-abreviaturas">Evitar abreviaturas</h3>
<p>Las abreviaturas permiten ahorrar teclear algunos caracteres cada vez que se utiliza la versi√≥n abreviada de la palabra. Sin embargo, las abreviaturas tienen el problema de que dificultan la legibilidad del c√≥digo, y el c√≥digo deber√≠a ser optimizado no para ser escrito sino para ser le√≠do. Con los entornos integrados de desarrollo que proporcionan asistencia de c√≥digo en la escritura en muchos casos escribir cuesta lo mismo que escribir la versi√≥n abreviada y no abreviada de una variable o m√©todo.</p>
<p>Las excepci√≥n a esta regla son aquellas abreviaturas que est√°n ampliamente aceptadas como las variables <em>i</em> y <em>j</em> como los contadores en una iteraci√≥n, <em>it</em> par el dato de la <em>lambda</em> o <em>min</em> y <em>max</em> para para indicar el m√°ximo o m√≠nimo.</p>
<h3 id="mantener-las-clases-peque√±as">Mantener las clases peque√±as</h3>
<p>Cuando una clase es muy grande es m√°s dif√≠cil de entender y de mantener. Si una clase supera cierta cantidad de l√≠neas de c√≥digo es muy posible que pueda ser dividida en una o m√°s clases m√°s peque√±as o dividir un m√©todo de muchas l√≠neas en varios m√°s peque√±os.</p>
<h3 id="evitar-los-m√©todos-_getter_-y-_setter_">Evitar los m√©todos <em>getter</em> y <em>setter</em></h3>
<p>Los m√©todos <em>getter</em> y <em>setter</em> impiden mantener la encapsulaci√≥n, las clases deben reflejar el dominio seg√∫n <em>Domain Driven Design</em>. Estos m√©todos adem√°s impiden mantener la encapsulaci√≥n de los datos y da lugar a clases an√©micas que √∫nicamente contiene propiedades y m√©todos <em>get</em> y <em>set</em>.</p>
<p>En este ejemplo para incrementar el saldo de una cuenta con m√©todos <em>get</em> y <em>set</em> un c√≥digo como el siguiente no tiene ninguna operaci√≥n de dominio. La operaci√≥n para incrementar el saldo no est√° encapsulada en la clase <em>Account</em>, en cualquier otra parte del c√≥digo que necesite realizar la operaci√≥n de incrementar el saldo hay que realizar la misma operaci√≥n. Adem√°s, de no ser muy legible la operaci√≥n de actualizaci√≥n del saldo de la cuenta en la clase controlador, se encadena varias operaciones con el operador punto.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Account</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">private</span> <span class="n">Money</span> <span class="n">balance</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="n">Money</span> <span class="nf">getBalance</span><span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="n">balance</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setBalance</span><span class="o">(</span><span class="n">Money</span> <span class="n">balance</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">this</span><span class="o">.</span><span class="na">balance</span> <span class="o">=</span> <span class="n">balance</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">AccountController</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateBalance</span><span class="o">(</span><span class="n">Account</span> <span class="n">account</span><span class="o">,</span> <span class="n">Money</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">account</span><span class="o">.</span><span class="na">setBalance</span><span class="o">(</span><span class="n">account</span><span class="o">.</span><span class="na">getBalance</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">amount</span><span class="o">));</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>GetterSetter.java</span>
    </div>
</div>
<p>A√±adiendo un m√©todo en la clase <em>Account</em> para incrementar el saldo el c√≥digo es m√°s legible. Adem√°s, el nuevo m√©todo <em>add</em> ser√≠a el lugar adecuado para insertar una validaci√≥n por ejemplo para requerir que al invocar la operaci√≥n la cantidad sea un valor positivo.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Account</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">private</span> <span class="n">Money</span> <span class="n">balance</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">Money</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="n">balance</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">amount</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">AccountController</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateBalance</span><span class="o">(</span><span class="n">Account</span> <span class="n">account</span><span class="o">,</span> <span class="n">Money</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">account</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">amount</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>DomainMethod.java</span>
    </div>
</div>
<h3 id="revisar-las-dependencias-de-las-clases">Revisar las dependencias de las clases</h3>
<p>Si una clase tiene muchas dependencias es muy posible que se convierta en una clase compleja y que realice varias tareas no relacionadas con poca cohesi√≥n. Una clase no deber√≠a tener muchas dependencias, una forma sencilla y r√°pida es analizar los <em>imports</em> de otras clases que utiliza una clase. Si tiene demasiados <em>imports</em> igual hace demasiadas cosas o tiene dependencias con cosas que no deber√≠a, por ejemplo una clase de la capa de dominio no debe tener dependencias de infraestructura.</p>
<p>Hay herramientas que permiten revisar las dependencias de forma automatizada para precisamente comprobar que las clases de un paquete no utilicen las de otros paquetes no deseados. Una de ellas es <a href="https://pmd.github.io/">PMD</a> y otra <a href="https://checkstyle.sourceforge.net/">Checkstyle</a>.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2018/02/analisis-estatico-de-codigo-con-pmd-y-un-ejemplo/">An√°lisis est√°tico de c√≥digo con PMD y un ejemplo</a></li>
</ul>
<h3 id="segregar-los-cambios-en-los-_commits_">Segregar los cambios en los <em>commits</em></h3>
<p>Utilizar una herramienta de control de versiones permite conservar todo el historial de cambios del c√≥digo fuente, por otro lado permite a varias personas colaborar y compartir los cambios unos con otros. Para hacer m√°s efectivo el uso del historial o la revisi√≥n de c√≥digo es aconsejable que los cambios de cada <em>commit</em> tengan un √∫nico objetivo, es preferible crear varios <em>commits</em> con cada acci√≥n de cambio que uno solo con todos los cambio con varias cosas mezcladas. Esta segregaci√≥n hace posible eliminar los cambios no deseados de un <em>commit</em> en concreto y hace m√°s f√°cil revisar los cambios realizados.</p>
<p>Por ejemplo, al hacer cambios es conveniente separar los cambios que arreglan un error de los cambios de formateo de c√≥digo. Separar los cambios en diferentes <em>commits</em> requiere algo de planificaci√≥n en los cambios que se desean hacer y dejar cambios para otro <em>commit</em> si se descubren nuevos cambios. con la herramienta de control de versiones <a href="https://git-scm.com/">Git</a> una opci√≥n es utilizar <em>git stash</em>, otra opci√≥n es simplemente anotar un cambio para realizarlo con posterioridad al actual.</p>
<div class="reference">
    Referencia:<br>
<ul>
<li><a href="http://williamdurand.fr/2013/06/03/object-calisthenics/">Object Calisthenics</a></li>
</ul>
</div>
]]>
        </content>
        
            
                <category term="java"/>
            
                <category term="planeta-codigo"/>
            
                <category term="programacion"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2021/10/medidas-de-seguridad-a-implementar-para-prevenir-y-minimizar-danos-en-ataques-informaticos/</id>
        <title>Medidas de seguridad a implementar para prevenir y minimizar da√±os en ataques inform√°ticos</title>
        <updated>2021-10-28T19:00:00+02:00</updated>
        <published>2021-10-28T19:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2021/10/medidas-de-seguridad-a-implementar-para-prevenir-y-minimizar-danos-en-ataques-informaticos/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Los ataques inform√°ticos dirigidos a los usuarios tienen el objetivo con una motivaci√≥n econ√≥mica del delincuente de robarles las credenciales de sus cuentas, datos de tarjetas de cr√©dito y datos personales, otros ataques est√°n dirigidos a los servicios que usan los usuarios. De los ataques dirigidos a los usuarios implementando las medidas de seguridad adecuadas en el servicio varios tipos de ataques son evitables como el <em>phishing</em> que es uno de los m√°s comunes ofreciendo inicio de sesi√≥n con segundo factor de autenticaci√≥n y con otras medidas los da√±os y riesgos son limitables. Otras medidas de seguridad implementadas en el servicio evita riesgos como usar <em>salted pasword hashing</em>. Como programadores los servicios deben hacer uso de buenas pr√°cticas e implementar medidas adicionales para evitar riesgos y da√±os.</strong></p>]]>
        <![CDATA[<p>Algunos ataques inform√°ticos est√°n dirigidos a las empresas y sus sistemas de computaci√≥n explotando alguna vulnerabilidad de seguridad. Tener un fallo de seguridad ya de por s√≠ es un grave problema para la imagen de la empresa tambi√©n con consecuencias econ√≥micas de p√©rdida de clientes o valor en la bolsa sino tambi√©n legales con posibles cuantiosas multas , adem√°s de otras consecuencias intangibles como la reputaci√≥n entre sus clientes y usuarios.</p>
<p>Otros ataques est√°n dirigidos hacia los usuarios como el robo de datos personales, bancarios o credenciales con t√©cnicas de suplantaci√≥n de identidad o <em>phishing</em>. A√∫n hoy en d√≠a muchas personas apenas tienen unos conocimientos b√°sicos de tecnolog√≠a y la mayor√≠a desconoce las medidas b√°sicas de seguridad. Estas personas a√∫n con una alfabetizaci√≥n digital muy b√°sica est√°n rodeadas de tecnolog√≠a y realizan importantes tareas como compras y transacciones bancarias. Muchas personas son v√≠ctimas de fraudes y estafas por internet, a veces por su desconocimiento pero tambi√©n a veces porque las empresas no implementan medidas de seguridad suficientes para que sus servicios sean m√°s dif√≠cil de ser explotados.</p>
<p>Los inform√°ticos tenemos una gran responsabilidad para dise√±ar sistemas seguros aplicando las mejores pr√°cticas de seguridad no solo como algo adicional a la finalizaci√≥n de una funcionalidad, sino involucrando al rol de <em>security operations</em>  o <em>SecOps</em> desde el inicio, al igual que no se deben dejar las pruebas de aseguramiento de calidad para el final la seguridad tampoco deber√≠a.
Los bancos utilizan medidas adicionales para realizar operaciones pero algunas medidas de seguridad dejan que desear en varios aspectos como requerir para todas las cuentas bancarias  iniciar sesi√≥n en la banca <em>online</em> con el n√∫mero del DNI y un c√≥digo de seis d√≠gitos, no implementar medidas de notificaci√≥n de pagos, transferencias o falta un registro de actividad completo en la cuenta digital.</p>
<p>Sin embargo, me da miedo que un banco que deber√≠a ser un referente en medidas de seguridad incluyan en la p√°gina donde los usuarios introducen sus credenciales para el acceso a la banca online recursos JavaScript de <a href="https://www.facebook.com/">Facebook</a>, <a href="https://twitter.com/">Twitter</a> y de dominios ajenos al banco que no controlan para hacer anal√≠tica web de seguimiento de usuarios.</p>
<div class="alert alert-warning pt-0 pb-0 tableofcontents"><h2>Contenido del art√≠culo</h2><toc></toc></div>
<h3 id="inyecci√≥n-de-sql-xss-_tabnabbing_-y-otras-vulnerabilidades-b√°sicas">Inyecci√≥n de SQL, XSS, <em>tabnabbing</em> y otras vulnerabilidades b√°sicas</h3>
<p>Hay errores de seguridad comunes identificados hace ya tiempo que a√∫n no est√°n obsoletos, no son errores de seguridad complejos de explotar y tampoco son errores complejos de evitar usando las t√©cnicas adecuadas de programaci√≥n o evitando utilizar ciertas operaciones en la manipulaci√≥n de datos. Varios de los errores de seguridad son por usar datos provenientes de fuentes no confiables sin aplicar el tratamiento adecuado. A√∫n siendo errores simples son peligrosos en una aplicaci√≥n vulnerable.</p>
<p>La fundaci√≥n OWASP mantiene un registro detallado de los diferentes tipos de seguridad, explicando el problema de seguridad y c√≥mo evitarlos. Tambi√©n publicar cada ciertos a√±os una lista de los 10 errores m√°s comunes durante ese a√±o.</p>
<ul>
<li><a href="https://owasp.org/www-community/attacks/">List of Attacks</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html">SQL Injection Prevention Cheat Sheet</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html">XSS Filter Evasion Cheat Sheet</a></li>
<li><a href="https://owasp.org/www-community/attacks/Reverse_Tabnabbing">Reverse Tabnabbing</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2020/05/el-problema-de-seguridad-tabnabbing-y-phishing-en-los-enlaces-en-nuevas-pestanas-a-paginas-externas-y-como-solucionarlo/">El problema de seguridad tabnabbing y phishing en los enlaces en nuevas pesta√±as a p√°ginas externas y c√≥mo solucionarlo</a></li>
</ul>
<h3 id="_salted-password-hashing_"><em>Salted Password Hashing</em></h3>
<p>Una aplicaci√≥n que guarda credenciales para autenticar a los usuarios habitualmente solicita dos datos, un identificador del usuario o de la cuenta y una contrase√±a que como solo conoce el leg√≠timo usuario permite identificarle en el sistema al iniciar sesi√≥n. Los identificadores de los usuarios y las contrase√±as la aplicaci√≥n necesita guardarlas en una base de datos para que la aplicaci√≥n las compare con las que proporciona un usuario al iniciar sesi√≥n.</p>
<p>Guardar la contrase√±a en la base de datos el valor original que el usuario ha proporcionado es un peligro ya que cualquier persona con acceso a la base de datos es capaz de conocer el valor de la contrase√±a. Para no guardar el valor original es posible utilizar una funci√≥n de <em>hash</em> de un solo sentido que permite transformar el valor original en otro derivador a partir del cual no es posible conocer el valor original pero permite conocer si es v√°lido aplicando la funci√≥n al dato proporcionado y compar√°ndolo con el guardado en la base de datos. Sin embargo, usar una funci√≥n <em>hash</em> no es suficiente ya que utilizando un ataque de diccionario con valores precalculados de <em>hashes</em> de  valores comunes de contrase√±as permite identificar cuentas con contrase√±as d√©biles.</p>
<p>La forma correcta de guardar contrase√±as es utilizando cifrado o sin cifrado utilizando una versi√≥n modificada de <em>hash</em> denominada <em>salted password hashing</em> que evita ataques de diccionario.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2015/04/guardar-contrasenas-usando-salted-password-hashing-y-otras-formas-correctas/">Guardar contrase√±as usando ¬´Salted Password Hashing¬ª y otras formas correctas</a></li>
</ul>
<h3 id="implementaci√≥n-de-segundo-factor-de-autenticaci√≥n">Implementaci√≥n de segundo factor de autenticaci√≥n</h3>
<p>Muchos usuarios no tienen conocimientos de inform√°tica, ni una alfabetizaci√≥n digital avanzada. Estos usuarios con unos conocimientos m√≠nimos utilizan la tecnolog√≠a por ser necesaria ya para muchas tareas o permitir realizarlas de forma m√°s r√°pida y sencilla. Pero incluso usuarios con muchos conocimientos avanzados de tecnolog√≠a tambi√©n son vulnerables a ciertos tipos de ataques como los de <em>phishing</em> sin las precauciones adecuadas. Los ataques de suplantaci√≥n de identidad o <em>phishing</em> son empleados por los delincuentes para robar informaci√≥n personal, credenciales de acceso a cualquier tipo de servicio y datos bancarios como tarjetas de cr√©dito.</p>
<p>Las aplicaciones que ofrecen el segundo factor de autenticaci√≥n y los usuarios que lo emplean mantienen su cuenta a salvo incluso si son v√≠ctimas de un ataque de <em>phishing</em>. Con el segundo factor de autenticaci√≥n adem√°s de la contrase√±a que es el algo que solo el usuario sabe se requiere algo que se tiene que ser√≠a un generador de c√≥digos temporales. En un ataque de <em>phishing</em> los delincuentes se hacen con lo que se sabe, si esto es lo √∫nico que permite el acceso a una cuenta es suficiente para que los delincuentes accedan a ella. Con el segundo factor de autenticaci√≥n la contrase√±a no es suficiente se requiere un c√≥digo adicional, en caso de que un ataque de <em>phishing</em> robase el c√≥digo temporal s√≥lo permitir√≠a iniciar sesi√≥n en la cuenta durante un breve periodo de tiempo habitualmente de 30 segundos.</p>
<p>Los servicios m√°s conocidos implementan el segundo factor de autenticaci√≥n que los usuarios deben activar, no es dif√≠cil de implementar en Java.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2020/11/que-es-por-que-y-como-activar-un-segundo-factor-de-autenticacion-en-google-amazon-paypal-y-otros-servicios/">Qu√© es, por qu√© y c√≥mo activar un segundo factor de autenticaci√≥n en Google, Amazon, PayPal y otros servicios</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2019/11/implementar-un-segundo-factor-de-autenticacion-en-una-aplicacion-web-java-con-spring/">Implementar un segundo factor de autenticaci√≥n en una aplicaci√≥n web Java con Spring</a></li>
</ul>
<h3 id="notificaci√≥n-de-acciones-relevantes">Notificaci√≥n de acciones relevantes</h3>
<p>Algunas operaciones son relevantes desde el punto de vista de seguridad, como el inicio de sesi√≥n, un intento fallido de inicio de sesi√≥n, cambio de contrase√±a o realizaci√≥n de algunas operaciones en el √°mbito de la aplicaci√≥n. Para mejorar la seguridad conviene enviar en este tipo de acciones una notificaci√≥n al usuario que permita advertir ante acciones que se puedan realizar sin su conocimiento. Las notificaciones permiten al usuario tomar medidas en caso de que detecte acciones fraudulentas. Las notificaciones pueden ser a trav√©s de un correo electr√≥nico, mensaje SMS o a trav√©s de mensajer√≠a instant√°nea.</p>
<p>Estos son dos ejemplos de correos electr√≥nicos que env√≠a <a href="https://www.google.com/intl/es/gmail/about/">Gmail</a> y <a href="https://es.wallapop.com/">Wallapop</a> para notificar al usuario de un nuevo inicio de sesi√≥n en su cuenta.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2021/10/medidas-de-seguridad-a-implementar-para-prevenir-y-minimizar-danos-en-ataques-informaticos/images/gmail-inicio-sesion_huee3b0496a171157529c82e29f9f8cebc_80671_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Notificaci√≥n de Gmail de inicio de sesi√≥n"><img src="https://picodotdev.github.io/blog-bitix/2021/10/medidas-de-seguridad-a-implementar-para-prevenir-y-minimizar-danos-en-ataques-informaticos/images/gmail-inicio-sesion_huee3b0496a171157529c82e29f9f8cebc_80671_300x200_fit_q90_h2_box_3.webp" width="161" height="200" alt="Notificaci√≥n de Gmail de inicio de sesi√≥n" title="Notificaci√≥n de Gmail de inicio de sesi√≥n" class="&#34; " loading="lazy"></a>
<a href="https://picodotdev.github.io/blog-bitix/2021/10/medidas-de-seguridad-a-implementar-para-prevenir-y-minimizar-danos-en-ataques-informaticos/images/wallapop-inicio-sesion_hu62f37908c47c484e5c6522c4c79fd755_123506_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Notificaci√≥n de Wallapop de inicio de sesi√≥n"><img src="https://picodotdev.github.io/blog-bitix/2021/10/medidas-de-seguridad-a-implementar-para-prevenir-y-minimizar-danos-en-ataques-informaticos/images/wallapop-inicio-sesion_hu62f37908c47c484e5c6522c4c79fd755_123506_300x200_fit_q90_h2_box_3.webp" width="103" height="200" alt="Notificaci√≥n de Wallapop de inicio de sesi√≥n" title="Notificaci√≥n de Wallapop de inicio de sesi√≥n" class="&#34; " loading="lazy"></a></p>
<figcaption>Correos electr√≥nicos de notificaci√≥n de inicio de sesi√≥n</figcaption>
</figure>
</div>
<h3 id="registro-de-actividad">Registro de actividad</h3>
<p>Mantener un registro de la actividad es otra variante para dar visibilidad y permitirle al usuario identificar actividad fraudulenta en su cuenta en caso de que haya sido v√≠ctima de un ataque o sus credenciales hayan sido robadas. Algunos servicios mantienen un registro con las fechas de los √∫ltimos inicios de sesi√≥n, la direcci√≥n IP de la computadora junto con su geolocalizaci√≥n que permite conocer su ubicaci√≥n aproximada, el navegador usado, sistema operativo o fecha de √∫ltimos cambios de contrase√±a.</p>
<p>Adem√°s de proporcionar al usuario un registro de actividad al mismo tiempo este conviene guardarlo en los registros del propio servicio en caso de necesitar investigar actividad sospechosa.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2021/10/medidas-de-seguridad-a-implementar-para-prevenir-y-minimizar-danos-en-ataques-informaticos/images/gmail-registro-actividad_hu684b93583f6beeef0a82426816b767c2_138167_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Registro de actividad en una cuenta de Gmail"><img src="https://picodotdev.github.io/blog-bitix/2021/10/medidas-de-seguridad-a-implementar-para-prevenir-y-minimizar-danos-en-ataques-informaticos/images/gmail-registro-actividad_hu684b93583f6beeef0a82426816b767c2_138167_300x200_fit_q90_h2_box_3.webp" width="178" height="200" alt="Registro de actividad en una cuenta de Gmail" title="Registro de actividad en una cuenta de Gmail" class="&#34; " loading="lazy"></a></p>
<figcaption>Registro de actividad en una cuenta de Gmail</figcaption>
</figure>
</div>
<h3 id="establecer-l√≠mites-de-uso">Establecer l√≠mites de uso</h3>
<p>Ya sea por una fallo de seguridad en un servicio vulnerable que ha sufrido un ataque o por un ataque dirigido al usuario por ejemplo con un ataque de <em>phishing</em> es posible implementar medidas no dirigidas a evitar los ataques sino a mitigar o reducir los posibles da√±os de un posible ataque.</p>
<p>Para mitigar los posibles da√±os un servicio puede implementar medidas para limitar los datos como establecer un l√≠mite de intentos fallidos de inicio de sesi√≥n antes de bloquear la cuenta de forma temporal. Los bancos por ejemplo permiten activar o desactivar las tarjetas de cr√©dito a petici√≥n del cliente que impidan la autorizaci√≥n de operaciones, con esta medida aunque un usuario haya sido atacado y un delincuente haya robado los datos de su tarjeta de cr√©dito este puede desactivarla para evitar operaciones fraudulentas con ella unido a la notificaci√≥n de acciones relevante un usuario puede actuar para evitar m√°s da√±os. Otras medidas que utilizan los bancos son establecer l√≠mites de disposici√≥n de efectivo diario, importe m√°ximo de transferencias, importe m√°ximo en comercios f√≠sicos y electr√≥nicos y de compras por internet.</p>
<h3 id="cifrar-informaci√≥n-personal">Cifrar informaci√≥n personal</h3>
<p>Los datos personales est√°n protegidos por leyes, un fallo de seguridad con el resultado de robo de datos personales tambi√©n tiene consecuencias legales para la empresa con importantes multas y econ√≥micas por p√©rdida de clientes y mala imagen.</p>
<p>Los datos a proteger de los usuario son aquellos que permita identificarlos como nombre y apellidos, DNI, direcci√≥n de correo electr√≥nico, direcci√≥n del domicilio, n√∫mero de tel√©fono y por supuesto datos bancarios como n√∫mero de cuenta y tarjetas de cr√©dito.</p>
<p>Para evitar el riesgo de un ataque dirigido al servicio que ocasione una fuga de datos es conveniente cifrarlos. Incluso para que los empleados que trabajan en la empresa no conozcan a qui√©n corresponden esos datos.</p>
<p>Cifrados los datos aun teniendo acceso a ellos la informaci√≥n est√° protegida ya que es necesario descifrarlos para obtener el valor original.</p>
<p>Vault es una aplicaci√≥n que ofrece el cifrado como servicio entre otras funcionalidades de seguridad.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2021/02/cifrado-y-descifrado-como-servicio-con-vault/">Cifrado y descifrado como servicio con Vault</a></li>
</ul>
<h3 id="informar-a-los-usuarios">Informar a los usuarios</h3>
<p>Para prevenir fraudes otras medidas sencillas son informar a los usuarios de unas medidas b√°sicas de prevenci√≥n de fraude y explicar c√≥mo son los procedimientos de comunicaci√≥n.</p>
<p>Algunos son desconfiar de mensajes inesperados, no acceder a enlaces de mensajes SMS, de mensajer√≠a instant√°nea y leer con atenci√≥n la direcci√≥n en el navegador de los enlaces a los que se acceder.</p>
<p>Nunca facilitar datos personales, credenciales de acceso a una cuenta no datos de tarjetas bancarias. Tampoco descargar ni instalar aplicaciones si no provienen de las tiendas oficiales del dispositivo. Y activar las notificaciones para conocer la actividad en la cuenta del servicio.</p>
<h3 id="comunicaciones-entre-servicios">Comunicaciones entre servicios</h3>
<p>La arquitectura de las aplicaciones tienden a dise√±arse de forma que ofrezcan un medio de invocar sus funcionalidades mediante llamadas de red ya sea con el protocolo HTTP mediante REST, GraphQL o gRPC.</p>
<p>Para autorizar las llamadas a los servicios estos han de implementar alguna forma de autenticaci√≥n y autorizaci√≥n por ejemplo con OAuth y JWT.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2016/09/autenticacion-con-oauth-y-keycloak-en-un-servicio-rest-con-jax-rs-y-spring-boot/">Autenticaci√≥n con OAuth y Keycloak en un servicio REST con JAX-RS y Spring Boot</a></li>
</ul>
<p>Otra forma de proteger los servicios m√°s sencilla sin que cada uno de ellos tenga que implementar las funcionalidades de autenticaci√≥n y autorizaci√≥n es utilizar un <em>service mesh</em>. <a href="https://www.consul.io/">Consul</a> adem√°s de ser un servicio que ofrece registro y descubrimiento ofrece la funcionalidad de conexi√≥n entre servicios con cifrado, autenticaci√≥n mutua y autorizaci√≥n especificando qu√© servicio est√° autorizado a comunicarse con cual.</p>
<p>Con las funcionalidades de conexi√≥n de Consul los servicios no es necesario que implementen el cifrado, autenticaci√≥n y autorizaci√≥n. Los servicios tienen menos responsabilidades, son m√°s sencillos y la autorizaci√≥n de la comunicaci√≥n es gestionada desde Consul.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2020/07/comunicaciones-seguras-autenticacion-mutua-y-autorizaciones-con-intenciones-entre-servicios-usando-consul-connect-y-nomad/">Comunicaciones seguras, autenticaci√≥n mutua y autorizaciones con intenciones entre servicios usando Consul Connect y Nomad</a></li>
</ul>
<h3 id="contrase√±as-en-repositorios-de-c√≥digo-fuente-y-artefactos-compilados">Contrase√±as en repositorios de c√≥digo fuente y artefactos compilados</h3>
<p>La seguridad de las aplicaciones se basa en contrase√±as, claves privadas y certificados que √∫nicamente las aplicaciones y los administradores de los servicios deben tener acceso.</p>
<p>Las credenciales deben ser guardadas aparte del c√≥digo fuente de la aplicaci√≥n, fuera de la herramienta de control de versiones. Incluso las credenciales en una clase Java compila a <em>bytecode</em> es posible acceder a ellas.</p>
<p>Estos secretos deben proporcionarse a las aplicaciones en tiempo de ejecuci√≥n por el orquestador de procesos, el entorno de ejecuci√≥n en la nube o de un servicio espec√≠fico de seguridad del que obtenerlo. Para mayor seguridad las propiedades con secretos de los archivos de configuraci√≥n en el sistema de archivos deben evitarse.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2019/01/las-contrasenas-e-informacion-sensible-en-el-codigo-fuente-o-bytecode-de-java-no-son-seguras/">Las contrase√±as e informaci√≥n sensible en el c√≥digo fuente o <em>bytecode</em> de Java no son seguras</a></li>
</ul>
<h3 id="otras">Otras</h3>
<p>Otra medida de seguridad es ofrecer la posibilidad de eliminar una cuenta o desactivarla tras un periodo de inactividad prolongado.</p>
<ul>
<li><a href="https://www.whitesourcesoftware.com/resources/blog/application-security-best-practices/">Application Security Best Practices</a></li>
<li><a href="https://techbeacon.com/security/7-must-dos-delivering-app-focused-security">7 must-dos for delivering app-focused security</a></li>
</ul>
<div class="reference">
    Referencia:<br>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Application_security">Application security</a></li>
</ul>
</div>
]]>
        </content>
        
            
                <category term="planeta-codigo"/>
            
                <category term="programacion"/>
            
                <category term="seguridad"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/</id>
        <title>Los diagramas UML para documentar y una aplicaci√≥n para crearlos</title>
        <updated>2021-09-02T20:00:00+02:00</updated>
        <published>2021-09-02T20:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Todo el conocimiento est√° en el c√≥digo fuente pero este no tiene una forma de f√°cil y r√°pida comprensi√≥n a alto nivel, para comprender un sistema es necesario una forma de documentaci√≥n que muestre los detalles importantes de los que se compone el sistema. El lenguaje unificado de desarrollo o UML permite describir un sistema utilizando diferentes diagramas espec√≠ficos para mostrar diferentes aspectos del sistema. Gaphor es una aplicaci√≥n de software libre disponible para diferentes sistemas operativos que permite crear y exportar a im√°genes los diferentes diagramas.</strong></p>]]>
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/gaphor.svg" width="200" height="200" alt="Gaphor" title="Gaphor" class="" loading="false&#34;"></p>
</div>
<p>El trabajo de desarrollo de software en mayor media es un trabajo colaborativo entre un grupo de personas, por ello la comunicaci√≥n y transmisi√≥n de informaci√≥n es fundamental. Por otro lado, los sistemas inform√°ticos de cierto tama√±o son complejos de los cuales ninguna persona tiene el conocimiento completo y detallado de todas las partes que lo forman. Esto hace que la documentaci√≥n y la transferencia de conocimiento sea importante en un grado similar al desarrollo de nuevas funcionalidades.</p>
<p>El problema de la documentaci√≥n es que se quede obsoleta ni refleje el estado actual del sistema por los continuos cambios realizados en el c√≥digo, para evitarlo la documentaci√≥n ha de ser a alto nivel que describan los conceptos fundamentales del sistema que no ser√°n propensos a cambiar. Otra forma de evitar esta obsolescencia en algunos casos es generar la documentaci√≥n a partir de la informaci√≥n embebida en el c√≥digo fuente como <a href="https://picodotdev.github.io/blog-bitix/2017/09/la-herramienta-de-documentacion-javadoc-de-java/">la documentaci√≥n Javadoc de las clases y API de Java</a> o <a href="https://picodotdev.github.io/blog-bitix/2021/07/como-documentar-una-api-rest-con-swagger-implementada-con-spring-boot/">la documentaci√≥n de una API REST con Swagger</a>. Sin embargo, no toda la documentaci√≥n que aporta valor es posible generarla de forma automatizada.</p>
<p>El c√≥digo fuente de una aplicaci√≥n contiene el conocimiento m√°s detallado y fiel de una aplicaci√≥n , sin embargo, tratar de comprender un sistema complejo compuesto por unas cuantas decenas de miles de l√≠neas de c√≥digo a√∫n usando un lenguaje de alto nivel ya sea Java , Python o C# es una tarea complicada o al menos que requiere mucho tiempo de investigaci√≥n y esfuerzo de comprensi√≥n. Una breve descripci√≥n en prosa y un esquema del sistema permite obtener la misma informaci√≥n que analizando el c√≥digo de forma mucho m√°s r√°pida.</p>
<p>Si en una organizaci√≥n cuando una persona la abandona deja un vac√≠o importante de conocimiento en las reglas de negocio implementadas o en la incorporaci√≥n de una nueva persona a un equipo toma demasiado tiempo y dedicaci√≥n adquirir el mismo conocimiento que el resto de miembros del equipo un problema de la organizaci√≥n quiz√° sea la falta de documentaci√≥n. Con el paso del tiempo a medida que una aplicaci√≥n es m√°s compleja y dado que las personas en una organizaci√≥n se van con el conocimiento que posean y otras vienen pero necesitan adquirir conocimiento, la documentaci√≥n es una forma de transferencia de conocimiento que est√° disponible de forma permanente y en forma de autoservicio.</p>
<p>Una buena documentaci√≥n ha de se concisa y transmitir su informaci√≥n de forma r√°pida, una forma es utilizar diagramas que esquematizan el sujeto que se trata de describir complementados descripciones en texto. El lenguaje unificado de modelado o UML describe una notaci√≥n est√°ndar para los diagramas y varios tipos de diagramas.</p>
<div class="alert alert-warning pt-0 pb-0 tableofcontents"><h2>Contenido del art√≠culo</h2><toc></toc></div>
<h3 id="el-lenguaje-unificado-de-modelado-o-uml">El lenguaje unificado de modelado o UML</h3>
<p><a href="https://es.wikipedia.org/wiki/Lenguaje_unificado_de_modelado">El lenguaje unificado de desarrollo</a> o UML estandariza las convenciones y elementos utilizados en los diagramas adem√°s de identificar y describir varios tipos de diagramas para describir un sistema desde varios puntos de vista. Cada uno de estos diagramas describen un sistema a alto nivel de forma esquematizada los conceptos fundamentales.</p>
<p>Los diagramas UML son de dos tipos estructurales que describen la parte est√°tica del sistema y de comportamiento que describen la parte din√°mica.</p>
<p>Diagramas UML estructurales:</p>
<ul>
<li><a href="https://es.wikipedia.org/wiki/Diagrama_de_clases">Diagrama de clases</a>: en un lenguaje de programaci√≥n orientado a objetos muestra las clases e interfaces por las que est√° compuesto el sistema y sus relaciones de herencia, composici√≥n e implementaci√≥n con diferentes tipos de flechas. Tambi√©n muestra los atributos y m√©todos que poseen las clases.</li>
<li><a href="https://es.wikipedia.org/wiki/Diagrama_de_paquetes">Diagrama de paquetes</a>: los paquetes son agrupaciones l√≥gicas de varias clases, en este diagrama se muestran los paquetes fundamentales asi como su relaci√≥n y dependencia con otros.</li>
<li><a href="https://es.wikipedia.org/wiki/Diagrama_de_objetos">Diagrama de objetos</a>: utilizan la misma notaci√≥n que los diagramas de clases, se diferencian de los diagramas de clases en que muestran las instancias en un momento determinado del sistema.</li>
<li><a href="https://es.wikipedia.org/wiki/Diagrama_de_componentes">Diagrama de componentes</a>: muestran los componentes fundamentales en los que se divide un sistema complejo y sus relaciones.</li>
<li><a href="https://es.wikipedia.org/wiki/Diagrama_de_estructura_compuesta">Diagrama de estructura compuesta</a>: muestra la estructura interna de una clase.</li>
<li><a href="https://es.wikipedia.org/wiki/Diagrama_de_despliegue">Diagrama de despliegue</a>: muestra en que elementos de computaci√≥n se despliega el software asi como sus relaciones. Son especialmente √∫tiles en los sistemas distribuidos o basados en microservicios.</li>
</ul>
<p>Diagramas UML de comportamiento:</p>
<ul>
<li><a href="https://es.wikipedia.org/wiki/Diagrama_de_flujo">Diagrama de flujo</a> o actividad: muestra la secuencia de acciones y decisiones implementadas en un algoritmo o proceso.</li>
<li><a href="https://es.wikipedia.org/wiki/Diagrama_de_secuencia">Diagrama de secuencia</a>: muestran las interacciones de los objetos entre si y el orden en el que se producen esas interacciones. El orden de las acciones se muestran de forma vertical y las interacciones como flechas.</li>
<li><a href="https://es.wikipedia.org/wiki/Diagrama_de_casos_de_uso">Diagrama de caso de uso</a>: proporciona una visi√≥n general de los actores involucrados en un sistema, las diferentes funciones que usa esos actores y c√≥mo interact√∫an estas diferentes funciones. Proporciona un descripci√≥n global del sistema inicial.</li>
<li>Diagrama de estado: algunos objetos o el sistema se comportan de forma diferente en funci√≥n del estado, estos diagramas muestran los diferentes estados de los que se compone y cual es su comportamiento en funci√≥n del estado y condiciones.</li>
<li><a href="https://es.wikipedia.org/wiki/Diagrama_de_comunicaci%C3%B3n">Diagrama de comunicaci√≥n</a></li>
<li><a href="https://es.wikipedia.org/wiki/Diagrama_global_de_interacciones">Diagrama de interacci√≥n</a>: muestra un proceso al igual que un diagrama de actividad pero empleando una colecci√≥n de diagramas de secuencia con su misma notaci√≥n.</li>
<li><a href="https://es.wikipedia.org/wiki/Diagrama_de_tiempos">Diagrama de tiempos</a></li>
</ul>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/uml-diagrams.svg" data-gallery="" title="Esquema de diagramas UML"><img src="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/uml-diagrams.svg" width="650" height="450" alt="Esquema de diagramas UML" title="Esquema de diagramas UML" class="&#34; " loading="lazy"></a></p>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/uml-sequence-diagram.svg" data-gallery="" title="Diagramas UML"><img src="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/uml-sequence-diagram.svg" width="300" height="250" alt="Diagramas UML" title="Diagramas UML" class="&#34; " loading="lazy"></a>
<a href="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/uml-activity-diagram.svg" data-gallery="" title="Diagramas UML"><img src="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/uml-activity-diagram.svg" width="300" height="250" alt="Diagramas UML" title="Diagramas UML" class="&#34; " loading="lazy"></a></p>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/uml-use-case-diagram.svg" data-gallery="" title="Diagramas UML"><img src="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/uml-use-case-diagram.svg" width="200" height="150" alt="Diagramas UML" title="Diagramas UML" class="&#34; " loading="lazy"></a>
<a href="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/uml-class-diagram.svg" data-gallery="" title="Diagramas UML"><img src="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/uml-class-diagram.svg" width="200" height="150" alt="Diagramas UML" title="Diagramas UML" class="&#34; " loading="lazy"></a>
<a href="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/uml-components-diagram_hu05de9b6e8664b2cd5ad22858fe2d2771_25693_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Diagramas UML"><img src="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/uml-components-diagram_hu05de9b6e8664b2cd5ad22858fe2d2771_25693_200x150_fit_q90_h2_box_3.webp" width="200" height="134" alt="Diagramas UML" title="Diagramas UML" class="&#34; " loading="lazy"></a></p>
<figcaption>Esquema y ejemplos de diagramas UML</figcaption>
</figure>
</div>
<h3 id="aplicaci√≥n-para-crear-diagramas-de-uml">Aplicaci√≥n para crear diagramas de UML</h3>
<p>Para crear los diagramas de UML es necesario utilizar una aplicaci√≥n, una orientada y especifica para crear diagramas UML es <a href="https://gaphor.org/">Gaphor</a>. Est√° disponible a trav√©s de <a href="https://flathub.org/apps/details/org.gaphor.Gaphor">aplicaci√≥n Flatpak</a> como <a href="https://picodotdev.github.io/blog-bitix/2018/11/flatpak-distribucion-e-instalacion-de-programas-de-escritorio-en-las-distribuciones-gnu-linux/">forma de empaquetar una aplicaci√≥n para cualquier distribuci√≥n GNU/Linux</a>,¬†para <a href="https://www.microsoft.com/es-es/windows/">Windows</a> y <a href="https://www.apple.com/macos/">macOS</a> adem√°s de ser una aplicaci√≥n de software libre. Gaphor es una aplicaci√≥n sencilla con un aspecto cuidado que forma parte del <a href="https://apps.gnome.org/es/">c√≠rculo de aplicaciones de GNOME</a> y sigue la gu√≠a de estilos para las aplicaciones de este escritorio.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/gaphor_hud62cbdecb255b8a2c9c1baf867fa06c9_101875_2560x1440_fit_q90_h2_box_3.webp" data-gallery=""><img src="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/gaphor_hud62cbdecb255b8a2c9c1baf867fa06c9_101875_650x450_fit_q90_h2_box_3.webp" width="648" height="450" class="&#34; " loading="lazy"></a></p>
<figcaption>Aplicaci√≥n Gaphor para crear diagramas UML</figcaption>
</figure>
</div>
<p>En el panel izquierdo se encuentran los elementos gr√°ficos con los que crear los diferentes diagramas. Los elementos gr√°ficos est√°n categorizados para crear diagramas de clases, paquetes y componentes, tambi√©n para diagramas de actividad, secuencia, estado y casos de uso, los otros diagramas se pueden crear con los elementos disponibles.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/gaphor-use-case-diagram_huc172453d1be757fbb9bedeb5a1766da9_144012_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Crear diagramas UML con Gaphor"><img src="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/gaphor-use-case-diagram_huc172453d1be757fbb9bedeb5a1766da9_144012_300x200_fit_q90_h2_box_3.webp" width="287" height="200" alt="Crear diagramas UML con Gaphor" title="Crear diagramas UML con Gaphor" class="&#34; " loading="lazy"></a>
<a href="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/gaphor-class-diagram_hu1f549975f2e991c56cd0f08319adb36c_121622_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Crear diagramas UML con Gaphor"><img src="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/gaphor-class-diagram_hu1f549975f2e991c56cd0f08319adb36c_121622_300x200_fit_q90_h2_box_3.webp" width="287" height="200" alt="Crear diagramas UML con Gaphor" title="Crear diagramas UML con Gaphor" class="&#34; " loading="lazy"></a>
<a href="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/gaphor-sequence-diagram_hua4964415d416ef25abd0c8bdf478abe2_124577_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="Crear diagramas UML con Gaphor"><img src="https://picodotdev.github.io/blog-bitix/2021/09/los-diagramas-uml-para-documentar-y-una-aplicacion-para-crearlos/images/gaphor-sequence-diagram_hua4964415d416ef25abd0c8bdf478abe2_124577_300x200_fit_q90_h2_box_3.webp" width="287" height="200" alt="Crear diagramas UML con Gaphor" title="Crear diagramas UML con Gaphor" class="&#34; " loading="lazy"></a></p>
<figcaption>Crear diagramas UML con Gaphor</figcaption>
</figure>
</div>
<p>Gaphor permite guardar en un mismo archivo m√∫ltiples diagramas que describan los diferentes aspectos del sistema asi como exportar los diagramas a diferentes formatos de archivo como PDF y forma to de imagen como¬†PNG y SVG. Otras de sus funciones son poder personalizar los estilos de los elementos con reglas de CSS. Finalmente, UML es simplemente una de los est√°ndares para crear diagramas, Gaphor soporta otro tipos de est√°ndares como el modelo C4, RAAML y SysML.</p>
]]>
        </content>
        
            
                <category term="planeta-codigo"/>
            
                <category term="programacion"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2021/08/the-three-ways-y-the-five-ideals-de-los-libros-the-devops-handbook-the-phoenix-project-y-the-unicorn-project/</id>
        <title>The three ways y The five ideals de los libros The DevOps Handbook, The Phoenix Project y The Unicorn Project</title>
        <updated>2021-08-25T20:00:00+02:00</updated>
        <published>2021-08-25T20:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2021/08/the-three-ways-y-the-five-ideals-de-los-libros-the-devops-handbook-the-phoenix-project-y-the-unicorn-project/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>En la trilog√≠a de los libros <em>The DevOps Handbook</em>, <em>The Phoenix Project</em> y <em>The Unicorn Project</em> se explican m√°s detalladamente varios principios para conseguir que la cadena de valor en un producto de software funcione de forma correcta y evitar en gran medida muchos problemas comunes, son los principios denominados como <em>The three ways</em> y <em>The five ideals</em>.</strong></p>]]>
        <![CDATA[<p>Una f√°brica que manufactura objetos f√≠sicos en una cadena de montaje en varios pasos, pueden ser coches o mesas de escritorio, puede parecer que no tiene mucho que ver con el desarrollo de software ya que en este √∫ltimo no se fabrican objetos f√≠sicos sino software que es algo intangible que no tiene una representaci√≥n f√≠sica.</p>
<p>Sin embargo, en realidad una cadena de montaje de objetos f√≠sicos tiene muchos puntos en com√∫n al desarrollo de software, en ambos casos se siguen una secuencia de pasos o cadena de valor desde que llega una orden hasta que √©sta es entregada al cliente. En el caso de una f√°brica de coches se producen coches y en un desarrollo de software se producen funcionalidades en una aplicaci√≥n.</p>
<p>Los mismos principios que se aplican en una cadena de valor en una cadena de montaje de una f√°brica tambi√©n se pueden aplicar al desarrollo de software para producir software, esos principios y metodolog√≠as permiten fabricar de forma eficiente y evitar problemas en la cadena de valor. Estos principios y metodolog√≠as identificados en varias organizaciones que tienen un gran rendimiento en su cadena de valor se resumen en <em>The three ways</em> y <em>The five ideals</em>.</p>
<div class="alert alert-warning pt-0 pb-0 tableofcontents"><h2>Contenido del art√≠culo</h2><toc></toc></div>
<h3 id="_the-three-ways_"><em>The three ways</em></h3>
<p><em>The three ways</em> son tres principios que se centran en el aspecto productivo, estos principios son explicados en el libro <a href="https://amzn.to/2UFmLzB">The DevOps Handbook</a> de una forma te√≥rica, detallada y extensa y en el libro <a href="https://amzn.to/3zcYDDC">The Phoenix Project</a> que son el argumento subyacente de una historia de ficci√≥n sobre una empresa con problemas en sus proyectos de software, algunos son reconocibles a los que uno pueda tener en su organizaci√≥n.</p>
<p>El libro empieza con los personajes de una empresa con multitud de problemas en el desarrollo que hacen peligrar la viabilidad de la empresa en una √©poca en la que la tecnolog√≠a est√° transformando su negocio, a lo largo del libro y con la gu√≠a de un cierto personaje misterioso van aplicando varias mejoras de forma paulatina que les permite recuperar el control.</p>
<p>Parte de la base de <em>The three ways</em> se fundamenta o es similar los principios definidos en el libro <a href="https://amzn.to/3B73QgE">Lean Enterprise</a>, el movimiento √°gil y el movimiento de entrega continua.</p>
<p>En mi experiencia profesional de t√≠pica consultor√≠a inform√°tica no hice pr√°cticamente ninguna de las pr√°cticas de los libros ni siquiera lo m√°s b√°sico como pruebas pruebas unitarias. Sin embargo, en otra experiencia profesional de una empresa de producto quiz√° no todos pero muchas de las pr√°cticas de estos principios si que los veo identificados.</p>
<p>Son libros muy recomendables de leer en los que se mencionan muchos otros bastante populares como <a href="https://amzn.to/2WhI4bx">Release it!</a>, <a href="https://amzn.to/3Dh6IJI">The Mythical Man Month</a>, <a href="https://amzn.to/2XLNtHZ">Continuous Delivery</a>, <a href="https://amzn.to/38c7mtE">The Pragmatic Programmer</a>, <a href="https://amzn.to/3sKn4WB">Extreme Programming Explained</a>.</p>
<div class="media media-amazon">
  <iframe style="width:120px;height:240px;" width="120" height="240" scrolling="no" frameborder="0" src="https://rcm-eu.amazon-adsystem.com/e/cm?lt1=_blank&amp;bc1=000000&amp;IS2=1&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;t=blobit-21&amp;language=es_ES&amp;o=30&amp;p=8&amp;l=as4&amp;m=amazon&amp;f=ifr&amp;ref=as_ss_li_til&amp;asins=1942788002&amp;linkId=9bde9b606b1e5d657881bee89a764d08" title="Amazon" class="lozad"></iframe>
  <iframe style="width:120px;height:240px;" width="120" height="240" scrolling="no" frameborder="0" src="https://rcm-eu.amazon-adsystem.com/e/cm?lt1=_blank&amp;bc1=000000&amp;IS2=1&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;t=blobit-21&amp;language=es_ES&amp;o=30&amp;p=8&amp;l=as4&amp;m=amazon&amp;f=ifr&amp;ref=as_ss_li_til&amp;asins=1942788290&amp;linkId=12422320bbd79294d7fd0b73ab29b714" title="Amazon" class="lozad"></iframe>
  <iframe style="width:120px;height:240px;" width="120" height="240" scrolling="no" frameborder="0" src="https://rcm-eu.amazon-adsystem.com/e/cm?lt1=_blank&amp;bc1=000000&amp;IS2=1&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;t=blobit-21&amp;language=es_ES&amp;o=30&amp;p=8&amp;l=as4&amp;m=amazon&amp;f=ifr&amp;ref=as_ss_li_til&amp;asins=1492091774&amp;linkId=2e0e926c66741529fa1963ab16f581d9" title="Amazon" class="lozad"></iframe>
</div>
<h4 id="_the-first-way-the-technical-practices-of-flow_"><em>The first way: The technical practices of flow</em></h4>
<p>El primer principio trata sobre la efectividad del flujo de trabajo, para medirlo toma como m√©trica principal el tiempo entre que entra una petici√≥n y esta es entregada que se denomina como el <em>lead time</em>. En el caso de desarrollo de software desde se crea una petici√≥n hasta que √©sta es desplegada en producci√≥n, su finalizaci√≥n engloba el despliegue no solo su desarrollo. Las pr√°cticas de este principio tratan de mejorar y evitar problemas en esta m√©trica.</p>
<p>Hay que tener en cuenta que dos partes de la cadena de valor tiene objetivos diferentes, el √°rea de desarrollo requiere de realizar despliegues de forma continua que potencialmente introducen errores, por otro lado el √°rea de operaciones requiere que los entornos sean estables y que los servicios no tengan errores por un cambio ni ca√≠das de servicio. Reducir la frecuencia de los despliegues para no introducir errores no resuelve los errores sino que¬† lo agrava al ser despliegues m√°s grandes. La opci√≥n es automatizar en la mayor medida posible las pruebas y el procesos de los despliegues, de modo que el conjunto de cambios est√© probado por las pruebas y sea m√°s peque√±o para f√°cil identificar la causa de un error m√°s f√°cilmente y no requiera intervenciones manuales que evite esperas.</p>
<p>El software al ser algo intangible es m√°s dif√≠cil de conocer su estado e identificar d√≥nde hay alg√∫n problema en la cadena de valor. Para visualizar el estado del trabajo se emplean los paneles kanban que agrupan en columnas seg√∫n el estado las peticiones, de esta forma es posible visualizar r√°pidamente qu√© peticiones han sido desplegadas, que peticiones est√°n el la cola de despliegue, que peticiones est√°n siendo probadas, que peticiones est√°n en desarrollo y cuales est√°n a la espera de ser desarrolladas. Este panel permite ver si en una determinada columna se est√°n acumulando muchas peticiones. El panel kanban permite ver el trabajo en progreso o <em>work in progress</em>¬† en la columna de peticiones en desarrollo o ver el tama√±o del lote o <em>batch size</em> en la columna de peticiones a la espera de ser desplegadas.</p>
<p>Otra forma de visibilizar el trabajo es hacer reuniones diarias que sirven para compartir informaci√≥n en la que cada miembro del equipo comenta en que estuvo trabajando el d√≠a anterior, en que trabajar√° durante el d√≠a y si existe alg√∫n bloqueo. El resto de los miembros del equipo quiz√° puedan ayudar a eliminar ese bloqueo o proporcionar alguna ayuda.</p>
<p>Conociendo el dato del trabajo en progreso y del tama√±o del lote permite limitarlos, ya que si son grandes es posible que causen problemas en la cadena de valor. Por ejemplo, un trabajo en progreso muy grande ocasiona que se est√© haciendo mucho trabajo pero que poco est√© siendo terminado o generando problemas de cambio de contexto entre diferentes peticiones, un tama√±o de lote grande es un problema ya que si hay alg√∫n problema en un despliegue ser√° m√°s dif√≠cil identificar cu√°l de las peticiones es la causante.</p>
<p>Para evitar entregar defectos en el siguiente paso de la cadena de valor una pr√°ctica es implementar teses unitarios del c√≥digo. Otro de los problemas en la cadena de valor es el cambio de manos del trabajo o <em>handoffs</em> entre diferentes personas, por ejemplo de una persona de desarrollo a una de operaciones ya que se requiere coordinaci√≥n y comunicaci√≥n. Para evitar los problemas de los <em>handoffs</em> conviene automatizar en la medida de lo posible cosas como la creaci√≥n de entornos de prueba o el despliegue de forma que las personas sean autosuficientes.</p>
<p>Para evitar riesgos en la publicaci√≥n de funcionalidades √©stas se pueden desplegar de forma progresiva obteniendo informaci√≥n de forma m√°s temprana que en el caso de publicarla en un momento determinado de forma completa. Para ello se utilizan los <em>feature flags</em> que permiten activar una funcionalidad a voluntad. Publicar la funcionalidad de forma progresiva y activarla con un <em>feature flag</em> permite reducir el tama√±o del lote y obtener <em>feedback</em> de forma m√°s temprana.</p>
<p>Tambi√©n conviene eliminar trabajo desperdiciado como un exceso de peticiones realizadas pero no desplegadas, realizar peticiones que no aportan valor, realizar m√°s de lo necesario, evitar <em>handoffs</em>, evitar esperas y defectos.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2021/08/the-three-ways-y-the-five-ideals-de-los-libros-the-devops-handbook-the-phoenix-project-y-the-unicorn-project/images/the-first-way_huf6470707fad182ac1c80eb63f8378501_10918_2560x1440_fit_q90_h2_box.webp" data-gallery="" title="The first way"><img src="https://picodotdev.github.io/blog-bitix/2021/08/the-three-ways-y-the-five-ideals-de-los-libros-the-devops-handbook-the-phoenix-project-y-the-unicorn-project/images/the-first-way_huf6470707fad182ac1c80eb63f8378501_10918_650x450_fit_q90_h2_box.webp" width="400" height="191" alt="The first way" title="The first way" class="&#34; " loading="lazy"></a></p>
<figcaption>The first way</figcaption>
</figure>
</div>
<h4 id="_the-second-way-the-technical-practices-of-feedback_"><em>The second way: The technical practices of feedback</em></h4>
<p>Una vez el flujo es correcto para mejorar la cadena de valor es necesario obtener informaci√≥n lo antes posible. Para ello se utilizan pr√°cticas como integraci√≥n continua en la que cada <em>commit</em> al repositorio de c√≥digo fuente ejecuta los teses unitarios y de integraci√≥n con el objetivo de comprobar que los cambios no introducen errores en las partes probadas del c√≥digo ni errores de regresi√≥n.</p>
<p>Otras forma de <em>feedback</em> es obtener informaci√≥n de los sistemas mediante telemetr√≠a para comprobar el estado de los sistemas, conocer su estado normal e identificar alg√∫n tipo de problema cuando algo se est√° comportando de forma an√≥mala respecto a su estado normal. Tambi√©n es posible utilizar pruebas A/B para comprobar si realmente una funcionalidad aporta valor o cual de varias posibilidades es la que m√°s aporta. Por ejemplo es posible realizar una prueba A/B que permita conocer cu√°l de dos dise√±os de una p√°gina de compra genera m√°s compras.</p>
<p>Otras pr√°cticas de <em>feedback</em> son realizar programaci√≥n en parejas o <em>pair programming</em> que permite evaluar otro punto de vista en el mismo momento de estar programando, revisiones de c√≥digo o <em>peer review</em> para obtener una segunda opini√≥n antes de aplicar los cambios en la rama principal de desarrollo o desplegar en producci√≥n. Herramientas como <a href="https://github.com/">GitHub</a> o <a href="https://about.gitlab.com/">GitLab</a> facilitan estos <em>peer review</em> a trav√©s de los <em>pull request</em>.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2021/08/the-three-ways-y-the-five-ideals-de-los-libros-the-devops-handbook-the-phoenix-project-y-the-unicorn-project/images/the-second-way_hud0a1efde209ea51f51d5958faf131afb_13203_2560x1440_fit_q90_h2_box.webp" data-gallery="" title="The second way"><img src="https://picodotdev.github.io/blog-bitix/2021/08/the-three-ways-y-the-five-ideals-de-los-libros-the-devops-handbook-the-phoenix-project-y-the-unicorn-project/images/the-second-way_hud0a1efde209ea51f51d5958faf131afb_13203_650x450_fit_q90_h2_box.webp" width="400" height="211" alt="The second way" title="The second way" class="&#34; " loading="lazy"></a></p>
<figcaption>The second way</figcaption>
</figure>
</div>
<h4 id="_the-third-way-the-technical-practices-of-continual-learning_"><em>The third way: The technical practices of continual learning</em></h4>
<p>El tercer principio propone pr√°cticas que permitan mejorar de forma continua y adquirir nuevo conocimiento. Unas de estas pr√°cticas son crear <em>post mortems</em> cuando ocurra un error con un impacto en el servicio. Los <em>post mortem</em> permiten averiguar la causa que gener√≥ el problema y establecer acciones para evitar que ocurra en el futuro, aplicando las acciones¬† de los <em>post mortem</em> seg√∫n sucedan los problemas a lo largo del tiempo deber√≠an evitarse que sucedan los mismo problemas de forma recurrente. Los <em>post mortem</em> no deben ser utilizados para castigar o identificar personas culpables sino para evitar que los mismo problemas sucedan en el futuro, deben ser <em>blameless</em>. Y en sistemas complejos como son muchos productos de software con muchas dependencias en los que una √∫nica persona no posee el conocimiento completo problemas se producir√°n sin ninguna duda.</p>
<p>Otra opci√≥n de aprendizaje es introducir problemas de forma intencionada para comprobar se un sistema contin√∫a funcionando a√∫n con los errores y para aprender c√≥mo se comporta el sistema ante esos errores, estas t√©cnicas se denominan <em>chaos monkey</em>.</p>
<p>Para compartir informaci√≥n en vez de crear documentos que quedar√°n desactualizados es preferible crear documentaci√≥n ejecutable como pruebas unitarias con ejemplo del uso de la API. En vez de utilizar correos electr√≥nicos como forma de comunicaci√≥n privadas utilizar herramientas m√°s instant√°neas y p√∫blicas como <a href="https://slack.com/">Slack</a> o <a href="https://www.microsoft.com/es-es/microsoft-teams/group-chat-software/">Teams</a> e incluso utilizar <em>bots</em> desde estas herramientas que lancen acciones como despliegues. Al quedar los registros de las comunicaciones p√∫blicas es f√°cil compartir la informaci√≥n.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2021/08/the-three-ways-y-the-five-ideals-de-los-libros-the-devops-handbook-the-phoenix-project-y-the-unicorn-project/images/the-third-way_hu99816a59d00e127fb6b995fd5213fcc3_20147_2560x1440_fit_q90_h2_box.webp" data-gallery="" title="The third way"><img src="https://picodotdev.github.io/blog-bitix/2021/08/the-three-ways-y-the-five-ideals-de-los-libros-the-devops-handbook-the-phoenix-project-y-the-unicorn-project/images/the-third-way_hu99816a59d00e127fb6b995fd5213fcc3_20147_650x450_fit_q90_h2_box.webp" width="400" height="224" alt="The third way" title="The third way" class="&#34; " loading="lazy"></a></p>
<figcaption>The third way</figcaption>
</figure>
</div>
<h3 id="_the-five-ideals_"><em>The five ideals</em></h3>
<p>De los mismos autores que los libros anteriores es el libro <a href="https://amzn.to/384Yt5l">The Unicorn Project</a>, es una novela de una historia ficticia simult√°nea a la historia del de libro <em>The Phoenix Project</em> ambientada en la misma organizaci√≥n, la historia es similar con un comienzo en el que hay varios problemas, en este caso un grupo de personas forma ¬´la rebeli√≥n aplicando tambi√©n mejoras de forma paulatina que les permite retomar el control, el mismo personaje misterioso aparece en este libro.</p>
<p>El libro <em>The Unicorn Project</em> explica <em>The five ideals</em> con varios principios que en global <em>The three ways</em> a√±adiendo el objetivo del √©xito desde el punto vista de negocio y de la organizaci√≥n.</p>
<div class="media media-amazon">
  <iframe style="width:120px;height:240px;" width="120" height="240" scrolling="no" frameborder="0" src="https://rcm-eu.amazon-adsystem.com/e/cm?lt1=_blank&amp;bc1=000000&amp;IS2=1&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;t=blobit-21&amp;language=es_ES&amp;o=30&amp;p=8&amp;l=as4&amp;m=amazon&amp;f=ifr&amp;ref=as_ss_li_til&amp;asins=1942788762&amp;linkId=81db509fbd9848a1d9c5e7e0c9454703" title="Amazon" class="lozad"></iframe>
</div>
<h4 id="_the-first-ideal-locality-and-simplicity_"><em>The first ideal: locality and simplicity</em></h4>
<p>Uno de los problemas que afecta al <em>lead time</em> es que en una determinada tarea sea necesario que intervengan varias personas y roles diferentes, sobre todo cuando cada una tiene sus propias tareas y prioridades. Estos cambios de manos generan tiempos de espera por cambios de contexto, comunicaci√≥n y coordinaci√≥n que retrasan la entrega.</p>
<p>Este ideal propone que la persona encargada de hacer los cambios de una tarea tenga la mayor capacidad posible para completarla con la menor ayuda de otros equipos. Hay que evitar procesos y burocracia innecesaria.</p>
<p>Una medida para implementar este ideal es las personas tenga a su disposici√≥n servicios en forma de autoservicio, por ejemplo si un desarrollador necesita un nuevo entorno de pruebas o desplegar en producci√≥n sea este el que pueda crearlo con alguna herramienta de forma automatizada o tenber la capacidad de hacer despliegues. A evitar ser√≠a el requerir de una persona con el rol de operaciones de forma manual cree el entorno o haga el despliegue. En este caso el rol de operaciones es proporcionar a desarrollo las herramientas necesarias para realizar las tareas de forma automatizada.</p>
<h4 id="_the-second-ideal-focus-flow-and-joy_"><em>The second ideal: focus, flow, and joy</em></h4>
<p>El segundo ideal indica que el trabajo no deber√≠a ser desagradable. Para que no lo sea hay que evitar esperas a que otras personas hagan cosas, estar trabajando en peque√±as cosas sin conocer su objetivo, evitar estar constantemente apagando fuegos, evitar identificar responsables cuando algo no funciona y evitar el agotamiento.</p>
<p>En vez de eso hay que tener visibilidad de los resultados del trabajo y tener una visi√≥n global de su impacto que sirvan de motivaci√≥n, trabajar en peque√±os lotes de trabajo que fluyan r√°pido en la cadena de valor y obtener realimentaci√≥n del trabajo. Estas condiciones permiten un desempe√±o correcto, ser un reto, aprender y crecer como profesionales, dominar el dominio de negocio e incluso disfrutar de ello.</p>
<h4 id="_the-third-ideal-improvement-of-daily-work_"><em>The third ideal: Improvement of daily work</em></h4>
<p>El tercer ideal indica que mejorar el trabajo diario es al menos tan importante como el propio trabajo. Cuando se crea deuda t√©cnica el eliminarla¬†es tratada como una prioridad, la arquitectura es mejorada y modernizada de forma constante de modo que siga siendo posible entregar trabajo con fluidez y m√°s valor antes, de forma segura sin miedos a hacer cambios por riesgos de generar errores y¬†de forma agradable.</p>
<h4 id="_the-fourth-ideal-psychological-safety_"><em>The fourth ideal: psychological safety</em></h4>
<p>En el cuarto ideal es necesario que haya seguridad psicol√≥gica de tal forma que los miembros del equipo se sientan seguros al hablar de problemas, de esta forma no solo se pueden resolver sino tambi√©n prevenir. Resolver problemas requiere honestidad y la honestidad requiere ausencia de miedo a ser castigado.</p>
<p>Los <em>post mortem</em> han de ser <em>blameless</em> de lo contrario las personas tender√°n a ocultar informaci√≥n o no visibilizar los problemas para tratar de evitar los castigos.</p>
<h4 id="_the-fifth-ideal-customer-focus_"><em>The fifth ideal: customer focus</em></h4>
<p>El quinto ideal trata sobre cual es el objetivo de la organizaci√≥n y que parte de la misma es la esencial y cu√°l es contextual. La esencial del negocio es la diferenciadora y por la que est√°n dispuestos a pagar los clientes, la contextual aunque importante no es relevante para el cliente. Los esfuerzos e iniciativas m√°s importantes de una organizaci√≥n deben estar dirigidos a aportar valor al cliente.</p>
<div class="reference">
    Referencia:<br>
<ul>
<li><a href="https://itrevolution.com/the-three-ways-principles-underpinning-devops/">The Three Ways: The Principles Underpinning DevOps</a></li>
<li><a href="https://www.ilimit.com/blog/principios-devops-the-three-ways/">Los principios DevOps: The Three Ways</a></li>
<li><a href="https://itrevolution.com/five-ideals-of-devops/">The Five Ideals of DevOps</a></li>
<li><a href="https://island94.org/2017/12/the-three-ways-explained">The Three Ways Explained</a></li>
<li><a href="https://island94.org/2020/11/the-five-ideals-explained">The five ideals explained</a></li>
<li><a href="https://www.futuralistech.com/the-unicorn-project-turns-devops-into-a-rebellion/">The Unicorn Project turns DevOps into a rebellion</a></li>
<li><a href="https://itrevolution.com/resource-guide-to-the-unicorn-project-part-1/">Resource Guide To The Unicorn Project </a></li>
</ul>
</div>
]]>
        </content>
        
            
                <category term="planeta-codigo"/>
            
                <category term="programacion"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2021/08/el-patron-de-estrangulacion-para-reemplazar-aplicaciones-heredadas/</id>
        <title>El patr√≥n de estrangulaci√≥n para reemplazar aplicaciones heredadas</title>
        <updated>2021-08-19T23:00:00+02:00</updated>
        <published>2021-08-19T23:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2021/08/el-patron-de-estrangulacion-para-reemplazar-aplicaciones-heredadas/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Reescribir partiendo desde cero una aplicaci√≥n grande que tiene sus defectos pero que ha sido desarrollada durante mucho tiempo y su funcionalidad m√°s importante opera mayormente bien no es una estrategia que est√© exenta de riesgo ni¬†garantiza que el el nuevo sistema tenga defectos parecidos, m√°s graves o incluso la reescritura fracase. Si la reescritura tiene riesgos pero existe la necesidad de sustituir la aplicaci√≥n heredada para solventar algunos de sus problemas es necesaria otra estrategia diferente a partir de cero. Una estrategia que se utiliza en estos casos es aplicar el patr√≥n de estrangulaci√≥n que reemplaza el sistema antiguo de forma incremental cada una de sus piezas.</strong></p>]]>
        <![CDATA[<p>Algunas aplicaciones tienen un tiempo de vida de uso muy prolongado que ofrecen una funcionalidad esencial en una empresa u organizaci√≥n, muchas son mantenidas durante todo este tiempo de vida a√±adiendo funcionalidades, modificando las existentes, corrigiendo errores, fallos de seguridad o modestas modernizaciones. Otras aplicaciones finalmente dejan de mantenerse completamente salvo errores graves. Pasado un lustro o una d√©cada con una cantidad importante de l√≠neas de c√≥digo implementadas por un equipo grande de personas probablemente las aplicaciones pueden considerarse heredadas presentando problemas en su base de c√≥digo o tecnolog√≠as ya consideradas obsoletas.</p>
<p>Quiz√° llegue un momento que surge el inter√©s de sustituir la aplicaci√≥n, una opci√≥n es reescribir completamente la aplicaci√≥n heredada con sus propios inconvenientes y riesgos otra opci√≥n es reemplazarla de forma incremental, en este √∫ltimo caso se suele utilizar el patr√≥n de estrangulaci√≥n. Los proyectos que se empiezan desde un inicio son los menos, lo habitual es tener que mantener sistemas existentes y cuando es necesario migrarlos a nuevos.</p>
<div class="alert alert-warning pt-0 pb-0 tableofcontents"><h2>Contenido del art√≠culo</h2><toc></toc></div>
<h3 id="el-problema-de-las-aplicaciones-heredadas">El problema de las aplicaciones heredadas</h3>
<p>Algunos de los motivos para desear sustituir una aplicaci√≥n son los siguientes.</p>
<ul>
<li>C√≥digo heredado complicado.</li>
<li>Reglas de negocio en varias ubicaciones del c√≥digo.</li>
<li>Dise√±o monol√≠tico no adecuado para las necesidades actuales de rendimiento, fiabilidad u organizaci√≥n de equipos de desarrollo.</li>
<li>Dificultad para hacer pruebas.</li>
<li>Acumulaci√≥n de deuda t√©cnica.</li>
<li>Proceso de despliegue complicado con varios pasos manuales.</li>
</ul>
<p>Cuando los problemas son demasiado grandes las consecuencias son que al hacer un cambio en el c√≥digo existente no haya confianza de que vaya a funcionar correctamente o requiera demasiado tiempo incrementando los tiempos desde que se acepta un cambio hasta que este es aplicado en producci√≥n. M√°s tiempo entre despliegues agrava los problemas, el resultado es que se crea una espiral de decadencia que realimenta si no se toman medidas para evitarlo.</p>
<h3 id="reescribir-o-reemplazar">Reescribir o reemplazar</h3>
<p>Entre las dos opciones al sustituir una aplicaci√≥n se puede optar por reescribir la aplicaci√≥n completamente desde cero o sustituir sus funcionalidades de forma incremental. La reescritura completa de una aplicaci√≥n grande no est√° exenta de problemas y riesgos. Probablemente no sea posible dejar de dar servicio a la aplicaci√≥n existente corrigiendo errores o modificaciones mientras la nueva aplicaci√≥n se est√° desarrollando. Sustituir un sistema de un tiempo de vida de m√°s de un lustro de vida en poco tiempo no es f√°cil conseguirlo en unos pocos meses ya que posiblemente tenga una base de c√≥digo grande con l√≥gica de negocio complicada embebida, la realidad es que pasado unos pocos meses despu√©s de empezada la tarea el nuevo sistema √∫nicamente tiene un porcentaje bajo de todas las funcionalidades de la antigua, tambi√©n se acumule la deuda t√©cnica con la presi√≥n de realizar una entrega y la nueva aplicaci√≥n contenga varios de los mismos problemas que la aplicaci√≥n que pretende sustituir.</p>
<p>Como alternativa a la reescritura est√° el reemplazo de forma incremental de partes del sistema mientras contin√∫a ofreciendo su servicio. La raz√≥n m√°s importante de optar por el reemplazo es reducir el riesgo de la reescritura completa. Realizar el reemplazo de forma incremental permite realizar entregas m√°s frecuentemente y monitorizar el progreso con m√°s cuidado. A veces esta opci√≥n no es tomada en cuenta ya que se considera que costosa m√°s, sin embargo, el poder realizar ciclos de entrega m√°s cortos permite aplicar el conocimiento adquirido en cada ciclo a los siguientes y obtener valor de forma m√°s temprana que con la reescritura completa. Para el reemplazo de forma incremental se utiliza el patr√≥n de estrangulaci√≥n.</p>
<p>Teniendo en cuenta que una aplicaci√≥n pasado un tiempo se considerar√° heredada y obsoleta, las aplicaciones deber√≠an dise√±arse y estructurarse de tal forma que faciliten su sustituci√≥n en un futuro.</p>
<h3 id="el-patr√≥n-de-estrangulaci√≥n">El patr√≥n de estrangulaci√≥n</h3>
<p>El patr√≥n de estrangulaci√≥n permite sustituir una aplicaci√≥n heredada reemplazando de forma gradual y con menos riesgos piezas espec√≠ficas de funcionalidad por nuevas aplicaciones y servicios. A medida que las funcionalidades de la aplicaci√≥n heredada son sustituidas, el nuevo sistema eventualmente reemplaza todas las funcionalidades del sistema heredado que es estrangulado hasta que nada de √©l queda ya por sustituir, lo que queda si no es necesario es posible eliminarlo. La aplicaci√≥n heredada se mantiene en funcionamiento en todo momento mientras el nuevo sistema funciona de la forma esperada.</p>
<p>El objetivo es reducir lentamente la dependencia del sistema heredado, el reemplazo llevar√° bastante tiempo pero planeado correctamente el patr√≥n de estrangulaci√≥n minimiza el riesgo y tiene menos impacto que una reescritura completa.</p>
<p>El patr√≥n no es la √∫nica estrategia que ayuda a reemplazar un sistema existente otras t√©cnicas que ayudan son <a href="https://picodotdev.github.io/blog-bitix/2021/07/servidor-mock-para-imitar-peticiones-y-respuestas-de-servicios-http-con-wiremock/">utilizar un servidor <em>mock</em> para imitar las peticiones y respuestas</a> mientras se desarrolla o en las pruebas unitarias y realizar <a href="https://picodotdev.github.io/blog-bitix/2021/08/introduccion-y-ejemplo-de-contract-testing-con-pact/">pruebas de contrato para validar de forma unitaria el cliente y el servidor</a> de un servicio. El intermediario para aplicar patr√≥n de estrangulaci√≥n puede ser simplemente <a href="https://picodotdev.github.io/blog-bitix/2016/07/como-crear-un-proxy-inverso-entre-el-servidor-web-nginx-y-un-servidor-de-aplicaciones-java/">un servidor  web que haga de <em>proxy</em> como Nginx o Apache</a> o mejor a√∫n <a href="https://picodotdev.github.io/blog-bitix/2021/09/el-proxy-inverso-traefik-caracteristicas-y-funcionalidades-que-ofrece/">un servidor <em>proxy</em> adaptado a la computaci√≥n nativa en la nube como Traefik</a>.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2021/08/el-patron-de-estrangulacion-para-reemplazar-aplicaciones-heredadas/images/the-strangler-pattern-1_hua30b7d595d77d2879eb3fa1cff7439a7_38105_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="El patr√≥n estrangulaci√≥n"><img src="https://picodotdev.github.io/blog-bitix/2021/08/el-patron-de-estrangulacion-para-reemplazar-aplicaciones-heredadas/images/the-strangler-pattern-1_hua30b7d595d77d2879eb3fa1cff7439a7_38105_650x450_fit_q90_h2_box_3.webp" width="650" height="188" alt="El patr√≥n estrangulaci√≥n" title="El patr√≥n estrangulaci√≥n" class="&#34; " loading="lazy"></a></p>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2021/08/el-patron-de-estrangulacion-para-reemplazar-aplicaciones-heredadas/images/the-strangler-pattern-2_huf7ae3995ad5ef359c4fc45aaecd02030_65044_2560x1440_fit_q90_h2_box_3.webp" data-gallery="" title="El patr√≥n estrangulaci√≥n"><img src="https://picodotdev.github.io/blog-bitix/2021/08/el-patron-de-estrangulacion-para-reemplazar-aplicaciones-heredadas/images/the-strangler-pattern-2_huf7ae3995ad5ef359c4fc45aaecd02030_65044_650x450_fit_q90_h2_box_3.webp" width="650" height="361" alt="El patr√≥n estrangulaci√≥n" title="El patr√≥n estrangulaci√≥n" class="&#34; " loading="lazy"></a></p>
<figcaption>El patr√≥n estrangulaci√≥n</figcaption>
</figure>
</div>
<h4 id="funcionamiento">Funcionamiento</h4>
<p>El funcionamiento del patr√≥n de estrangulaci√≥n es bastante simple. El primer paso consiste en establecer un intermediario entre el c√≥digo o aplicaci√≥n heredado a sustituir y el cliente o usuario de este c√≥digo. En el inicio de proceso de estrangulaci√≥n, el intermediario simplemente delega cada petici√≥n que recibe en el c√≥digo o aplicaci√≥n heredado. Una vez que el intermediario est√° ubicado puede redirigir las peticiones a otra aplicaci√≥n o componente una vez completado su desarrollo.</p>
<p>Por ejemplo, suponiendo que se desea reemplazar la funcionalidad de autenticaci√≥n y autorizaci√≥n, se desarrollan los nuevos servicios de autenticaci√≥n y autorizaci√≥n de forma completamente separada de la aplicaci√≥n heredada. Para empezar usar el nuevo c√≥digo, el intermediario intercepta todos los intentos de inicio de sesi√≥n y en vez de delegarlos en la aplicaci√≥n heredada los delega en el nuevo servicio. Este proceso se repite para cada nueva funcionalidad,¬†en cada reemplazo se redirigen m√°s peticiones fuera de la aplicaci√≥n heredada.</p>
<p>Los usuarios del servicio no deber√≠an notar los cambios, al menos no ninguno que no sea una mejora en el servicio o que el reemplazo proporcione una nueva funcionalidad a medida que su c√≥digo aumenta. Algunos servicios reemplazados dependen de nuevos repositorios de datos, es posible que haya la necesidad de coordinar ciertos datos entre los repositorios de datos de lo que queda de la aplicaci√≥n heredada y el repositorio de datos de un nuevo servicio. Esta coordinaci√≥n de datos es un aspecto a tener en cuenta para tratar de minimizar la redundancia de datos que facilite la transici√≥n.</p>
<p>En el caso de una aplicaci√≥n monol√≠tica es posible optar por una opci√≥n tambi√©n monol√≠tica pero m√°s modular que resuelva algunos de los problemas en el c√≥digo de la aplicaci√≥n heredada o ya que se realiza la tarea del reemplazo aprovechar para utilizar una arquitectura de microservicios si estos se adaptan a las necesidades de la aplicaci√≥n y de desarrollo en diferentes equipos independientes para que puedan trabajar de forma simult√°nea e independiente.</p>
<p>El intermediario en una aplicaci√≥n monol√≠tica es una clase fachada que delega en el c√≥digo heredado, en el nuevo m√≥dulo o en un microservicio que extrae de la aplicaci√≥n heredada la funcionalidad a estragular. En el caso de una aplicaci√≥n heredada que funciona mediante llamadas de red como HTTP el intermediario es un <em>proxy</em> inverso que redirige las peticiones a la aplicaci√≥n heredada o al nuevo servicio sin que los clientes sean conscientes del cambio. Adicionalmente si la aplicaci√≥n heredada utiliza colas de mensajes una posible opci√≥n es hacer cambiar la aplicaci√≥n heredada para que lea de otras colas nuevas y el intermediario lea de las colas de mensajes originales, de esto modo el intermediario puede decidir si enviar los mensajes a las colas de la aplicaci√≥n heredada o a su reemplazo.</p>
<h4 id="ventajas-e-inconvenientes">Ventajas e inconvenientes</h4>
<p>Las ventajas del patr√≥n de estrangulaci√≥n son:</p>
<ul>
<li>Proporciona una forma de transformar un sistema con menos riesgo que una reescritura desde cero.</li>
<li>Los nuevos servicios se desarrollan de forma incremental.</li>
<li>Se mantienen los servicios antiguos mientras se desarrollan los nuevos.</li>
</ul>
<p>Los inconvenientes son:</p>
<ul>
<li>Requiere cuidado en el enrutado de peticiones hacia los diferentes sistemas. Cada nuevo servicio requiere adaptar la l√≥gica del intermediario para redirigir las peticiones de la funcionalidad del viejo servicio al nuevo, cuando una aplicaci√≥n est√° compuesta de gran cantidad de servicios es un trabajo significativo.</li>
<li>Requiere un plan de vuelta hacia para cada funcionalidad reemplazada en caso de que las casas vayan mal. A√∫n as√≠ esto es m√°s sencillo y est√° m√°s acotado que en el caso de la reescritura.</li>
</ul>
<h4 id="que-seleccionar-primero-para-estrangular">Que seleccionar primero para estrangular</h4>
<p>Otra cuesti√≥n que funcionalidades de la aplicaci√≥n heredada reemplazar primero. Es posible utilizar varios criterios pudiendo ser su facilidad de reemplazo, importancia, tama√±o o dependencias que tenga.</p>
<div class="reference">
    Referencia:<br>
<ul>
<li><a href="https://martinfowler.com/bliki/StranglerFigApplication.html">StranglerFigApplication</a></li>
<li><a href="https://www.michielrook.nl/2016/11/strangler-pattern-practice/">The Strangler pattern in practice</a></li>
<li><a href="https://www.kiuwan.com/strangle-pattern-legacy-apps/">Use the Strangler Pattern to Refactor Legacy Apps</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/strangler-fig">Strangler Fig pattern</a></li>
<li><a href="https://www.linkedin.com/pulse/microservices-design-patterns-part-3-patternsproxy-satish-sharma">Microservices Design Patterns Part 3 : Patterns(Proxy, Aggregator)</a></li>
<li><a href="https://dzone.com/articles/monolith-to-microservices-using-the-strangler-patt">Monolith to Microservices Using the Strangler Pattern</a></li>
<li><a href="https://medium.com/nerd-for-tech/the-strangler-pattern-microservices-design-patterns-in-practice-made-easy-with-aws-serverless-97437a82b052">The Strangler Pattern: Microservices Design Patterns In Practice Made Easy with AWS Serverless</a></li>
<li><a href="https://www.redhat.com/architect/pros-and-cons-strangler-architecture-pattern">The pros and cons of the Strangler architecture pattern</a></li>
<li><a href="https://www.ibm.com/garage/method/practices/code/chunking-strategy-strangler-pattern/">Break the monolith: Chunking strategy and the Strangler pattern</a></li>
<li><a href="https://capgemini-engineering.com/us/en/insight/part-3-choosing-the-right-strategy-to-migrate-your-monolithic-application-to-a-microservices-based-architecture/">PART 3: Choosing the Right Strategy to Migrate Your Monolithic Application to a Microservices-Based Architecture</a></li>
<li><a href="https://www.overops.com/blog/strangler-pattern-how-to-keep-sane-with-legacy-monolith-applications/">Strangler Pattern: How to Deal With Legacy Code During the Container Revolution</a></li>
<li><a href="https://mechanicalrock.github.io/2020/05/04/strangler-pattern.html">Strangler Pattern</a></li>
<li><a href="https://www.atelier-solutions.com/the-strangler-pattern-and-legacy-migration-strategies/">The Strangler Pattern and Legacy Migration Strategies</a></li>
</ul>
</div>
]]>
        </content>
        
            
                <category term="planeta-codigo"/>
            
                <category term="programacion"/>
            
        
    </entry>
    
</feed>