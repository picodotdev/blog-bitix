<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title type="text">Blog Bitix</title>
    <subtitle type="text">Blog sobre al lenguaje de programación Java y la distribución GNU/Linux que uso habitualmente, Arch Linux, lo que aprendo sobre el software libre, la programación web y otros temas relacionados con la tecnología y la informática. El contenido puede contener trazas de asuntos fuera de tema.</subtitle>
    <link rel="self" href="https://picodotdev.github.io/blog-bitix/index.xml"/>
    <link href="https://picodotdev.github.io/blog-bitix/" />
    <id>https://picodotdev.github.io/blog-bitix/tags/software-libre/</id>
    <updated>2022-01-13T23:00:00+01:00</updated>
    <author><name>picodotdev</name></author>
    <generator>Hugo</generator>
    <icon>https://picodotdev.github.io/blog-bitix/assets/favicon.ico</icon>
    <logo>https://picodotdev.github.io/blog-bitix/assets/images/blog-bitix.svg</logo>
    <rights>https://creativecommons.org/licenses/by-sa/4.0/</rights>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2017/12/hemeroteca-12/</id>
        <title>Hemeroteca #12</title>
        <updated>2018-01-13T11:35:00+01:00</updated>
        <published>2017-12-30T09:30:00+01:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2017/12/hemeroteca-12/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        
        <![CDATA[<p>Cuarto año de Blog Bitix y en febrero serán ocho desde que empecé con <a href="https://elblogdepicodev.blogspot.com.es">El blog del pico.dev</a>. En los últimos seis meses he seguido publicando casi a dos artículos por semana y durante el 2017 ha sido casi siempre así, en este semestre han sido 48 artículos, que juntos con los 39 del primero son 87 durante el año 2017, mi mayor tasa de publicación en un año.</p>
<p>En estas hemerotecas siempre repaso cual es la evolución de visitas e ingresos de AdSense que quizá a alguien más le resulte de interés. En Junio y Julio alcance unas 50K páginas vistas el mayor pico de visitas, aunque en meses posteriores han descendido, al principio lo achacaba a los meses vacacionales de verano pero luego se han mantenido no se si por alguna penalización de Google o algún artículo que recibía muchas visitas y haya descendido en su posicionamiento. En cualquier caso en los últimos meses del año las visitas han tenido una tendencia ascendente, de unas 40K páginas vistas y superior respecto a las de hace una año que comparándolas han sido de 25K en 2016 y de 38K en 2017 un crecimiento de un 85%. No está mal, si el año siguiente fuese igual me daría por muy satisfecho.</p>
<p>En el apartado de ingresos por la publicidad AdSense, algunos artículos patrocinados y enlaces de afiliación también ha estado bien. En estos momentos por AdSense es raro el día que no recibo al menos un euro y algún día excepcional he recibido 8, otros algo menos de 2 y 3, mensualmente ya es habitual que esté en un rango de 30 y 45 €, los ingresos de AdSense se relacionan en gran medida con el número de visitas. Al final el artículo que publiqué sobre los <a href="https://picodotdev.github.io/blog-bitix/2017/02/cursos-de-formacion-de-keepcoding/">cursos de formación de KeepCoding</a> han merecido la pena como artículo patrocinado con la compra de dos usuario de tres cursos (aunque la mayoría de gente se registran a los cursos gratuitos), pero esto junto con los artículos patrocinados es más esporádico y por el momento poco habitual para mi.</p>
<p>En alguna ocasión me han comentado que me donarían algo por los artículos que escribo, una posibilidad sería usar <a href="https://www.patreon.com/">Patreon</a> o <a href="https://www.paypal.com/">PayPal</a>, sin embargo, no me convence mucho la donación directa por ser demasiado generosa y he preferido añadir una <a href="https://picodotdev.github.io/blog-bitix/series/donacion/">página con ciertos productos tecnológicos y <em>gamers</em> seleccionados</a> para que si alguien le gusta mis artículos, se acuerda y quiere donarme algo lo haga a través de estos enlaces de afiliación. Al que compra le cuesta lo mismo pero yo recibo una comisión. Esto me recuerda que debería hacer alguna nueva donación a proyectos de software libre y estoy pensando en <a href="https://lineageos.org/">Lineage OS</a> y <a href="https://www.replicant.us/">Replicant</a>.</p>
<p>Quien crea que es mucho que pruebe a crearse una bitácora, un canal en <a href="https://www.youtube.com/">YouTube</a> o un <em>podcast</em> y verá rápidamente que o se acierta en la temática y se es muy bueno creando contenido que genera interés o primero verá que han de pasar dos años y dedicar una ingente cantidad de horas a crear ese contenido para llegar a estas cifras que tampoco son altas, no en vano muchos de estos proyectos son abandonados al cabo de unos meses, por algo será.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/12/hemeroteca-12/images/analytics-2017_hu9673f1dbb4b3f428b854147e70d639bf_62017_2560x1440_fit_box_3.png" data-gallery="" title="Analytics 2017 de Blog Bitix"><img src="https://picodotdev.github.io/blog-bitix/2017/12/hemeroteca-12/images/analytics-2017_hu9673f1dbb4b3f428b854147e70d639bf_62017_300x200_fit_box_3.png" width="300" height="117" alt="Analytics 2017 de Blog Bitix" title="Analytics 2017 de Blog Bitix"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/12/hemeroteca-12/images/gadsense-2017_hu3955e30c6b90da6e9f89725e82304470_34878_2560x1440_fit_box_3.png" data-gallery="" title="AdSense 2017 de Blog Bitix"><img src="https://picodotdev.github.io/blog-bitix/2017/12/hemeroteca-12/images/gadsense-2017_hu3955e30c6b90da6e9f89725e82304470_34878_300x200_fit_box_3.png" width="300" height="91" alt="AdSense 2017 de Blog Bitix" title="AdSense 2017 de Blog Bitix"  class="lozad "></a></p>
<figcaption>Evolución visitas e ingresos en 2017</figcaption>
</figure>
</div>
<p>Pero por otra parte he recibido buenos comentarios sobre lo que escribo en Blog Bitix, por algunas personas vía <a href="https://twitter.com/">Twitter</a> y otras en algún comentario que me anima a seguir escribiendo y compartiendo como hasta ahora lo que voy aprendiendo e investigando que algún día espero utilizar en algún trabajo antes de que me jubile o pruebe ser un jardinero o barrendero.</p>
<p>Este <a href="https://picodotdev.github.io/blog-bitix/2017/">año 2017 he escrito los artículos</a> y este semestre me propuse publicar una mayor cantidad de artículos relacionados con el lenguaje de programación Java con motivo de la pasada publicación de Java 9. Pero primero empecé con un par de artículos sobre <em>portlets</em> y <a href="https://tapestry.apache.org/">Apache Tapestry</a> que en algún momento espero añadirlos en alguna sección del libro <a href="https://picodotdev.github.io/blog-bitix/2014/08/actualizacion-del-libro-plugin-tapestry/">PlugIn Tapestry</a>. Por supuesto, varios artículos comentando las novedades más relevantes de Java 9 publicado en septiembre entre ellas la modularidad y otras no menos notables.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/07/introduccion-a-los-portales-y-ejemplo-de-portlet-con-liferay/">Introducción a los portales y ejemplo de portlet con Liferay</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/07/portlets-con-el-framework-apache-tapestry-y-apache-pluto/">Portlets con el framework Apache Tapestry y Apache Pluto</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/07/iniciar-rapido-un-proyecto-de-java-con-gradle-o-de-spring-con-spring-initializr/">Iniciar rápido un proyecto de Java con Gradle o de Spring con Spring Initializr</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/07/iniciacion-a-la-programacion-concurrente-en-java/">Iniciación a la programación concurrente en Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/07/4-formas-de-hacer-un-bucle-for-en-java/">4 formas de hacer un bucle for en Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/07/ejecutar-varias-tareas-de-forma-concurrente-en-java/">Ejecutar varias tareas de forma concurrente en Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/08/el-antipatron-de-inicializacion-de-variables-con-dobles-llaves-en-java/">El antipatrón de inicialización de variables con dobles llaves en Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/08/cache-simple-de-datos-y-con-ehcache-en-java/">Cache simple de datos y con Ehcache en Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/09/los-cuantificadores-greedy-reluctant-y-possessive-en-expresiones-regulares/">Los cuantificadores greedy, reluctant y possessive en expresiones regulares</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/09/los-tipos-de-referencias-debiles-soft-weak-y-phantom-en-java/">Los tipos de referencias débiles soft, weak y phantom en Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/09/la-herramienta-de-documentacion-javadoc-de-java/">La herramienta de documentación Javadoc de Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/09/como-generar-la-documentacion-javadoc-con-gradle/">Cómo generar la documentación Javadoc con Gradle</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/09/crear-anotaciones-de-javadoc-personalizadas-con-taglets/">Crear anotaciones de Javadoc personalizadas con taglets</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/09/cambiar-y-personalizar-los-estilos-de-la-documentacion-javadoc/">Cambiar y personalizar los estilos de la documentación Javadoc</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/09/novedades-y-nuevas-caracteristicas-de-java-9-los-modulos/">Novedades y nuevas características de Java 9, los módulos</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/09/novedades-de-java-9-mas-alla-de-la-modularidad/">Novedades de Java 9, más allá de la modularidad</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/09/jshell-la-herramienta-repl-incorporada-en-java-9/">JShell la herramienta REPL incorporada en Java 9</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/10/evitar-niveles-de-anidacion-de-sentencias-condicionales-con-guard-clauses/">Evitar niveles de anidación de sentencias condicionales con guard clauses</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/10/ejemplo-con-el-cliente-http-2-de-java/">Ejemplo con el cliente HTTP/2 de Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/10/obtener-el-minimo-o-maximo-de-dos-una-lista-o-stream-de-valores-en-java/">Obtener el mínimo o máximo de dos, una lista o stream de valores en Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/10/las-excepciones-para-gestionar-errores-con-java/">Las excepciones para gestionar errores en Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/10/obtener-informacion-de-la-pila-de-las-excepciones/">Obtener información de la pila de las excepciones</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/10/formas-de-reducir-el-codigo-de-las-clases-pojo-de-java/">Formas de reducir el código de las clases POJO de Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/10/visualizar-datos-y-generar-graficas-en-java-con-jfreechart/">Visualizar datos y generar gráficas en Java con JFreeChart</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/11/la-forma-correcta-de-ordenar-alfabeticamente-cadenas-en-java/">La forma correcta de ordenar alfabéticamente cadenas en Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/12/introduccion-a-la-programacion-funcional-con-java-y-la-libreria-vavr/">Introducción a la programación funcional con Java y la librería Vavr</a></li>
</ul>
<p>Una serie de artículos sobre <a href="https://graphql.org/">GraphQL</a> como alternativa a una API REST que tiene algunas ventajas. Aún me queda publicar uno de esta serie, en cuanto se acepte un <em>pull request</em> a raíz de una petición que cree con <a href="https://github.com/graphql-java/graphql-java-tools/issues/93">un problema que me encontré</a>.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/11/que-es-graphql-y-ejemplo-para-una-interfaz-de-un-servicio-con-spring-boot-y-java/">Qué es GraphQL y ejemplo para una interfaz de un servicio con Spring Boot y Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/11/usar-un-resolver-para-recuperar-propiedades-en-graphql/">Usar un resolver para recuperar propiedades en GraphQL</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/11/consultas-con-parametros-para-filtrar-datos-en-graphql/">Consultas con parámetros para filtrar datos en GraphQL</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/11/paginacion-usando-cursores-en-graphql-y-java/">Paginación usando cursores en GraphQL y Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/12/definir-nuevos-tipos-de-datos-escalares-en-graphql/">Definir nuevos tipos de datos escalares en GraphQL</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/11/devolver-mensajes-de-error-descriptivos-en-graphql/">Devolver mensajes de error descriptivos en GraphQL</a></li>
</ul>
<p>De los menos en este semestre están relacionados con el software libre. De <a href="https://about.gitlab.com/">GitLab</a> tengo otro par de artículos por publicar para realizar integración continua y mostrando más en detalles su gestión de peticiones, wiki y páginas. Si estas navidades tienes algún momento para ver la televisión en uno de los siguientes artículos encontrarás varias ideas relacionadas con la tecnología.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/08/instalar-y-renovar-un-certificado-de-lets-encrypt-en-nginx/">Instalar y renovar un certificado de Let&rsquo;s Encrypt en Nginx</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/12/el-buscador-que-respeta-tu-privacidad-duckduckgo/">El buscador que respeta tu privacidad, DuckDuckGo</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/12/peliculas-sobre-tecnologia-o-informatica-series-documentales-videos-libros-gnu-linux-y-software-libre/">Películas sobre tecnología o informática, series, documentales, vídeos, libros, GNU/Linux y software libre</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/12/como-eliminar-metainformacion-de-las-fotos-en-gnu-linux/">Como eliminar metainformación de las fotos en GNU/Linux</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/">GitLab, la completa herramienta integrada para desarrollo de software</a></li>
</ul>
<p>O de opinión.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/10/la-triste-realidad-de-java-versiones-antiguas/">La triste realidad de Java, versiones antiguas</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/10/consejos-para-empresas-y-gente-de-recursos-humanos-que-busquen-talento/">Consejos para empresas y gente de recursos humanos que busquen talento</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2015/07/microsoft-does-not-care-if-you-use-windows-or-office-without-a-license/">Microsoft does not care if you use Windows or Office without a license</a></li>
</ul>
<p>Algunos artículos de tema alternativos en la temática principal de este blog pero que también me gusta compartir, comentando el cambio que hice de compañía eléctrica a <a href="https://www.holaluz.com/">Holaluz</a>, de caldera a termo eléctrico y la diferencia en la factura entre tener caldera y tener termo eléctrico. Un par de artículos de los robles que he plantado que espero prosperen, publicaré alguno más. También algún artículo de desempaquetado.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/07/desempaquetado-maletin-herramientas-mannesmann-y-bandejas-melamina-balvi/">Desempaquetado maletín herramientas Mannesmann y bandejas melamina Balvi</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/07/la-busqueda-de-ejemplares-de-roble-comun/">La búsqueda de ejemplares de roble común</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/09/como-seleccionar-y-hacer-germinar-facilmente-semillas-de-roble/">Cómo seleccionar y hacer germinar fácil semillas de roble</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/08/sustituir-caldera-de-gas-por-un-termo-electrico-fleck-duo-7-50/">Sustituir caldera de gas por un termo eléctrico Fleck Duo 7 50</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/11/comparando-la-factura-entre-caldera-de-gas-y-termo-electrico/">Comparando la factura entre caldera de gas y termo eléctrico</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/11/me-cambio-a-la-electrica-holaluz/">Me cambio a la eléctrica Holaluz</a></li>
</ul>
<p>Una buena colección de libros técnicos que he leído durante el último trío de años y me han gustado junto con una selección de productos tecnológicos.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/08/37-buenos-libros-sobre-sobre-java-linux-devops-y-desarrollo-que-he-leido/">37 buenos libros sobre sobre Java, Linux, DevOps y desarrollo que he leído</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/11/8-plus-ideas-de-productos-tecnologicos-para-comprar-o-regalar/">8+ ideas de productos tecnológicos para comprar o regalar</a></li>
</ul>
<p>Espero seguir escribiendo como hasta ahora en el 2018 si el tiempo del que dispongo me lo permite y continuo con motivación. Por lo pronto son unos cuantos artículos que ya tengo escritos a falta de retocar en el momento que los publique. Puedes aprovechar para repasar esta lista y leer alguno si te lo perdiste, por supuesto si aún no lo has hecho, suscríbete con tu lector preferido al <a href="https://picodotdev.github.io/blog-bitix/index.xml"><em>feed</em> a Blog Bitix</a>. Finalmente, ya solo me queda desearos con la siguiente imagen linuxera de <a href="http://www.klowner.com/">Klowner</a>&hellip; ¡Buen <strike>2016</strike> 2018!</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/12/hemeroteca-12/images/christmas-tux-2017_hu4666a9b653f218359d1cc8abe813ce9a_529979_2560x1440_fit_q90_box.jpg" data-gallery="" title="¡Buen 2018!"><img src="https://picodotdev.github.io/blog-bitix/2017/12/hemeroteca-12/images/christmas-tux-2017_hu4666a9b653f218359d1cc8abe813ce9a_529979_600x450_fit_q90_box.jpg" width="600" height="338" alt="¡Buen 2018!" title="¡Buen 2018!"  class="lozad "></a></p>
<figcaption>¡Buen 2018! <br>Fuente: klowner.com</figcaption>
</figure>
</div>
]]>
        </content>
        
            
                <category term="blog"/>
            
                <category term="java"/>
            
                <category term="planeta-codigo"/>
            
                <category term="programacion"/>
            
                <category term="software"/>
            
                <category term="software-libre"/>
            
                <category term="tapestry"/>
            
                <category term="gnu-linux"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/</id>
        <title>GitLab, la completa herramienta integrada para desarrollo de software</title>
        <updated>2018-01-14T02:00:00+01:00</updated>
        <published>2017-12-23T10:00:00+01:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Al desarrollar software una herramienta de control de versiones como Git y otras como un gestor de peticiones, una herramienta de integración continua o despliegue contínuo o una wiki para documentación son necesarias. Hay productos específicos para cada uno de ellos pero GitLab proporciona en una único producto todas estas facilitando su instalación y administración estando integradas en el mismo producto.</strong></p>]]>
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/gitlab.svg" width="200" height="184" alt="GitLab" title="GitLab"  class=""></p>
</div>
<p>Usar una herramienta de control de versiones para el código fuente de un proyecto o programa es imprescindible para recuperar versiones anteriores de los archivos, comparar y compartir los cambios con el resto de desarrolladores del equipo. Otras herramientas imprescindibles son un gestor de peticiones para documentar cuál es el trabajo a realizar, ver en que se está trabajando, priorizar el trabajo inmediato que se realizará y el estado de cada petición. Por otro lado una herramienta donde recoger documentación del proyecto ayuda a compartir información y hacer que ese conocimiento quede recogido en algún lugar que pueda ser consultado con posterioridad o para futuros desarrolladores. También en estos días es imprescindible una herramienta para automatizar la ejecución de las pruebas unitarias y funcionales en cada <em>commit</em> al repositorio de código fuente.</p>
<p>Para cada una de estas funcionalidades hay herramientas específicas: <a href="https://git-scm.com/">Git</a> para la herramienta de control de versiones, <a href="https://github.com/">GitHub</a> con algunas funciones colaborativas como <em>pull request</em> y revisiones de código, <a href="https://www.atlassian.com/software/jira">Jira</a> para la gestión de peticiones, <a href="https://www.mediawiki.org/">MediaWiki</a> para documentar cierta información o <a href="https://jenkins.io/">Jenkins</a> para la ejecución de las pruebas automatizadas. Instalar estas herramientas individualmente requiere tiempo y dedicación, además de mantenimiento posterior.</p>
<p><a href="https://about.gitlab.com/">GitLab</a> es una herramienta que proporciona estas funcionalidades en un único producto y por tanto más fácil de instalar y administrar. Quizá su gestor de peticiones y wiki no tenga tantas opciones como sus respectivos productos específicos pero para la mayoría de casos son más que suficientes. Y tiene un desarrollo muy activo añadiendo características cada pocas semanas.</p>
<p>Hay varias formas de instalar GitLab, una de ellas es <a href="https://about.gitlab.com/installation/#ubuntu">instalandolo como un paquete de software</a> en la propia máquina, usando una <a href="https://docs.gitlab.com/ce/install/docker.html">imagen de Docker</a> o con una <a href="https://bitnami.com/stack/gitlab">imagen de Bitnami</a>. Siguiendo el artículo de <a href="https://picodotdev.github.io/blog-bitix/2014/11/introduccion-a-bitnami/">Introducción a Bitnami</a> puedes conocer como instalar GitLab en una máquina virtual con <a href="https://www.virtualbox.org/">VirtualBox</a> y con la <a href="https://picodotdev.github.io/blog-bitix/series/docker/">serie de artículos sobre Docker</a> como instalarlo en forma de contenedor y en la web de GitLab se explica como instalarlo como un software más de un sistema.</p>
<p>Usando <a href="https://www.docker.com/">Docker</a> y el siguiente archivo de <a href="https://docs.docker.com/compose/">Docker Compose</a> basta el comando <code>docker-compose up</code> para iniciar GitLab. Instalado GitLab de alguna de las formas anteriores usando un navegador web y con la dirección <em>https://gitlab</em> (configurados los certificados SSL y la ubicación de los volúmenes) se accede a la aplicación de GitLab, donde inicialmente se pide la contraseña del usuario administrador <em>root</em> con la que iniciar sesión y realizar las tareas administrativas como crear otros usuarios y proyectos.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span><span class="lnt">26&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;3.4&#39;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">gitlab</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;gitlab/gitlab-ce:latest&#39;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">gitlab</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;localhost&#39;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">environment</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span><span class="nt">GITLAB_OMNIBUS_CONFIG</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">&#10;</span></span></span><span class="line"><span class="cl"><span class="sd">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;external_url &#39;https://gitlab&#39;&#10;</span></span></span><span class="line"><span class="cl"><span class="sd">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nginx[&#39;ssl_certificate&#39;] = &#39;/etc/gitlab/ssl/gitlab.crt&#39;&#10;</span></span></span><span class="line"><span class="cl"><span class="sd">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nginx[&#39;ssl_certificate_key&#39;] = &#39;/etc/gitlab/ssl/gitlab.key&#39;</span><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">ports</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="s1">&#39;8022:22&#39;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="s1">&#39;8080:80&#39;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="s1">&#39;8443:443&#39;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">volumes</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="s1">&#39;gitlab-config-volume:/etc/gitlab&#39;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="s1">&#39;gitlab-log-volume:/var/log/gitlab&#39;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="s1">&#39;gitlab-data-volume:/var/opt/gitlab&#39;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="s1">&#39;./docker-volumes/gitlab/ssl:/etc/gitlab/ssl&#39;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">volumes</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">gitlab-config-volume</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">gitlab-log-volume</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">gitlab-data-volume</span><span class="p">:</span><span class="w">&#10;</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>docker-compose.yml</span>
    </div>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/change-password_hu3f295538ccf72e0ec99dcad5d4c63996_44191_2560x1440_fit_box_3.png" data-gallery="" title="Contraseña de root"><img src="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/change-password_hu3f295538ccf72e0ec99dcad5d4c63996_44191_300x200_fit_box_3.png" width="281" height="200" alt="Contraseña de root" title="Contraseña de root"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/sing-in_hue89707dcc5c5de11c60f0a85274f050b_42041_2560x1440_fit_box_3.png" data-gallery="" title="Inicio de sesión"><img src="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/sing-in_hue89707dcc5c5de11c60f0a85274f050b_42041_300x200_fit_box_3.png" width="280" height="200" alt="Inicio de sesión" title="Inicio de sesión"  class="lozad "></a></p>
<figcaption>Contraseña e inicio de sesión</figcaption>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/welcome_hu2da1e5fdf1b426fa9452872d3bd4a19b_52228_2560x1440_fit_box_3.png" data-gallery="" title="Página de bienvenida"><img src="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/welcome_hu2da1e5fdf1b426fa9452872d3bd4a19b_52228_300x200_fit_box_3.png" width="300" height="145" alt="Página de bienvenida" title="Página de bienvenida"  class="lozad "></a></p>
<figcaption>Página de bienvenida</figcaption>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/profile_hu55e86529b7a0f31262c5a2c1b23c311f_100271_2560x1440_fit_box_3.png" data-gallery="" title="Perfil de usuario"><img src="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/profile_hu55e86529b7a0f31262c5a2c1b23c311f_100271_300x200_fit_box_3.png" width="215" height="200" alt="Perfil de usuario" title="Perfil de usuario"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/admin-area_hu2bc627e32bd560de9019a98c885f2cf6_91134_2560x1440_fit_box_3.png" data-gallery="" title="Área de administración"><img src="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/admin-area_hu2bc627e32bd560de9019a98c885f2cf6_91134_300x200_fit_box_3.png" width="300" height="166" alt="Área de administración" title="Área de administración"  class="lozad "></a></p>
<figcaption>Perfil de usuario y área de administración</figcaption>
</figure>
</div>
<p>Iniciada sesión ya se puede empezar a usar GitLab a crear usuarios con sus claves SSH, repositorios de Git pudiendo importar otros existentes, crear nuevos, páginas de una wiki y peticiones, integración y entrega continua y personalizar el panel <em>kanban</em> con el flujo que deseamos que sigan las peticiones en la organización, por ejemplo, <em>planning</em>, <em>ready</em>, <em>doing</em>, <em>review</em>, <em>merged</em> y <em>deployed</em>.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/new-proyect_hu551d53ebe6ff130f5283b65bd7d57bcf_146652_2560x1440_fit_box_3.png" data-gallery="" title="Nuevo proyecto"><img src="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/new-proyect_hu551d53ebe6ff130f5283b65bd7d57bcf_146652_300x200_fit_box_3.png" width="300" height="164" alt="Nuevo proyecto" title="Nuevo proyecto"  class="lozad "></a></p>
<figcaption>Nuevo proyecto</figcaption>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/new-issue_hu7402a5aeec834bb2c1b9692593fe6d54_88682_2560x1440_fit_box_3.png" data-gallery="" title="Nueva petición"><img src="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/new-issue_hu7402a5aeec834bb2c1b9692593fe6d54_88682_300x200_fit_box_3.png" width="300" height="144" alt="Nueva petición" title="Nueva petición"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/issues-board_hu5059f50581f26d8841e090624a928783_64972_2560x1440_fit_box_3.png" data-gallery="" title="Panel de peticiones"><img src="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/issues-board_hu5059f50581f26d8841e090624a928783_64972_300x200_fit_box_3.png" width="300" height="144" alt="Panel de peticiones" title="Panel de peticiones"  class="lozad "></a></p>
<figcaption>Nueva petición y panel de peticiones</figcaption>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/new-wiki-page_hu56ffba61cfee3aad93461a4d9826c6ee_67467_2560x1440_fit_box_3.png" data-gallery="" title="Nueva página wiki"><img src="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/new-wiki-page_hu56ffba61cfee3aad93461a4d9826c6ee_67467_300x200_fit_box_3.png" width="300" height="156" alt="Nueva página wiki" title="Nueva página wiki"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/wiki-page_hu9d2686a12d158d298665c940d773eac8_48317_2560x1440_fit_box_3.png" data-gallery="" title="Página wiki"><img src="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/wiki-page_hu9d2686a12d158d298665c940d773eac8_48317_300x200_fit_box_3.png" width="300" height="144" alt="Página wiki" title="Página wiki"  class="lozad "></a></p>
<figcaption>Página wiki</figcaption>
</figure>
</div>
<p>Creado un proyecto GitLab e introducida la clave pública SSH nos proporciona la dirección URL con la que se puede clonar, convertir una carpeta existente en un repositorio o añadir un repositorio existente. Una vez con el repositorio en el sistema de archivos local se puede empezar a subir, modificar y eliminar archivos del repositorio de control de versiones. Hecho algún <em>commit</em> y subido algún archivo desde GitLab se puede ver el contenido del repositorio de Git.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span><span class="lnt">4&#10;</span><span class="lnt">5&#10;</span><span class="lnt">6&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ git clone ssh://git@gitlab:8022/root/test.git&#10;</span></span><span class="line"><span class="cl">$ <span class="nb">cd</span> <span class="nb">test</span>&#10;</span></span><span class="line"><span class="cl">$ touch README.md&#10;</span></span><span class="line"><span class="cl">$ git add README.md&#10;</span></span><span class="line"><span class="cl">$ git commit -m <span class="s2">&#34;add README&#34;</span>&#10;</span></span><span class="line"><span class="cl">$ git push -u origin master</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>clone-repository.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span><span class="lnt">4&#10;</span><span class="lnt">5&#10;</span><span class="lnt">6&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ <span class="nb">cd</span> <span class="nb">test</span>&#10;</span></span><span class="line"><span class="cl">$ git init&#10;</span></span><span class="line"><span class="cl">$ git remote add origin ssh://git@gitlab:8022/root/test.git&#10;</span></span><span class="line"><span class="cl">$ git add .&#10;</span></span><span class="line"><span class="cl">$ git commit -m <span class="s2">&#34;Initial commit&#34;</span>&#10;</span></span><span class="line"><span class="cl">$ git push -u origin master</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>existing-folder.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span><span class="lnt">4&#10;</span><span class="lnt">5&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> <span class="nb">test</span>&#10;</span></span><span class="line"><span class="cl">git remote rename origin old-origin&#10;</span></span><span class="line"><span class="cl">git remote add origin ssh://git@gitlab:8022/root/test.git&#10;</span></span><span class="line"><span class="cl">git push -u origin --all&#10;</span></span><span class="line"><span class="cl">git push -u origin --tags</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>existing-repository.sh</span>
    </div>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/project-details-1_hua47bf6d38b0dd5109067886cedcd51c2_134607_2560x1440_fit_box_3.png" data-gallery="" title="Detalles de proyecto"><img src="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/project-details-1_hua47bf6d38b0dd5109067886cedcd51c2_134607_300x200_fit_box_3.png" width="222" height="200" alt="Detalles de proyecto" title="Detalles de proyecto"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/project-details-2_hud95fc715f3e235e843f2be32102e7524_152847_2560x1440_fit_box_3.png" data-gallery="" title="Detalles de proyecto"><img src="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/project-details-2_hud95fc715f3e235e843f2be32102e7524_152847_300x200_fit_box_3.png" width="289" height="200" alt="Detalles de proyecto" title="Detalles de proyecto"  class="lozad "></a></p>
<figcaption>Detalles de proyecto</figcaption>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/source-file_hufc00af2bd9f3dc146f74ce204a45b1ae_76527_2560x1440_fit_box_3.png" data-gallery="" title="Contenido de archivo código fuente"><img src="https://picodotdev.github.io/blog-bitix/2017/12/gitlab-la-completa-herramienta-integrada-para-desarrollo-de-software/images/source-file_hufc00af2bd9f3dc146f74ce204a45b1ae_76527_300x200_fit_box_3.png" width="300" height="144" alt="Contenido de archivo código fuente" title="Contenido de archivo código fuente"  class="lozad "></a></p>
<figcaption>Contenido de archivo de código fuente</figcaption>
</figure>
</div>
<p>Otras formas de usar GitLab es desde la nube de <a href="https://aws.amazon.com/es/ec2/">Amazon EC2</a> o de forma SaaS a un coste de entre 39 € y 199 € por usuario y mes pero si la nube no es una opción una de las ventajas de GitLab es que se puede instalar en algún sistema propio de cualquiera de las formas anteriores y tener proyecto privados. GitLab es otra herramienta que a añadiría a <a href="https://picodotdev.github.io/blog-bitix/2015/06/nueva-visita-a-herramientas-para-un-proyecto-java/">Herramientas para un proyecto Java</a>. Hay alguna cosa adicional a conocer <a href="https://docs.gitlab.com/ce/update/README.html">como realizar una actualización</a> cuando se publique una nueva versión o <a href="https://docs.gitlab.com/ce/raketasks/backup_restore.html#creating-a-backup-of-the-gitlab-system">como hacer copias de seguridad y restaurarlas</a>. Lo que he mostrado aquí son solo una introducción a unas pocas de las muchas posibilidades de GitLab.</p>
<div class="alert alert-secondary sourcecode">
    <img src="https://picodotdev.github.io/blog-bitix/assets/images/icons/terminal.svg" width="64" height="64" alt="Terminal" title="Terminal" class="lozad sourcecode-icon">
    <p>
            El <a href="https://github.com/picodotdev/blog-ejemplos/tree/master/GitLab">código fuente completo del ejemplo</a> puedes descargarlo del repositorio de ejemplos de Blog Bitix alojado en GitHub y probarlo en tu equipo ejecutando siguiente comando:<br><code>docker-compose up</code></p>
</div>
]]>
        </content>
        
            
                <category term="planeta-codigo"/>
            
                <category term="software"/>
            
                <category term="software-libre"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2017/12/como-eliminar-metainformacion-de-las-fotos-en-gnu-linux/</id>
        <title>Como eliminar metainformación de las fotos en GNU/Linux</title>
        <updated>2017-12-22T18:00:00+01:00</updated>
        <published>2017-12-22T18:00:00+01:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2017/12/como-eliminar-metainformacion-de-las-fotos-en-gnu-linux/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/gnu.svg" width="200" height="196" alt="GNU" title="GNU"  class=""></p>
</div>
<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/linux.svg" width="200" height="232" alt="Linux" title="Linux"  class=""></p>
</div>
<p>En los archivos de las fotos e imágenes además de su información visual gráfica, los millones de píxeles, se guarda información adicional relacionada con la misma, por ejemplo, con que modelo de cámara se realizó, la fecha y la hora a la que se realizó, e incluso la localización si la cámara dispone de GPS u otro medio de ubicación como posicionamiento mediante la red de datos móvil o WIFI.</p>
<p>Compartir la foto en redes sociales ya es compartir mucha información y un peligro para la privacidad pero si además va acompañada de esta metainformación lo es algo más. Esta metainformación, información sobre la información, información sobre la imagen, son los <a href="https://es.wikipedia.org/wiki/Exchangeable_image_file_format">datos EXIF</a> y se guardan embebidos en el propio archivo de la foto.</p>
<p>Podemos obtener la metainformación guardada en la foto de diferentes formas. Una con la herramienta de visualización de imágenes de nuestro entorno de escritorio, en mi caso con el visor de imágenes de <a href="https://www.gnome.org/">GNOME</a> o con las propiedades de archivo de <a href="https://www.microsoft.com/es-es/windows/">Windows</a> (botón derecho del ratón sobre el archivo &gt; Propiedades). Otra es usando la herramienta ImageMagick.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/12/como-eliminar-metainformacion-de-las-fotos-en-gnu-linux/images/visor-imagenes_hu4963d27b856a96c5f47e229f55955a16_987189_2560x1440_fit_box_3.png" data-gallery="" title="Visor de imágenes de GNOME"><img src="https://picodotdev.github.io/blog-bitix/2017/12/como-eliminar-metainformacion-de-las-fotos-en-gnu-linux/images/visor-imagenes_hu4963d27b856a96c5f47e229f55955a16_987189_300x200_fit_box_3.png" width="136" height="200" alt="Visor de imágenes de GNOME" title="Visor de imágenes de GNOME"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/12/como-eliminar-metainformacion-de-las-fotos-en-gnu-linux/images/propiedades-imagen_hu70383a2fb948f1bd506ced73d1cb1367_48909_2560x1440_fit_box_3.png" data-gallery="" title="Propiedades de imagen con metadatos"><img src="https://picodotdev.github.io/blog-bitix/2017/12/como-eliminar-metainformacion-de-las-fotos-en-gnu-linux/images/propiedades-imagen_hu70383a2fb948f1bd506ced73d1cb1367_48909_300x200_fit_box_3.png" width="207" height="200" alt="Propiedades de imagen con metadatos" title="Propiedades de imagen con metadatos"  class="lozad "></a></p>
<figcaption>Imagen y propiedades con metadatos</figcaption>
</figure>
</div>
<p>Instalado el paquete <a href="https://www.imagemagick.org">ImageMagick</a> de nuestra distribución <a href="https://www.gnu.org/">GNU</a>/<a href="https://www.linux.com/">Linux</a>, en este caso con <a href="https://www.archlinux.org/">Arch Linux</a> la metainformación de una foto se obtiene con el comando:</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ identify -verbose planton-roble.jpg$ identify -verbose planton-roble.jpg&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>identify.sh</span>
    </div>
</div>
<p>Si la foto incluye personas algunas redes sociales como <a href="https://www.facebook.com/">Facebook</a> permiten identificarlas, acompañada de metainformación además informa de con que, con quién, cuando y donde se tomó la foto. Si te importa y quieres proteger tu privacidad un poco es aconsejable eliminar esta metainformación al subir o compartir las fotos en las redes sociales. Con ImageMagick se puede eliminar la metainformación con los siguientes comandos. El primero modifica el archivo original y el segundo crea una copia de la foto sin la metainformación:</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ mogrify -strip *.jpg&#10;</span></span><span class="line"><span class="cl">$ convert -strip source.jpg destination.jpg &#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>mogrify-convert.sh</span>
    </div>
</div>
<p><a href="https://help.twitter.com/es/using-twitter/tweeting-gifs-and-pictures">Twitter elimina los datos EXIF</a> de las fotos aunque utiliza la ubicación de la foto para realizar sugerencias de ubicaciones. <a href="https://www.facebook.com/">Facebook</a> creo que también elimina los datos EXIF al menos al visualizarlas, también <a href="https://www.whatsapp.com/">WhatsApp</a> y <a href="https://telegram.org/">Telegram</a>. Pero al compartir los archivos de fotos de forma directa como correo electrónico o por algún otro medio los metadatos seguirán estando presentes.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/12/como-eliminar-metainformacion-de-las-fotos-en-gnu-linux/images/planton-roble_hud0fc0db0d78a6f19c535a581fd7f4ddd_615910_2560x1440_fit_q90_box.jpg" data-gallery="" title="Imagen con datos EXIF"><img src="https://picodotdev.github.io/blog-bitix/2017/12/como-eliminar-metainformacion-de-las-fotos-en-gnu-linux/images/planton-roble_hud0fc0db0d78a6f19c535a581fd7f4ddd_615910_300x200_fit_q90_box.jpg" width="150" height="200" alt="Imagen con datos EXIF" title="Imagen con datos EXIF"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/12/como-eliminar-metainformacion-de-las-fotos-en-gnu-linux/images/planton-roble-noexif_hu1c1e87beb0ed78012360b8f81c258ebb_646306_2560x1440_fit_q90_box.jpg" data-gallery="" title="Imagen sin datos EXIF"><img src="https://picodotdev.github.io/blog-bitix/2017/12/como-eliminar-metainformacion-de-las-fotos-en-gnu-linux/images/planton-roble-noexif_hu1c1e87beb0ed78012360b8f81c258ebb_646306_300x200_fit_q90_box.jpg" width="150" height="200" alt="Imagen sin datos EXIF" title="Imagen sin datos EXIF"  class="lozad "></a></p>
<figcaption>Imagen izquierda con datos EXIF, imagen derecha sin datos EXIF</figcaption>
</figure>
</div>
<p>¿Puedes averiguar el dispositivo, la fecha en la que hizo la foto y con que software fotográfico se editó?</p>
<p>Independientemente de los datos EXIF al compartir fotos hay que tener un poco de cuidado, si tu privacidad no te importa mucho y compartes cualquier cosa personal tuya y así lo has decidido, tú mismo, eso sí simplemente se respetuoso y respeta la privacidad de las personas de las que tienes intención de compartir fotos. Ten en cuenta que compartir que estás de vacaciones, amigos, familiares y con el resto del historial de tu red social se puede conocer bastante acerca de la vida de una persona.</p>
]]>
        </content>
        
            
                <category term="gnu-linux"/>
            
                <category term="planeta-codigo"/>
            
                <category term="software-libre"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2017/08/instalar-y-renovar-un-certificado-de-lets-encrypt-en-nginx/</id>
        <title>Instalar y renovar un certificado de Let&#39;s Encrypt en Nginx</title>
        <updated>2017-08-18T17:00:00+02:00</updated>
        <published>2017-08-12T11:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2017/08/instalar-y-renovar-un-certificado-de-lets-encrypt-en-nginx/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Let&rsquo;s Encrypt es una entidad que emite certificados TLS/SSL que son reconocidos como de confianza por los navegadores web. Usando esta entidad de certificación es posible obtener y renovar un certificado TLS/SSL de forma automatizada, rápida y sin coste alguno.</strong></p>]]>
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/lets-encrypt.svg" width="350" height="83" alt="Let&amp;#39;s Encrypt" title="Let&amp;#39;s Encrypt"  class=""></p>
</div>
<p><a href="https://www.google.es/">Google</a> ha anunciado que su buscador va a considerar el uso del protocolo seguro HTTPS como un criterio de <abbr title="Search Engine Optimization">SEO</abbr> y posicionamiento en la lista de resultados, posicionando mejor aquellas páginas web que usen el protocolo seguro. Además, el navegador <a href="https://www.google.es/chrome/browser/desktop/">Chrome</a> va a advertir al usuario para algunas páginas que usen solo HTTP que esas páginas son inseguras. Por estos motivos y para mayor seguridad y privacidad del usuario es conveniente usar el protocolo seguro HTTPS.</p>
<p>El mayor inconveniente de usar el protocolo seguro HTTPS es que es necesario un certificado firmado por una autoridad de confianza instalada en el navegador del usuario. Hasta ahora había que comprar el certificado que puede llegar a tener un coste de más de 100 €, instalarlo en el servidor y renovarlo antes de su fecha de expiración. Tareas quizá manuales por tanto tediosas y propensas a que surjan errores o se nos olvide hacer la renovación del certificado sobre todo si son múltiples los certificados a gestionar.</p>
<p>Para mejorar la seguridad en la web y facilitar la administración de certificados hace un tiempo se creó una entidad <a href="https://letsencrypt.org/">Let&rsquo;s Encrypt</a> asociado a la <a href="https://www.linuxfoundation.org/">Linux Foundation</a> con la que es posible automatizar la obtención y renovación de un certificado TLS/SSL firmado por una autoridad de confianza para los navegadores. Además Let&rsquo;s Encrypt permite obtener un certificado sin ningún coste, de forma gratuita.</p>
<p>Los pasos para usar en un servidor web un certificado de Let&rsquo;s Encrypt son los siguientes. Primero hay que instalar el <a href="https://www.archlinux.org/packages/community/any/certbot/">paquete certbot</a> según la distribución de GNU/Linux, en <a href="https://www.archlinux.org/">Arch Linux</a>:</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># pacman -S certbot</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>pacman.sh</span>
    </div>
</div>
<p>En el proceso de obtención del certificado demostraremos que somos los propietarios del sitio web a certificar. Usando <a href="https://nginx.org/">nginx</a> como servidor web, iniciado y el dominio a certificar con la opción <em>-d</em> se usa el siguiente comando:</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># certbot certonly --webroot -w /usr/share/nginx/html -d smaug.l5.ca</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>certbot.sh</span>
    </div>
</div>
<p>El certificado obtenido tiene una fecha de expiración de únicamente tres meses periodo antes del cual hay que renovarlo. Para hacer la renovación hay que usar el comando:</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># certbot renew</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>certbot-renew.sh</span>
    </div>
</div>
<p>La renovación del certificado se realiza cuando queda poco tiempo para que expire, unos 30 días, el siguiente comando permite comprobar antes si la configuración es correcta para realizar la renovación.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># certbot renew --dry-run</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>certbot-renew-dry-run.sh</span>
    </div>
</div>
<p>La clave privada y certificado que Let&rsquo;s Encrypt genera una vez el dominio se ha validado se ubican en el directorio <em>/etc/letsencrypt/live/</em> con una carpeta por cada dominio. También se puede ver desde la linea de comandos los certificados existentes y sus fechas de expiración.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ls /etc/letsencrypt/live/smaug.l5.ca</span>&#10;</span></span><span class="line"><span class="cl">cert.pem  chain.pem  fullchain.pem  privkey.pem&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>key-cert.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ sudo certbot certificates&#10;</span></span><span class="line"><span class="cl"><span class="o">[</span>sudo<span class="o">]</span> password <span class="k">for</span> raspberrypi: &#10;</span></span><span class="line"><span class="cl">Saving debug log to /var/log/letsencrypt/letsencrypt.log&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">-------------------------------------------------------------------------------&#10;</span></span><span class="line"><span class="cl">Found the following certs:&#10;</span></span><span class="line"><span class="cl">  Certificate Name: smaug.l5.ca&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;Domains: smaug.l5.ca&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;Expiry Date: 2017-10-21 09:18:00+00:00 <span class="o">(</span>VALID: <span class="m">70</span> days<span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;Certificate Path: /etc/letsencrypt/live/smaug.l5.ca/fullchain.pem&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;Private Key Path: /etc/letsencrypt/live/smaug.l5.ca/privkey.pem&#10;</span></span><span class="line"><span class="cl">-------------------------------------------------------------------------------</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>certbot-certificates.sh</span>
    </div>
</div>
<p>Dado el relativo poco tiempo de validez de los certificados es recomendable automatizar la renovación empleando una <a href="https://es.wikipedia.org/wiki/Cron_%28Unix%29">expresión cron</a>. La utilidad <em>certbot</em> solo hace la renovación del certificado cuando queda menos de un més para su expiración aunque se programe su ejecución en este caso cada 6 horas y en un minuto aleatorio que Let&rsquo;s Encrypt recomienda para que todos los usuarios no programen sus renovaciones al mismo tiempo:</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ sudo su&#10;</span></span><span class="line"><span class="cl"><span class="c1"># crontab -e</span>&#10;</span></span><span class="line"><span class="cl"><span class="m">0</span> */6 * * * sleep <span class="si">${</span><span class="nv">RANDOM</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">2</span><span class="si">}</span>m <span class="p">;</span> certbot renew --quiet --renew-hook <span class="s2">&#34;systemctl restart nginx.service&#34;</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>cron.sh</span>
    </div>
</div>
<p>Una vez que se ha renovado el certificado hay que reiniciar el servidor web para que lo utilice y para ello está el parámetro <em>--renew-hook</em> que ejecuta un comando cuando se produce una renovación. En el ejemplo anterior está el comando para reiniciar el servicio de nginx con el sistema gestión de procesos de <a href="https://www.freedesktop.org/wiki/Software/systemd/">systemd</a>.</p>
<p>Let&rsquo;s Encrypt con <em>certbot</em> comprueba si somos el propietario de un sitio web instalando en el servidor web un archivo que posteriormente antes de generar el certificado lo valida. Este archivo para nginx se ubica en el directorio <em>/usr/share/nginx/html/.well-known/acme-challenge/</em> y ha de estar accesible desde internet con el protocolo HTTP en la dirección <em>/.well-known/acme-challenge/</em> del servidor web.</p>
<p>La siguiente configuración del servidor web nginx redirige todo el tráfico usando el protocolo HTTPS excepto el contenido del directorio <em>/.well-known/acme-challenge/</em> que queda accesible por HTTP.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span><span class="lnt">26&#10;</span><span class="lnt">27&#10;</span><span class="lnt">28&#10;</span><span class="lnt">29&#10;</span><span class="lnt">30&#10;</span><span class="lnt">31&#10;</span><span class="lnt">32&#10;</span><span class="lnt">33&#10;</span><span class="lnt">34&#10;</span><span class="lnt">35&#10;</span><span class="lnt">36&#10;</span><span class="lnt">37&#10;</span><span class="lnt">38&#10;</span><span class="lnt">39&#10;</span><span class="lnt">40&#10;</span><span class="lnt">41&#10;</span><span class="lnt">42&#10;</span><span class="lnt">43&#10;</span><span class="lnt">44&#10;</span><span class="lnt">45&#10;</span><span class="lnt">46&#10;</span><span class="lnt">47&#10;</span><span class="lnt">48&#10;</span><span class="lnt">49&#10;</span><span class="lnt">50&#10;</span><span class="lnt">51&#10;</span><span class="lnt">52&#10;</span><span class="lnt">53&#10;</span><span class="lnt">54&#10;</span><span class="lnt">55&#10;</span><span class="lnt">56&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">worker_processes</span>  <span class="mi">1</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">events</span> <span class="p">{</span>&#10;</span></span><span class="line"><span class="cl">  <span class="kn">worker_connections</span> <span class="mi">64</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl"><span class="p">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">http</span> <span class="p">{</span>&#10;</span></span><span class="line"><span class="cl">  <span class="kn">include</span>&nbsp;&nbsp;&nbsp;&nbsp;   <span class="s">mime.types</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">  <span class="kn">default_type</span>  <span class="s">application/octet-stream</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">  <span class="kn">sendfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="no">on</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">  <span class="c1">#tcp_nopush&nbsp;&nbsp;&nbsp;&nbsp; on;&#10;</span></span></span><span class="line"><span class="cl"><span class="c1"></span>&#10;</span></span><span class="line"><span class="cl">  <span class="kn">keepalive_timeout</span>  <span class="mi">65</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">  <span class="kn">gzip</span> <span class="no">on</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">  <span class="kn">gzip_disable</span> <span class="s">&#34;msie6&#34;</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">  <span class="kn">gzip_vary</span> <span class="no">on</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">  <span class="kn">gzip_proxied</span> <span class="s">any</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">  <span class="kn">gzip_comp_level</span> <span class="mi">6</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">  <span class="kn">gzip_buffers</span> <span class="mi">16</span> <span class="mi">8k</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">  <span class="kn">gzip_http_version</span> <span class="mi">1</span><span class="s">.1</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">  <span class="kn">gzip_types</span> <span class="s">text/plain</span> <span class="s">text/css</span> <span class="s">application/json</span> <span class="s">application/x-javascript</span> <span class="s">text/xml</span> <span class="s">application/xml</span> <span class="s">application/xml+rss</span> <span class="s">text/javascript</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">  <span class="kn">server</span> <span class="p">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">listen</span>&nbsp;&nbsp;&nbsp;&nbsp;   <span class="mi">80</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">server_name</span>  <span class="s">localhost</span> <span class="s">smaug.l5.ca</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">location</span> <span class="s">/.well-known/</span> <span class="p">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="kn">allow</span> <span class="s">all</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="kn">alias</span> <span class="s">/usr/share/nginx/html/.well-known/</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>&nbsp;&nbsp;&nbsp;&nbsp;&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="kn">return</span> <span class="mi">301</span> <span class="s">https://</span><span class="nv">$host$request_uri</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span>&#10;</span></span><span class="line"><span class="cl">  <span class="p">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">  <span class="kn">server</span> <span class="p">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">listen</span>&nbsp;&nbsp;&nbsp;&nbsp;   <span class="mi">443</span> <span class="s">ssl</span> <span class="s">http2</span> <span class="s">default_server</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">server_name</span>  <span class="s">localhost</span> <span class="s">smaug.l5.ca</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">ssl_certificate</span>&nbsp;&nbsp;&nbsp;&nbsp;  <span class="s">/etc/letsencrypt/live/smaug.l5.ca/cert.pem</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">ssl_certificate_key</span>  <span class="s">/etc/letsencrypt/live/smaug.l5.ca/privkey.pem</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">ssl_protocols</span> <span class="s">TLSv1.1</span> <span class="s">TLSv1.2</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">ssl_ciphers</span>   <span class="s">HIGH:!aNULL:!MD5</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">ssl_session_cache</span>   <span class="s">shared:SSL:1m</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">ssl_session_timeout</span> <span class="mi">3m</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="kn">root</span>   <span class="s">/usr/share/nginx/html</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;  <span class="kn">index</span>  <span class="s">index.html</span> <span class="s">index.htm</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span>&#10;</span></span><span class="line"><span class="cl">  <span class="p">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>nginx.conf</span>
    </div>
</div>
<p>Y este es el resultado al acceder con el navegador al sitio web que tengo instalado en una <a href="https://www.raspberrypi.org/">Raspberry Pi</a> accesible desde internet con un dominio de <a href="https://freedns.afraid.org/">FreeDNS</a>:</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/08/instalar-y-renovar-un-certificado-de-lets-encrypt-en-nginx/images/smaug-1_hu12a4623b7f6c5a899b17fffa3e5f273d_39940_2560x1440_fit_box_3.png" data-gallery="" title="Sitio web con certificado de Let&amp;#39;s Encrypt"><img src="https://picodotdev.github.io/blog-bitix/2017/08/instalar-y-renovar-un-certificado-de-lets-encrypt-en-nginx/images/smaug-1_hu12a4623b7f6c5a899b17fffa3e5f273d_39940_300x200_fit_box_3.png" width="285" height="200" alt="Sitio web con certificado de Let&amp;#39;s Encrypt" title="Sitio web con certificado de Let&amp;#39;s Encrypt"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/08/instalar-y-renovar-un-certificado-de-lets-encrypt-en-nginx/images/smaug-2_hu4cb5bdb44c9d0e30ac5cc5600a4ff243_32417_2560x1440_fit_box_3.png" data-gallery="" title="Sitio web con certificado de Let&amp;#39;s Encrypt"><img src="https://picodotdev.github.io/blog-bitix/2017/08/instalar-y-renovar-un-certificado-de-lets-encrypt-en-nginx/images/smaug-2_hu4cb5bdb44c9d0e30ac5cc5600a4ff243_32417_300x200_fit_box_3.png" width="300" height="198" alt="Sitio web con certificado de Let&amp;#39;s Encrypt" title="Sitio web con certificado de Let&amp;#39;s Encrypt"  class="lozad "></a></p>
<figcaption>Sitio web con certificado de Let&#39;s Encrypt</figcaption>
</figure>
</div>
<p>En la documentación del proyecto de Let&rsquo;s Encrypt hay explicaciones más detalladas sobre <a href="https://letsencrypt.org/how-it-works/">como funciona</a>, <a href="https://letsencrypt.org/docs/rate-limits/">límites de uso</a>, <a href="https://certbot.eff.org/docs/using.html">como usarlo</a> y <a href="https://certbot.eff.org/">varias guías según el servidor web y distribución GNU/Linux</a>.</p>
]]>
        </content>
        
            
                <category term="planeta-codigo"/>
            
                <category term="seguridad"/>
            
                <category term="software"/>
            
                <category term="software-libre"/>
            
                <category term="web"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2017/06/hemeroteca-11/</id>
        <title>Hemeroteca #11</title>
        <updated>2017-11-25T13:00:00+01:00</updated>
        <published>2017-06-24T10:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2017/06/hemeroteca-11/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        
        <![CDATA[<p>Desde hace ya tiempo escribir y publicar en el blog es una de las cosas que realmente me gustan y me motivan a pesar de que el blog me requiere mucho tiempo de mi tiempo personal, cada artículo me exige entre 5 y 10 horas de dedicación durante el fin de semana y en mi tiempo libre. Es satisfactorio ver que cada semana y cada mes el número de visitas aumentan a un ritmo rozando los dos dígitos y que también se nota en los <a href="https://picodotdev.github.io/blog-bitix/series/donacion/">ingresos por publicidad de AdSense que en parte dono</a> a alguno de los proyectos de software libre que usó o me parecen interesante apoyarles económicamente aunque sea de forma pequeña.</p>
<p>Aún no he llegado al punto de plantearme seriamente abandonar el blog y recuperar mi tiempo para leer, ver películas que ahora me descargo pero pocas veo, andar en bicicleta, pasear u otras cosas, a veces pienso que le dedico mucho tiempo al blog, antes escribía un artículo a la semana, ahora estoy publicando muchas dos artículos faltándome más tiempo para editar y publicar los artículos que para redactarlos. La fe de poder de usar en un trabajo muchas de las herramientas de escribo, que es uno de mis motivaciones de tener el blog, me mantiene escribiendo aunque la realidad es que llevo ya 3 lustros trabajando y en prácticamente la totalidad de proyectos la tecnología estaba ya decidida e impuesta.</p>
<p>El número de visitas ha aumentado notablemente de unas 9K páginas vistas en enero de 2016 a unas 30K en enero de 2017 y ahora a finales de junio unas 60K. Solamente en estos seis primeros meses ya he duplicado el tráfico mayoritariamente proveniente del buscador Google. Los ingresos por AdSense también han aumentado notablemente de 15 € pasando a 50 € mensuales con los que ahora cada dos meses recibo una transferencia de Google en mi cuenta corriente lo que empieza a ser una cantidad respetable aunque no compense por ello solamente la dedicación que requiere.</p>
<p>Más del 90% del tráfico que recibo proviene del buscador Google y el resto de tráfico directo o de referencia. Solo unos 5 artículos son los que reciben la mayor parte de las visitas y que intento aprovechar para que los usuarios accedan a otros artículos relacionados. El aumento de visitas se debe a que con el paso del tiempo habré posicionado mejor algunos artículos en Google y en menor medida a los nuevos que he publicado. A Google creo que le gustan los sitios que publican nuevo contenido con asiduidad y regularmente en primera instancia y en medida similar si es de calidad. De enero de 2014 a enero de 2016 el crecimiento parece plano pero también fue constante aunque simplemente se ve enmascarado por el de los últimos meses.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/06/hemeroteca-11/images/analytics_hua65fb47a1fc6b7d99ab1ef790400d702_57891_2560x1440_fit_box_3.png" data-gallery="" title="Analytics"><img src="https://picodotdev.github.io/blog-bitix/2017/06/hemeroteca-11/images/analytics_hua65fb47a1fc6b7d99ab1ef790400d702_57891_300x200_fit_box_3.png" width="300" height="116" alt="Analytics" title="Analytics"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/06/hemeroteca-11/images/gadsense_hu5f43ec457b6633535f99ef05b77d9384_26656_2560x1440_fit_box_3.png" data-gallery="" title="AdSense"><img src="https://picodotdev.github.io/blog-bitix/2017/06/hemeroteca-11/images/gadsense_hu5f43ec457b6633535f99ef05b77d9384_26656_300x200_fit_box_3.png" width="300" height="90" alt="AdSense" title="AdSense"  class="lozad "></a></p>
<figcaption>Evolución visitas e ingresos</figcaption>
</figure>
</div>
<p>Analizando los ingresos y visitas de mi blog y divagando cual sería el tráfico que debería generar para vivir únicamente blog si con 60K páginas vistas obtengo 50 € en ingresos al mes, debería multiplicar por ¿30, 40? el tráfico de este momento para vivir del blog, pero siendo más modesto multiplicar por 5 o 10 ya serían unos ingresos muy notables y algo que parece alcanzable aunque no sea fácilmente, ¿cuantas visitas mensuales son esas para una web? ¿3,6M de páginas vistas al mes? ¿300K o 600K siendo más modesto?. Quizá si publicase en inglés la audiencia sería mayor, aún no se cual es el tráfico que poseen otras páginas hispanas personales de temática tecnológica, software libre o programación más conocidos para saber cual es el límite de visitas alcanzable en este nicho de temática ya que los blogs que sigo en pocos he visto esta misma exhivición impúdica de datos que incluyo aquí (si como blogger te sientes aludido ya tienes tema para un artículo ;). Medios como <a href="https://www.xataka.com/">Xataka</a> o <a href="https://www.genbeta.com/">Genbeta</a> por citar algunos tecnológicos muy conocidos profesionales, empresariales o de grupos editoriales con las vistas que tienen deben generar suficiente tráfico para que sus ingresos solo en publicidad costeen los gastos de los redactores, servidores, viajes, paguen algunos sueldos, etc.</p>
<p>Cambiando de tema y yendo a la hemeroteca en la lista de artículos que he publicado en estos seis meses están los siguientes, en total 40 (incluido este) nuevos artículos únicos y fabricados artesanalmente a mano. Este semestre he hecho dos donaciones de 60 € y publicados otros tantos artículos comentando a que proyectos.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/01/articulo-3-de-yo-apoyo-al-software-libre/">Artículo #3 de Yo apoyo al software libre</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/05/articulo-4-de-yo-apoyo-al-software-libre/">Artículo #4 de Yo apoyo al software libre</a></li>
</ul>
<p>Este semestre he publicado una nueva serie sobre electrónica aprovechando que compre un kit con varios elementos electrónicos con los que jugar para la <a href="https://www.raspberrypi.org/">Raspberry Pi</a> 3 que he usado en la 1, se ha compuesto de un total de 10 artículos y aún podría escribir alguno más pero lo dejaré para otro momento si recupero las ganas de cacharrear con el hardware otra vez.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/02/desempaquetado-del-kit-de-iniciacion-a-la-electronica-para-la-raspberry-pi/">Desempaquetado del kit de iniciación a la electrónica para la Raspberry Pi</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/03/ejemplo-hello-world-con-java-en-la-raspberry-pi/">Ejemplo Hello World con Java en la Raspberry Pi</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/03/ejemplo-encender-y-apagar-diodo-led-con-la-raspberry-pi-en-java/">Ejemplo encender y apagar diodo LED con la Raspberry Pi en Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/03/controlar-un-display-lcd-1602-para-mostrar-texto-con-la-raspberry-pi-y-java/">Controlar un display LCD 1602 para mostrar texto con la Raspberry Pi y Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/03/ejemplo-de-jni-usar-codigo-en-c-desde-java/">Ejemplo de JNI, usar código en C desde Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/03/obtener-la-temperatura-y-humedad-con-el-sensor-dht11-la-raspberry-pi-c-y-java/">Obtener la temperatura y humedad con el sensor DHT11, la Raspberry Pi, C y Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/04/como-usar-un-diodo-led-un-pulsador-y-un-zumbador-con-la-raspberry-pi-y-java/">Cómo usar un diodo LED, un pulsador y un zumbador con la Raspberry Pi y Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/04/ejemplo-sensor-de-golpes-y-detector-movimiento-en-la-raspberry-pi-con-java/">Ejemplo sensor de golpes y detector de movimiento en la Raspberry Pi con Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/05/controlar-un-servomotor-con-la-raspberry-pi-y-java/">Controlar un servomotor con la Raspberry Pi y Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/05/luces-navidenas-con-la-raspberry-pi-y-java/">Luces navideñas con la Raspberry Pi y Java</a></li>
</ul>
<p>La otra serie de varios artículos publicados durante otras tantas semanas ha sido sobre <a href="https://docs.docker.com/swarm/">Docker Swarm</a> continuando y completando un poco más la serie sobre <a href="https://www.docker.com/">Docker</a> para crear <em>clusters</em> de nodos con la tecnología de la se se está hablando mucho y está transformando el estado del arte para el despliegue, ejecución y distribución de servicios.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/03/introduccion-y-ejemplo-de-cluster-de-contenedores-con-docker-swarm/">Introducción y ejemplo de cluster de contenedores con Docker Swarm</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/04/iniciar-un-stack-de-servicios-en-un-cluster-de-docker-swarm/">Iniciar un stack de servicios en un cluster de Docker Swarm</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/04/escalar-y-actualizar-un-servicio-de-un-cluster-de-docker-swarm/">Escalar y actualizar un servicio de un cluster de Docker Swarm</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/04/contenedores-en-docker-swarm-con-volumenes-de-datos-persistentes-usando-rex-ray-y-virtualbox/">Contenedores en Docker Swarm con volúmenes de datos persistentes usando REX-Ray y VirtualBox</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/04/informacion-sensible-en-contenedores-con-docker-secrets/">Información sensible en los contenedores con Docker Secrets</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/04/imagenes-de-docker-con-alpine-linux/">Imágenes de Docker con Alpine Linux</a></li>
</ul>
<p>Entre otros artículos que he publicado está un <em>script</em> para instalar <a href="https://www.archlinux.org/">Arch Linux</a> de forma desatendida, automatizada y personalizable. Dado que Arch Linux no posee un instalador y hay que introducir los comandos directamente en la terminal para realizar la instalación después de leer una buena cantidad de documentación de la estupenda <a href="https://wiki.archlinux.org/">wiki de Arch Linux</a>, este <em>script</em> sirve para instalar Arch Linux de forma sencilla o como consulta de los comandos a ejecutar paso a paso para instalar esta distribución.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-facil-rapido-desatendido-automatizado-y-personalizable/">Script para instalar Arch Linux fácil, rápido, desatendido, automatizado y personalizable</a></li>
</ul>
<p>También he publicado algún que otro artículo de opinión de dos noticias relevantes que se han producido en este periodo de tiempo, como son el ataque del <em>ransomware</em> WannaCry y que afectó a algunas empresas y organizaciones y relacionado con este tema me preguntaba si las distribuciones GNU/Linux son más seguras que Windows. También daba mi opinión sobre el el anuncio de Shuttleworth de abandonar la convergencia con el servidor gráfico Mir y el entorno de escritorio Unity. Y un último sobre la diferencia de trato para bien de <a href="https://www.pepephone.com/">Pepephone</a> con lo que es habitual en otras empresas de telecomunicaciones para mal.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/01/distribuciones-gnu-linux-mas-seguras-que-windows/">Distribuciones GNU/Linux, ¿más seguras que Windows?</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/05/sobre-el-anuncio-de-shuttleworth-de-abandonar-unity-y-mir-y-volver-a-gnome-en-ubuntu/">Sobre el anuncio de Shuttleworth de abandonar Unity y Mir y volver a GNOME en Ubuntu</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/05/sobre-el-ataque-de-ransomware-que-ha-sufrido-telefonica-y-otras-empresas/">Sobre el ataque de ransomware que ha sufrido Telefonica y otras empresas</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/06/asi-trata-pepephone-a-sus-clientes/">Así trata Pepephone a sus clientes</a></li>
</ul>
<p>Dos artículos para usuarios sin muchos conocimientos de como instalar <a href="https://www.microsoft.com/es-es/windows/">Windows</a> o la distribución <a href="https://www.ubuntu.com/">Ubuntu</a> de <a href="https://www.gnu.org/">GNU</a>/<a href="https://www.linux.com/">Linux</a>. Explicando paso a paso y detalladamente con capturas de pantalla cuales son los pasos para realizar la instalación desde cero.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-windows-10-paso-a-paso-desde-cero/">Descargar e instalar Windows 10 paso a paso desde cero</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/">Descargar e instalar la distribución Ubuntu de GNU/Linux paso a paso desde cero</a></li>
</ul>
<p>Un par de artículos patrocinados de los cuales uno ha sido otra forma de ingreso.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/02/cursos-de-formacion-de-keepcoding/">Cursos de formación de KeepCoding</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/">Servidores Cloud VPS de Clouding.io para hospedar blogs y páginas web</a></li>
</ul>
<p>También he publicado un par de artículos en inglés traducción de otros que publique en español como experimento para comprobar que tal se indexan en Google y si alguno de ellos atrae visitas a mi blog.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2016/01/windows-10-and-office-2016-as-easy-to-use-without-license-as-always/">Windows 10 and Office 2016 as easy to use without license as always</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2016/05/4-free-office-suites-alternatives-to-microsoft-office/">3 office alternative options to Microsoft Office</a></li>
</ul>
<p>Habiendo publicado dos series con una buena cantidad de artículos este semestre he publicado pocos artículos de programación. A destacar de estos últimos ha sido el resumen como en años anteriores de la conferencia <a href="https://bilbostack.com/">BilboStack</a> celebrada en febrero de las presentaciones a las que asistí. Varios artículos sobre diferentes tipos de bases de datos relacionales, de documentos y de clave valor representadas por <a href="https://www.postgresql.org/">PostgreSQL</a>, <a href="https://www.mongodb.com/">MongoDB</a> y <a href="https://redis.io/">Redis</a>. También como realizar autenticación mutua entre cliente y servidor con certificados ya sea con el programa <em>curl</em>, una aplicación en la plataforma Java o con un navegador web.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/01/registro-y-descubrimiento-de-servicios-con-spring-cloud-y-consul/">Registro y descubrimiento de servicios con Spring Cloud y Consul</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/02/conferencia-bilbostack-2017/">Conferencia BilboStack 2017</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/02/como-crear-un-servicio-de-systemd-para-una-aplicacion-con-spring-boot/">Cómo crear un servicio de systemd para una aplicación con Spring Boot</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/02/ejemplo-de-rabbitmq-con-java-para-enviar-y-recibir-mensajes/">Ejemplo de RabbitMQ con Java para enviar y recibir mensajes</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/05/introduccion-a-la-base-de-datos-relacional-postgresql/">Introducción a la base de datos relacional PostgreSQL</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/05/introduccion-a-la-base-de-datos-nosql-mongodb/">Introducción a la base de datos NoSQL MongoDB</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/06/usar-la-base-de-datos-nosql-mongodb-con-java/">Usar la base de datos NoSQL MongoDB con Java</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/06/introduccion-a-la-base-de-datos-nosql-redis/">Introducción a la base de datos NoSQL Redis</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/06/autenticacion-mutua-de-cliente-y-servidor-con-certificados/">Autenticación mutua de cliente y servidor con certificados</a></li>
</ul>
<p>Para acabar publique un artículo de un cargador de pilas recargables, un paquete de pilas de la marca blanca de Amazon y un reloj con un pequeño análisis y múltiples fotos.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2017/03/desempaquetado-de-cargador-de-pilas-recargables-pilas-recargables-aa-y-reloj-despertador/">Desempaquetado de cargador de pilas recargables, pilas recargables AA y reloj despertador</a></li>
</ul>
<p>Que disfrutéis leyendo algunos de los artículos que publiqué y aprovechar para suscribiros con vuestro lector de <em>feeds</em> preferido a Blog Bitix para no perderos ninguno de los que publique en el siguiente semestre que posiblemente verse bastante sobre Java.</p>
]]>
        </content>
        
            
                <category term="blog"/>
            
                <category term="java"/>
            
                <category term="planeta-codigo"/>
            
                <category term="programacion"/>
            
                <category term="software"/>
            
                <category term="software-libre"/>
            
                <category term="tapestry"/>
            
                <category term="gnu-linux"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/</id>
        <title>Descargar e instalar la distribución Ubuntu de GNU/Linux paso a paso desde cero</title>
        <updated>2020-07-03T19:00:00+02:00</updated>
        <published>2017-05-13T09:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Pasar de usar Windows a usar una distribución GNU/Linux es un paso difícil para muchos usuarios, algunos usuarios desconocen incluso que tienen la posibilidad de usar un sistema operativo alternativo a Windows. O si lo conocen pueden creer erróneamente que instalar una distribución GNU/Linux es muy complicado&hellip; sabiendo algunas casas por lo demás es tan sencillo instalar como el sistema operativo Windows ya que muchas distribuciones incluyen una interfaz gráfica en su instalador y el proceso consiste en responder unas pocas preguntas, introducir algunos datos y pulsar varios botones siguiente.</strong></p>]]>
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/ubuntu.svg" width="200" height="200" alt="Ubuntu" title="Ubuntu"  class=""></p>
</div>
<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/linux.svg" width="200" height="232" alt="Linux" title="Linux"  class=""></p>
</div>
<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/gnu.svg" width="200" height="196" alt="GNU" title="GNU"  class=""></p>
</div>
<p>Quizá hayas oído hablar de Linux o <a href="https://www.gnu.org/">GNU</a>/<a href="https://www.linux.com/">Linux</a> como alternativa al sistema operativo de Microsoft <a href="https://www.microsoft.com/es-es/windows/">Windows</a> y sientes curiosidad por probarlo y adentrarte con ello en el mundo del software libre. Si estás leyendo esta guía y te es necesaria para instalar una de las muchas distribuciones de GNU/Linux entiendo que necesitas ayuda para saber como instalarlo desde cero, paso a paso y empezando desde lo más básico.</p>
<p>En GNU/Linux para cada tarea que un usuario quiera realizar hay múltiples opciones entre las que elegir, desde tareas ofimáticas como <a href="https://www.libreoffice.org/">LibreOffice</a>, navegadores web como <a href="https://www.mozilla.org/es-ES/firefox/new/">Firefox</a> o <a href="https://www.google.es/chrome/browser/desktop/">Chrome</a>, mensajería instantánea como <a href="https://wiki.gnome.org/action/show/Apps/Empathy">Empathy</a>, correo electrónico como <a href="https://wiki.gnome.org/Apps/Evolution/">Evolution</a>, <a href="https://www.thunderbird.net/es-ES/">Thunderbird</a> o <a href="https://wiki.gnome.org/Apps/Geary">Geary</a>, reproductores de música o vídeo como <a href="https://www.videolan.org/vlc/">VLC</a>, visor de imágenes y archivos PDF, edición fotográfica como <a href="https://www.gimp.org/">GIMP</a>, edición de vídeo como <a href="https://www.openshot.org/">OpenShot</a>, <a href="https://picodotdev.github.io/blog-bitix/2016/08/22-plus-buenos-juegos-en-gnu-linux/">algunos juegos destacables</a>, &hellip; en todos los casos hay un programa de software libre por el que no hay que pagar una licencia ni buscar <em>cracks</em> para activar el software que son fuente de virus y problemas de seguridad. Y ya desde hace mucho tiempo en GNU/Linux el hardware es reconocido y usable en su mayor parte desde el primer momento incluyendo la tarjeta gráfica, sonido, red, bluetooth, wifi, HDMI, USB, &hellip; aunque alguno puede necesitar instalar sus controladores de dispositivo.</p>
<p>Debes saber es en GNU/Linux hay muchas versiones o distribuciones, muchas desarrolladas por personas sin ánimo de lucro que se agrupan formando comunidades y otras que tienen el soporte de una empresa pero que a los usuarios les ofrece la distribución sin ningún coste ni necesidad de adquirir licencias. Una distribución está formada por el conjunto de programas de software o paquetes, repositorios de paquetes y gestor de paquetes. Hay muchas distribuciones, y muchas son cientos, pero no más de 10 con una cuota de uso dentro de las distros significativa.</p>
<p>El paso de Windows a GNU/Linux significa usar un nuevo entorno y es algo que muchos de los usuarios que hoy somos de GNU/Linux hemos dado en algún momento, yo empecé por pasar <a href="https://elblogdepicodev.blogspot.com.es/2010/03/de-windows-arch-linux.htmlindex-amp.html">De Windows a Arch Linux</a> y aún me mantengo <a href="https://picodotdev.github.io/blog-bitix/2014/08/de-arch-linux-a-arch-linux/">De Arch Linux a Arch Linux</a>. GNU/Linux tiene sus puntos fuertes y algunos para los usuarios de escritorio menos fuertes, principalmente debido a no ser el sistema mayoritario los fabricantes tienen más en cuenta a Windows cuando lanzan un nuevo producto, en el caso de los juegos triple A o la excesiva fragmentación por la cantidad de opciones. En cualquier caso muchas distribuciones GNU/Linux son tan fáciles de usar como Windows o <a href="https://www.apple.com/macos/">macOS</a> y tan o más capaces que estos.</p>
<p>Lo primero que debes hacer es <a href="https://picodotdev.github.io/blog-bitix/2016/10/elegir-una-distribucion-gnu-linux-segun-el-usuario-uso-o-equipo/">decidir la distribución que quieres instalar</a>, según tus preferencias y necesidades. Para los usuarios que van a tener su primer contacto con GNU/Linux algunas de las recomendadas son <a href="https://www.ubuntu.com/">Ubuntu</a> o <a href="https://elementary.io/es/">elementaryOS</a>.</p>
<p>Ubuntu es una de las muchas distribuciones de GNU/Linux existentes y una de las recomendadas para los usuarios principiantes y con más conocimientos por su buen funcionamiento. Las versiones LTS de Ubuntu tienen <a href="https://ubuntu.com/about/release-cycle">ciclo de desarrollo</a> con un soporte de largo plazo de 5 años para corrección de errores y fallos de seguridad. Las versiones LTS se publican cada dos años. Salvo que estés afectado por <em>versionitis</em> y quieras tener las últimas versiones de los programas la versión LTS más reciente es la recomendable y suficiente en vez de la última versión no LTS.</p>
<p>Para instalar Ubuntu solo se necesita una memoria USB de 4 GiB de capacidad, el medio de instalación y unos 30 minutos para completar el proceso de instalación. Ubuntu instalado ocupa unos 10 GiB de espacio pero dependiendo de las aplicaciones que se quieran instalar, los documentos personales, fotos, vídeos y otros archivos el espacio recomendado es mayor.</p>
<p>En este artículo explicaré como instalar Ubuntu en su versión 20.04 <abbr title="Long Term Support">LTS</abbr>.</p>
<div class="alert alert-warning tableofcontents"><h2>Contenido del artículo</h2><toc></toc></div>
<h3 id="requisitos-mínimos">Requisitos mínimos</h3>
<p>Los <a href="https://help.ubuntu.com/community/Installation/SystemRequirements">requisitos mínimos de Ubuntu</a> son bastante bajos para cualquier sistema de unos pocos años, menores que los requeridos para instalar Windows. Aunque en la memoria es recomendable tener al menos 2 GiB o incluso 4 GiB. Cualquier equipo medio de de la última década cumple estos requisitos.</p>
<ul>
<li>Procesador 2 GHz con dos núcleos o mejor</li>
<li>Memoria RAM del sistema de 4 GiB</li>
<li>25 GB de espacio de almacenamiento</li>
<li>Gráficos con resolución de al menos 1024x768</li>
<li>Unidad USB o CD/DVD</li>
<li>Acceso a internet es recomendable</li>
</ul>
<h3 id="crear-una-copia-de-seguridad">Crear una copia de seguridad</h3>
<p>Al instalar Ubuntu todos los datos que tuviese el equipo se perderán por lo que si quieres conservarlos debes copiarlos previamente a un disco duro externo o memoria USB de la capacidad que necesiten tus archivos, una vez finalizada la instalación de Ubuntu puedes recuperarlos y copiarlos al equipo de nuevo.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2016/05/como-realizar-copias-de-seguridad-en-windows-con-freefilesync/">Cómo realizar copias de seguridad en Windows con FreeFileSync</a></li>
</ul>
<h3 id="descargar-el-medio-de-instalación-de-ubuntu">Descargar el medio de instalación de Ubuntu</h3>
<p>Antes de iniciar la instalación hay que <a href="https://ubuntu.com/download/desktop">descargar la imágen ISO</a> de la versión de Ubuntu que queramos instalar desde la <a href="https://www.ubuntu.com/">página oficial de la distribución</a>, solo es necesario un navegador web para descargar de forma directa el archivo que es la imagen del medio de instalación, un archio de extensión <em>iso</em> que ocupa casi 3 GiB. El archivo también es descargable mediante la red de compartición de archivos entre usuarios <em>torrent</em>. Ubuntu proporciona <a href="https://ubuntu.com/download/flavours">varias versiones de su distribución</a> donde varía principalmente el entorno de escritorio que también debes elegir según tus preferencias, hay varias posibilidades entre ellas dos de las más preferidas están <a href="https://www.gnome.org/">GNOME</a> y <a href="https://www.kde.org/">KDE</a>. Cualquiera de ellas con un aspecto gráfico muy cuidado, intuitivas y fáciles de usar. La opción más similar al entorno de escritorio de Windows es KDE con la que te encontrarás bastante cómodo al usarla si provienes de Windows.</p>
<ul>
<li><a href="https://www.ubuntu.com/">Ubuntu</a></li>
<li><a href="https://ubuntu.com/download/flavours">Más sabores de Ubuntu</a></li>
</ul>
<h3 id="crear-el-medio-de-instalación-usb">Crear el medio de instalación USB</h3>
<p>Para una mayor velocidad de instalación es mejor usar una memoria USB de al menos 8 GiB de capacidad en vez un disco CD o DVD que son más lentos y algunos equipos nuevos ya ni siquiera incorporan estas unidades porque están en desuso con la aparición de las memorias USB más rápidas, fiables, de mayor capacidad y más pequeñas. La memoria debe estar vacía ya que se perderán todos sus datos. Con el <a href="https://rufus.akeo.ie/">programa Rufus para Windows</a> seleccionado el archivo de la imagen ISO descargada y la unidad USB se crea el medio de instalación, en la siguiente página está explicado como <a href="https://ubuntu.com/tutorials/tutorial-create-a-usb-stick-on-windows">crear una memoria USB arrancable en Windows</a>.</p>
<p>Hay que conectar una memoria USB, seleccionarla, seleccionar el archivo de la imagen ISO de Ubuntu y pulsar el botón <em>Empezar</em>, al cabo de unos minutos la memoria estará lista para empezar a instalar Ubuntu.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/rufus_hud9b0e05f6272fca4d03a6a3ac68655b9_30106_2560x1440_fit_box_3.png" data-gallery="" title="Creación de medio de instalación en memoria USB desde Windows"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/rufus_hud9b0e05f6272fca4d03a6a3ac68655b9_30106_300x200_fit_box_3.png" width="143" height="200" alt="Creación de medio de instalación en memoria USB desde Windows" title="Creación de medio de instalación en memoria USB desde Windows"  class="lozad "></a></p>
<figcaption>Creación de medio de instalación en memoria USB dese Windows</figcaption>
</figure>
</div>
<h3 id="iniciar-el-sistema-con-el-medio-de-instalación">Iniciar el sistema con el medio de instalación</h3>
<p>Con el equipo apagado y la memoria USB contactada a un puerto hay que iniciar el equipo para que se inicie desde la memoria USB. La forma de hacer que el equipo arranque desde la memoria USB depende de cual sea el fabricante. Pulsando una tecla dependiendo de caso como F2, F8, F10, F12, ESC u otra se puede entrar en la BIOS o seleccionar el medio de instalación. La BIOS es una zona de configuración donde se modifican algunos parámetros del equipo muy importantes con lo que hay que tener cuidado de que se modifica para evitar comportamientos anómalos, a pesar de todo suele ser bastante intuitiva y si es un equipo reciente incluso con interfaz gráfica.</p>
<p>Según el fabricante e incluso modelos de la misma fabricante la tecla de acceso para iniciar desde el medio de instalación varía:</p>
<ul>
<li>Acer: F2 o Delete</li>
<li>Asus: F2 o F10</li>
<li>Dell: F2, F1, Delete, F12 o F3</li>
<li>HP: F10 o Esc</li>
<li>Lenovo: F1 o F2</li>
<li>Sony: F2, F3, F1 o tecla assist</li>
<li>Toshiba: F2, F1, Esc</li>
</ul>
<p>En las siguientes páginas puedes encontrar varias posibles teclas para entrar en la BIOS y cambiar la unidad de inicio del sistema según la marca, <a href="http://www.makeuseof.com/tag/enter-bios-computer/">I</a>, <a href="https://www.lifewire.com/bios-setup-utility-access-keys-for-major-bios-manufacturers-2624461">II</a> y <a href="https://www.lifewire.com/bios-setup-utility-access-keys-for-popular-computer-systems-2624463">III</a>.</p>
<p>Puede ser el caso de que cuando se inicia el equipo muestre un mensaje con la tecla que hay que pulsar si hay que probar hasta dar con ella. Después de pulsar la tecla de encendido poco después o según se muestra un logotipo es cuando hay que pulsar la tecla.</p>
<p>Si tu sistema tiene una BIOS de tipo UEFI, cualquier equipo del último lustro su BIOS será de este tipo, se debe <a href="https://help.ubuntu.com/community/UEFI">desactivar la opción llamada <em>Secure Boot</em></a> que utiliza Windows como medida de seguridad pero que no está soportada aún en GNU/Linux.</p>
<h3 id="instalar-ubuntu">Instalar Ubuntu</h3>
<p>Al iniciar el instalador al principio de todo se ofrece la posibilidad de probar Ubuntu sin realizar ningún cambio al equipo, esto permite comprobar que funciona correctamente y no hay problemas de compatibilidad con el hardware importantes. La mayoría de hardware es reconocido sin necesidad de instalar controladores específicos. Una vez realizada la prueba se puede iniciar la instalación.</p>
<p>El instalador que guía en la instalación de Ubuntu realiza varias preguntas a responder por el usuario e introducir algunos pocos datos y en cuestión de menos de una hora el equipo ya está listo para empezar a usarse. En el artículo he utilizado la versión 20.04 LTS.</p>
<p>El asistente de instalación pregunta:</p>
<ul>
<li>El idioma.</li>
<li>Si se quieren descargar las actualizaciones (recomendable) y software para reproducir mp3, flash así como controladores para la tarjeta gráfica y wifi.</li>
<li>Borrar el contenido del disco duro y si se quieren cifrar los datos del dispositivo de almacenamiento.</li>
<li>La clave para cifrar los datos del dispositivo de almacenamiento.</li>
<li>Una confirmación para proceder a borrar el disco duro e iniciar la instalación.</li>
<li>La zona horaria del usuario y la disposición del teclado.</li>
<li>El nombre del equipo, del usuario y la contraseña para iniciar sesión.</li>
</ul>
<p>Inicio del asistente.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-01_hu80b54ae6d26ed74c8ff630b97e4e1a59_7536_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-01_hu80b54ae6d26ed74c8ff630b97e4e1a59_7536_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-02_hue61c454da241ba3b9f34aabd0a3426c9_25965_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-02_hue61c454da241ba3b9f34aabd0a3426c9_25965_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-03_hu55c148391a13d866cca89aa9443502ac_16789_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-03_hu55c148391a13d866cca89aa9443502ac_16789_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a></p>
</figure>
</div>
<p>Pasos en los que solicitan unos pocos datos como el idioma, la disposición del teclado, tipo de instalación, ubicación y el usuario y contraseña de inicio de sesión.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-04_huc76ead5dbdf5b1de7cf5125c303ac8ad_171153_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-04_huc76ead5dbdf5b1de7cf5125c303ac8ad_171153_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-05_huc76ead5dbdf5b1de7cf5125c303ac8ad_183562_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-05_huc76ead5dbdf5b1de7cf5125c303ac8ad_183562_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-06_huc76ead5dbdf5b1de7cf5125c303ac8ad_177997_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-06_huc76ead5dbdf5b1de7cf5125c303ac8ad_177997_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a></p>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-07_hu381a470e33f4c2bfbf820a7503983527_167587_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-07_hu381a470e33f4c2bfbf820a7503983527_167587_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-08_hu71ffffd1791dada8be6e27259b5aae1f_264576_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-08_hu71ffffd1791dada8be6e27259b5aae1f_264576_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-09_hu7297958323b89f21231a1636f9932ae6_171082_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-09_hu7297958323b89f21231a1636f9932ae6_171082_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a></p>
</figure>
</div>
<p>El resto de la instalación Ubuntu copia los archivos necesarios al dispositivo de almacenamiento.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-10_hu7297958323b89f21231a1636f9932ae6_537592_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-10_hu7297958323b89f21231a1636f9932ae6_537592_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-11_huc1426316a4ed6f2012682e7c075d3d85_465000_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-11_huc1426316a4ed6f2012682e7c075d3d85_465000_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-12_huc1426316a4ed6f2012682e7c075d3d85_557165_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-12_huc1426316a4ed6f2012682e7c075d3d85_557165_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a></p>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-13_huc1426316a4ed6f2012682e7c075d3d85_587499_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-13_huc1426316a4ed6f2012682e7c075d3d85_587499_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-14_huc1426316a4ed6f2012682e7c075d3d85_541738_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-14_huc1426316a4ed6f2012682e7c075d3d85_541738_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-15_huc1426316a4ed6f2012682e7c075d3d85_466681_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-15_huc1426316a4ed6f2012682e7c075d3d85_466681_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a></p>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-16_huc1426316a4ed6f2012682e7c075d3d85_456501_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-16_huc1426316a4ed6f2012682e7c075d3d85_456501_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-17_hufa7c092d7c9aa209a34bd5ca12e3d152_543631_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-17_hufa7c092d7c9aa209a34bd5ca12e3d152_543631_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-18_huff631f4c20736869f4fb89d6e13c0c71_545095_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-18_huff631f4c20736869f4fb89d6e13c0c71_545095_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a></p>
</figure>
</div>
<p>Al final de la instalación se solicita reiniciar para realizar el primer arranque.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-19_hu084d7f6229b142343d723a9a8664c9f2_570056_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-19_hu084d7f6229b142343d723a9a8664c9f2_570056_300x200_fit_box_3.png" width="267" height="200" alt="Instalación de Ubuntu" title="Instalación de Ubuntu"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-20_hu0c56d68ee1f731dc74618ca35c91b523_18266_2560x1440_fit_box_3.png" data-gallery=""><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/instalacion-ubuntu-20_hu0c56d68ee1f731dc74618ca35c91b523_18266_300x200_fit_box_3.png" width="267" height="200"  class="lozad "></a></p>
<figcaption>Instalación de Ubuntu</figcaption>
</figure>
</div>
<h3 id="primer-inicio-de-sesión-ubuntu">Primer inicio de sesión Ubuntu</h3>
<p>Si se ha elegido cifrar el contenido del dispositivo de almacenamiento al realizar la instalación en el inicio del sistema Ubuntu pregunta por la contraseña para descifrar su contenido. Por seguridad se solicita el usuario y contraseña introducir en los pasos de la instalación.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/ubuntu-01_hu83ba0553d32bfef8f287514a9f51ac52_16759_2560x1440_fit_box_3.png" data-gallery="" title="Ubuntu 20.04"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/ubuntu-01_hu83ba0553d32bfef8f287514a9f51ac52_16759_300x200_fit_box_3.png" width="267" height="200" alt="Ubuntu 20.04" title="Ubuntu 20.04"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/ubuntu-02_hu455d48947f641dde79fe0e60cc6a4df7_17472_2560x1440_fit_box_3.png" data-gallery=""><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/ubuntu-02_hu455d48947f641dde79fe0e60cc6a4df7_17472_300x200_fit_box_3.png" width="267" height="200"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/ubuntu-03_hu1516d9e7cb3580cf7f58f2a80fa637e8_21310_2560x1440_fit_box_3.png" data-gallery="" title="Ubuntu 20.04 con entorno de escritorio Unity"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/ubuntu-03_hu1516d9e7cb3580cf7f58f2a80fa637e8_21310_300x200_fit_box_3.png" width="267" height="200" alt="Ubuntu 20.04 con entorno de escritorio Unity" title="Ubuntu 20.04 con entorno de escritorio Unity"  class="lozad "></a></p>
</figure>
</div>
<p>Este es el aspecto del entorno de escritorio con GNOME de Ubuntu 20.04. En la parte izquierda se encuentra el lanzador de aplicaciones con varios iconos. En la parte superior izquierda está a acción actividades con la que buscar el resto de aplicaciones instaladas, el la parte superior derecha el menú del sistema desde donde se puede apagar, reiniciar el equipo o variar el volumen del sistema entre otras opciones de configuración.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/ubuntu-04_hu688947c873613f770b8fce072759e364_634897_2560x1440_fit_box_3.png" data-gallery="" title="Ubuntu 20.04 con entorno de escritorio GNOME"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/ubuntu-04_hu688947c873613f770b8fce072759e364_634897_300x200_fit_box_3.png" width="267" height="200" alt="Ubuntu 20.04 con entorno de escritorio GNOME" title="Ubuntu 20.04 con entorno de escritorio GNOME"  class="lozad "></a></p>
<figcaption>Ubuntu 20.04 con entorno de escritorio GNOME</figcaption>
</figure>
</div>
<h3 id="realizar-tareas-básicas-para-instalar-programas-obtener-actualizaciones-y-mantenimiento">Realizar tareas básicas para instalar programas, obtener actualizaciones y mantenimiento</h3>
<p>Después de instalar Ubuntu es necesario conocer como realizar algunas tareas básicas de mantenimiento para tener actualizado el sistema, para obtener importantes actualizaciones de seguridad, correcciones de errores, nuevas funcionalidades, instalar nuevos programas y desinstalar los programas que se dejan de usar además empezar a conocer la terminal.</p>
<ul>
<li><a href="https://picodotdev.github.io/blog-bitix/2020/02/tareas-basicas-de-administracion-y-uso-despues-de-instalar-una-distribucion-gnu-linux/">Tareas básicas después de instalar una distribución GNU/Linux</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2020/02/las-aplicaciones-integradas-del-entorno-de-escritorio-gnome/">Las aplicaciones del entorno de escritorio de GNOME</a></li>
<li><a href="https://picodotdev.github.io/blog-bitix/2020/03/listado-de-programas-esenciales-segun-categoria-para-gnu-linux/">Listado de programas esenciales según categoría para GNU/Linux</a></li>
</ul>
<p>Ubuntu por defecto ya incorpora una buena cantidad de software preinstalado. En cualquier caso con la aplicación <em>Software de Ubuntu</em> se puede instalar más. Al cabo de un tiempo de haber instalado Ubuntu se publicarán actualizaciones del software que tengas instalado con mejoras y correcciones de seguridad que son recomendables instalarlas usando la aplicación <em>Ubuntu Software</em>. Ubuntu comprueba periódicamente si hay nuevas actualizaciones, si las hay muestra una notificación con cuales son y permite realizar la actualización a conveniencia del usuario. Una vez instaladas las actualizaciones algunas requieren reiniciar el sistema para que surtan efecto.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/ubuntu-software_hubdb830f2826f6688b0b8fa1e5f87f040_158219_2560x1440_fit_box_3.png" data-gallery="" title="Instalar y desinstalar software"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/ubuntu-software_hubdb830f2826f6688b0b8fa1e5f87f040_158219_300x200_fit_box_3.png" width="267" height="200" alt="Instalar y desinstalar software" title="Instalar y desinstalar software"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/ubuntu-actualizaciones_hu3b9a8ab8614b95a6f0f7f998145f0351_538937_2560x1440_fit_box_3.png" data-gallery="" title="Notificación de actualizaciones de Ubuntu"><img src="https://picodotdev.github.io/blog-bitix/2017/05/descargar-e-instalar-la-distribucion-ubuntu-de-gnu-linux-paso-a-paso-desde-cero/images/ubuntu-actualizaciones_hu3b9a8ab8614b95a6f0f7f998145f0351_538937_300x200_fit_box_3.png" width="267" height="200" alt="Notificación de actualizaciones de Ubuntu" title="Notificación de actualizaciones de Ubuntu"  class="lozad "></a></p>
<figcaption>Instalar software y notificación de actualizaciones de seguridad</figcaption>
</figure>
</div>
<h3 id="obtener-ayuda">Obtener ayuda</h3>
<p>En internet hay gran cantidad de artículos en blogs o foros con ayuda que puedes encontrar con un buscador web como <a href="https://www.google.es/">Google</a> o <a href="https://duckduckgo.com/">DuckDuckGo</a>. En ellos seguramente encontrarás una respuesta que te resuelva o ayude en cualquier problema que se te presente o duda que te surja.</p>
<p>Si has leído este artículo y te decides a dar el salto a GNU/Linux deja un comentario, me gusta leer que he ayudado a alguien y si tienes alguna duda y no encuentras una respuesta en la web pregúntame en un comentario e intentaré darle respuesta.</p>
]]>
        </content>
        
            
                <category term="gnu-linux"/>
            
                <category term="planeta-codigo"/>
            
                <category term="software"/>
            
                <category term="software-libre"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2017/05/articulo-4-de-yo-apoyo-al-software-libre/</id>
        <title>Artículo #4 de Yo apoyo al software libre</title>
        <updated>2017-05-06T11:00:00+02:00</updated>
        <published>2017-05-06T11:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2017/05/articulo-4-de-yo-apoyo-al-software-libre/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        
        <![CDATA[<p>En los últimos meses las visitas que estoy recibiendo en Blog Bitix están creciendo cada mes entre un 5% y 10%, junto con el número de visitas los ingresos por la publicidad AdSense también estoy notando que está aumentando en proporción similar o incluso más aún. Cuando hace no tanto un buen mes generaba unos 12 € y uno malo 6 € ahora el <em>blog</em> me está reportando entre 18 € y 40 € al mes. Además, en este último periodo he escrito un artículo patrocinado sobre <a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/">Servidores Cloud VPS en la nube</a> para <a href="https://clouding.io/">Clouding.io</a> que también ha sido otra forma de ingreso. El punto negativo de todo esto es que solo son unos pocos artículos los que se llevan la mayor parte del tráfico de mi <em>blog</em>, aún así el resto de artículos contribuyen a que las visitas e ingresos aumenten constantemente.</p>
<p>Como cada vez que desde hace un tiempo recibo una transferencia en mi cuenta por la publicidad <a href="https://www.google.com/adsense/">AdSense</a> o a través del programa de <a href="https://afiliados.amazon.es">afiliados de Amazon</a> me he planteado realizar unas pocas donaciones económicas a algunos de los proyectos de software libre que uso habitualmente o creo que son merecedores de una donación. En anteriores ocasiones han sido a la <a href="https://fsfe.org/index.en.html">FSFE</a>, <a href="https://es.wikipedia.org/wiki/Wikipedia:Portada">Wikipedia</a>, <a href="https://www.mozilla.org/es-ES/firefox/new/">Firefox</a>, <a href="https://elementary.io/es/">Elementary OS</a>, <a href="https://archlinuxarm.org/">Arch Linux ARM</a> y <a href="https://www.libreoffice.org/">Libre Office</a>.</p>
<h3 id="gnome">GNOME</h3>
<p>Uno de los proyectos a los que he donado esta vez ha sido al entorno de escritorio <a href="https://www.gnome.org/">GNOME</a> que uso en mi equipo con <a href="https://www.gnu.org/">GNU</a>/<a href="https://www.linux.com/">Linux</a> ya desde la época de la versión 2.30 allá por el 2010 y continué utilizándolo desde los inicios turbulentos de la versión 3.0 en la que todavía era un nuevo concepto del escritorio inmaduro pero que desde entonces ha mejorado notablemente en cada nueva versión publicada con una cadencia puntual cada seis meses. A partir de la versión 3.16 o 3.18 el escritorio de GNOME empezó a completar la visión de sus desarrolladores y satisfacer con las expectativas de muchos más usuarios en cuanto a funcionalidades y detalles gráficos. En las últimas versiones los cambios ya no son tan notables pero sigue mejorando.</p>
<div class="media">
<figure>
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/gnome.svg" width="200" height="200" alt="GNOME" title="GNOME"  class="lozad "></p>
</figure>
</div>
<h3 id="videolan-vlc">VideoLAN (VLC)</h3>
<p>Otro proyecto al que he donado ha sido el <a href="https://www.videolan.org/vlc/">reproductor de multimedia VLC</a> del que no me gusta mucho su interfaz gráfica pero que funciona muy bien y es capaz de reproducir cualquier formato de archivo multimedia ya sea de audio o vídeo. Además de este proyecto me encargo de la traducción al español.</p>
<div class="media">
<figure>
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/vlc.svg" width="200" height="200" alt="VLC" title="VLC"  class="lozad "></p>
</figure>
</div>
<h3 id="arch-linux">Arch Linux</h3>
<p>Finalmente, he donado a <a href="https://www.archlinux.org/">Arch Linux</a> que es la distribución de GNU/Linux que ya uso de manera constante desde hace unos años después de usar en unos pequeños periodos <a href="https://www.ubuntu.com/">Ubuntu</a> y <a href="https://www.debian.org/">Debian</a>. Al ser una distribución <em>rolling release</em> o en constante actualización no es necesario reinstalar cada nueva versión basta con actualizar el equipo cada unas semanas para tener las últimas versiones de cada paquete de software que se encuentre en sus repositorios de paquetes. La última reinstalación de Arch Linux que hice en mi equipo es de principios del 2014, no por actualizar el equipo cada unas semanas he tenido problemas con las nuevas versiones o los he resuelto fácilmente leyendo la excelente <a href="https://wiki.archlinux.org/">wiki</a>, los <a href="https://bbs.archlinux.org/">foros</a> o la página principal con las noticias de la distribución.</p>
<p>Por un problema con el medio de pago que usa Arch Linux, <a href="http://spi-inc.org/">Software in the Public Interest (SPI)</a>, para hacer donaciones directas no he podido pagar con mi tarjeta de crédito, finalmente he optado por comprar unas pegatinas para poner en el portátil, unas de Arch Linux, otras de Linux y otras de GNOME en <a href="http://www.unixstickers.com/">unixstickers</a>.</p>
<div class="media">
<figure>
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/archlinux.svg" width="250" height="250" alt="Arch Linux" title="Arch Linux"  class="lozad "></p>
</figure>
</div>
<h3 id="comprobantes-de-las-donaciones">Comprobantes de las donaciones</h3>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/05/articulo-4-de-yo-apoyo-al-software-libre/images/donacion-gnome_hubf624972ca565d573fd01c595ad5be73_114825_2560x1440_fit_box_3.png" data-gallery="" title="Donación GNOME"><img src="https://picodotdev.github.io/blog-bitix/2017/05/articulo-4-de-yo-apoyo-al-software-libre/images/donacion-gnome_hubf624972ca565d573fd01c595ad5be73_114825_650x450_fit_box_3.png" width="273" height="450" alt="Donación GNOME" title="Donación GNOME"  class="lozad "></a></p>
<figcaption>Donación GNOME</figcaption>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/05/articulo-4-de-yo-apoyo-al-software-libre/images/donacion-videolan_huc52f852ff4bf0144f6ce56770da8ce30_109043_2560x1440_fit_box_3.png" data-gallery="" title="Donación VideoLAN (VLC)"><img src="https://picodotdev.github.io/blog-bitix/2017/05/articulo-4-de-yo-apoyo-al-software-libre/images/donacion-videolan_huc52f852ff4bf0144f6ce56770da8ce30_109043_650x450_fit_box_3.png" width="297" height="450" alt="Donación VideoLAN (VLC)" title="Donación VideoLAN (VLC)"  class="lozad "></a></p>
<figcaption>Donación VideoLAN (VLC)</figcaption>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/05/articulo-4-de-yo-apoyo-al-software-libre/images/donacion-archlinux_hu6df8fc6b4d96b58de7e87afc49a732b7_101954_2560x1440_fit_box_3.png" data-gallery="" title="Donación Arch Linux"><img src="https://picodotdev.github.io/blog-bitix/2017/05/articulo-4-de-yo-apoyo-al-software-libre/images/donacion-archlinux_hu6df8fc6b4d96b58de7e87afc49a732b7_101954_650x450_fit_box_3.png" width="264" height="450" alt="Donación Arch Linux" title="Donación Arch Linux"  class="lozad "></a></p>
<figcaption>Donación Arch Linux</figcaption>
</figure>
</div>
<p>Las donaciones no son muy cuantiosas pero son una forma de entre las muchas que hay de colaborar con estos proyectos. Otras formas de colaborar son reportando de errores o que no requieren conocimiento técnico como traduciendo las aplicaciones al lenguaje español o simplemente compartiendo las imágenes torrent de las distribuciones GNU/Linux.</p>
<p>Si los ingresos que tengo siguen al mismo ritmo que los últimos meses, y parece que sí, en poco tiempo escribiré un nuevo artículo con los proyectos a los que he donado.</p>
<p><a href="https://www.gnu.org/">Yo apoyo al software libre</a></p>
<table class="table">
    <thead>
        <tr class="thead-dark">
            <th colspan="4">Donaciones que he realizado hasta la última fecha</th>
        </tr>
        <tr class="thead-light">
            <th>#</th>
            <th>Fecha</th>
            <th>Proyecto</th>
            <th>Donación</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1</td>
            <td>2015/12</td>
            <td>Free Software Foundation Europe (FSFE)</td>
            <td>40 €</td>
        </tr>
        <tr>
            <td>2</td>
            <td>2016/09</td>
            <td>Wikipedia, Mozilla/Firefox</td>
            <td>10 €, 10 €</td>
        </tr>
        <tr>
            <td>3</td>
            <td>2017/01</td>
            <td>elementaryOS, Libre Office, Arch Linux ARM</td>
            <td>10 €, 10 €, 10 €</td>
        </tr>
        <tr>
            <td>4</td>
            <td>2017/05</td>
            <td>GNOME, VideoLAN (VLC), Arch Linux</td>
            <td>15,31 €, 10 €, 0,31 €</td>
        </tr>
        <tr>
            <td>5</td>
            <td>2018/01</td>
            <td>LineageOS, Replicant</td>
            <td>15 €, 15 €</td>
        </tr>
        <tr>
            <td>6</td>
            <td>2018/12</td>
            <td>Wine</td>
            <td>$20</td>
        </tr>
        <tr>
            <td>7</td>
            <td>2019/12</td>
            <td>Calibre</td>
            <td>$10</td>
        </tr>
        <tr>
            <td>8</td>
            <td>2020/12</td>
            <td>Phoronix, Mozilla/Firefox, GnuPG</td>
            <td>$12, 10 €, 10 €</td>
        </tr>
        <tr>
            <td>9</td>
            <td>2022/01</td>
            <td>KeePassXC</td>
            <td>15 €</td>
        </tr>
        <tr>
            <td colspan="3">Total</td>
            <td>180 €, $42</td>
        </tr>
    </tbody>
</table>
]]>
        </content>
        
            
                <category term="planeta-codigo"/>
            
                <category term="software-libre"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2017/04/imagenes-de-docker-con-alpine-linux/</id>
        <title>Imágenes de Docker con Alpine Linux</title>
        <updated>2017-04-28T23:00:00+02:00</updated>
        <published>2017-04-28T23:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2017/04/imagenes-de-docker-con-alpine-linux/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/docker.svg" width="200" height="167" alt="Docker" title="Docker"  class=""></p>
</div>
<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/alpinelinux.svg" width="350" height="85" alt="Alpine Linux" title="Alpine Linux"  class=""></p>
</div>
<p>En el repositorio de imágenes <a href="https://registry.hub.docker.com/">Docker Hub</a> de <a href="https://www.docker.com/">Docker</a> hay múltiples versiones de cada software <em>contenirizado</em>, alguna de las versiones están etiquetadas con la palabra <em>alpine</em>. Las imágenes de Docker etiquetadas con <em>alpine</em> hacen referencia a que usan como base la distribución <a href="https://www.alpinelinux.org/">Alpine Linux</a> y la razón de usar Alpine Linux es que al ser una distribución minimalista basada en <a href="https://www.busybox.net/">busybox</a> y <a href="https://www.musl-libc.org/">musl-libc</a> hace que las imágenes ocupen bastante menos que una imagen equivalente por ejemplo basada en <a href="https://www.ubuntu.com/">Ubuntu</a> o <a href="https://www.debian.org/">Debian</a>, seguramente porque no contienen una buena cantidad de cosas innecesarias.</p>
<p>Por ejemplo, la <a href="https://hub.docker.com/_/openjdk/">imagen de Docker que contiene en JDK</a> de Java basada en Debian ocupa 643 MiB y la imagen de Java basada en Alpine Linux ocupa 101 MiB, una diferencia significativa de casi 500 MiB. Con la capacidad de los discos duros actuales no es tanto por lo que ocupan en disco sino por el tiempo que las imágenes tardan en descargarse desde el repositorio e iniciarse los contenedores como es el caso en un <a href="https://picodotdev.github.io/blog-bitix/2017/03/introduccion-y-ejemplo-de-cluster-de-contenedores-con-docker-swarm/">cluster de contenedores Docker</a>.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/04/imagenes-de-docker-con-alpine-linux/images/imagenes-docker_hu253efe971b278639688e2ea3de182c9f_81827_2560x1440_fit_box_3.png" data-gallery="" title="Imágenes de Docker con su tamaño. Ver imágenes openjdk, Ubuntu y Alpine. Linux"><img src="https://picodotdev.github.io/blog-bitix/2017/04/imagenes-de-docker-con-alpine-linux/images/imagenes-docker_hu253efe971b278639688e2ea3de182c9f_81827_300x200_fit_box_3.png" width="300" height="165" alt="Imágenes de Docker con su tamaño. Ver imágenes openjdk, Ubuntu y Alpine. Linux" title="Imágenes de Docker con su tamaño. Ver imágenes openjdk, Ubuntu y Alpine. Linux"  class="lozad "></a></p>
<figcaption>Imágenes de Docker con su tamaño. Ver imágenes openjdk, Ubuntu y Alpine Linux.</figcaption>
</figure>
</div>
<p>El tiempo de descarga solo se emplea la primera vez que se hace uso de una imagen pero como las imágenes se van actualizando hay que tener en cuenta que en cada nueva versión que se use hay que descargar una nueva imagen, cuanto más pequeñas sean las imágenes menos tiempo se emplea en descargarlas y más rápidamente se iniciarán los contenedores.</p>
<p>La <a href="https://hub.docker.com/_/ubuntu/">imagen base de Ubuntu</a> con la que crear nuevas ocupa 117 MiB y la <a href="https://hub.docker.com/_/alpine/">imagen base de Alpine Linux</a> únicamente 3.98 MiB. Si creamos imágenes propias basadas en Alpine Linux deberemos saber que esta distribución usa su propio gestor de paquetes <em>apk</em> y su propio <a href="https://pkgs.alpinelinux.org/packages">repositorio de paquetes</a>. Para <a href="https://picodotdev.github.io/blog-bitix/2014/11/como-crear-una-imagen-para-docker-usando-un-dockerfile/">crear una imagen de Docker</a> hay que usar los archivos <em>Dockerfile</em> que contienen las instrucciones para construir la imagen del contenedor.</p>
]]>
        </content>
        
            
                <category term="planeta-codigo"/>
            
                <category term="software-libre"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2017/04/informacion-sensible-en-los-contenedores-con-docker-secrets/</id>
        <title>Información sensible en los contenedores con Docker Secrets</title>
        <updated>2017-04-22T12:00:00+02:00</updated>
        <published>2017-04-22T12:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2017/04/informacion-sensible-en-los-contenedores-con-docker-secrets/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Parte de la información que usan los contenedores de Docker se debe proteger de accesos no deseados. Anteriormente en algunos casos se usaban variables de entorno para lanzar los contenedores lo que no es seguro si se listan los procesos del sistema con sus parámetros, incluir archivos en las imágenes de los contenedores tampoco es recomendable. Docker Secrets permite proporcionar y mantener segura la información sensible que usen los contenedores.</strong></p>]]>
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/docker.svg" width="200" height="167" alt="Docker" title="Docker"  class=""></p>
</div>
<p>Los contenedores de <a href="https://www.docker.com/">Docker</a> necesitan acceder a algunos datos sensibles desde el punto de vista de la seguridad como usuarios y contraseñas, certificados SSL, claves privadas SSH o cualquier otra información de acceso restringido. Algunos de estos datos en Docker se proporcionan mediante variables de entorno al lanzar los contenedores, esto es inseguro ya que al hacer un listado de los procesos con sus parámetros de invocación los relativos a Docker mostrarán esta información, lo que es un posible problema de seguridad.</p>
<p>Con <a href="https://docs.docker.com/engine/swarm/secrets/">Docker Secrets</a> se puede gestionar esta información que se necesita en tiempo de ejecución pero que no se quiere almacenar en la imagen de Docker o en el repositorio de código fuente. Algunos ejemplos de información sensible son:</p>
<ul>
<li>Nombres de usuario y contraseñas.</li>
<li>Certificados TLS y claves.</li>
<li>Claves SSH.</li>
<li>Otra información sensible como el nombre de una base de datos o el nombre de un servidor interno.</li>
</ul>
<p>Los secretos de Docker se proporcionan a los contenedores que los necesitan y se transmiten de forma cifrada al nodo en el que se ejecuten. Los secretos se montan en el sistema de archivos en la ruta <em>/run/secrets/&lt;secret_name&gt;</em> de forma descifrada al que el servicio del contenedor puede acceder.</p>
<p>Algunos comandos para manejar los secretos son los siguientes:</p>
<ul>
<li><em>docker secret create secreto</em>: crea un secreto.</li>
<li><em>docker secret inspect secreto</em>: muestra los detalles de un secreto.</li>
<li><em>docker secret ls</em>: lista los secretos creados.</li>
<li><em>docker secret rm secreto</em>: elimina un secreto.</li>
<li>Se usa el parámetro <em>--secret</em> para <em>docker service create</em> y <em>--secret-add</em> y <em>--secret-rm flags</em> para <em>docker service update</em>.</li>
</ul>
<p>Usando un <em>stack</em> de servicios con un archivo de <a href="https://docs.docker.com/compose/">Docker Compose</a> en la sección <em>secrets</em> de los servicios se indica cuales usa, en la sección <em>secrets</em> se definen los secretos de los servicios con sus nombres y su contenido referenciando archivos que pueden ser binarios o de text no superior a 500 KiB.</p>
<p>Al servicio de <a href="https://nginx.org/">nginx</a> la clave privada y certificado para configurar el acceso mediante el protocolo seguro HTTPS se le proporciona a través de secretos que son referenciados en el archivo de configuración del servidor web <em>nginx.conf</em>.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span><span class="lnt">26&#10;</span><span class="lnt">27&#10;</span><span class="lnt">28&#10;</span><span class="lnt">29&#10;</span><span class="lnt">30&#10;</span><span class="lnt">31&#10;</span><span class="lnt">32&#10;</span><span class="lnt">33&#10;</span><span class="lnt">34&#10;</span><span class="lnt">35&#10;</span><span class="lnt">36&#10;</span><span class="lnt">37&#10;</span><span class="lnt">38&#10;</span><span class="lnt">39&#10;</span><span class="lnt">40&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3.1&#34;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">nginx</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">nginx:stable-alpine</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">ports</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="s2">&#34;80:80&#34;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="s2">&#34;443:443&#34;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">networks</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="l">proxy</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">secrets</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="l">nginx.conf</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="l">localhost.pem</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="l">localhost.key</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l">sh -c &#34;exec nginx -c /run/secrets/nginx.conf -g &#39;daemon off;&#39;&#34;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">app</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">localhost:5000/spring-boot-app:1.0</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">ports</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="s2">&#34;8080:8080&#34;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">networks</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="l">proxy</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">volumes</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="l">app:/data</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">secrets</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="l">message.txt</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">networks</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">proxy</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">volumes</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">app</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l">rexray</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">secrets</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">nginx.conf</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l">./nginx.conf</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">localhost.pem</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l">./localhost.pem</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">localhost.key</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l">./localhost.key</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">message.txt</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l">./message.txt</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>docker-compose-stack-app.yml</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span><span class="lnt">26&#10;</span><span class="lnt">27&#10;</span><span class="lnt">28&#10;</span><span class="lnt">29&#10;</span><span class="lnt">30&#10;</span><span class="lnt">31&#10;</span><span class="lnt">32&#10;</span><span class="lnt">33&#10;</span><span class="lnt">34&#10;</span><span class="lnt">35&#10;</span><span class="lnt">36&#10;</span><span class="lnt">37&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">...</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="s">http</span> <span class="p">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">...</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="s">upstream</span> <span class="s">app</span> <span class="p">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;	<span class="kn">server</span> <span class="s">app_app:8080</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">server</span> <span class="p">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">listen</span>&nbsp;&nbsp;&nbsp;&nbsp;   <span class="mi">80</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">return</span> <span class="mi">301</span> <span class="s">https://</span><span class="nv">$host$request_uri</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">server</span> <span class="p">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">listen</span>&nbsp;&nbsp;&nbsp;&nbsp;   <span class="mi">443</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">server_name</span>  <span class="s">localhost</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">ssl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="no">on</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">ssl_certificate</span>&nbsp;&nbsp;&nbsp;&nbsp;  <span class="s">/run/secrets/localhost.pem</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">ssl_certificate_key</span>  <span class="s">/run/secrets/localhost.key</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">ssl_session_timeout</span>  <span class="mi">5m</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">ssl_protocols</span>  <span class="s">SSLv2</span> <span class="s">SSLv3</span> <span class="s">TLSv1</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">ssl_ciphers</span>  <span class="s">HIGH:!aNULL:!MD5</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">ssl_prefer_server_ciphers</span>   <span class="no">on</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">proxy_pass</span> <span class="s">http://app</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$host</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kn">proxy_set_header</span> <span class="s">X-Real-IP</span> <span class="nv">$remote_addr</span><span class="p">;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>nginx.conf</span>
    </div>
</div>
<p>Por otra parte la aplicación Java con <a href="https://projects.spring.io/spring-boot/">Spring Boot</a> lista el contenido de los secretos incorporados en el contenedor cuando se solicita en la URL <em>https://192.168.99.100/system/info/</em>, esto no se debe hacer porque se pierde la seguridad que proporcionan los secretos pero sirve a modo de muestra en el ejemplo.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span><span class="lnt">26&#10;</span><span class="lnt">27&#10;</span><span class="lnt">28&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">io.github.picodotdev.blogbitix.dockerswarm</span><span class="o">;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="o">...</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="nd">@Component</span>&#10;</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HostInfoContributor</span> <span class="kd">implements</span> <span class="n">InfoContributor</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nd">@Override</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">public</span> <span class="kt">void</span> <span class="nf">contribute</span><span class="o">(</span><span class="n">Info</span><span class="o">.</span><span class="na">Builder</span> <span class="n">builder</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">details</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">try</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">...</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">File</span><span class="o">[]</span> <span class="n">secrets</span> <span class="o">=</span> <span class="n">FileSystems</span><span class="o">.</span><span class="na">getDefault</span><span class="o">().</span><span class="na">getPath</span><span class="o">(</span><span class="s">&#34;/run/secrets/&#34;</span><span class="o">).</span><span class="na">toFile</span><span class="o">().</span><span class="na">listFiles</span><span class="o">();</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span><span class="o">(</span><span class="n">File</span> <span class="n">file</span> <span class="o">:</span> <span class="n">secrets</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">try</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">Files</span><span class="o">.</span><span class="na">lines</span><span class="o">(</span><span class="n">file</span><span class="o">.</span><span class="na">toPath</span><span class="o">()).</span><span class="na">collect</span><span class="o">(</span><span class="n">Collectors</span><span class="o">.</span><span class="na">joining</span><span class="o">(</span><span class="s">&#34;\n&#34;</span><span class="o">));</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">details</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">file</span><span class="o">.</span><span class="na">getName</span><span class="o">().</span><span class="na">toString</span><span class="o">(),</span> <span class="n">content</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">builder</span><span class="o">.</span><span class="na">withDetails</span><span class="o">(</span><span class="n">details</span><span class="o">);</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>HostInfoContributor.java</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span><span class="err">...,</span><span class="nt">&#34;message.txt&#34;</span><span class="p">:</span><span class="s2">&#34;Hello World!&#34;</span><span class="p">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>info.json</span>
    </div>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/04/informacion-sensible-en-los-contenedores-con-docker-secrets/images/message_hu4ebecdd1723c600c663f2f340442b569_13817_2560x1440_fit_box_3.png" data-gallery="" title="Contenido del archivo message.txt"><img src="https://picodotdev.github.io/blog-bitix/2017/04/informacion-sensible-en-los-contenedores-con-docker-secrets/images/message_hu4ebecdd1723c600c663f2f340442b569_13817_300x200_fit_box_3.png" width="300" height="97" alt="Contenido del archivo message.txt" title="Contenido del archivo message.txt"  class="lozad "></a></p>
<figcaption>Contenido del archivo message.txt</figcaption>
</figure>
</div>
<p>Para probar el ejemplo hay que ejecutar varios comandos, la secuencia completa es la siguiente:</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span><span class="lnt">4&#10;</span><span class="lnt">5&#10;</span><span class="lnt">6&#10;</span><span class="lnt">7&#10;</span><span class="lnt">8&#10;</span><span class="lnt">9&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ./01-cluster-create.sh&#10;</span></span><span class="line"><span class="cl">$ ./02-vboxwebsrv.sh&#10;</span></span><span class="line"><span class="cl">$ ./03-rex-ray-install.sh&#10;</span></span><span class="line"><span class="cl">$ ./04-docker-compose-stack-deploy-registry.sh&#10;</span></span><span class="line"><span class="cl">$ ./05-spring-boot-app-build.sh&#10;</span></span><span class="line"><span class="cl">$ ./06-create-volumes.sh&#10;</span></span><span class="line"><span class="cl">$ ./06-docker-compose-stack-deploy-app.sh&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">$ curl -k https://192.168.99.100/system/info</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>run.sh</span>
    </div>
</div>
<div class="alert alert-secondary sourcecode">
    <img src="https://picodotdev.github.io/blog-bitix/assets/images/icons/terminal.svg" width="64" height="64" alt="Terminal" title="Terminal" class="lozad sourcecode-icon">
    <p>
            El <a href="https://github.com/picodotdev/blog-ejemplos/tree/master/DockerSwarm">código fuente completo del ejemplo</a> puedes descargarlo del repositorio de ejemplos de Blog Bitix alojado en GitHub.</p>
</div>
]]>
        </content>
        
            
                <category term="planeta-codigo"/>
            
                <category term="software-libre"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2017/04/contenedores-en-docker-swarm-con-volumenes-de-datos-persistentes-usando-rex-ray-y-virtualbox/</id>
        <title>Contenedores en Docker Swarm con volúmenes de datos persistentes usando REX-Ray y VirtualBox</title>
        <updated>2017-04-16T23:00:00+02:00</updated>
        <published>2017-04-16T12:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2017/04/contenedores-en-docker-swarm-con-volumenes-de-datos-persistentes-usando-rex-ray-y-virtualbox/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Salvo que un servicio sea sin estado o <em>stateless</em> los contenedores de Docker necesitan persistir datos y que estos sobrevivan a su terminación, como es el caso de un contenedor de una base de datos. Además en un <em>cluster</em> de nodos Docker hay que tener en cuenta que los datos deben estar accesibles para todos los nodos ya que un contenedor que usase los datos podría ser lanzado en cualquiera de ellos. REX-Ray es un sistema de almacenamiento en red que cubre estas necesidades, es simple de instalar, configurar y de iniciar. En el artículo muestro un ejemplo usando REX-Ray junto con Docker Swarm y VirtualBox.</strong></p>]]>
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/docker.svg" width="200" height="167" alt="Docker" title="Docker"  class=""></p>
</div>
<p>Los contenedores de datos son efímeros, se crean y se destruyen y con ellos los datos que tuviesen en su sistema de archivos de modo que cualquier dato que queramos que sobreviva a la vida del contenedor ha de almacenarse de forma externa, este es el caso de los datos de una base de datos como <a href="https://www.postgresql.org/">PostgreSQL</a> o <a href="https://www.mongodb.com/">MongoDB</a>. Además usando <a href="https://docs.docker.com/swarm/">Docker Swarm</a> se plantea el problema de que hay varios nodos formando un <em>cluster</em> por lo que los datos han de estar accesibles independientemente del nodo en el que sea iniciado el contenedor que los utilice y significa que los datos no pueden estar almacenados en el nodo ya que un contenedor podría ser iniciado en cualquiera de ellos.</p>
<p>Así que los contenedores iniciados en un <em>cluster</em> de Docker Swarm que usen datos persistentes necesitan un sistema de almacenamiento en red externo a los contenedores y nodos. Una de las opciones disponibles es <a href="https://rexray.codedellemc.com/">REX-Ray</a> que ofrece una configuración sencilla y múltiples proveedores de computación entre las que están las más populares como <a href="https://aws.amazon.com/es/ec2/">Amazon EC2</a>, <a href="https://www.digitalocean.com/">Digital Ocean</a>, <a href="https://cloud.google.com/compute/">Google Compute Engine</a>, <a href="https://azure.microsoft.com/es-es/">microsoft-azure</a> e incluso <a href="https://www.virtualbox.org/">VirtualBox</a>.</p>
<p>En el siguiente ejemplo uso un <em>cluster</em> de nodos Docker, VirtualBox y REX-Ray para proporcionar volúmenes de datos persistentes para un contenedor que tiene una base de datos postgres basándome en el artículo previo <a href="https://picodotdev.github.io/blog-bitix/2017/03/introduccion-y-ejemplo-de-cluster-de-contenedores-con-docker-swarm/">Crear un <em>cluster</em> de contenedores Docker</a> donde explicaba como crear un <em>cluster</em> de nodos con Docker Swarm.</p>
<p>Para la integración entre VirtualBox y REX-Ray hay que iniciar primero un servidor en el <em>host</em> que permite a REX-Ray hacer llamadas remotas a VirtualBox para que gestione los volúmenes de datos.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span><span class="lnt">4&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env bash&#10;</span></span></span><span class="line"><span class="cl"><span class="cp"></span>&#10;</span></span><span class="line"><span class="cl">VBoxManage setproperty websrvauthlibrary null&#10;</span></span><span class="line"><span class="cl">vboxwebsrv -H 0.0.0.0 -v</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>02-vboxwebsrv.sh</span>
    </div>
</div>
<p>Si hay un <em>firewall</em> hay que permitir el tráfico para el puerto <em>18083</em>, en mi caso que uso <em>ufw</em> creando la siguiente regla.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ sudo ufw allow to any port <span class="m">18083</span> from 192.168.0.0/16&#10;</span></span><span class="line"><span class="cl">&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>ufw.sh</span>
    </div>
</div>
<p>Con el <em>cluster</em> creado debemos instalar y configurar REX-Ray en cada uno de los nodos ejecutando varios comandos, un comando instala REX-Ray, otro crea el archivo de configuración en <em>/etc/rexray/config.yml</em> y finalmente otro inicia el servicio de REX-Ray. Algunas opciones que se indican en el archivo de configuración de REX-Ray es la ubicación en el <em>host</em> donde se guardan los volúmenes con el parámetro <em>volumePath</em>.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env bash&#10;</span></span></span><span class="line"><span class="cl"><span class="cp"></span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">#export MACHINE_STORAGE_PATH=&#34;/run/media/picodotdev/BMOVE ROJO/docker-machine/&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1">#sudo ufw allow to any port 18083 from 192.168.0.0/16  </span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">for</span> i in <span class="s2">&#34;01&#34;</span> <span class="s2">&#34;02&#34;</span> <span class="s2">&#34;03&#34;</span><span class="p">;</span> <span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">	docker-machine ssh node-<span class="nv">$i</span> <span class="s2">&#34;curl -sSL https://dl.bintray.com/emccode/rexray/install | sh -&#34;</span>&#10;</span></span><span class="line"><span class="cl">	docker-machine ssh node-<span class="nv">$i</span> <span class="s2">&#34;cat &gt; /tmp/rexray-config.yml &lt;&lt; EOF&#10;</span></span></span><span class="line"><span class="cl"><span class="s2">rexray:&#10;</span></span></span><span class="line"><span class="cl"><span class="s2">  logLevel: info&#10;</span></span></span><span class="line"><span class="cl"><span class="s2">libstorage:&#10;</span></span></span><span class="line"><span class="cl"><span class="s2">  service: virtualbox&#10;</span></span></span><span class="line"><span class="cl"><span class="s2">virtualbox:&#10;</span></span></span><span class="line"><span class="cl"><span class="s2">  endpoint: http://192.168.99.1:18083&#10;</span></span></span><span class="line"><span class="cl"><span class="s2">  volumePath: /run/media/picodotdev/BMOVE ROJO/docker-machine/volumes/&#10;</span></span></span><span class="line"><span class="cl"><span class="s2">  controllerName: SATA&#10;</span></span></span><span class="line"><span class="cl"><span class="s2">EOF&#10;</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">	docker-machine ssh node-<span class="nv">$i</span> <span class="s2">&#34;sudo mkdir -p /etc/rexray/&#34;</span>&#10;</span></span><span class="line"><span class="cl">	docker-machine ssh node-<span class="nv">$i</span> <span class="s2">&#34;sudo mv /tmp/rexray-config.yml /etc/rexray/config.yml&#34;</span>&#10;</span></span><span class="line"><span class="cl">	docker-machine ssh node-<span class="nv">$i</span> <span class="s2">&#34;sudo rexray start&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="k">done</span>&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>03-rex-ray-install.sh</span>
    </div>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/04/contenedores-en-docker-swarm-con-volumenes-de-datos-persistentes-usando-rex-ray-y-virtualbox/images/instalacion-rex-ray_hu9269de5ba430913abbd77617811f8219_72113_2560x1440_fit_box_3.png" data-gallery="" title="Instalación de REX-Ray en nodos de Docker Swarm con VirtualBox"><img src="https://picodotdev.github.io/blog-bitix/2017/04/contenedores-en-docker-swarm-con-volumenes-de-datos-persistentes-usando-rex-ray-y-virtualbox/images/instalacion-rex-ray_hu9269de5ba430913abbd77617811f8219_72113_300x200_fit_box_3.png" width="254" height="200" alt="Instalación de REX-Ray en nodos de Docker Swarm con VirtualBox" title="Instalación de REX-Ray en nodos de Docker Swarm con VirtualBox"  class="lozad "></a></p>
<figcaption>Instalación de REX-Ray en nodos de Docker Swarm con VirtualBox</figcaption>
</figure>
</div>
<p>Para probar la persistencia de datos usaré un <em>stack</em> iniciado de la misma forma que en artículo <a href="https://picodotdev.github.io/blog-bitix/2017/04/iniciar-un-stack-de-servicios-en-un-cluster-de-docker-swarm/">Iniciar un stack de servicios en un cluster de Docker Swarm</a> pero con un contenedor de postgres que guarda los datos en un volumen de REX-Ray en <em>/var/lib/postgresql/data</em>. Para iniciar el <em>stack</em> el <em>custer</em> de Docker Swarm uso un archivo de <a href="https://docs.docker.com/compose/">Docker Compose</a> con la definición del <em>stack</em> en formato YAML.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3.1&#34;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">postgres</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">postgres:latest</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">ports</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="s2">&#34;5432:5432&#34;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">volumes</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="l">postgres:/var/lib/postgresql/data</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">volumes</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">postgres</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>docker-compose-stack-postgres.yml</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env bash&#10;</span></span></span><span class="line"><span class="cl"><span class="cp"></span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">#export MACHINE_STORAGE_PATH=&#34;/run/media/picodotdev/BMOVE ROJO/docker-machine/&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nb">eval</span> <span class="k">$(</span>docker-machine env node-01<span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">docker stack deploy -c docker-compose-stack-postgres.yml postgres&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">sleep 30s&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -e <span class="s2">&#34;\n# Cluster services&#34;</span>&#10;</span></span><span class="line"><span class="cl">docker service ls&#10;</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -e <span class="s2">&#34;\n# Nginx service tasks&#34;</span>&#10;</span></span><span class="line"><span class="cl">docker service ps nginx_nginx&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">for</span> i in <span class="s2">&#34;01&#34;</span> <span class="s2">&#34;02&#34;</span> <span class="s2">&#34;03&#34;</span><span class="p">;</span> <span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> -e <span class="s2">&#34;\n# Node </span><span class="nv">$i</span><span class="s2"> containers&#34;</span>&#10;</span></span><span class="line"><span class="cl">	<span class="nb">eval</span> <span class="k">$(</span>docker-machine env node-<span class="nv">$i</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">	docker ps&#10;</span></span><span class="line"><span class="cl"><span class="k">done</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>06-docker-compose-stack-deploy-postgres.sh</span>
    </div>
</div>
<p>En la siguiente captura de pantalla se observa en que nodo ha sido iniciado el contenedor de postgres y que identificativo se le ha asignado.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/04/contenedores-en-docker-swarm-con-volumenes-de-datos-persistentes-usando-rex-ray-y-virtualbox/images/stack-deploy-postgres_huc4318c531e7472eac4f793e01e0a1a73_77737_2560x1440_fit_box_3.png" data-gallery="" title="Deploy del stack de postgres"><img src="https://picodotdev.github.io/blog-bitix/2017/04/contenedores-en-docker-swarm-con-volumenes-de-datos-persistentes-usando-rex-ray-y-virtualbox/images/stack-deploy-postgres_huc4318c531e7472eac4f793e01e0a1a73_77737_300x200_fit_box_3.png" width="300" height="150" alt="Deploy del stack de postgres" title="Deploy del stack de postgres"  class="lozad "></a></p>
<figcaption>Deploy del stack de postgres</figcaption>
</figure>
</div>
<p>En el <em>stack</em> el volumen de datos postgres está declarado y creado de forma externa. Usando VirtualBox con REX-Ray en el <em>host</em> o anfitrión se crea un archivo que contiene los datos del volumen. Al listar los volúmenes de datos además de los creados <em>postgres</em> y <em>app</em> están los de los discos duros de cada uno de los nodos identificados como <em>disk.vmdk</em>. El parámetro <em>opt=size=5</em> indica que el volumen de datos es de una tamaño de 5GiB.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env bash&#10;</span></span></span><span class="line"><span class="cl"><span class="cp"></span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">#export MACHINE_STORAGE_PATH=&#34;/run/media/picodotdev/BMOVE ROJO/docker-machine/&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nb">eval</span> <span class="k">$(</span>docker-machine env node-01<span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">docker volume create --driver<span class="o">=</span>rexray --name<span class="o">=</span>postgres --opt<span class="o">=</span><span class="nv">size</span><span class="o">=</span><span class="m">5</span>&#10;</span></span><span class="line"><span class="cl">docker volume create --driver<span class="o">=</span>rexray --name<span class="o">=</span>app --opt<span class="o">=</span><span class="nv">size</span><span class="o">=</span><span class="m">5</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -e <span class="s2">&#34;\n# Volumes&#34;</span>&#10;</span></span><span class="line"><span class="cl">docker volume ls</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>06-create-volumes.sh</span>
    </div>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/04/contenedores-en-docker-swarm-con-volumenes-de-datos-persistentes-usando-rex-ray-y-virtualbox/images/volumes_hu1a75dbcefbb92d4d004e2d4d4ce88252_33342_2560x1440_fit_box_3.png" data-gallery="" title="Volúmenes de datos"><img src="https://picodotdev.github.io/blog-bitix/2017/04/contenedores-en-docker-swarm-con-volumenes-de-datos-persistentes-usando-rex-ray-y-virtualbox/images/volumes_hu1a75dbcefbb92d4d004e2d4d4ce88252_33342_300x200_fit_box_3.png" width="300" height="193" alt="Volúmenes de datos" title="Volúmenes de datos"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/04/contenedores-en-docker-swarm-con-volumenes-de-datos-persistentes-usando-rex-ray-y-virtualbox/images/volumes-nautilus_hu09fff62e4158ba9c87ce0b119de89d76_22720_2560x1440_fit_box_3.png" data-gallery="" title="Archivos de volúmenes en el sistema de archivos del host"><img src="https://picodotdev.github.io/blog-bitix/2017/04/contenedores-en-docker-swarm-con-volumenes-de-datos-persistentes-usando-rex-ray-y-virtualbox/images/volumes-nautilus_hu09fff62e4158ba9c87ce0b119de89d76_22720_300x200_fit_box_3.png" width="300" height="166" alt="Archivos de volúmenes en el sistema de archivos del host" title="Archivos de volúmenes en el sistema de archivos del host"  class="lozad "></a></p>
<figcaption>Volúmenes de datos</figcaption>
</figure>
</div>
<p>Para crear algunos datos en la base de datos hay que conectarse al contenedor y lanzar algunas sentencias SQL. Hay que obtener el identificativo del contenedor de postgres, iniciar un proceso <em>bash</em>, realizar la conexión a la base de datos con el cliente <em>psql</em> y lanzar las sentencias SQL.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span><span class="lnt">26&#10;</span><span class="lnt">27&#10;</span><span class="lnt">28&#10;</span><span class="lnt">29&#10;</span><span class="lnt">30&#10;</span><span class="lnt">31&#10;</span><span class="lnt">32&#10;</span><span class="lnt">33&#10;</span><span class="lnt">34&#10;</span><span class="lnt">35&#10;</span><span class="lnt">36&#10;</span><span class="lnt">37&#10;</span><span class="lnt">38&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ docker ps -q --filter <span class="nv">label</span><span class="o">=</span>com.docker.swarm.service.name<span class="o">=</span>postgres_postgres&#10;</span></span><span class="line"><span class="cl">ac90f7e1e7b5&#10;</span></span><span class="line"><span class="cl">$ docker <span class="nb">exec</span> -it ac90f7e1e7b5 /bin/bash&#10;</span></span><span class="line"><span class="cl">postgres-# psql --username<span class="o">=</span>postgres&#10;</span></span><span class="line"><span class="cl"><span class="nv">postgres</span><span class="o">=</span><span class="c1"># CREATE TABLE COMPANY(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   </span>&#10;</span></span><span class="line"><span class="cl">postgres<span class="o">(</span><span class="c1">#&nbsp;&nbsp;&nbsp;&nbsp;ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SERIAL PRIMARY KEY&nbsp;&nbsp;&nbsp;&nbsp; NOT NULL,</span>&#10;</span></span><span class="line"><span class="cl">postgres<span class="o">(</span><span class="c1">#&nbsp;&nbsp;&nbsp;&nbsp;NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   NOT NULL,</span>&#10;</span></span><span class="line"><span class="cl">postgres<span class="o">(</span><span class="c1">#&nbsp;&nbsp;&nbsp;&nbsp;AGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT NULL,</span>&#10;</span></span><span class="line"><span class="cl">postgres<span class="o">(</span><span class="c1">#&nbsp;&nbsp;&nbsp;&nbsp;ADDRESS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHAR(50),</span>&#10;</span></span><span class="line"><span class="cl">postgres<span class="o">(</span><span class="c1">#&nbsp;&nbsp;&nbsp;&nbsp;SALARY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; REAL</span>&#10;</span></span><span class="line"><span class="cl">postgres<span class="o">(</span><span class="c1"># );</span>&#10;</span></span><span class="line"><span class="cl">CREATE TABLE&#10;</span></span><span class="line"><span class="cl"><span class="nv">postgres</span><span class="o">=</span><span class="c1"># \dt</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  List of relations&#10;</span></span><span class="line"><span class="cl"> Schema <span class="p">|</span>  Name   <span class="p">|</span> Type  <span class="p">|</span>  Owner   &#10;</span></span><span class="line"><span class="cl">--------+---------+-------+----------&#10;</span></span><span class="line"><span class="cl"> public <span class="p">|</span> company <span class="p">|</span> table <span class="p">|</span> postgres&#10;</span></span><span class="line"><span class="cl"><span class="o">(</span><span class="m">1</span> row<span class="o">)</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">postgres</span><span class="o">=</span><span class="c1"># \d+ company</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Table <span class="s2">&#34;public.company&#34;</span>&#10;</span></span><span class="line"><span class="cl"> Column  <span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp; Type&nbsp;&nbsp;&nbsp;&nbsp;  <span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Modifiers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <span class="p">|</span> Storage  <span class="p">|</span> Stats target <span class="p">|</span> Descrip&#10;</span></span><span class="line"><span class="cl">tion &#10;</span></span><span class="line"><span class="cl">---------+---------------+------------------------------------------------------+----------+--------------+--------&#10;</span></span><span class="line"><span class="cl">-----&#10;</span></span><span class="line"><span class="cl"> id&nbsp;&nbsp;&nbsp;&nbsp;  <span class="p">|</span> integer&nbsp;&nbsp;&nbsp;&nbsp;   <span class="p">|</span> not null default nextval<span class="o">(</span><span class="s1">&#39;company_id_seq&#39;</span>::regclass<span class="o">)</span> <span class="p">|</span> plain&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="p">|</span> &#10;</span></span><span class="line"><span class="cl"> name&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">|</span> text&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="p">|</span> not null&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="p">|</span> extended <span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="p">|</span> &#10;</span></span><span class="line"><span class="cl"> age&nbsp;&nbsp;&nbsp;&nbsp; <span class="p">|</span> integer&nbsp;&nbsp;&nbsp;&nbsp;   <span class="p">|</span> not null&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="p">|</span> plain&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="p">|</span> &#10;</span></span><span class="line"><span class="cl"> address <span class="p">|</span> character<span class="o">(</span>50<span class="o">)</span> <span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="p">|</span> extended <span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="p">|</span> &#10;</span></span><span class="line"><span class="cl"> salary  <span class="p">|</span> real&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="p">|</span> plain&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="p">|</span> &#10;</span></span><span class="line"><span class="cl">Indexes:&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;company_pkey&#34;</span> PRIMARY KEY, btree <span class="o">(</span>id<span class="o">)</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">postgres</span><span class="o">=</span><span class="c1"># INSERT INTO COMPANY (name, age, address, salary) VALUES (&#39;Company A&#39;, 21, &#39;13, Rue del Percebe&#39;, 45000);</span>&#10;</span></span><span class="line"><span class="cl">INSERT <span class="m">0</span> <span class="m">1</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">postgres</span><span class="o">=</span><span class="c1"># SELECT * FROM company;</span>&#10;</span></span><span class="line"><span class="cl"> id <span class="p">|</span>   name&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">|</span> age <span class="p">|</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <span class="p">|</span> salary&#10;</span></span><span class="line"><span class="cl">----+-----------+-----+----------------------------------------------------+--------&#10;</span></span><span class="line"><span class="cl">  <span class="m">3</span> <span class="p">|</span> Company A <span class="p">|</span>  <span class="m">21</span> <span class="p">|</span> 13, Rue del Percebe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">|</span>  <span class="m">45000</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">(</span><span class="m">1</span> row<span class="o">)</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>postgres.sh</span>
    </div>
</div>
<p>Destruyendo el <em>stack</em> y volviéndolo a arrancar posiblemente Docker Swarm iniciará el contenedor en otro nodo del <em>cluster</em> pero los datos seguirán estando presentes en la base de datos postgres, se puede comprobar iniciando una nueva sesión bash en el nuevo contenedor, iniciando el cliente de <em>psql</em> y lanzando la consulta <em>select</em> de SQL o con el comando <code>\dt</code> para obtener las tablas de la base de datos, <em>\d+ company</em> para obtener una descripción de la tabla y la consulta SQL <em>SELECT * FROM company;</em>.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span><span class="lnt">4&#10;</span><span class="lnt">5&#10;</span><span class="lnt">6&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env bash&#10;</span></span></span><span class="line"><span class="cl"><span class="cp"></span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">#export MACHINE_STORAGE_PATH=&#34;/run/media/picodotdev/BMOVE ROJO/docker-machine/&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nb">eval</span> <span class="k">$(</span>docker-machine env node-01<span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">docker stack rm postgres</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>docker-compose-stack-remove-postgres.sh</span>
    </div>
</div>
<div class="alert alert-secondary sourcecode">
    <img src="https://picodotdev.github.io/blog-bitix/assets/images/icons/terminal.svg" width="64" height="64" alt="Terminal" title="Terminal" class="lozad sourcecode-icon">
    <p>
            El <a href="https://github.com/picodotdev/blog-ejemplos/tree/master/DockerSwarm">código fuente completo del ejemplo</a> puedes descargarlo del repositorio de ejemplos de Blog Bitix alojado en GitHub.</p>
</div>
<div class="reference">
    Referencia:<br>
<ul>
<li><a href="https://rexray.readthedocs.io/en/v0.3.3/user-guide/installation/">REX-Ray Installation</a></li>
<li><a href="https://rexray.readthedocs.io/en/v0.3.3/user-guide/installation/#docker-machine-virtualbox">REX-Ray Installation - Docker Machine (VirtualBox)</a></li>
<li><a href="https://rexray.readthedocs.io/en/v0.3.3/user-guide/storage-providers/#virtualbox">REX-Ray Storage Providers - VirtualBox</a></li>
<li><a href="http://rexray.readthedocs.io/en/stable/user-guide/applications/">REX-Ray - Applications</a></li>
</ul>
</div>
]]>
        </content>
        
            
                <category term="planeta-codigo"/>
            
                <category term="software-libre"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2017/04/escalar-y-actualizar-un-servicio-de-un-cluster-de-docker-swarm/</id>
        <title>Escalar y actualizar un servicio de un cluster de Docker Swarm</title>
        <updated>2017-04-16T13:00:00+02:00</updated>
        <published>2017-04-09T11:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2017/04/escalar-y-actualizar-un-servicio-de-un-cluster-de-docker-swarm/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Ya tenemos un <em>cluster</em> formado por varios nodos con algún servicio ejecutándose en el <em>cluster</em> de Docker Swarm. Si surge la necesidad los servicios del <em>cluster</em> se pueden escalar cambiando el número de instancias de contenedores que forma el servicio para atender las necesidades computacionales o para ofrecer el servicio a más usuarios. Por otro lado, pasado un tiempo muy posiblemente se publicará una nueva imagen de los contenedores, el servicio se puede actualizar para que los contenedores utilicen esa nueva imagen.</strong></p>]]>
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/docker.svg" width="200" height="167" alt="Docker" title="Docker"  class=""></p>
</div>
<p>Una vez que ya hemos <a href="https://picodotdev.github.io/blog-bitix/2017/03/introduccion-y-ejemplo-de-cluster-de-contenedores-con-docker-swarm/">creado un <em>cluster</em> de nodos con Docker Swarm</a> y hemos desplegado algunos servicios ya sea directamente mediante comandos para crear servicios o mediante un <a href="https://picodotdev.github.io/blog-bitix/2017/04/iniciar-un-stack-de-servicios-en-un-cluster-de-docker-swarm/"><em>stack</em> con un archivo similar a un Docker Compose</a> al cabo de un tiempo necesitaremos hacer otras operaciones. Dos de esas operaciónes básicas son escalar hacia arriba o hacia abajo un servicio cambiando el número de instancias de contenedores desplegadas o actualizar la imagen que utilizan los servicios por otra diferente posiblemente más nueva.</p>
<p>En la documentación de <a href="https://www.docker.com/">Docker</a> están detallados y comentados los <a href="https://docs.docker.com/engine/swarm/swarm-tutorial/scale-service/">comandos para escalar un servicio</a>. Por ejemplo, en el <em>cluster</em> de ejemplo formado por tres nodos, uno con el rol de <em>manager</em> y otros dos como <em>worker</em>, ejecutándose en <a href="https://www.virtualbox.org/">VirtualBox</a> y desplegando un servicio para el servidor <a href="https://nginx.org/">nginx</a> con inicialmente una réplica o instancia podemos escalar el servicio para que se cree alguna instancia o contenedor más del servicio con el siguiente comando <code>docker service scale</code>.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env bash&#10;</span></span></span><span class="line"><span class="cl"><span class="cp"></span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">#export MACHINE_STORAGE_PATH=&#34;/run/media/picodotdev/BMOVE ROJO/docker-machine/&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nb">eval</span> <span class="k">$(</span>docker-machine env node-01<span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -e <span class="s2">&#34;\n# Nginx service tasks&#34;</span>&#10;</span></span><span class="line"><span class="cl">docker service ps nginx&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -e <span class="s2">&#34;\n# Nginx service inspect&#34;</span>&#10;</span></span><span class="line"><span class="cl">docker service inspect --pretty nginx&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">docker service scale <span class="nv">nginx</span><span class="o">=</span><span class="m">4</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">sleep 1m&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -e <span class="s2">&#34;\n# Nginx service tasks&#34;</span>&#10;</span></span><span class="line"><span class="cl">docker service ps nginx&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -e <span class="s2">&#34;\n# Nginx service inspect&#34;</span>&#10;</span></span><span class="line"><span class="cl">docker service inspect --pretty nginx&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>06-nginx-scale.sh</span>
    </div>
</div>
<p>Al igual que cuando se crea un contenedor para un servicio en el <em>cluster</em> <a href="https://docs.docker.com/swarm/">Docker Swarm</a> si no se indica alguna restricción decidirá en qué nodos se crean las nuevas instancias o contenedores del servicio.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/04/escalar-y-actualizar-un-servicio-de-un-cluster-de-docker-swarm/images/nginx-service-1_huebd5c25c0b0faf24527b6ab44777e5b5_76821_2560x1440_fit_box_3.png" data-gallery="" title="Servicio de nginx con una réplica"><img src="https://picodotdev.github.io/blog-bitix/2017/04/escalar-y-actualizar-un-servicio-de-un-cluster-de-docker-swarm/images/nginx-service-1_huebd5c25c0b0faf24527b6ab44777e5b5_76821_300x200_fit_box_3.png" width="300" height="161" alt="Servicio de nginx con una réplica" title="Servicio de nginx con una réplica"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/04/escalar-y-actualizar-un-servicio-de-un-cluster-de-docker-swarm/images/nginx-service-4_hu1208181ff1627b77e3058ac3d716d6f5_90824_2560x1440_fit_box_3.png" data-gallery="" title="Servicio de nginx escalado a cuatro réplicas"><img src="https://picodotdev.github.io/blog-bitix/2017/04/escalar-y-actualizar-un-servicio-de-un-cluster-de-docker-swarm/images/nginx-service-4_hu1208181ff1627b77e3058ac3d716d6f5_90824_300x200_fit_box_3.png" width="300" height="161" alt="Servicio de nginx escalado a cuatro réplicas" title="Servicio de nginx escalado a cuatro réplicas"  class="lozad "></a></p>
<figcaption>Servicio de nginx antes y después de escalarlo</figcaption>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/04/escalar-y-actualizar-un-servicio-de-un-cluster-de-docker-swarm/images/nginx-service-scale_hub8dd279f35158bcce114c552cc782715_24245_2560x1440_fit_box_3.png" data-gallery="" title="Escalado del servicio de nginx"><img src="https://picodotdev.github.io/blog-bitix/2017/04/escalar-y-actualizar-un-servicio-de-un-cluster-de-docker-swarm/images/nginx-service-scale_hub8dd279f35158bcce114c552cc782715_24245_300x200_fit_box_3.png" width="300" height="161" alt="Escalado del servicio de nginx" title="Escalado del servicio de nginx"  class="lozad "></a></p>
<figcaption>Escalado del servicio de nginx</figcaption>
</figure>
</div>
<p>Por otro lado, una vez desplegados en un <em>cluster</em> algunos servicios llegará el momento en que queramos actualizar algún parámetro del servicio, uno de ellos será probablemente la imagen del servicio cuando se publique una nueva. En la página de documentación <a href="https://docs.docker.com/engine/swarm/swarm-tutorial/rolling-update/">Aplicando actualizaciones a un servicio</a> está explicada esta funcionalidad y los comandos junto con sus opciones que hay que utilizar.</p>
<p>En el ejemplo al crear el <em>cluster</em> se usa la última imagen de docker para nginx, en un entorno de producción es más recomendable establecer una versión en concreto para evitar que la imagen que se usa no varía desde que se prueba hasta que se despliega. El siguiente <em>script</em> actualiza la imagen a la versión <em>nginx:1.10-alpine</em> en todas las réplicas del servicio de nginx en el <em>cluster</em>.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env bash&#10;</span></span></span><span class="line"><span class="cl"><span class="cp"></span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">#export MACHINE_STORAGE_PATH=&#34;/run/media/picodotdev/BMOVE ROJO/docker-machine/&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nb">eval</span> <span class="k">$(</span>docker-machine env node-01<span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -e <span class="s2">&#34;\n# Nginx service tasks&#34;</span>&#10;</span></span><span class="line"><span class="cl">docker service ps nginx&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -e <span class="s2">&#34;\n# Nginx service inspect&#34;</span>&#10;</span></span><span class="line"><span class="cl">docker service inspect --pretty nginx&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">docker service update --image nginx:1.10-alpine nginx&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">sleep 1m&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -e <span class="s2">&#34;\n# Nginx service tasks&#34;</span>&#10;</span></span><span class="line"><span class="cl">docker service ps nginx&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -e <span class="s2">&#34;\n# Nginx service inspect&#34;</span>&#10;</span></span><span class="line"><span class="cl">docker service inspect --pretty nginx&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>06-nginx-update.sh</span>
    </div>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/04/escalar-y-actualizar-un-servicio-de-un-cluster-de-docker-swarm/images/nginx-service-update_huc4c244276d3bb3c7e0dd9083867fc331_62385_2560x1440_fit_box_3.png" data-gallery="" title="Actualización de la imagen del servicio de nginx"><img src="https://picodotdev.github.io/blog-bitix/2017/04/escalar-y-actualizar-un-servicio-de-un-cluster-de-docker-swarm/images/nginx-service-update_huc4c244276d3bb3c7e0dd9083867fc331_62385_300x200_fit_box_3.png" width="300" height="161" alt="Actualización de la imagen del servicio de nginx" title="Actualización de la imagen del servicio de nginx"  class="lozad "></a></p>
<figcaption>Actualización de la imagen del servicio de nginx</figcaption>
</figure>
</div>
<p>Docker Swarm realiza el proceso de actualización siguiendo los siguientes pasos:</p>
<ul>
<li>Detiene el primer contenedor o tarea a actualizar.</li>
<li>Programa la actualización del contenedor o tarea detenida.</li>
<li>Inicia una nueva tarea actualizado.</li>
<li>Si la tarea actualizada retorna su estado como <em>RUNNING</em> se espera un tiempo determinado y se inicia el proceso de actualización de una nueva tarea.</li>
<li>Si, en cualquier momento durante la actualización, una tarea retorna su estado como <em>FAILED</em>, se detiene la actualización.</li>
</ul>
<p>Por defecto, el planificador actualiza las tareas o contenedores del servicio de uno en uno. Con la opción <em>--update-parallelism</em> se especifica el número de tareas del servicio que se actualizan simultáneamente. La opción <em>--update-delay</em> especifica el tiempo de espera desde que se actualiza la tarea de un servicio y la siguiente. Se puede describir como una combinación de segundos, minutos o horas, de modo que 1m30s indica una espera de 1 minuto y 30 segundos.</p>
<p>En los <a href="https://docs.docker.com/compose/compose-file/">archivos en formato YAML de los <em>stacks</em> de Docker Compose</a> hay una sección en cada servicio en el que se indica el número de contenedores que se desea que esté formado el servicio así como las opciones de paralelismo y tiempo de espera entre actualización. Para actualizar el <em>stack</em> basta con hacer de nuevo el <em>deploy</em>, ya sea la imagen usada, el número de réplicas u otros parámetros.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span><span class="lnt">4&#10;</span><span class="lnt">5&#10;</span><span class="lnt">6&#10;</span><span class="lnt">7&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nn">...</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">deploy</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">4</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">update_config</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">parallelism</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">delay</span><span class="p">:</span><span class="w"> </span><span class="l">1m30s</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">...</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>docker-compose-stack-app.yml</span>
    </div>
</div>
<div class="alert alert-secondary sourcecode">
    <img src="https://picodotdev.github.io/blog-bitix/assets/images/icons/terminal.svg" width="64" height="64" alt="Terminal" title="Terminal" class="lozad sourcecode-icon">
    <p>
            El <a href="https://github.com/picodotdev/blog-ejemplos/tree/master/DockerSwarm">código fuente completo del ejemplo</a> puedes descargarlo del repositorio de ejemplos de Blog Bitix alojado en GitHub.</p>
</div>
]]>
        </content>
        
            
                <category term="planeta-codigo"/>
            
                <category term="software-libre"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2017/04/iniciar-un-stack-de-servicios-en-un-cluster-de-docker-swarm/</id>
        <title>Iniciar un stack de servicios en un cluster de Docker Swarm</title>
        <updated>2017-04-02T12:00:00+02:00</updated>
        <published>2017-04-02T12:00:00+02:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2017/04/iniciar-un-stack-de-servicios-en-un-cluster-de-docker-swarm/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Los <em>stacks</em> en Docker Swarm son definiciones en un archivo de texto en formato YAML de múltiples servicios además de volúmenes, redes de software y secretos. Esta definición de un <em>stack</em> ejecutado en un <em>cluster</em> de nodos Docker Swarm permite iniciar múltiples contenedores además de los otros elementos que necesiten para su funcionamiento. Los <em>stacks</em> son el equivalente para Docker Swarm de los archivos multicontenedor de Docker Compose, y el formato de ambos muy similar.</strong></p>]]>
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/docker.svg" width="200" height="167" alt="Docker" title="Docker"  class=""></p>
</div>
<p>Con <a href="https://docs.docker.com/compose/">Docker Compose</a> se pueden <a href="https://picodotdev.github.io/blog-bitix/2015/07/aplicaciones-multicontenedor-con-docker-compose/">definir en un único archivo un conjunto de contenedores</a> que forma un servicio o aplicación y que se lanzan como una unidad. En vez de ejecutar los comandos individuales que inician cada contenedor el archivo en formato <a href="https://www.yaml.org/">yaml</a> de Docker Compose define varios contenedores y al ser un archivo de texto es añadible a un sistema de control de versiones para registrar los cambios. La información del archivo de Docker Compose es la misma que se indicaría en el comando para iniciar un contenedor individual.</p>
<p>En versiones más recientes se ha modificado ligeramente el formato del archivo de Docker Compose para añadirle las características necesarias que necesita <a href="https://docs.docker.com/swarm/">Docker Swarm</a>, la <a href="https://picodotdev.github.io/blog-bitix/2017/03/introduccion-y-ejemplo-de-cluster-de-contenedores-con-docker-swarm/">herramienta integrada en Docker que permite crear <em>clusters</em> de nodos</a> que ejecuten contenedores <a href="https://www.docker.com/">Docker</a>. A estos archivos ahora se les denomina como <em>stacks</em>. Así hay nuevas secciones como <em>services</em>, <em>networks</em>, <em>volumes</em> y <em>secrets</em> entre otras para soportar algunas funcionalidades adicionales. La sección <em>services</em> es similar a la que usábamos en Docker Compose y define los contenedores. Por ejemplo, para definir que el servicio se componga de un contenedor con un servidor web <a href="https://nginx.org/">nginx</a> usaríamos el siguiente archivo. El parámetro <em>version</em> es muy importante ya que indica las opciones soportadas en el archivo.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3.1&#34;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">nginx</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">nginx:stable-alpine</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">ports</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="s2">&#34;80:80&#34;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="s2">&#34;443:443&#34;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">deploy</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">2</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>docker-compose-stack-nginx.yml</span>
    </div>
</div>
<p>A destacar las opciones <em>deploy</em> y <em>replicas</em> ya que indican cuantas instancias o contenedores de ese servicio habrá en el <em>cluster</em>. Al igual que con los comandos de Docker Swarm era posible crear redes por software a las cuales conectar los contenedores para que se puedan comunicar entre sí en la sección <em>networks</em> de cada servicio se indica las redes a las que conectarlo y en la sección a nivel raíz del archivo las redes a crear.</p>
<p>También hay una sección propia para definir los volúmenes que dependiendo del <em>driver</em> se integra con diferentes plataformas de computación como <a href="https://aws.amazon.com/es/ec2/">Amazon EC2</a>, <a href="https://www.digitalocean.com/">Digital Ocean</a>, <a href="https://www.virtualbox.org/">VirtualBox</a> con <a href="https://rexray.readthedocs.io/en/v0.3.3/">REX-Ray</a>, &hellip;. Los volúmenes proporcionan persistencia a los efímeros contenedores, por un lado almacenar datos que deban sobrevivir a la vida de un contenedor en su sistema de archivos es inadecuado ya que sus datos no son compartidos si se inicia otra instancia del contenedor y son eliminados cuando el contenedor desaparece, por otro lado en un <em>cluster</em> de contenedores Docker si un contenedor de un servicio finaliza inexperadamente Docker Swarm puede decidir reiniciarlo en cualquier otro nodo del <em>cluster</em> para mantener el estado del servicio por lo que los archivos compartidos no pueden estar tampoco en el <em>host</em> que hospeda los contenedores. Por estos motivos Docker Swarm necesita de un sistema de persistencia, que en este caso son los volúmenes definidos en la sección del mismo nombre <em>volumes</em>.</p>
<p>Para mayor seguridad se ha incorporado la sección <em>secrets</em> en la que se especifican elementos de datos como archivos que en el contenedor se montan en el directorio <em>/run/secrets/</em>. Algunos elementos sensibles como usuarios y contraseñas al proporcionarse como parámetros o variables de entorno aparecen haciendo un listado de procesos del sistema con sus respectivos comandos de lanzamiento y parámetros, lo que es un problema de seguridad. Hay otros elementos sensibles como claves SSH, claves privadas o certificados que ahora con los <em>secrets</em> no es necesario incluirlos en la propia imagen del contenedor.</p>
<p>La forma de iniciar y eliminar un <em>stack</em> en un <em>cluster</em> de nodos Docker Swarm es el siguiente:</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env bash&#10;</span></span></span><span class="line"><span class="cl"><span class="cp"></span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">#export MACHINE_STORAGE_PATH=&#34;/run/media/picodotdev/BMOVE ROJO/docker-machine/&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nb">eval</span> <span class="k">$(</span>docker-machine env node-01<span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">docker stack deploy -c docker-compose-stack-nginx.yml nginx&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">sleep 30s&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -e <span class="s2">&#34;\n# Cluster services&#34;</span>&#10;</span></span><span class="line"><span class="cl">docker service ls&#10;</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -e <span class="s2">&#34;\n# Nginx service tasks&#34;</span>&#10;</span></span><span class="line"><span class="cl">docker service ps nginx_nginx&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">for</span> i in <span class="s2">&#34;01&#34;</span> <span class="s2">&#34;02&#34;</span> <span class="s2">&#34;03&#34;</span><span class="p">;</span> <span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;\n# Node </span><span class="nv">$i</span><span class="s2"> containers&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">eval</span> <span class="k">$(</span>docker-machine env node-<span class="nv">$i</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;docker ps&#10;</span></span><span class="line"><span class="cl"><span class="k">done</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">for</span> i in <span class="s2">&#34;01&#34;</span> <span class="s2">&#34;02&#34;</span> <span class="s2">&#34;03&#34;</span><span class="p">;</span> <span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;\n# Node </span><span class="nv">$i</span><span class="s2"> request&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">NODE_IP</span><span class="o">=</span><span class="k">$(</span>docker-machine ip node-<span class="nv">$i</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;curl http://<span class="nv">$NODE_IP</span>/&#10;</span></span><span class="line"><span class="cl"><span class="k">done</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>06-docker-compose-stack-deploy-nginx.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span><span class="lnt">4&#10;</span><span class="lnt">5&#10;</span><span class="lnt">6&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env bash&#10;</span></span></span><span class="line"><span class="cl"><span class="cp"></span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">#export MACHINE_STORAGE_PATH=&#34;/run/media/picodotdev/BMOVE ROJO/docker-machine/&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nb">eval</span> <span class="k">$(</span>docker-machine env node-01<span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">docker stack rm nginx</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>docker-compose-stack-remove-nginx.sh</span>
    </div>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/04/iniciar-un-stack-de-servicios-en-un-cluster-de-docker-swarm/images/nginx-service_huaf72f50b5fc5509540108f173383460a_97355_2560x1440_fit_box_3.png" data-gallery=""><img src="https://picodotdev.github.io/blog-bitix/2017/04/iniciar-un-stack-de-servicios-en-un-cluster-de-docker-swarm/images/nginx-service_huaf72f50b5fc5509540108f173383460a_97355_300x200_fit_box_3.png" width="281" height="200"  class="lozad "></a></p>
<figcaption>Cluster de nodos de Docker Swarm con servicio de nginx replicado con 2 instancias</figcaption>
</figure>
</div>
<p>En la captura de la terminal se aprecia como estando el <em>cluster</em> formado por tres nodos y el servicio estando replicado con dos instancias Docker Swarm ha decidido iniciar una instancia de contenedor nginx en el <em>nodo-01</em> y otra en el <em>nodo-03</em> pero perfectamente podría haber iniciado una de ellas en el <em>nodo-02</em>. Gracias a las capacidades de <em>networking</em> de Docker Swarm con <a href="https://docs.docker.com/engine/swarm/ingress/">Routing Mesh</a> al cualquier nodo que se le haga una petición al puerto 80 del servicio de nginx devolverá una respuesta, incluso si se hace en el ejemplo la petición al <em>nodo-02</em> la respuesta será devuelta aunque en ese nodo no tenga una instancia de contenedor ejecutándose, realmente redirigirá la petición de forma transparente para el cliente la petición a un nodo que si tenga una instancia de nginx. También, al estar el servicio replicado con dos instancias Docker Swarm realizará automáticamente un <a href="https://docs.docker.com/docker-cloud/getting-started/deploy-app/9_load-balance_the_service/">balanceo de carga</a> <em>round-robin</em> repartiendo las peticiones entre cada una de las instancias de nginx.</p>
<p>De los <em>volumes</em> y <em>secrets</em> en posteriores entregas de esta <a href="https://picodotdev.github.io/blog-bitix/series/docker/">serie de artículos sobre Docker</a> las comentaré de forma específica. El <em>stack</em> de servicios mostrado en este ejemplo es muy sencillo. Aunque también sencillo en el mismo código fuente del ejemplo incluyo otro <em>stack</em> formado por un servicio de nginx y una aplicación Java con <a href="https://projects.spring.io/spring-boot/">Spring Boot</a> que hace uso de <em>secrets</em> y <em>volumes</em>.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span><span class="lnt">18&#10;</span><span class="lnt">19&#10;</span><span class="lnt">20&#10;</span><span class="lnt">21&#10;</span><span class="lnt">22&#10;</span><span class="lnt">23&#10;</span><span class="lnt">24&#10;</span><span class="lnt">25&#10;</span><span class="lnt">26&#10;</span><span class="lnt">27&#10;</span><span class="lnt">28&#10;</span><span class="lnt">29&#10;</span><span class="lnt">30&#10;</span><span class="lnt">31&#10;</span><span class="lnt">32&#10;</span><span class="lnt">33&#10;</span><span class="lnt">34&#10;</span><span class="lnt">35&#10;</span><span class="lnt">36&#10;</span><span class="lnt">37&#10;</span><span class="lnt">38&#10;</span><span class="lnt">39&#10;</span><span class="lnt">40&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3.1&#34;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">nginx</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">nginx:stable-alpine</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">ports</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="s2">&#34;80:80&#34;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="s2">&#34;443:443&#34;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">networks</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="l">proxy</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">secrets</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="l">nginx.conf</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="l">localhost.pem</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="l">localhost.key</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l">sh -c &#34;exec nginx -c /run/secrets/nginx.conf -g &#39;daemon off;&#39;&#34;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">app</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">localhost:5000/spring-boot-app:1.0</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">ports</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="s2">&#34;8080:8080&#34;</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">networks</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="l">proxy</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">volumes</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="l">app:/data</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">secrets</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;  </span>- <span class="l">message.txt</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">networks</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">proxy</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">volumes</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">app</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l">rexray</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">secrets</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">nginx.conf</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l">./nginx.conf</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">localhost.pem</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l">./localhost.pem</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">localhost.key</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l">./localhost.key</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">message.txt</span><span class="p">:</span><span class="w">&#10;</span></span></span><span class="line"><span class="cl"><span class="w">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l">./message.txt</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>docker-compose-stack-app.yml</span>
    </div>
</div>
<p>Un libro que me ha gustado mucho y que recomiendo leer sobre Docker Swarm es <a href="https://amzn.to/2mIirti">The Devops 2.1 Toolkit</a> que lo explica detalladamente y todo el libro está orientado a como usarlo en un entorno de producción. Un libro más introductorio que también he leído y que está bastante bien es <a href="https://amzn.to/2mF3Xtj">Docker in Action</a>.</p>
<div class="media media-amazon">
  <iframe style="width:120px;height:240px;" width="120" height="240" scrolling="no" frameborder="0" src="https://rcm-eu.amazon-adsystem.com/e/cm?lt1=_blank&amp;bc1=000000&amp;IS2=1&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;t=blobit-21&amp;language=es_ES&amp;o=30&amp;p=8&amp;l=as4&amp;m=amazon&amp;f=ifr&amp;ref=as_ss_li_til&amp;asins=1492036730&amp;linkId=666d0aff3a2629cd87c205370bc5ae87" title="Amazon" class="lozad"></iframe>
  <iframe style="width:120px;height:240px;" width="120" height="240" scrolling="no" frameborder="0" src="https://rcm-eu.amazon-adsystem.com/e/cm?lt1=_blank&amp;bc1=000000&amp;IS2=1&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;t=blobit-21&amp;language=es_ES&amp;o=30&amp;p=8&amp;l=as4&amp;m=amazon&amp;f=ifr&amp;ref=as_ss_li_til&amp;asins=1633430235&amp;linkId=9d344246cd59cd65a952305379c2556a" title="Amazon" class="lozad"></iframe>
  <iframe style="width:120px;height:240px;" width="120" height="240" scrolling="no" frameborder="0" src="https://rcm-eu.amazon-adsystem.com/e/cm?lt1=_blank&amp;bc1=000000&amp;IS2=1&amp;bg1=FFFFFF&amp;fc1=000000&amp;lc1=0000FF&amp;t=blobit-21&amp;language=es_ES&amp;o=30&amp;p=8&amp;l=as4&amp;m=amazon&amp;f=ifr&amp;ref=as_ss_li_til&amp;asins=1542468914&amp;linkId=2101ae950cfcfe9e69b6cc1210e4bf2c" title="Amazon" class="lozad"></iframe>
</div>
<p>Docker Swarm es una opción simple y que está integrada en Docker pero no ofrece todas las funcionalidades de algunas otras opciones que el algunos casos de uso algo más avanzados son necesarias o convenientes. <a href="https://www.nomadproject.io/">Nomad</a> es otra opción simple para gestionar un conjunto de aplicaciones o servicios pero con algunas funcionalidades adicionales que no posee Docker Swarm como escribo en <a href="https://picodotdev.github.io/blog-bitix/2019/04/introduccion-a-nomad-para-gestionar-aplicaciones-y-microservicios/">Introducción a Nomad para gestionar aplicaciones y microservicios</a>.</p>
<div class="alert alert-secondary sourcecode">
    <img src="https://picodotdev.github.io/blog-bitix/assets/images/icons/terminal.svg" width="64" height="64" alt="Terminal" title="Terminal" class="lozad sourcecode-icon">
    <p>
            El <a href="https://github.com/picodotdev/blog-ejemplos/tree/master/DockerSwarm">código fuente completo del ejemplo</a> puedes descargarlo del repositorio de ejemplos de Blog Bitix alojado en GitHub.</p>
</div>
<div class="reference">
    Referencia:<br>
<ul>
<li><a href="https://docs.docker.com/engine/swarm/stack-deploy/">Deploy a stack to a swarm</a></li>
<li><a href="https://docs.docker.com/compose/compose-file/">Compose file reference</a></li>
</ul>
</div>
]]>
        </content>
        
            
                <category term="planeta-codigo"/>
            
                <category term="software-libre"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/</id>
        <title>Servidores Cloud VPS de Clouding.io para hospedar blogs y páginas web</title>
        <updated>2017-11-06T20:00:00+01:00</updated>
        <published>2017-02-28T22:00:00+01:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Al escribir este artículo patrocinado sobre Clouding.io he podido probar de primera mano el crear un servidor virtual basado en la computación en la nube. Después de probarlo me parece una opción sencilla y sin complicaciones, adecuada y más que suficiente desde el rango de proyectos más pequeños de presencia en internet, blogs o servicios web y con capacidad suficiente hasta los proyectos más grandes y exigentes de cualquier empresa. Además, con la característica diferenciadora de ofrecer soporte en español en caso de necesitar algún tipo de asistencia o ayuda.</strong></p>]]>
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/clouding.svg" width="300" height="222" alt="Clouding.io" title="Clouding.io"  class=""></p>
</div>
<p>Toda página web, blog y servicio que está accesible en internet ha de ser hospedado en algún servidor. Por motivos de fiabilidad, también coste y flexibilidad se suele contratar un servicio de hospedaje de los muchos que hay en internet. Desde no hace tanto tiempo ha surgido una modalidad de hospedaje que permite mayor flexibilidad, la llamada <a href="https://en.wikipedia.org/wiki/Cloud_computing">cloud computing</a> o computación en la nube, cuya características diferenciadoras son permitir variar de forma elástica, aumentando o reduciendo, los recursos de computación utilizados ya sea de procesador, memoria, almacenamiento o transferencia de datos. Otra característica de la computación en la nube es que es inmediata (en cuestión de minutos) sin necesidad de trámites administrativos o tiempos de espera, los servicios de computación en la nube incluyen paneles de administración para los servidores accesibles a través de un navegador con aplicaciones sencillas o incluso interfaces basadas en linea de comandos de modo que es posible automatizar las tareas de sistemas con <a href="https://en.wikipedia.org/wiki/DevOps">DevOps</a>.</p>
<p>Hay múltiples opciones de computación en la nube algunas con más servicios y funcionalidades pero también más complejas y no necesarias para proyectos sencillos y no muy grandes. Una de las opciones de computación en la nube sencilla pero suficiente en muchos casos es <a href="https://clouding.io/">Clouding.io</a> que en la opción más básica ofrece un servidor con <strong>1/2 núcleo de CPU, 1 GiB de memoria, 5 GiB de almacenamiento persistente de estado sólido o SSD y 2 TiB de datos de transferencia a un precio de 3 € + IVA al mes</strong> (unos 3.5 € con IVA incluido), precio incluso más económica que otras opciones de servidores en la nube.</p>
<p>Para un página web con archivos estáticos de presencia en internet o un blog como Blog Bitix que solo utiliza recursos estáticos (HTML, CSS, JavaScript e imágenes) lo más básico ya sería suficiente y para un blog con <a href="https://wordpress.org/">Wordpress</a> utilizando 2 GiB y un precio de 9 € al mes también debería ser más que suficiente para un tráfico respetable en cantidad.</p>
<p>Una de las ventajas del <em>cloud computing</em> es la elasticidad que permite cambiar en cualquier momento los recursos reservados según las necesidades como la cantidad de memoria, núcleos de procesador o espacio en disco, tanto para reservar más recursos o para disminuir los recursos utilizados y también el coste. En la página de Clouding.io está la simple política de precios según los recursos reservados. <strong>Desde 1 GiB hasta 192 GiB de memoria, desde 1 hasta 48 cores de CPU y desde 5 GiB hasta 1900 GiB de almacenamiento SSD</strong> por servidor cubriendo las necesidades hasta de las aplicaciones más exigentes.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-web_hu6d459e25f76ec896873005b1fc0287df_217640_2560x1440_fit_box_3.png" data-gallery="" title="Página web de Clouding.io"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-web_hu6d459e25f76ec896873005b1fc0287df_217640_650x450_fit_box_3.png" width="650" height="442" alt="Página web de Clouding.io" title="Página web de Clouding.io"  class="lozad "></a></p>
<figcaption>Página web de Clouding.io</figcaption>
</figure>
</div>
<div class="alert alert-warning tableofcontents"><h2>Contenido del artículo</h2><toc></toc></div>
<h3 id="infraestructura-_cloud_-de-clouding">Infraestructura <em>cloud</em> de Clouding</h3>
<p>Algunas de las características de Clouding.io algo más detalladas en su página web es que ofrecen soporte en español y discos SSD rápidos para el almacenamiento además de las siguientes:</p>
<ul>
<li>Potente: procesadores de última generación, redes de alta velocidad y baja latencia, almacenamiento redundante, virtualización de alto rendimiento con KVM, cache inteligente y discos SSD.</li>
<li>Estable: Triple Réplica, Auto Reparación, Datacenter Tier 4, Calidad Empresarial, Protección de Red, Hosting DNS.</li>
<li>Flexible: Cloud Hosting por Horas, Windows Cloud, Linux Cloud, Configuración a medida, Ampliaciones temporales, Activación inmediata.</li>
<li>Fácil: Soporte de Calidad, Cloud Pros, Teclado y Monitor Remoto, Como y cuando quieras, DIY: Hazlo tú mismo, Comunidad.</li>
</ul>
<p>En el blog de Clouding.io hay artículos interesantes y tiene una comunidad con una base de conocimiento y una sección de preguntas y respuestas para resolver cualquier duda que nos surja, todo en español. Las imágenes de sistemas operativos que ofrecen son las siguientes en las que se incluyen la opción de <a href="https://www.microsoft.com/es-es/windows/">Windows</a> aunque siendo este un blog más afín al software libre recomiendo una de las versiones de <a href="https://www.gnu.org/">GNU</a>/<a href="https://www.linux.com/">Linux</a>, una ventaja es que el precio es más barato. De <a href="https://www.ubuntu.com/">Ubuntu</a> hay múltiples versiones aunque siendo el propósito prestar un servicio durante periodos de tiempo largos lo recomendable es utilizar una versión <abbr title="Long Term Support">LTS</abbr> o de soporte prolongado. También es posible otras distribuciones populares como sistema operativo como <a href="https://www.debian.org/">Debian</a> y <a href="https://www.centos.org/">CentOS</a>.</p>
<p>Clouding ofrece una infraestructura de alta disponibilidad, con servicios de copias de seguridad para preservar datos y restauración, toma de instantáneas como medida de seguridad y recuperación, archivado de servidores para ahorrar costes, redimensionado de servidores gracias a la computación <em>cloud</em>, configuración de red privada para mayor seguridad. En el panel de administración de los servidores también se ofrecen detalles para la monitorización y observabilidad con los que comprobar el buen estado de funcionamiento del servidor.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-caracteristicas-1_hu47cae0a478570364adf19f84fbfbe4d4_94578_2560x1440_fit_box_3.png" data-gallery="" title="Características de Clouding"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-caracteristicas-1_hu47cae0a478570364adf19f84fbfbe4d4_94578_200x150_fit_box_3.png" width="200" height="115" alt="Características de Clouding" title="Características de Clouding"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-caracteristicas-2_hud8f3f8d7341ef400d32f1a50a52163e9_95722_2560x1440_fit_box_3.png" data-gallery="" title="Características de Clouding"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-caracteristicas-2_hud8f3f8d7341ef400d32f1a50a52163e9_95722_200x150_fit_box_3.png" width="200" height="114" alt="Características de Clouding" title="Características de Clouding"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-caracteristicas-3_hu5696f2a73e44764296c3694618fa04a5_92878_2560x1440_fit_box_3.png" data-gallery="" title="Características de Clouding"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-caracteristicas-3_hu5696f2a73e44764296c3694618fa04a5_92878_200x150_fit_box_3.png" width="200" height="114" alt="Características de Clouding" title="Características de Clouding"  class="lozad "></a></p>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-caracteristicas-4_hu141d7784ad9fac9f3ec5f057f7862247_99197_2560x1440_fit_box_3.png" data-gallery="" title="Características de Clouding"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-caracteristicas-4_hu141d7784ad9fac9f3ec5f057f7862247_99197_200x150_fit_box_3.png" width="200" height="115" alt="Características de Clouding" title="Características de Clouding"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-caracteristicas-5_hu36c7e1637319c262e9aab10087164207_92561_2560x1440_fit_box_3.png" data-gallery="" title="Características de Clouding"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-caracteristicas-5_hu36c7e1637319c262e9aab10087164207_92561_200x150_fit_box_3.png" width="200" height="118" alt="Características de Clouding" title="Características de Clouding"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-caracteristicas-6_hua7694af4fd912997d20e00b13a1244ee_90902_2560x1440_fit_box_3.png" data-gallery="" title="Características de Clouding"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-caracteristicas-6_hua7694af4fd912997d20e00b13a1244ee_90902_200x150_fit_box_3.png" width="200" height="117" alt="Características de Clouding" title="Características de Clouding"  class="lozad "></a></p>
<figcaption>Características de Clouding</figcaption>
</figure>
</div>
<p>Para garantizar un buen servicio utilizan una infraestructura moderna y de alto rendimiento, redundante y tolerante a fallos compuesta por hardware, software, red, imágenes y centros de datos. Almacenamiento con discos SSD NVMe de alta velocidad, RAM con corrección de errores ECC, consola de emergencia y monitorización, red de alto rendimiento baja velocidad con protecciones frente ataques DDOS y con dirección IP pública, imágenes para servidores basados en Linux o Windows, paneles de control y aplicaciones preinstaladas, finalmente sus centros de datos ubicados en España son redundantes y con energía 100% renovable.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-infraestructura-1_hua0b71a493c7e0f9a963194c3eecb131d_129895_2560x1440_fit_box_3.png" data-gallery="" title="Infraestructura de Clouding"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-infraestructura-1_hua0b71a493c7e0f9a963194c3eecb131d_129895_200x150_fit_box_3.png" width="161" height="150" alt="Infraestructura de Clouding" title="Infraestructura de Clouding"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-infraestructura-2_hu26a10119971413dd8558a72c1e104fed_135238_2560x1440_fit_box_3.png" data-gallery="" title="Infraestructura de Clouding"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-infraestructura-2_hu26a10119971413dd8558a72c1e104fed_135238_200x150_fit_box_3.png" width="160" height="150" alt="Infraestructura de Clouding" title="Infraestructura de Clouding"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-infraestructura-3_huee52e53912c36303bac457dd7e3703da_127867_2560x1440_fit_box_3.png" data-gallery="" title="Infraestructura de Clouding"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-infraestructura-3_huee52e53912c36303bac457dd7e3703da_127867_200x150_fit_box_3.png" width="158" height="150" alt="Infraestructura de Clouding" title="Infraestructura de Clouding"  class="lozad "></a></p>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-infraestructura-4_hu5cd5cc7fdf3eed52fa514d1d014559e6_123773_2560x1440_fit_box_3.png" data-gallery="" title="Infraestructura de Clouding"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-infraestructura-4_hu5cd5cc7fdf3eed52fa514d1d014559e6_123773_200x150_fit_box_3.png" width="159" height="150" alt="Infraestructura de Clouding" title="Infraestructura de Clouding"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-infraestructura-5_hu407ad9e63341590400f3617a98a4b99b_124760_2560x1440_fit_box_3.png" data-gallery="" title="Infraestructura de Clouding"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-infraestructura-5_hu407ad9e63341590400f3617a98a4b99b_124760_200x150_fit_box_3.png" width="158" height="150" alt="Infraestructura de Clouding" title="Infraestructura de Clouding"  class="lozad "></a></p>
<figcaption>Infraestructura de Clouding</figcaption>
</figure>
</div>
<p>Son muchas las empresas que confían en Clouding como proveedor de servicios para sus necesidades tecnológicas. Dado el tamaño de estas empresas es garantía de que el servicio de Clouding está a la altura para tenerlos como clientes.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-clientes_hub824dfca607c3f0a0eb0c96ed75b2a20_126653_2560x1440_fit_box_3.png" data-gallery="" title="Clientes de Clouding"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/clouding-clientes_hub824dfca607c3f0a0eb0c96ed75b2a20_126653_200x150_fit_box_3.png" width="188" height="150" alt="Clientes de Clouding" title="Clientes de Clouding"  class="lozad "></a></p>
<figcaption>Clientes de Clouding</figcaption>
</figure>
</div>
<h3 id="crear-un-servidor-_cloud_-en-clouding">Crear un servidor <em>cloud</em> en Clouding</h3>
<p>Para probar su servicio ofrecen un cupón de 5 €, que con la opción más básica son unos 45 días de uso continuado en su configuración más básica para evaluar su servicio sin compromiso. El registro requiere validar una cuenta de correo electrónico, móvil y tarjeta de crédito. Requerir el móvil y la tarjeta de crédito para probar el servicio es algo excesivo pero quizá necesario para evitar <em>spam</em> y usos no deseados. Realizado el registro ya está disponible el acceso al panel de administración desde el que crear nuevos servidores, arrancarlos, modificarlos, pararlos o eliminarlos.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/registro_huae5c4934c92475d27870cebea28f77ff_60890_2560x1440_fit_box_3.png" data-gallery="" title="Pasos de verificación del registro"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/registro_huae5c4934c92475d27870cebea28f77ff_60890_300x200_fit_box_3.png" width="300" height="143" alt="Pasos de verificación del registro" title="Pasos de verificación del registro"  class="lozad "></a></p>
<figcaption>Registro</figcaption>
</figure>
</div>
<p>Completado el registro accediendo al panel de administración en la sección servidores podremos crear las instancias y con que cantidad de recursos reservados, para ajustar el precio y dada la elasticidad de los servidores se puede empezar por las opciones mínimas e ir subiendo hasta que los recursos sean suficientes para el correcto funcionamiento de servidor según los recursos necesarios.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/panel-administracion_hua8cc9f49dd164b7b495598d82a88e5ea_30889_2560x1440_fit_box_3.png" data-gallery="" title="Panel de administración"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/panel-administracion_hua8cc9f49dd164b7b495598d82a88e5ea_30889_300x200_fit_box_3.png" width="300" height="143" alt="Panel de administración" title="Panel de administración"  class="lozad "></a></p>
<figcaption>Panel de administración</figcaption>
</figure>
</div>
<p>Como utilidad Clouding.io ofrece un panel donde gestionar los registros DNS del dominio que contratemos y conocer los nombre de <em>host</em> y direcciones IP de los servidores de DNS de Clouding.io. Casi seguro que la entidad registradora del dominio que le asignemos al servicio para su acceso también tenga la opción de administrar los registros DNS, usar el de Clouding.io es más por unificar en un solo sitio toda la administración del servidor. En las opciones avanzadas se pueden administrar multitud de tipos de registro DNS.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/dns_hu41e10548ff765daddec6c6cb902f451b_53127_2560x1440_fit_box_3.png" data-gallery="" title="Administración DNS"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/dns_hu41e10548ff765daddec6c6cb902f451b_53127_300x200_fit_box_3.png" width="300" height="143" alt="Administración DNS" title="Administración DNS"  class="lozad "></a></p>
<figcaption>Administración DNS</figcaption>
</figure>
</div>
<p>La sección principal es la de <em>Servidores</em> donde hay tres pestañas: una para los servidores, otra para las reglas de <em>firewall</em> para controlar el tráfico entrante y saliente de cada servidor y otra para las <em>llaves SSH</em> que usaremos para conectarnos desde nuestro equipo de forma segura. Seleccionado las características del servidor (memoria, procesadores y espacio en disco) al cabo de unos momentos el servidor se iniciará y estará disponible para que nos conectemos mediante SSH o desde la terminal con interfaz web ofrecida. Desde el listado de servidores podremos pararlo, reiniciarlo, redimensionarlo o eliminarlo. En la pestaña <em>Acceso</em> obtendremos el nombre de <em>host</em> asignado y la dirección IP privada y pública asignada, así como la contraseña del usuario <em>root</em>. En la pestaña <em>Estadísticas</em> monitorizaremos el estado del servidor y conoceremos si es necesario redimiensionarlo en algún parámetro.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/servidor_hu3131f9c01206c90471248ec20a9654a7_37137_2560x1440_fit_box_3.png" data-gallery="" title="Parámetros de acceso de un servidor"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/servidor_hu3131f9c01206c90471248ec20a9654a7_37137_300x200_fit_box_3.png" width="300" height="143" alt="Parámetros de acceso de un servidor" title="Parámetros de acceso de un servidor"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/acceso_huc8456af10ea1e5396a7fdc1b23cabe2c_91973_2560x1440_fit_box_3.png" data-gallery="" title="Parámetros de acceso de un servidor"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/acceso_huc8456af10ea1e5396a7fdc1b23cabe2c_91973_300x200_fit_box_3.png" width="255" height="200" alt="Parámetros de acceso de un servidor" title="Parámetros de acceso de un servidor"  class="lozad "></a></p>
<figcaption>Un servidor y sus parámetros de acceso</figcaption>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/nuevo-servidor_hu6fae8938a73c88b555c9f18a38a80ffa_82256_2560x1440_fit_box_3.png" data-gallery="" title="Nuevo servidor"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/nuevo-servidor_hu6fae8938a73c88b555c9f18a38a80ffa_82256_300x200_fit_box_3.png" width="290" height="200" alt="Nuevo servidor" title="Nuevo servidor"  class="lozad "></a></p>
<figcaption>Nuevo servidor</figcaption>
</figure>
</div>
<p>Las reglas del <em>firewall</em> por defecto son demasiado permisivas, si solo necesitamos que el puerto 80, el del servidor web, esté abierto el resto de reglas para otros puertos se pueden eliminar para evitar posibles agujeros de seguridad. Una cosa buena es que se pueden crear múltiples reglas de seguridad y aplicar a cada servidor la más conveniente.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/firewall_hu9d750e187604d5487e9e11027a30a400_116554_2560x1440_fit_box_3.png" data-gallery="" title="Reglas de firewall"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/firewall_hu9d750e187604d5487e9e11027a30a400_116554_300x200_fit_box_3.png" width="210" height="200" alt="Reglas de firewall" title="Reglas de firewall"  class="lozad "></a></p>
<figcaption>Reglas de firewall</figcaption>
</figure>
</div>
<h3 id="conexión-mediante-línea-de-comandos-con-ssh">Conexión mediante línea de comandos con SSH</h3>
<p>Las llaves SSH son necesarias para conectarnos al servidor y lanzar comandos desde la terminal. Generada una llave SSH desde el apartado <em>Llaves SSH</em> descargaremos la clave privada, la añadiremos al directorio <em>~/.ssh</em> y configuraremos el archivo <em>~/.ssh/config</em> para acceder al servidor.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/llaves-ssh_huea62ffdec855ca869e85cc274ad4d7d3_30472_2560x1440_fit_box_3.png" data-gallery="" title="Claves SSH"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/llaves-ssh_huea62ffdec855ca869e85cc274ad4d7d3_30472_300x200_fit_box_3.png" width="300" height="143" alt="Claves SSH" title="Claves SSH"  class="lozad "></a></p>
<figcaption>Claves SSH</figcaption>
</figure>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span><span class="lnt">4&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">Host 6ff66804-d8f0-4b4e-a176-1e30a40a0672.clouding.host&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;HostName 6ff66804-d8f0-4b4e-a176-1e30a40a0672.clouding.host&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;User root&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;IdentityFile ~/.ssh/clouding.pem</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>config</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt"> 1&#10;</span><span class="lnt"> 2&#10;</span><span class="lnt"> 3&#10;</span><span class="lnt"> 4&#10;</span><span class="lnt"> 5&#10;</span><span class="lnt"> 6&#10;</span><span class="lnt"> 7&#10;</span><span class="lnt"> 8&#10;</span><span class="lnt"> 9&#10;</span><span class="lnt">10&#10;</span><span class="lnt">11&#10;</span><span class="lnt">12&#10;</span><span class="lnt">13&#10;</span><span class="lnt">14&#10;</span><span class="lnt">15&#10;</span><span class="lnt">16&#10;</span><span class="lnt">17&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">-----BEGIN RSA PRIVATE KEY-----&#10;</span></span><span class="line"><span class="cl">MIIEpQIBAAKCAQEA2kXDUI1E8VcfPUf6YLju2bBPAjy3Y8+GTJMHmDikpPt+uTp4&#10;</span></span><span class="line"><span class="cl">gt5miCFYnZYJB4g3/o/sUPLHBqnQN23jlXn4s0xe/20hKc6iDPSoJEjurqCrpRPj&#10;</span></span><span class="line"><span class="cl">eYwfnes3xdPXJujgAUXodTtPhoQMfmKHvw9mgEwHA6QKRyU83/ZXKldywBDet3Vh&#10;</span></span><span class="line"><span class="cl">NcNayFEzBsLWR1niI0/SKu903XLszS2l93tsB+hhQzD44G57AKJgpQZ+wPkXD4yB&#10;</span></span><span class="line"><span class="cl">KWVUjLodOGSLm00S5EqyQDPZb1QosFu/eFGnriOlA1CY2+Ef+EkQ6ydBRGrS6kY7&#10;</span></span><span class="line"><span class="cl">uharn+9wZNUAXc+542iUlW7GNfVijd1sAZVxfQIDAQABAoIBAFkVuA2cWtMVd86P&#10;</span></span><span class="line"><span class="cl">HgVz9Sgr6VNEbKT0AiAmsibSl4AulR4MWzsugjJ1SbGnlq/YTOI843p2W/zAOhcl&#10;</span></span><span class="line"><span class="cl">ZomPao3jUbJ2W96wUztub2G/0oq7UNLjNyhYpF7TrcO0Hk/nI+XhHmsade603lSG&#10;</span></span><span class="line"><span class="cl">6lh0dKVQYlx+CyPWcu4FoLXLUy5H80+s40oAbGi4Cd/Ldozcno7ael3CmmAfqc3N&#10;</span></span><span class="line"><span class="cl">r2xSxZregTEbBtl4vV3a0T4YONgsj6qW9rXj3asC6lu9ndXhzOlTt/yc+uU4/VND&#10;</span></span><span class="line"><span class="cl">f5oxT/oariimRlH+YAE0hJHcfltsvDAn/XBhndbBb3aIThcoreWHEYeq/TiCR+KO&#10;</span></span><span class="line"><span class="cl">hPOYEAECgYEA9CRLr3uT1VbOAtjrcnziitI2iJMMqo4W/PXZMBUeWOccBp+bQUQc&#10;</span></span><span class="line"><span class="cl">vR7gYy605iIh413ytDIbZE8rvR4XVi+DU9S38GO1Wa1NorTUym3LqA2GhzCeaY5F&#10;</span></span><span class="line"><span class="cl">eeb085SwK7cqha1ye4h+1eHh1jTJcn+6oCcnl0oeUeBvvlCtiQ8s0QECgYEA5N/N&#10;</span></span><span class="line"><span class="cl">...&#10;</span></span><span class="line"><span class="cl">-----END RSA PRIVATE KEY-----</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>clouding.pem</span>
    </div>
</div>
<p>En los ajustes veremos el saldo disponible que se irá descontando según los recursos consumidos durante el periodo de tiempo utilizados. Una cosa importante es que aunque el servidor esté apagado seguirá contabilizándose en la facturación. Podemos elegir recibir notificaciones cuando el saldo de la cuenta sea bajo para realizar una recarga.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/ajustes_hu3abe75b398785d9c4d59314317679cd1_110183_2560x1440_fit_box_3.png" data-gallery="" title="Ajustes, facturación e informes"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/ajustes_hu3abe75b398785d9c4d59314317679cd1_110183_300x200_fit_box_3.png" width="217" height="200" alt="Ajustes, facturación e informes" title="Ajustes, facturación e informes"  class="lozad "></a></p>
<figcaption>Ajustes, facturación e informes</figcaption>
</figure>
</div>
<p>Una de las primeras cosas aconsejables realizar es tener acceso mediante SSH descargando la clave privada desde le apartado <em>Llaves SSH</em>, con GNU/Linux no se necesita mucho más para conectarse al servidor, en Windows se puede utilizar un programa como <a href="https://www.putty.org/">PuTTY</a>. En cualquier caso siempre está disponible el acceso vía web. Otra de las cosas que a realizar es acceder al servidor SSH mediante un dominio propio que también con anterioridad hay que registrar. Y también es recomendable actualizar todos los paquetes o actualizaciones de seguridad del sistema.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/ssh_hu496b30201e505a3438bf4a6b41205b72_78898_2560x1440_fit_box_3.png" data-gallery="" title="Acceso mediante SSH"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/ssh_hu496b30201e505a3438bf4a6b41205b72_78898_300x200_fit_box_3.png" width="300" height="164" alt="Acceso mediante SSH" title="Acceso mediante SSH"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/consola-vnc_hu7a23f71cd1c51143e57e920da827f002_49236_2560x1440_fit_box_3.png" data-gallery="" title="Acceso mediante consola VNC"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/consola-vnc_hu7a23f71cd1c51143e57e920da827f002_49236_300x200_fit_box_3.png" width="300" height="143" alt="Acceso mediante consola VNC" title="Acceso mediante consola VNC"  class="lozad "></a></p>
<figcaption>Acceso mediante SSH y consola VNC</figcaption>
</figure>
</div>
<p>Con acceso vía SSH al servidor ya es posible administrarlo con una herramienta como <a href="https://www.ansible.com/">Ansible</a> instalando paquetes, actualizar el servidor y configurar servicios como los servidores web <a href="https://nginx.org/">nginx</a> o <a href="https://httpd.apache.org/">Apache</a>, <a href="https://www.docker.com/">Docker</a> y otra multitud de tareas que permite esta herramienta. En el artículo <a href="https://picodotdev.github.io/blog-bitix/2021/12/aprovisionar-un-servidor-en-la-infraestructura-cloud-de-clouding-con-ubuntu-y-nginx-usando-ansible-y-protocolo-seguro-https-con-lets-encrypt/">Aprovisionar un servidor en la infraestructura cloud de Clouding con Ubuntu y Nginx usando Ansible y protocolo seguro HTTPS con Let&rsquo;s Encrypt</a> muestro como aprovisionar de forma automatizada un servidor <em>cloud</em> de Clouding.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/nginx_hua6e3fe23dbf811bd6c8adc84847a8465_43808_2560x1440_fit_box_3.png" data-gallery="" title="Servidor NGINX"><img src="https://picodotdev.github.io/blog-bitix/2017/02/servidores-cloud-vps-de-cloudingio-para-hospedar-blogs-y-paginas-web/images/nginx_hua6e3fe23dbf811bd6c8adc84847a8465_43808_300x200_fit_box_3.png" width="300" height="143" alt="Servidor NGINX" title="Servidor NGINX"  class="lozad "></a></p>
<figcaption>Servidor NGINX</figcaption>
</figure>
</div>
<p>He encontrado en su blog algunos artículos interesantes y base de conocimiento. Otros artículos de interés son los que escribí en la <a href="https://picodotdev.github.io/blog-bitix/series/web/">serie web</a> en la que comentaba aspectos como HTTP/2, HTTPS, redirecciones o GZIP.</p>
<p>En definitiva Clouding.io es una opción de computación en la nube sencilla, con una política de precios simple y adecuada para proyectos desde pequeños de páginas web y presencia en internet hasta medianos que requieren una base de datos y tenga un tráfico ya notable, con soporte en español y que se puede probar sin compromiso. Al ser computación en la nube ofrece gran flexibilidad y ajustar el precio a los recursos consumidos, al usar discos SSD el buen rendimiento ya lo he notado al probar su servicio cuando he actualizado los paquetes del servidor e instalado el de nginx. Según las características anunciadas de redundancia la fiabilidad es destacable para que no haya caídas de servicio.</p>
]]>
        </content>
        
            
                <category term="gnu-linux"/>
            
                <category term="planeta-codigo"/>
            
                <category term="patrocinado"/>
            
                <category term="software-libre"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/</id>
        <title>Script para instalar Arch Linux de forma fácil, rápido, desatendido, automatizado y personalizable</title>
        <updated>2020-06-20T20:30:00+02:00</updated>
        <published>2017-01-13T00:00:00+01:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        <![CDATA[<p><strong>Arch Linux es una de las distribuciones más personalizables de GNU/Linux pero cuya instalación requiere leer una buena cantidad de documentación, guías o manuales para saber que comandos ejecutar paso a paso en el <em>prompt</em> del sistema en el que te deja se medio de instalación. Algunos usuarios eligen una distribución como Antergos, KaOS o Manjaro con un instalalador gráfico y guiado simplemente por el hecho de no enfrentarse a la instalación de Arch Linux desde la línea de comandos. Aún así, ejecutar un comando y esperar a que termine para introducir otro es lento y requiere de atención.</strong></p>]]>
        <![CDATA[<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/archlinux.svg" width="250" height="186" alt="Arch Linux" title="Arch Linux"  class=""></p>
</div>
<div class="logotypes">
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/linux.svg" width="200" height="232" alt="Linux" title="Linux"  class=""></p>
</div>
<p>Hace tiempo que instalar una distribución <a href="https://www.gnu.org/">GNU</a>/<a href="https://www.linux.com/">Linux</a> no tiene más dificultad que instalar un sistema operativo como <a href="https://www.microsoft.com/es-es/windows/">Windows</a>, que consiste en descargar la imagen ISO del CD o DVD, grabarla en un CD, DVD o memoria USB e iniciar el sistema con el medio. Las <a href="https://picodotdev.github.io/blog-bitix/2016/10/elegir-una-distribucion-gnu-linux-segun-el-usuario-uso-o-equipo/">distribuciones aconsejadas para usuarios que provienen de Windows o macOS</a> o no tiene muchos conocimientos informáticos poseen instaladores gráficos o basados en texto y guiados en varios pasos hasta completar la instalación en menos de media hora. Distribuciones como <a href="https://www.ubuntu.com/">Ubuntu</a>, <a href="https://elementary.io/es/">elementary OS</a> o <a href="https://www.linuxmint.com/">Linux Mint</a> hacen que la instalación no requiera conocimientos y sea completada con éxito por cualquier usuario.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/images/debian-installer-text_hu24823266aaadbd5ea03f13734b295699_7331_2560x1440_fit_box_3.png" data-gallery="" title="Instalador de Debian en modo texto"><img src="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/images/debian-installer-text_hu24823266aaadbd5ea03f13734b295699_7331_300x200_fit_box_3.png" width="267" height="200" alt="Instalador de Debian en modo texto" title="Instalador de Debian en modo texto"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/images/debian-installer-graphics_hu57b39c5df8bb0f15d502613ed89fe1b4_28647_2560x1440_fit_box_3.png" data-gallery="" title="Instalador de Debian en modo gráfico"><img src="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/images/debian-installer-graphics_hu57b39c5df8bb0f15d502613ed89fe1b4_28647_300x200_fit_box_3.png" width="267" height="200" alt="Instalador de Debian en modo gráfico" title="Instalador de Debian en modo gráfico"  class="lozad "></a></p>
<figcaption>Instalación guíada de Debian basada en texto y gráfica</figcaption>
</figure>
</div>
<p>Otras distribuciones basadas en principios diferentes y usuarios a los que está destinadas con otras necesidades o preferencias puede que requieran algo más de conocimientos a cambio de realizar configuraciones más avanzadas como el particionado del disco, cifrado del disco o software que se instala. Algunas distribuciones como <a href="https://www.archlinux.org/">Arch Linux</a> incluso no proporcionan ningún instalador.</p>
<blockquote>
<p>It is targeted at the proficient GNU/Linux user, or anyone with a do-it-yourself attitude who is
willing to read the documentation, and solve their own problems.</p>
</blockquote>
<div class="alert alert-warning tableofcontents"><h2>Contenido del artículo</h2><toc></toc></div>
<h3 id="la-instalación-del-sistena-con-arch-linux">La instalación del sistena con Arch Linux</h3>
<p>En Arch Linux con su <a href="https://wiki.archlinux.org/index.php/Arch_Linux">forma de hacer las cosas</a> deja al usuario el poder de personalizar el sistema completamente a sus necesidades y preferencias únicamente limitado por su determinación de conseguirlo. Solo proporciona <a href="https://www.archlinux.org/download/">el medio con el que iniciar la instalación</a> que comienza con una terminal y un <em>prompt</em> del sistema, una <a href="https://wiki.archlinux.org/index.php/Installation_guide">guía de instalación</a> junto con las <a href="https://wiki.archlinux.org/index.php/General_recommendations">recomendaciones generales</a> y <a href="https://wiki.archlinux.org/">una de las mejores fuentes de información en GNU/Linux</a> además de completa de cada aspecto que necesitemos en la instalación. Después de haber leído las páginas relevantes de la wiki de Arch Linux, seguramente más de una y dos veces, hasta comprenderla en su mayor parte se empieza a realizar la receta que contenga los comandos necesarios hasta completar la instalación.</p>
<p>En multitud de blogs y vídeos de YouTube hay guías que contienen los comandos y las explicaciones necesarias. Cualquier usuario de Arch Linux con un blog seguramente ha publicado un artículo con su guía de instalación (sí, <a href="https://picodotdev.github.io/blog-bitix/2014/05/anexo-a-la-guia-de-instalacion-y-del-principiante-de-arch-linux/">yo también publiqué la mía</a>). Un usuario que quiera instalar Arch Linux debe leer varios de esos artículos además de la guía oficial de instalación. Según la filosofía de Arch Linux este proceso de aprendizaje se considera necesario y permite una mayor comprensión del sistema.</p>
<p>Pero saber los comandos que hay que introducir para realizar la instalación de Arch Linux no evita tener que teclearlos uno de tras de otro y esperar a que termine el anterior para introducir el siguiente. Tampoco todas las personas tienen el tiempo para realizarlo. Varias <a href="https://wiki.archlinux.org/index.php/Arch-based_distributions">distribuciones derivadas de Arch Linux</a> como <a href="https://antergos.com/">Antergos</a>, <a href="https://kaosx.us/">KaOS</a> o <a href="https://manjaro.org/">Manjaro</a> ofrecen los instaladores gráficos y guiados más amigables que atraen a algunos usuarios buscando usar Arch Linux pero no pasar por su poco amigable proceso de instalación. Por fortuna al ser una distribución <em>rolling release</em> (en constante actualización) solo hay que hacer una única instalación por equipo en principio durante toda su vida de uso. Pero incluso para los usuarios de Arch Linux realizar una segunda instalación en un nuevo equipo es cansina.</p>
<p>Hace unos meses conocí <a href="https://arch-anywhere.org/">arch-anywhere</a> que básicamente es un <em>script</em> de bash, con un instalador guiado y basado en texto que hace menos laboriosa la instalación de Arch Linux de forma similar a las existentes en otras distribuciones más amigables. Sin embargo, hay un dos cosas que no me convencen de <em>arch-anywhere</em>, una es que no es desatendido requiriendo contestar a varias preguntas de forma interactiva, esperar a que termine ejecute algún comando según la contestación anterior y contestar a la siguiente pregunta. Otra cosa que no me convence es que usa una imagen ISO propia y no la original de Arch Linux. Por lo demás, ofrece un buen nivel de personalización cubriendo las necesidades más comunes de los usuarios como personalizar el particionado, elegir el sistema de archivos, si se quiere LVM, cifrado, el entorno de escritorio (GNOME, KDE, XFCE, &hellip;), kernel, cargador de arranque (GRUB) y programas a instalar.</p>
<h3 id="el-instalador-alis-y-características-soportadas">El instalador alis y características soportadas</h3>
<p>Basándome en la idea de <em>arch-anywhere</em> y dedicando un poco de tiempo he creado un <em>script</em> en <a href="https://es.wikipedia.org/wiki/Bash">bash</a> para instalar Arch Linux de forma automatizada, desatendida y personalizable hasta cierto punto aunque siendo útil para los casos de configuraciones más comunes, sin ser imprescindible leer unas decenas de páginas de la wiki de Arch Linux ni seguir ninguna guía o tutorial paso a paso. Algunas de las funcionalidades que soporta son:</p>
<ul>
<li><strong>Sistema</strong>: UEFI, BIOS</li>
<li><strong>Almacenamiento</strong>: SATA, NVMe i MMC</li>
<li><strong>Cifrado</strong>: partición root cifrada y no cifrada</li>
<li><strong>Particionamiento</strong>: no LVM, LVM, LVM on LUKS, GPT on UEFI, MBR on BIOS</li>
<li><strong>Sistema de archivos</strong>: ext4, btrfs (with subvols), xfs, f2fs, reiserfs</li>
<li><strong>Kernels</strong>: linux, linux-lts, linux-hardened, linux-zen</li>
<li><strong>Entorno de escritorio</strong>: GNOME, KDE, XFCE, Mate, Cinnamon, LXDE, i3-wm, i3-gaps</li>
<li><strong>Gestor de inicio de sesión</strong>: GDM, SDDM, Lightdm, lxdm</li>
<li><strong>Controlador gráfico</strong>: intel, nvidia y amd con opcionalmente inicio KMS. Con intel opcionalmente fastboot, aceleración de vídeo por hardware y compresión de framebuffer.</li>
<li><strong>Cargador de arranque</strong>: GRUB, rEFInd, systemd-boot</li>
<li><strong>Shell personalizado</strong>: bash, zsh, dash, fish</li>
<li><strong>Red inalámbrica WIFI</strong> en la instalación</li>
<li><strong>TRIM periódico</strong> para almacenamiento SSD</li>
<li><strong>Microcódigo de procesador</strong> para Intel y AMD</li>
<li><strong>Archivo swap</strong> opcional</li>
<li><strong>VirtualBox guest additions</strong></li>
<li><strong>Conpresión del Kernel compression</strong> y <strong>parámetros personalizados</strong></li>
<li><strong>Creación de usuarios</strong> y <strong>adición a grupo sudoers</strong></li>
<li><strong>Habilitar y deshabilitar units de systemd</strong></li>
<li>Soporte <strong>Multilib</strong></li>
<li><strong>Instalación de paquetes</strong></li>
<li>Instalación de utilidad Flatpak e <strong>instalación de paquetes Flatpak</strong></li>
<li>Instalación de utilidad SDKMAN e <strong>installation de paquetes SDKMAN</strong></li>
<li>Instalación de utilidad AUR (paru, yay, aurman) e <strong>installation de paquetes AUR</strong></li>
<li><strong>Instalación de paquetes después de la inatalación del sistema base</strong> (forma preferida para la instalación de paquetes)</li>
<li>Script para la descarga, <strong>scripts de recuperación</strong> y archivos de configuración</li>
<li><strong>Reintento de descarga de paquetes</strong> al haber errores de conexión on espejo</li>
<li><strong>Soporte Packer</strong> para pruebas en VirtualBox</li>
<li><strong>Tradas de instalación</strong> con todos los comandos ejecutados y su salida en un archivo o <strong>vídeo de asciinema</strong></li>
<li>Espera después de la instalación para un <strong>reinicio abortable</strong></li>
<li>Posibilidad de crear un <em>fork</em> y <strong>usar configuración propia</strong></li>
</ul>
<p>La forma aconsejada de instalar Arch Linux es aprendiendo cuales son los comandos a ejecutar y que hace cada uno de ellos, primero lee la guía oficial de instalación de Arch Linux y comprende que hacen los comandos del <em>script</em>. Este <em>script</em> no es oficial y por ello en el <a href="https://foros.archlinux-es.org/">foro de Arch Linux en español</a> o <a href="https://bbs.archlinux.org/">en inglés</a> no podrán darte soporte aunque yo en los comentarios de este artículo te ayudaré si preguntas. Ten en cuenta que este <em>script</em> elimina toda la información del dispositivo de instalación. Si lo pruebas deja un comentario al final de artículo.</p>
<p>Iniciado el sistema con la imagen ISO de Arch Linux de instalación, hay que descargar el <em>script</em>, editar algunas variables de entorno para la configuración de alis e iniciar el proceso de instalación. Dependiendo del entorno de escritorio preferido, si se desea LVM, el tipo del sistema de archivos, si se desea cifrar el sistema de archivos y paquetes a instalar los valores de las variables variarán según las preferencias que inicialmente tienes unos valores comunes. Dos variables que hay que modificar al menos son <em>USER_NAME</em> y <em>USER_PASSWORD</em> con el nombre del usuario y su contraseña que vaya a utilizar el sistema.</p>
<p>El tiempo requerido de instalación varía según el ancho de banda de la conexión a internet y del tipo de almacenamiento, en mi caso con ADSL con una descarga de 1.2 MiB/s y SSD la instalación del sistema base sin entorno de escritorio me tarda aproximandamente 10 minutos. Con una conexión de fibra tardará sensiblemente menos tiempo. El <em>script</em> de instalación contiene con los mismos comandos que serían necesarios para realizar la instalación manualmente de forma interactiva.</p>
<p>Aunque no se utilice alis, el código bash del <em>script</em> puede verse como documentación ejecutable o como referencia si se opta por hacer la instalación manualmente. Contiene los mismos comandos que un usuario ejecutaría manualmente uno detrás de otro en una instalación interactiva. <a href="https://github.com/picodotdev/alis/">alis</a> es un <em>script</em> que permite hacer la instalación de Arch Linux de forma desatendida, automatizada y personalizable de Arch Linux.</p>
<p>Estos son los comandos de uso de alis y su archivo de configuración con el que personalizar la instalación.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">1&#10;</span><span class="lnt">2&#10;</span><span class="lnt">3&#10;</span><span class="lnt">4&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># loadkeys es</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># curl -sL https://bit.ly/2F3CATp | bash</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># vim alis.conf</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># ./alis.sh</span></span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>alis-install.sh</span>
    </div>
</div>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">  1&#10;</span><span class="lnt">  2&#10;</span><span class="lnt">  3&#10;</span><span class="lnt">  4&#10;</span><span class="lnt">  5&#10;</span><span class="lnt">  6&#10;</span><span class="lnt">  7&#10;</span><span class="lnt">  8&#10;</span><span class="lnt">  9&#10;</span><span class="lnt"> 10&#10;</span><span class="lnt"> 11&#10;</span><span class="lnt"> 12&#10;</span><span class="lnt"> 13&#10;</span><span class="lnt"> 14&#10;</span><span class="lnt"> 15&#10;</span><span class="lnt"> 16&#10;</span><span class="lnt"> 17&#10;</span><span class="lnt"> 18&#10;</span><span class="lnt"> 19&#10;</span><span class="lnt"> 20&#10;</span><span class="lnt"> 21&#10;</span><span class="lnt"> 22&#10;</span><span class="lnt"> 23&#10;</span><span class="lnt"> 24&#10;</span><span class="lnt"> 25&#10;</span><span class="lnt"> 26&#10;</span><span class="lnt"> 27&#10;</span><span class="lnt"> 28&#10;</span><span class="lnt"> 29&#10;</span><span class="lnt"> 30&#10;</span><span class="lnt"> 31&#10;</span><span class="lnt"> 32&#10;</span><span class="lnt"> 33&#10;</span><span class="lnt"> 34&#10;</span><span class="lnt"> 35&#10;</span><span class="lnt"> 36&#10;</span><span class="lnt"> 37&#10;</span><span class="lnt"> 38&#10;</span><span class="lnt"> 39&#10;</span><span class="lnt"> 40&#10;</span><span class="lnt"> 41&#10;</span><span class="lnt"> 42&#10;</span><span class="lnt"> 43&#10;</span><span class="lnt"> 44&#10;</span><span class="lnt"> 45&#10;</span><span class="lnt"> 46&#10;</span><span class="lnt"> 47&#10;</span><span class="lnt"> 48&#10;</span><span class="lnt"> 49&#10;</span><span class="lnt"> 50&#10;</span><span class="lnt"> 51&#10;</span><span class="lnt"> 52&#10;</span><span class="lnt"> 53&#10;</span><span class="lnt"> 54&#10;</span><span class="lnt"> 55&#10;</span><span class="lnt"> 56&#10;</span><span class="lnt"> 57&#10;</span><span class="lnt"> 58&#10;</span><span class="lnt"> 59&#10;</span><span class="lnt"> 60&#10;</span><span class="lnt"> 61&#10;</span><span class="lnt"> 62&#10;</span><span class="lnt"> 63&#10;</span><span class="lnt"> 64&#10;</span><span class="lnt"> 65&#10;</span><span class="lnt"> 66&#10;</span><span class="lnt"> 67&#10;</span><span class="lnt"> 68&#10;</span><span class="lnt"> 69&#10;</span><span class="lnt"> 70&#10;</span><span class="lnt"> 71&#10;</span><span class="lnt"> 72&#10;</span><span class="lnt"> 73&#10;</span><span class="lnt"> 74&#10;</span><span class="lnt"> 75&#10;</span><span class="lnt"> 76&#10;</span><span class="lnt"> 77&#10;</span><span class="lnt"> 78&#10;</span><span class="lnt"> 79&#10;</span><span class="lnt"> 80&#10;</span><span class="lnt"> 81&#10;</span><span class="lnt"> 82&#10;</span><span class="lnt"> 83&#10;</span><span class="lnt"> 84&#10;</span><span class="lnt"> 85&#10;</span><span class="lnt"> 86&#10;</span><span class="lnt"> 87&#10;</span><span class="lnt"> 88&#10;</span><span class="lnt"> 89&#10;</span><span class="lnt"> 90&#10;</span><span class="lnt"> 91&#10;</span><span class="lnt"> 92&#10;</span><span class="lnt"> 93&#10;</span><span class="lnt"> 94&#10;</span><span class="lnt"> 95&#10;</span><span class="lnt"> 96&#10;</span><span class="lnt"> 97&#10;</span><span class="lnt"> 98&#10;</span><span class="lnt"> 99&#10;</span><span class="lnt">100&#10;</span><span class="lnt">101&#10;</span><span class="lnt">102&#10;</span><span class="lnt">103&#10;</span><span class="lnt">104&#10;</span><span class="lnt">105&#10;</span><span class="lnt">106&#10;</span><span class="lnt">107&#10;</span><span class="lnt">108&#10;</span><span class="lnt">109&#10;</span><span class="lnt">110&#10;</span><span class="lnt">111&#10;</span><span class="lnt">112&#10;</span><span class="lnt">113&#10;</span><span class="lnt">114&#10;</span><span class="lnt">115&#10;</span><span class="lnt">116&#10;</span><span class="lnt">117&#10;</span><span class="lnt">118&#10;</span><span class="lnt">119&#10;</span><span class="lnt">120&#10;</span><span class="lnt">121&#10;</span><span class="lnt">122&#10;</span><span class="lnt">123&#10;</span><span class="lnt">124&#10;</span><span class="lnt">125&#10;</span><span class="lnt">126&#10;</span><span class="lnt">127&#10;</span><span class="lnt">128&#10;</span><span class="lnt">129&#10;</span><span class="lnt">130&#10;</span><span class="lnt">131&#10;</span><span class="lnt">132&#10;</span><span class="lnt">133&#10;</span><span class="lnt">134&#10;</span><span class="lnt">135&#10;</span><span class="lnt">136&#10;</span><span class="lnt">137&#10;</span><span class="lnt">138&#10;</span><span class="lnt">139&#10;</span><span class="lnt">140&#10;</span><span class="lnt">141&#10;</span><span class="lnt">142&#10;</span><span class="lnt">143&#10;</span><span class="lnt">144&#10;</span><span class="lnt">145&#10;</span><span class="lnt">146&#10;</span><span class="lnt">147&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Arch Linux Install Script (alis) configuration file</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">#</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># Some variables values are preceded by a ! character, this means that the value is ignored.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># Some variables accept a single value others accept multiple values as annotated in the comments.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># Some variables are boolean with a value of true or false.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">#</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># Read the Arch Linux wiki pages to learn more about the variables values.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># https://github.com/picodotdev/alis/blob/master/README.md</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># init</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## KEYS sets keyboard layout.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## LOG generates a log file with the commands executed and output generated during installation.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">### The log file is saved to /var/log/alis.log.</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">KEYS</span><span class="o">=</span><span class="s2">&#34;es&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">LOG</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># partition</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## DEVICE sets which is the device for the installation.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## DEVICE_TRIM sets if the DEVICE device supports TRIM feature.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## LVM sets if the DEVICE is partitioned with LVM partition scheme.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## LUKS_PASSWORD and LUKS_PASSWORD_RETYPE if set is the password for encrypt the device. With LVM, LVM on LUKS is used. If &#34;ask&#34; password alis asks for a secure password.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## FILE_SYSTEM_TYPE root device is formatted with this file system type.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## SWAP_SIZE swap file size with a size of the value in megabytes. If no value no swap file is created.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## PARTITION_MODE how partition is performed on DEVICE.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">### &#34;auto&#34; value deletes all existing partitions and creates a boot partition and a root partition using disk full size.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">### Warning! all disk data will be lost, so backup existing data before.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">### &#34;custom&#34; value allows to use a custom parted partition script.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">### &#34;manual&#34; allows to specify which existing partitions are used for boot partition and root partition.</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">DEVICE</span><span class="o">=</span><span class="s2">&#34;/dev/sda !/dev/nvme0n1 !/dev/mmcblk0&#34;</span> <span class="c1"># sata nvme mmc (single)</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">DEVICE_TRIM</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">LVM</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">LUKS_PASSWORD</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">LUKS_PASSWORD_RETYPE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">FILE_SYSTEM_TYPE</span><span class="o">=</span><span class="s2">&#34;ext4 !btrfs !xfs !f2fs !reiserfs&#34;</span> <span class="c1"># (single)</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">SWAP_SIZE</span><span class="o">=</span><span class="s2">&#34;!2048 !4096 !8192&#34;</span> <span class="c1"># (single)</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">PARTITION_MODE</span><span class="o">=</span><span class="s2">&#34;auto !custom !manual&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">PARTITION_CUSTOM_PARTED_UEFI</span><span class="o">=</span><span class="s2">&#34;mklabel gpt mkpart ESP fat32 1MiB 512MiB mkpart root </span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2"> 512MiB 100% set 1 esp on&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">PARTITION_CUSTOM_PARTED_BIOS</span><span class="o">=</span><span class="s2">&#34;mklabel msdos mkpart primary ext4 4MiB 512MiB mkpart primary </span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2"> 512MiB 100% set 1 boot on&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">PARTITION_CUSTOMMANUAL_BOOT</span><span class="o">=</span><span class="s2">&#34;!/dev/sda1 !/dev/nvme0n1p1 !/dev/mmcblk0p1&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">PARTITION_CUSTOMMANUAL_ROOT</span><span class="o">=</span><span class="s2">&#34;!/dev/sda2 !/dev/nvme0n1p2 !/dev/mmcblk0p2&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># network_install</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## Variables to setup the WIFI connection to internet.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## The WIFI interface, WIFI ESSID identifier and WIFI password must be specified. If &#34;ask&#34; password alis asks for a secure password.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## PING_HOSTNAME is the host to check the internet connection.</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">WIFI_INTERFACE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">WIFI_ESSID</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">WIFI_KEY</span><span class="o">=</span><span class="s2">&#34;ask&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">WIFI_KEY_RETYPE</span><span class="o">=</span><span class="s2">&#34;ask&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">PING_HOSTNAME</span><span class="o">=</span><span class="s2">&#34;mirrors.kernel.org&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># install</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## REFLECTOR allows to use reflector utility to use the best mirrors for packages download.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## REFLECTOR_COUNTRIES is an array of countries to select mirrors from.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## PACMAN_MIRROR if reflector is not used this specific mirror is used.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## KERNELS additional kernels and headers to install.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## KERNELS_COMPRESSION selects de algorithm for kernel compression.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## KERNELS_PARAMETERS specific kernel parameters to set on boot. eg. iommu=soft</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">REFLECTOR</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">REFLECTOR_COUNTRIES</span><span class="o">=(</span><span class="s2">&#34;Spain&#34;</span><span class="o">)</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">PACMAN_MIRROR</span><span class="o">=</span><span class="s2">&#34;https://mirrors.kernel.org/archlinux/\$repo/os/\$arch&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">KERNELS</span><span class="o">=</span><span class="s2">&#34;!linux-lts !linux-lts-headers !linux-hardened !linux-hardened-headers !linux-zen !linux-zen-headers&#34;</span> <span class="c1"># (multiple)</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">KERNELS_COMPRESSION</span><span class="o">=</span><span class="s2">&#34;!gzip !bzip2 !lzma !xz !lzop !lz4 zstd&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">KERNELS_PARAMETERS</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># display driver</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## DISPLAY_DRIVER installs a specific display driver, you must know which brand is the graphics hardware.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## Other variables activates some features if are supported for the DISPLAY_DRIVER.</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">DISPLAY_DRIVER</span><span class="o">=</span><span class="s2">&#34;!intel !amdgpu !ati !nvidia !nvidia-lts !nvidia-dkms !nvidia-390xx !nvidia-390xx-lts !nvidia-390xx-dkms !nouveau&#34;</span> <span class="c1"># (single)</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">KMS</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">FASTBOOT</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">FRAMEBUFFER_COMPRESSION</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">DISPLAY_DRIVER_DDX</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">VULKAN</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">DISPLAY_DRIVER_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">DISPLAY_DRIVER_HARDWARE_ACCELERATION_INTEL</span><span class="o">=</span><span class="s2">&#34;intel-media-driver !libva-intel-driver&#34;</span> <span class="c1"># (single)</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># config</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## Some variables for system configuration, from timezone, locale and keyboard to the root password.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## ROOT_PASSWORD root user password. If &#34;ask&#34; password alis asks for a secure password.</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">TIMEZONE</span><span class="o">=</span><span class="s2">&#34;/usr/share/zoneinfo/Europe/Madrid&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">LOCALES</span><span class="o">=(</span><span class="s2">&#34;es_ES.UTF-8 UTF-8&#34;</span> <span class="s2">&#34;en_US.UTF-8 UTF-8&#34;</span><span class="o">)</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">LOCALE_CONF</span><span class="o">=(</span><span class="s2">&#34;LANG=es_ES.UTF-8&#34;</span> <span class="s2">&#34;LANGUAGE=es_ES:es:en_US:en&#34;</span><span class="o">)</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">KEYMAP</span><span class="o">=</span><span class="s2">&#34;KEYMAP=es&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">KEYLAYOUT</span><span class="o">=</span><span class="s2">&#34;es&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">KEYMODEL</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">KEYVARIANT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">KEYOPTIONS</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">FONT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">FONT_MAP</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">HOSTNAME</span><span class="o">=</span><span class="s2">&#34;archlinux&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">ROOT_PASSWORD</span><span class="o">=</span><span class="s2">&#34;ask&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">ROOT_PASSWORD_RETYPE</span><span class="o">=</span><span class="s2">&#34;ask&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># user</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## USER_NAME, USER_PASSWORD Regular user to create in the system. A password must be specified, if &#34;ask&#34; password alis asks for a secure password.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## ADDITIONAL_USERS is an array of additional users to create in the system, if &#34;ask&#34; password alis asks for a secure password.</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">USER_NAME</span><span class="o">=</span><span class="s2">&#34;picodotdev&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">USER_PASSWORD</span><span class="o">=</span><span class="s2">&#34;ask&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">USER_PASSWORD_RETYPE</span><span class="o">=</span><span class="s2">&#34;ask&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">ADDITIONAL_USERS</span><span class="o">=()</span> <span class="c1"># eg. (&#34;user1=password1&#34; &#34;user2=password2&#34;)</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1">## systemd-homed (experimental feature)</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">### SYSTEMD_HOMED &#34;true&#34; value requires interactivity to set user password</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">SYSTEMD_HOMED</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">SYSTEMD_HOMED_STORAGE</span><span class="o">=</span><span class="s2">&#34;directory !fscrypt !luks !cifs !subvolume&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">SYSTEMD_HOMED_CIFS_DOMAIN</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">SYSTEMD_HOMED_CIFS_SERVICE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># mkinitcpio</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## HOOKS are the system hooks to execute to build the initial ramdisk.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">### Generally, it is not necessary to modify, alis enables or disables some hooks</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">### taking in account other variables values like bootloader or device encryption.</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">HOOKS</span><span class="o">=</span><span class="s2">&#34;base !udev !usr !resume !systemd !btrfs keyboard autodetect modconf block !net !dmraid !mdadm !mdadm_udev !keymap !consolefont !sd-vconsole !encrypt !lvm2 !sd-encrypt !sd-lvm2 fsck filesystems&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># bootloader</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## BOOTLOADER system boot loader.</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">BOOTLOADER</span><span class="o">=</span><span class="s2">&#34;!grub !refind systemd&#34;</span> <span class="c1"># (single)</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># shell</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## CUSTOM_SHELL configures an alternative custom shell interpreter.</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">CUSTOM_SHELL</span><span class="o">=</span><span class="s2">&#34;bash !zsh !dash !fish&#34;</span> <span class="c1"># (single)</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># desktop</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## DESKTOP_ENVIRONMENT installs a desktop environment.</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">DESKTOP_ENVIRONMENT</span><span class="o">=</span><span class="s2">&#34;!gnome !kde !xfce !mate !cinnamon !lxde !i3-wm !i3-gaps&#34;</span> <span class="c1"># (single)</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># packages (all multiple)</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## PACKAGES_MULTILIB configures multilib repository for pacman and install multilib packages for display driver</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## PACKAGES_INSTALL installs packages on system installation, edit alis-packages.conf to select packages.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">### It is recommended to install packages after base installation and reboot.</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">PACKAGES_MULTILIB</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">PACKAGES_INSTALL</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># misc</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## VAGRANT for build a VirtualBox OVA with Packer</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">VAGRANT</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># systemd</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## SYSTEMD_UNITS systemd units to enable or disable.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">### If preceded with a &#34;+&#34; unit is enabled, if preceded with &#34;-&#34; unit is disabled, if preceded with &#34;!&#34; unit is ignored (no action is performed).</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">### eg. &#34;+ufw.service&#34; to enable, &#34;-ufw.service&#34; to disable, &#34;!ufw.service&#34; to ignore</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">SYSTEMD_UNITS</span><span class="o">=</span><span class="s2">&#34;!ufw.service !docker.service&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># reboot</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">## REBOOT on installation end reboots the system automatically. If &#34;false&#34; no reboot is performed and the user must do it explicitly.</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">REBOOT</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>alis.conf</span>
    </div>
</div>
<p>### Capturas de diferentes entornos de escritorio soportados</p>
<p>Estas son algunas capturas de pantalla con diferentes entornos de escritorio que he probado con VirtualBox.</p>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/images/archlinux-gnome_hu9b320e0da9c3f7b53e055de7bd0dea05_59051_2560x1440_fit_q90_box.jpg" data-gallery="" title="GNOME"><img src="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/images/archlinux-gnome_hu9b320e0da9c3f7b53e055de7bd0dea05_59051_300x200_fit_q90_box.jpg" width="267" height="200" alt="GNOME" title="GNOME"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/images/archlinux-kde_huc1033173311b1fe983324c1eed546025_77308_2560x1440_fit_q90_box.jpg" data-gallery="" title="KDE"><img src="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/images/archlinux-kde_huc1033173311b1fe983324c1eed546025_77308_300x200_fit_q90_box.jpg" width="267" height="200" alt="KDE" title="KDE"  class="lozad "></a></p>
<figcaption>Entornos de escritorio GNOME y KDE</figcaption>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/images/archlinux-xfce_hu207a5cc7835aaa368efdd5626136b4e2_50488_2560x1440_fit_q90_box.jpg" data-gallery="" title="XFCE"><img src="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/images/archlinux-xfce_hu207a5cc7835aaa368efdd5626136b4e2_50488_300x200_fit_q90_box.jpg" width="267" height="200" alt="XFCE" title="XFCE"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/images/archlinux-cinnamon_huada952b2201e9040ea05142b38c6dec4_57971_2560x1440_fit_q90_box.jpg" data-gallery="" title="Cinnamon"><img src="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/images/archlinux-cinnamon_huada952b2201e9040ea05142b38c6dec4_57971_300x200_fit_q90_box.jpg" width="267" height="200" alt="Cinnamon" title="Cinnamon"  class="lozad "></a></p>
<figcaption>Entornos de escritorio Xfce y Cinnamon</figcaption>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/images/archlinux-lxde_huafe9060d5dbd54d661872c90b35b3c3e_60009_2560x1440_fit_q90_box.jpg" data-gallery="" title="LXDE"><img src="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/images/archlinux-lxde_huafe9060d5dbd54d661872c90b35b3c3e_60009_300x200_fit_q90_box.jpg" width="267" height="200" alt="LXDE" title="LXDE"  class="lozad "></a>
<a href="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/images/archlinux-mate_huc99153c03fd4a5e1c154432239083495_26705_2560x1440_fit_q90_box.jpg" data-gallery="" title="Mate"><img src="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/images/archlinux-mate_huc99153c03fd4a5e1c154432239083495_26705_300x200_fit_q90_box.jpg" width="267" height="200" alt="Mate" title="Mate"  class="lozad "></a></p>
<figcaption>Entornos de escritorio LXDE y Mate</figcaption>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/images/archlinux-root-password_hubb5350839af640196e4dc7ade488175e_3831_2560x1440_fit_box_3.png" data-gallery="" title="Solicitud de contraseña para descifrar partición root"><img src="https://picodotdev.github.io/blog-bitix/2017/01/script-para-instalar-arch-linux-de-forma-facil-rapido-desatendido-automatizado-y-personalizable/images/archlinux-root-password_hubb5350839af640196e4dc7ade488175e_3831_300x200_fit_box_3.png" width="267" height="200" alt="Solicitud de contraseña para descifrar partición root" title="Solicitud de contraseña para descifrar partición root"  class="lozad "></a></p>
<figcaption>Solicitud de contraseña para descifrar partición root</figcaption>
</figure>
</div>
<h3 id="vídeo-de-instalación-del-sistema-base-con-alis">Vídeo de instalación del sistema base con alis</h3>
<p>El siguiente vídeo capturado con <a href="https://asciinema.org/">asciinema</a> muestra como utilizando alis se instala Arch Linux en una computadora con el proceso completo de la instalación base del sistema.</p>
<div class="media">
<a href="https://asciinema.org/a/418524" target="_blank"><amp-img src="https://asciinema.org/a/418524.png" width="650" height="563" class="lozad"></amp-img></a>
</div>
<h3 id="código-fuente-de-alis">Código fuente de alis</h3>
<p>El código del instalador no es muy complicado y mucho más sencillo que otros <em>scripts</em> interactivos similares, al no mezclar los comandos de la instalación con los mensajes interactivos que hacen preguntas y esperan respuestas, además después de configurar las variables e iniciado el proceso de instalación la misma se realiza de forma desatendida hasta completarse sin requerir que el usuario introduzca más datos de forma interactiva.</p>
<p>Los comandos que he recopilado de la receta son los que ejecutaríamos uno detrás de otro partiendo el medio de instalación original de Arch Linux. La función <em>main</em> contiene los pasos en los que consiste la instalación, desde el particionado y cifrado del disco hasta el reinicio una vez completada la instalación, el resto de las funciones los comandos de ese paso de la instalación.</p>
<div class="code">
    <div class="highlight"><div class="chroma">&#10;<table class="lntable"><tr><td class="lntd">&#10;<pre tabindex="0" class="chroma"><code><span class="lnt">   1&#10;</span><span class="lnt">   2&#10;</span><span class="lnt">   3&#10;</span><span class="lnt">   4&#10;</span><span class="lnt">   5&#10;</span><span class="lnt">   6&#10;</span><span class="lnt">   7&#10;</span><span class="lnt">   8&#10;</span><span class="lnt">   9&#10;</span><span class="lnt">  10&#10;</span><span class="lnt">  11&#10;</span><span class="lnt">  12&#10;</span><span class="lnt">  13&#10;</span><span class="lnt">  14&#10;</span><span class="lnt">  15&#10;</span><span class="lnt">  16&#10;</span><span class="lnt">  17&#10;</span><span class="lnt">  18&#10;</span><span class="lnt">  19&#10;</span><span class="lnt">  20&#10;</span><span class="lnt">  21&#10;</span><span class="lnt">  22&#10;</span><span class="lnt">  23&#10;</span><span class="lnt">  24&#10;</span><span class="lnt">  25&#10;</span><span class="lnt">  26&#10;</span><span class="lnt">  27&#10;</span><span class="lnt">  28&#10;</span><span class="lnt">  29&#10;</span><span class="lnt">  30&#10;</span><span class="lnt">  31&#10;</span><span class="lnt">  32&#10;</span><span class="lnt">  33&#10;</span><span class="lnt">  34&#10;</span><span class="lnt">  35&#10;</span><span class="lnt">  36&#10;</span><span class="lnt">  37&#10;</span><span class="lnt">  38&#10;</span><span class="lnt">  39&#10;</span><span class="lnt">  40&#10;</span><span class="lnt">  41&#10;</span><span class="lnt">  42&#10;</span><span class="lnt">  43&#10;</span><span class="lnt">  44&#10;</span><span class="lnt">  45&#10;</span><span class="lnt">  46&#10;</span><span class="lnt">  47&#10;</span><span class="lnt">  48&#10;</span><span class="lnt">  49&#10;</span><span class="lnt">  50&#10;</span><span class="lnt">  51&#10;</span><span class="lnt">  52&#10;</span><span class="lnt">  53&#10;</span><span class="lnt">  54&#10;</span><span class="lnt">  55&#10;</span><span class="lnt">  56&#10;</span><span class="lnt">  57&#10;</span><span class="lnt">  58&#10;</span><span class="lnt">  59&#10;</span><span class="lnt">  60&#10;</span><span class="lnt">  61&#10;</span><span class="lnt">  62&#10;</span><span class="lnt">  63&#10;</span><span class="lnt">  64&#10;</span><span class="lnt">  65&#10;</span><span class="lnt">  66&#10;</span><span class="lnt">  67&#10;</span><span class="lnt">  68&#10;</span><span class="lnt">  69&#10;</span><span class="lnt">  70&#10;</span><span class="lnt">  71&#10;</span><span class="lnt">  72&#10;</span><span class="lnt">  73&#10;</span><span class="lnt">  74&#10;</span><span class="lnt">  75&#10;</span><span class="lnt">  76&#10;</span><span class="lnt">  77&#10;</span><span class="lnt">  78&#10;</span><span class="lnt">  79&#10;</span><span class="lnt">  80&#10;</span><span class="lnt">  81&#10;</span><span class="lnt">  82&#10;</span><span class="lnt">  83&#10;</span><span class="lnt">  84&#10;</span><span class="lnt">  85&#10;</span><span class="lnt">  86&#10;</span><span class="lnt">  87&#10;</span><span class="lnt">  88&#10;</span><span class="lnt">  89&#10;</span><span class="lnt">  90&#10;</span><span class="lnt">  91&#10;</span><span class="lnt">  92&#10;</span><span class="lnt">  93&#10;</span><span class="lnt">  94&#10;</span><span class="lnt">  95&#10;</span><span class="lnt">  96&#10;</span><span class="lnt">  97&#10;</span><span class="lnt">  98&#10;</span><span class="lnt">  99&#10;</span><span class="lnt"> 100&#10;</span><span class="lnt"> 101&#10;</span><span class="lnt"> 102&#10;</span><span class="lnt"> 103&#10;</span><span class="lnt"> 104&#10;</span><span class="lnt"> 105&#10;</span><span class="lnt"> 106&#10;</span><span class="lnt"> 107&#10;</span><span class="lnt"> 108&#10;</span><span class="lnt"> 109&#10;</span><span class="lnt"> 110&#10;</span><span class="lnt"> 111&#10;</span><span class="lnt"> 112&#10;</span><span class="lnt"> 113&#10;</span><span class="lnt"> 114&#10;</span><span class="lnt"> 115&#10;</span><span class="lnt"> 116&#10;</span><span class="lnt"> 117&#10;</span><span class="lnt"> 118&#10;</span><span class="lnt"> 119&#10;</span><span class="lnt"> 120&#10;</span><span class="lnt"> 121&#10;</span><span class="lnt"> 122&#10;</span><span class="lnt"> 123&#10;</span><span class="lnt"> 124&#10;</span><span class="lnt"> 125&#10;</span><span class="lnt"> 126&#10;</span><span class="lnt"> 127&#10;</span><span class="lnt"> 128&#10;</span><span class="lnt"> 129&#10;</span><span class="lnt"> 130&#10;</span><span class="lnt"> 131&#10;</span><span class="lnt"> 132&#10;</span><span class="lnt"> 133&#10;</span><span class="lnt"> 134&#10;</span><span class="lnt"> 135&#10;</span><span class="lnt"> 136&#10;</span><span class="lnt"> 137&#10;</span><span class="lnt"> 138&#10;</span><span class="lnt"> 139&#10;</span><span class="lnt"> 140&#10;</span><span class="lnt"> 141&#10;</span><span class="lnt"> 142&#10;</span><span class="lnt"> 143&#10;</span><span class="lnt"> 144&#10;</span><span class="lnt"> 145&#10;</span><span class="lnt"> 146&#10;</span><span class="lnt"> 147&#10;</span><span class="lnt"> 148&#10;</span><span class="lnt"> 149&#10;</span><span class="lnt"> 150&#10;</span><span class="lnt"> 151&#10;</span><span class="lnt"> 152&#10;</span><span class="lnt"> 153&#10;</span><span class="lnt"> 154&#10;</span><span class="lnt"> 155&#10;</span><span class="lnt"> 156&#10;</span><span class="lnt"> 157&#10;</span><span class="lnt"> 158&#10;</span><span class="lnt"> 159&#10;</span><span class="lnt"> 160&#10;</span><span class="lnt"> 161&#10;</span><span class="lnt"> 162&#10;</span><span class="lnt"> 163&#10;</span><span class="lnt"> 164&#10;</span><span class="lnt"> 165&#10;</span><span class="lnt"> 166&#10;</span><span class="lnt"> 167&#10;</span><span class="lnt"> 168&#10;</span><span class="lnt"> 169&#10;</span><span class="lnt"> 170&#10;</span><span class="lnt"> 171&#10;</span><span class="lnt"> 172&#10;</span><span class="lnt"> 173&#10;</span><span class="lnt"> 174&#10;</span><span class="lnt"> 175&#10;</span><span class="lnt"> 176&#10;</span><span class="lnt"> 177&#10;</span><span class="lnt"> 178&#10;</span><span class="lnt"> 179&#10;</span><span class="lnt"> 180&#10;</span><span class="lnt"> 181&#10;</span><span class="lnt"> 182&#10;</span><span class="lnt"> 183&#10;</span><span class="lnt"> 184&#10;</span><span class="lnt"> 185&#10;</span><span class="lnt"> 186&#10;</span><span class="lnt"> 187&#10;</span><span class="lnt"> 188&#10;</span><span class="lnt"> 189&#10;</span><span class="lnt"> 190&#10;</span><span class="lnt"> 191&#10;</span><span class="lnt"> 192&#10;</span><span class="lnt"> 193&#10;</span><span class="lnt"> 194&#10;</span><span class="lnt"> 195&#10;</span><span class="lnt"> 196&#10;</span><span class="lnt"> 197&#10;</span><span class="lnt"> 198&#10;</span><span class="lnt"> 199&#10;</span><span class="lnt"> 200&#10;</span><span class="lnt"> 201&#10;</span><span class="lnt"> 202&#10;</span><span class="lnt"> 203&#10;</span><span class="lnt"> 204&#10;</span><span class="lnt"> 205&#10;</span><span class="lnt"> 206&#10;</span><span class="lnt"> 207&#10;</span><span class="lnt"> 208&#10;</span><span class="lnt"> 209&#10;</span><span class="lnt"> 210&#10;</span><span class="lnt"> 211&#10;</span><span class="lnt"> 212&#10;</span><span class="lnt"> 213&#10;</span><span class="lnt"> 214&#10;</span><span class="lnt"> 215&#10;</span><span class="lnt"> 216&#10;</span><span class="lnt"> 217&#10;</span><span class="lnt"> 218&#10;</span><span class="lnt"> 219&#10;</span><span class="lnt"> 220&#10;</span><span class="lnt"> 221&#10;</span><span class="lnt"> 222&#10;</span><span class="lnt"> 223&#10;</span><span class="lnt"> 224&#10;</span><span class="lnt"> 225&#10;</span><span class="lnt"> 226&#10;</span><span class="lnt"> 227&#10;</span><span class="lnt"> 228&#10;</span><span class="lnt"> 229&#10;</span><span class="lnt"> 230&#10;</span><span class="lnt"> 231&#10;</span><span class="lnt"> 232&#10;</span><span class="lnt"> 233&#10;</span><span class="lnt"> 234&#10;</span><span class="lnt"> 235&#10;</span><span class="lnt"> 236&#10;</span><span class="lnt"> 237&#10;</span><span class="lnt"> 238&#10;</span><span class="lnt"> 239&#10;</span><span class="lnt"> 240&#10;</span><span class="lnt"> 241&#10;</span><span class="lnt"> 242&#10;</span><span class="lnt"> 243&#10;</span><span class="lnt"> 244&#10;</span><span class="lnt"> 245&#10;</span><span class="lnt"> 246&#10;</span><span class="lnt"> 247&#10;</span><span class="lnt"> 248&#10;</span><span class="lnt"> 249&#10;</span><span class="lnt"> 250&#10;</span><span class="lnt"> 251&#10;</span><span class="lnt"> 252&#10;</span><span class="lnt"> 253&#10;</span><span class="lnt"> 254&#10;</span><span class="lnt"> 255&#10;</span><span class="lnt"> 256&#10;</span><span class="lnt"> 257&#10;</span><span class="lnt"> 258&#10;</span><span class="lnt"> 259&#10;</span><span class="lnt"> 260&#10;</span><span class="lnt"> 261&#10;</span><span class="lnt"> 262&#10;</span><span class="lnt"> 263&#10;</span><span class="lnt"> 264&#10;</span><span class="lnt"> 265&#10;</span><span class="lnt"> 266&#10;</span><span class="lnt"> 267&#10;</span><span class="lnt"> 268&#10;</span><span class="lnt"> 269&#10;</span><span class="lnt"> 270&#10;</span><span class="lnt"> 271&#10;</span><span class="lnt"> 272&#10;</span><span class="lnt"> 273&#10;</span><span class="lnt"> 274&#10;</span><span class="lnt"> 275&#10;</span><span class="lnt"> 276&#10;</span><span class="lnt"> 277&#10;</span><span class="lnt"> 278&#10;</span><span class="lnt"> 279&#10;</span><span class="lnt"> 280&#10;</span><span class="lnt"> 281&#10;</span><span class="lnt"> 282&#10;</span><span class="lnt"> 283&#10;</span><span class="lnt"> 284&#10;</span><span class="lnt"> 285&#10;</span><span class="lnt"> 286&#10;</span><span class="lnt"> 287&#10;</span><span class="lnt"> 288&#10;</span><span class="lnt"> 289&#10;</span><span class="lnt"> 290&#10;</span><span class="lnt"> 291&#10;</span><span class="lnt"> 292&#10;</span><span class="lnt"> 293&#10;</span><span class="lnt"> 294&#10;</span><span class="lnt"> 295&#10;</span><span class="lnt"> 296&#10;</span><span class="lnt"> 297&#10;</span><span class="lnt"> 298&#10;</span><span class="lnt"> 299&#10;</span><span class="lnt"> 300&#10;</span><span class="lnt"> 301&#10;</span><span class="lnt"> 302&#10;</span><span class="lnt"> 303&#10;</span><span class="lnt"> 304&#10;</span><span class="lnt"> 305&#10;</span><span class="lnt"> 306&#10;</span><span class="lnt"> 307&#10;</span><span class="lnt"> 308&#10;</span><span class="lnt"> 309&#10;</span><span class="lnt"> 310&#10;</span><span class="lnt"> 311&#10;</span><span class="lnt"> 312&#10;</span><span class="lnt"> 313&#10;</span><span class="lnt"> 314&#10;</span><span class="lnt"> 315&#10;</span><span class="lnt"> 316&#10;</span><span class="lnt"> 317&#10;</span><span class="lnt"> 318&#10;</span><span class="lnt"> 319&#10;</span><span class="lnt"> 320&#10;</span><span class="lnt"> 321&#10;</span><span class="lnt"> 322&#10;</span><span class="lnt"> 323&#10;</span><span class="lnt"> 324&#10;</span><span class="lnt"> 325&#10;</span><span class="lnt"> 326&#10;</span><span class="lnt"> 327&#10;</span><span class="lnt"> 328&#10;</span><span class="lnt"> 329&#10;</span><span class="lnt"> 330&#10;</span><span class="lnt"> 331&#10;</span><span class="lnt"> 332&#10;</span><span class="lnt"> 333&#10;</span><span class="lnt"> 334&#10;</span><span class="lnt"> 335&#10;</span><span class="lnt"> 336&#10;</span><span class="lnt"> 337&#10;</span><span class="lnt"> 338&#10;</span><span class="lnt"> 339&#10;</span><span class="lnt"> 340&#10;</span><span class="lnt"> 341&#10;</span><span class="lnt"> 342&#10;</span><span class="lnt"> 343&#10;</span><span class="lnt"> 344&#10;</span><span class="lnt"> 345&#10;</span><span class="lnt"> 346&#10;</span><span class="lnt"> 347&#10;</span><span class="lnt"> 348&#10;</span><span class="lnt"> 349&#10;</span><span class="lnt"> 350&#10;</span><span class="lnt"> 351&#10;</span><span class="lnt"> 352&#10;</span><span class="lnt"> 353&#10;</span><span class="lnt"> 354&#10;</span><span class="lnt"> 355&#10;</span><span class="lnt"> 356&#10;</span><span class="lnt"> 357&#10;</span><span class="lnt"> 358&#10;</span><span class="lnt"> 359&#10;</span><span class="lnt"> 360&#10;</span><span class="lnt"> 361&#10;</span><span class="lnt"> 362&#10;</span><span class="lnt"> 363&#10;</span><span class="lnt"> 364&#10;</span><span class="lnt"> 365&#10;</span><span class="lnt"> 366&#10;</span><span class="lnt"> 367&#10;</span><span class="lnt"> 368&#10;</span><span class="lnt"> 369&#10;</span><span class="lnt"> 370&#10;</span><span class="lnt"> 371&#10;</span><span class="lnt"> 372&#10;</span><span class="lnt"> 373&#10;</span><span class="lnt"> 374&#10;</span><span class="lnt"> 375&#10;</span><span class="lnt"> 376&#10;</span><span class="lnt"> 377&#10;</span><span class="lnt"> 378&#10;</span><span class="lnt"> 379&#10;</span><span class="lnt"> 380&#10;</span><span class="lnt"> 381&#10;</span><span class="lnt"> 382&#10;</span><span class="lnt"> 383&#10;</span><span class="lnt"> 384&#10;</span><span class="lnt"> 385&#10;</span><span class="lnt"> 386&#10;</span><span class="lnt"> 387&#10;</span><span class="lnt"> 388&#10;</span><span class="lnt"> 389&#10;</span><span class="lnt"> 390&#10;</span><span class="lnt"> 391&#10;</span><span class="lnt"> 392&#10;</span><span class="lnt"> 393&#10;</span><span class="lnt"> 394&#10;</span><span class="lnt"> 395&#10;</span><span class="lnt"> 396&#10;</span><span class="lnt"> 397&#10;</span><span class="lnt"> 398&#10;</span><span class="lnt"> 399&#10;</span><span class="lnt"> 400&#10;</span><span class="lnt"> 401&#10;</span><span class="lnt"> 402&#10;</span><span class="lnt"> 403&#10;</span><span class="lnt"> 404&#10;</span><span class="lnt"> 405&#10;</span><span class="lnt"> 406&#10;</span><span class="lnt"> 407&#10;</span><span class="lnt"> 408&#10;</span><span class="lnt"> 409&#10;</span><span class="lnt"> 410&#10;</span><span class="lnt"> 411&#10;</span><span class="lnt"> 412&#10;</span><span class="lnt"> 413&#10;</span><span class="lnt"> 414&#10;</span><span class="lnt"> 415&#10;</span><span class="lnt"> 416&#10;</span><span class="lnt"> 417&#10;</span><span class="lnt"> 418&#10;</span><span class="lnt"> 419&#10;</span><span class="lnt"> 420&#10;</span><span class="lnt"> 421&#10;</span><span class="lnt"> 422&#10;</span><span class="lnt"> 423&#10;</span><span class="lnt"> 424&#10;</span><span class="lnt"> 425&#10;</span><span class="lnt"> 426&#10;</span><span class="lnt"> 427&#10;</span><span class="lnt"> 428&#10;</span><span class="lnt"> 429&#10;</span><span class="lnt"> 430&#10;</span><span class="lnt"> 431&#10;</span><span class="lnt"> 432&#10;</span><span class="lnt"> 433&#10;</span><span class="lnt"> 434&#10;</span><span class="lnt"> 435&#10;</span><span class="lnt"> 436&#10;</span><span class="lnt"> 437&#10;</span><span class="lnt"> 438&#10;</span><span class="lnt"> 439&#10;</span><span class="lnt"> 440&#10;</span><span class="lnt"> 441&#10;</span><span class="lnt"> 442&#10;</span><span class="lnt"> 443&#10;</span><span class="lnt"> 444&#10;</span><span class="lnt"> 445&#10;</span><span class="lnt"> 446&#10;</span><span class="lnt"> 447&#10;</span><span class="lnt"> 448&#10;</span><span class="lnt"> 449&#10;</span><span class="lnt"> 450&#10;</span><span class="lnt"> 451&#10;</span><span class="lnt"> 452&#10;</span><span class="lnt"> 453&#10;</span><span class="lnt"> 454&#10;</span><span class="lnt"> 455&#10;</span><span class="lnt"> 456&#10;</span><span class="lnt"> 457&#10;</span><span class="lnt"> 458&#10;</span><span class="lnt"> 459&#10;</span><span class="lnt"> 460&#10;</span><span class="lnt"> 461&#10;</span><span class="lnt"> 462&#10;</span><span class="lnt"> 463&#10;</span><span class="lnt"> 464&#10;</span><span class="lnt"> 465&#10;</span><span class="lnt"> 466&#10;</span><span class="lnt"> 467&#10;</span><span class="lnt"> 468&#10;</span><span class="lnt"> 469&#10;</span><span class="lnt"> 470&#10;</span><span class="lnt"> 471&#10;</span><span class="lnt"> 472&#10;</span><span class="lnt"> 473&#10;</span><span class="lnt"> 474&#10;</span><span class="lnt"> 475&#10;</span><span class="lnt"> 476&#10;</span><span class="lnt"> 477&#10;</span><span class="lnt"> 478&#10;</span><span class="lnt"> 479&#10;</span><span class="lnt"> 480&#10;</span><span class="lnt"> 481&#10;</span><span class="lnt"> 482&#10;</span><span class="lnt"> 483&#10;</span><span class="lnt"> 484&#10;</span><span class="lnt"> 485&#10;</span><span class="lnt"> 486&#10;</span><span class="lnt"> 487&#10;</span><span class="lnt"> 488&#10;</span><span class="lnt"> 489&#10;</span><span class="lnt"> 490&#10;</span><span class="lnt"> 491&#10;</span><span class="lnt"> 492&#10;</span><span class="lnt"> 493&#10;</span><span class="lnt"> 494&#10;</span><span class="lnt"> 495&#10;</span><span class="lnt"> 496&#10;</span><span class="lnt"> 497&#10;</span><span class="lnt"> 498&#10;</span><span class="lnt"> 499&#10;</span><span class="lnt"> 500&#10;</span><span class="lnt"> 501&#10;</span><span class="lnt"> 502&#10;</span><span class="lnt"> 503&#10;</span><span class="lnt"> 504&#10;</span><span class="lnt"> 505&#10;</span><span class="lnt"> 506&#10;</span><span class="lnt"> 507&#10;</span><span class="lnt"> 508&#10;</span><span class="lnt"> 509&#10;</span><span class="lnt"> 510&#10;</span><span class="lnt"> 511&#10;</span><span class="lnt"> 512&#10;</span><span class="lnt"> 513&#10;</span><span class="lnt"> 514&#10;</span><span class="lnt"> 515&#10;</span><span class="lnt"> 516&#10;</span><span class="lnt"> 517&#10;</span><span class="lnt"> 518&#10;</span><span class="lnt"> 519&#10;</span><span class="lnt"> 520&#10;</span><span class="lnt"> 521&#10;</span><span class="lnt"> 522&#10;</span><span class="lnt"> 523&#10;</span><span class="lnt"> 524&#10;</span><span class="lnt"> 525&#10;</span><span class="lnt"> 526&#10;</span><span class="lnt"> 527&#10;</span><span class="lnt"> 528&#10;</span><span class="lnt"> 529&#10;</span><span class="lnt"> 530&#10;</span><span class="lnt"> 531&#10;</span><span class="lnt"> 532&#10;</span><span class="lnt"> 533&#10;</span><span class="lnt"> 534&#10;</span><span class="lnt"> 535&#10;</span><span class="lnt"> 536&#10;</span><span class="lnt"> 537&#10;</span><span class="lnt"> 538&#10;</span><span class="lnt"> 539&#10;</span><span class="lnt"> 540&#10;</span><span class="lnt"> 541&#10;</span><span class="lnt"> 542&#10;</span><span class="lnt"> 543&#10;</span><span class="lnt"> 544&#10;</span><span class="lnt"> 545&#10;</span><span class="lnt"> 546&#10;</span><span class="lnt"> 547&#10;</span><span class="lnt"> 548&#10;</span><span class="lnt"> 549&#10;</span><span class="lnt"> 550&#10;</span><span class="lnt"> 551&#10;</span><span class="lnt"> 552&#10;</span><span class="lnt"> 553&#10;</span><span class="lnt"> 554&#10;</span><span class="lnt"> 555&#10;</span><span class="lnt"> 556&#10;</span><span class="lnt"> 557&#10;</span><span class="lnt"> 558&#10;</span><span class="lnt"> 559&#10;</span><span class="lnt"> 560&#10;</span><span class="lnt"> 561&#10;</span><span class="lnt"> 562&#10;</span><span class="lnt"> 563&#10;</span><span class="lnt"> 564&#10;</span><span class="lnt"> 565&#10;</span><span class="lnt"> 566&#10;</span><span class="lnt"> 567&#10;</span><span class="lnt"> 568&#10;</span><span class="lnt"> 569&#10;</span><span class="lnt"> 570&#10;</span><span class="lnt"> 571&#10;</span><span class="lnt"> 572&#10;</span><span class="lnt"> 573&#10;</span><span class="lnt"> 574&#10;</span><span class="lnt"> 575&#10;</span><span class="lnt"> 576&#10;</span><span class="lnt"> 577&#10;</span><span class="lnt"> 578&#10;</span><span class="lnt"> 579&#10;</span><span class="lnt"> 580&#10;</span><span class="lnt"> 581&#10;</span><span class="lnt"> 582&#10;</span><span class="lnt"> 583&#10;</span><span class="lnt"> 584&#10;</span><span class="lnt"> 585&#10;</span><span class="lnt"> 586&#10;</span><span class="lnt"> 587&#10;</span><span class="lnt"> 588&#10;</span><span class="lnt"> 589&#10;</span><span class="lnt"> 590&#10;</span><span class="lnt"> 591&#10;</span><span class="lnt"> 592&#10;</span><span class="lnt"> 593&#10;</span><span class="lnt"> 594&#10;</span><span class="lnt"> 595&#10;</span><span class="lnt"> 596&#10;</span><span class="lnt"> 597&#10;</span><span class="lnt"> 598&#10;</span><span class="lnt"> 599&#10;</span><span class="lnt"> 600&#10;</span><span class="lnt"> 601&#10;</span><span class="lnt"> 602&#10;</span><span class="lnt"> 603&#10;</span><span class="lnt"> 604&#10;</span><span class="lnt"> 605&#10;</span><span class="lnt"> 606&#10;</span><span class="lnt"> 607&#10;</span><span class="lnt"> 608&#10;</span><span class="lnt"> 609&#10;</span><span class="lnt"> 610&#10;</span><span class="lnt"> 611&#10;</span><span class="lnt"> 612&#10;</span><span class="lnt"> 613&#10;</span><span class="lnt"> 614&#10;</span><span class="lnt"> 615&#10;</span><span class="lnt"> 616&#10;</span><span class="lnt"> 617&#10;</span><span class="lnt"> 618&#10;</span><span class="lnt"> 619&#10;</span><span class="lnt"> 620&#10;</span><span class="lnt"> 621&#10;</span><span class="lnt"> 622&#10;</span><span class="lnt"> 623&#10;</span><span class="lnt"> 624&#10;</span><span class="lnt"> 625&#10;</span><span class="lnt"> 626&#10;</span><span class="lnt"> 627&#10;</span><span class="lnt"> 628&#10;</span><span class="lnt"> 629&#10;</span><span class="lnt"> 630&#10;</span><span class="lnt"> 631&#10;</span><span class="lnt"> 632&#10;</span><span class="lnt"> 633&#10;</span><span class="lnt"> 634&#10;</span><span class="lnt"> 635&#10;</span><span class="lnt"> 636&#10;</span><span class="lnt"> 637&#10;</span><span class="lnt"> 638&#10;</span><span class="lnt"> 639&#10;</span><span class="lnt"> 640&#10;</span><span class="lnt"> 641&#10;</span><span class="lnt"> 642&#10;</span><span class="lnt"> 643&#10;</span><span class="lnt"> 644&#10;</span><span class="lnt"> 645&#10;</span><span class="lnt"> 646&#10;</span><span class="lnt"> 647&#10;</span><span class="lnt"> 648&#10;</span><span class="lnt"> 649&#10;</span><span class="lnt"> 650&#10;</span><span class="lnt"> 651&#10;</span><span class="lnt"> 652&#10;</span><span class="lnt"> 653&#10;</span><span class="lnt"> 654&#10;</span><span class="lnt"> 655&#10;</span><span class="lnt"> 656&#10;</span><span class="lnt"> 657&#10;</span><span class="lnt"> 658&#10;</span><span class="lnt"> 659&#10;</span><span class="lnt"> 660&#10;</span><span class="lnt"> 661&#10;</span><span class="lnt"> 662&#10;</span><span class="lnt"> 663&#10;</span><span class="lnt"> 664&#10;</span><span class="lnt"> 665&#10;</span><span class="lnt"> 666&#10;</span><span class="lnt"> 667&#10;</span><span class="lnt"> 668&#10;</span><span class="lnt"> 669&#10;</span><span class="lnt"> 670&#10;</span><span class="lnt"> 671&#10;</span><span class="lnt"> 672&#10;</span><span class="lnt"> 673&#10;</span><span class="lnt"> 674&#10;</span><span class="lnt"> 675&#10;</span><span class="lnt"> 676&#10;</span><span class="lnt"> 677&#10;</span><span class="lnt"> 678&#10;</span><span class="lnt"> 679&#10;</span><span class="lnt"> 680&#10;</span><span class="lnt"> 681&#10;</span><span class="lnt"> 682&#10;</span><span class="lnt"> 683&#10;</span><span class="lnt"> 684&#10;</span><span class="lnt"> 685&#10;</span><span class="lnt"> 686&#10;</span><span class="lnt"> 687&#10;</span><span class="lnt"> 688&#10;</span><span class="lnt"> 689&#10;</span><span class="lnt"> 690&#10;</span><span class="lnt"> 691&#10;</span><span class="lnt"> 692&#10;</span><span class="lnt"> 693&#10;</span><span class="lnt"> 694&#10;</span><span class="lnt"> 695&#10;</span><span class="lnt"> 696&#10;</span><span class="lnt"> 697&#10;</span><span class="lnt"> 698&#10;</span><span class="lnt"> 699&#10;</span><span class="lnt"> 700&#10;</span><span class="lnt"> 701&#10;</span><span class="lnt"> 702&#10;</span><span class="lnt"> 703&#10;</span><span class="lnt"> 704&#10;</span><span class="lnt"> 705&#10;</span><span class="lnt"> 706&#10;</span><span class="lnt"> 707&#10;</span><span class="lnt"> 708&#10;</span><span class="lnt"> 709&#10;</span><span class="lnt"> 710&#10;</span><span class="lnt"> 711&#10;</span><span class="lnt"> 712&#10;</span><span class="lnt"> 713&#10;</span><span class="lnt"> 714&#10;</span><span class="lnt"> 715&#10;</span><span class="lnt"> 716&#10;</span><span class="lnt"> 717&#10;</span><span class="lnt"> 718&#10;</span><span class="lnt"> 719&#10;</span><span class="lnt"> 720&#10;</span><span class="lnt"> 721&#10;</span><span class="lnt"> 722&#10;</span><span class="lnt"> 723&#10;</span><span class="lnt"> 724&#10;</span><span class="lnt"> 725&#10;</span><span class="lnt"> 726&#10;</span><span class="lnt"> 727&#10;</span><span class="lnt"> 728&#10;</span><span class="lnt"> 729&#10;</span><span class="lnt"> 730&#10;</span><span class="lnt"> 731&#10;</span><span class="lnt"> 732&#10;</span><span class="lnt"> 733&#10;</span><span class="lnt"> 734&#10;</span><span class="lnt"> 735&#10;</span><span class="lnt"> 736&#10;</span><span class="lnt"> 737&#10;</span><span class="lnt"> 738&#10;</span><span class="lnt"> 739&#10;</span><span class="lnt"> 740&#10;</span><span class="lnt"> 741&#10;</span><span class="lnt"> 742&#10;</span><span class="lnt"> 743&#10;</span><span class="lnt"> 744&#10;</span><span class="lnt"> 745&#10;</span><span class="lnt"> 746&#10;</span><span class="lnt"> 747&#10;</span><span class="lnt"> 748&#10;</span><span class="lnt"> 749&#10;</span><span class="lnt"> 750&#10;</span><span class="lnt"> 751&#10;</span><span class="lnt"> 752&#10;</span><span class="lnt"> 753&#10;</span><span class="lnt"> 754&#10;</span><span class="lnt"> 755&#10;</span><span class="lnt"> 756&#10;</span><span class="lnt"> 757&#10;</span><span class="lnt"> 758&#10;</span><span class="lnt"> 759&#10;</span><span class="lnt"> 760&#10;</span><span class="lnt"> 761&#10;</span><span class="lnt"> 762&#10;</span><span class="lnt"> 763&#10;</span><span class="lnt"> 764&#10;</span><span class="lnt"> 765&#10;</span><span class="lnt"> 766&#10;</span><span class="lnt"> 767&#10;</span><span class="lnt"> 768&#10;</span><span class="lnt"> 769&#10;</span><span class="lnt"> 770&#10;</span><span class="lnt"> 771&#10;</span><span class="lnt"> 772&#10;</span><span class="lnt"> 773&#10;</span><span class="lnt"> 774&#10;</span><span class="lnt"> 775&#10;</span><span class="lnt"> 776&#10;</span><span class="lnt"> 777&#10;</span><span class="lnt"> 778&#10;</span><span class="lnt"> 779&#10;</span><span class="lnt"> 780&#10;</span><span class="lnt"> 781&#10;</span><span class="lnt"> 782&#10;</span><span class="lnt"> 783&#10;</span><span class="lnt"> 784&#10;</span><span class="lnt"> 785&#10;</span><span class="lnt"> 786&#10;</span><span class="lnt"> 787&#10;</span><span class="lnt"> 788&#10;</span><span class="lnt"> 789&#10;</span><span class="lnt"> 790&#10;</span><span class="lnt"> 791&#10;</span><span class="lnt"> 792&#10;</span><span class="lnt"> 793&#10;</span><span class="lnt"> 794&#10;</span><span class="lnt"> 795&#10;</span><span class="lnt"> 796&#10;</span><span class="lnt"> 797&#10;</span><span class="lnt"> 798&#10;</span><span class="lnt"> 799&#10;</span><span class="lnt"> 800&#10;</span><span class="lnt"> 801&#10;</span><span class="lnt"> 802&#10;</span><span class="lnt"> 803&#10;</span><span class="lnt"> 804&#10;</span><span class="lnt"> 805&#10;</span><span class="lnt"> 806&#10;</span><span class="lnt"> 807&#10;</span><span class="lnt"> 808&#10;</span><span class="lnt"> 809&#10;</span><span class="lnt"> 810&#10;</span><span class="lnt"> 811&#10;</span><span class="lnt"> 812&#10;</span><span class="lnt"> 813&#10;</span><span class="lnt"> 814&#10;</span><span class="lnt"> 815&#10;</span><span class="lnt"> 816&#10;</span><span class="lnt"> 817&#10;</span><span class="lnt"> 818&#10;</span><span class="lnt"> 819&#10;</span><span class="lnt"> 820&#10;</span><span class="lnt"> 821&#10;</span><span class="lnt"> 822&#10;</span><span class="lnt"> 823&#10;</span><span class="lnt"> 824&#10;</span><span class="lnt"> 825&#10;</span><span class="lnt"> 826&#10;</span><span class="lnt"> 827&#10;</span><span class="lnt"> 828&#10;</span><span class="lnt"> 829&#10;</span><span class="lnt"> 830&#10;</span><span class="lnt"> 831&#10;</span><span class="lnt"> 832&#10;</span><span class="lnt"> 833&#10;</span><span class="lnt"> 834&#10;</span><span class="lnt"> 835&#10;</span><span class="lnt"> 836&#10;</span><span class="lnt"> 837&#10;</span><span class="lnt"> 838&#10;</span><span class="lnt"> 839&#10;</span><span class="lnt"> 840&#10;</span><span class="lnt"> 841&#10;</span><span class="lnt"> 842&#10;</span><span class="lnt"> 843&#10;</span><span class="lnt"> 844&#10;</span><span class="lnt"> 845&#10;</span><span class="lnt"> 846&#10;</span><span class="lnt"> 847&#10;</span><span class="lnt"> 848&#10;</span><span class="lnt"> 849&#10;</span><span class="lnt"> 850&#10;</span><span class="lnt"> 851&#10;</span><span class="lnt"> 852&#10;</span><span class="lnt"> 853&#10;</span><span class="lnt"> 854&#10;</span><span class="lnt"> 855&#10;</span><span class="lnt"> 856&#10;</span><span class="lnt"> 857&#10;</span><span class="lnt"> 858&#10;</span><span class="lnt"> 859&#10;</span><span class="lnt"> 860&#10;</span><span class="lnt"> 861&#10;</span><span class="lnt"> 862&#10;</span><span class="lnt"> 863&#10;</span><span class="lnt"> 864&#10;</span><span class="lnt"> 865&#10;</span><span class="lnt"> 866&#10;</span><span class="lnt"> 867&#10;</span><span class="lnt"> 868&#10;</span><span class="lnt"> 869&#10;</span><span class="lnt"> 870&#10;</span><span class="lnt"> 871&#10;</span><span class="lnt"> 872&#10;</span><span class="lnt"> 873&#10;</span><span class="lnt"> 874&#10;</span><span class="lnt"> 875&#10;</span><span class="lnt"> 876&#10;</span><span class="lnt"> 877&#10;</span><span class="lnt"> 878&#10;</span><span class="lnt"> 879&#10;</span><span class="lnt"> 880&#10;</span><span class="lnt"> 881&#10;</span><span class="lnt"> 882&#10;</span><span class="lnt"> 883&#10;</span><span class="lnt"> 884&#10;</span><span class="lnt"> 885&#10;</span><span class="lnt"> 886&#10;</span><span class="lnt"> 887&#10;</span><span class="lnt"> 888&#10;</span><span class="lnt"> 889&#10;</span><span class="lnt"> 890&#10;</span><span class="lnt"> 891&#10;</span><span class="lnt"> 892&#10;</span><span class="lnt"> 893&#10;</span><span class="lnt"> 894&#10;</span><span class="lnt"> 895&#10;</span><span class="lnt"> 896&#10;</span><span class="lnt"> 897&#10;</span><span class="lnt"> 898&#10;</span><span class="lnt"> 899&#10;</span><span class="lnt"> 900&#10;</span><span class="lnt"> 901&#10;</span><span class="lnt"> 902&#10;</span><span class="lnt"> 903&#10;</span><span class="lnt"> 904&#10;</span><span class="lnt"> 905&#10;</span><span class="lnt"> 906&#10;</span><span class="lnt"> 907&#10;</span><span class="lnt"> 908&#10;</span><span class="lnt"> 909&#10;</span><span class="lnt"> 910&#10;</span><span class="lnt"> 911&#10;</span><span class="lnt"> 912&#10;</span><span class="lnt"> 913&#10;</span><span class="lnt"> 914&#10;</span><span class="lnt"> 915&#10;</span><span class="lnt"> 916&#10;</span><span class="lnt"> 917&#10;</span><span class="lnt"> 918&#10;</span><span class="lnt"> 919&#10;</span><span class="lnt"> 920&#10;</span><span class="lnt"> 921&#10;</span><span class="lnt"> 922&#10;</span><span class="lnt"> 923&#10;</span><span class="lnt"> 924&#10;</span><span class="lnt"> 925&#10;</span><span class="lnt"> 926&#10;</span><span class="lnt"> 927&#10;</span><span class="lnt"> 928&#10;</span><span class="lnt"> 929&#10;</span><span class="lnt"> 930&#10;</span><span class="lnt"> 931&#10;</span><span class="lnt"> 932&#10;</span><span class="lnt"> 933&#10;</span><span class="lnt"> 934&#10;</span><span class="lnt"> 935&#10;</span><span class="lnt"> 936&#10;</span><span class="lnt"> 937&#10;</span><span class="lnt"> 938&#10;</span><span class="lnt"> 939&#10;</span><span class="lnt"> 940&#10;</span><span class="lnt"> 941&#10;</span><span class="lnt"> 942&#10;</span><span class="lnt"> 943&#10;</span><span class="lnt"> 944&#10;</span><span class="lnt"> 945&#10;</span><span class="lnt"> 946&#10;</span><span class="lnt"> 947&#10;</span><span class="lnt"> 948&#10;</span><span class="lnt"> 949&#10;</span><span class="lnt"> 950&#10;</span><span class="lnt"> 951&#10;</span><span class="lnt"> 952&#10;</span><span class="lnt"> 953&#10;</span><span class="lnt"> 954&#10;</span><span class="lnt"> 955&#10;</span><span class="lnt"> 956&#10;</span><span class="lnt"> 957&#10;</span><span class="lnt"> 958&#10;</span><span class="lnt"> 959&#10;</span><span class="lnt"> 960&#10;</span><span class="lnt"> 961&#10;</span><span class="lnt"> 962&#10;</span><span class="lnt"> 963&#10;</span><span class="lnt"> 964&#10;</span><span class="lnt"> 965&#10;</span><span class="lnt"> 966&#10;</span><span class="lnt"> 967&#10;</span><span class="lnt"> 968&#10;</span><span class="lnt"> 969&#10;</span><span class="lnt"> 970&#10;</span><span class="lnt"> 971&#10;</span><span class="lnt"> 972&#10;</span><span class="lnt"> 973&#10;</span><span class="lnt"> 974&#10;</span><span class="lnt"> 975&#10;</span><span class="lnt"> 976&#10;</span><span class="lnt"> 977&#10;</span><span class="lnt"> 978&#10;</span><span class="lnt"> 979&#10;</span><span class="lnt"> 980&#10;</span><span class="lnt"> 981&#10;</span><span class="lnt"> 982&#10;</span><span class="lnt"> 983&#10;</span><span class="lnt"> 984&#10;</span><span class="lnt"> 985&#10;</span><span class="lnt"> 986&#10;</span><span class="lnt"> 987&#10;</span><span class="lnt"> 988&#10;</span><span class="lnt"> 989&#10;</span><span class="lnt"> 990&#10;</span><span class="lnt"> 991&#10;</span><span class="lnt"> 992&#10;</span><span class="lnt"> 993&#10;</span><span class="lnt"> 994&#10;</span><span class="lnt"> 995&#10;</span><span class="lnt"> 996&#10;</span><span class="lnt"> 997&#10;</span><span class="lnt"> 998&#10;</span><span class="lnt"> 999&#10;</span><span class="lnt">1000&#10;</span><span class="lnt">1001&#10;</span><span class="lnt">1002&#10;</span><span class="lnt">1003&#10;</span><span class="lnt">1004&#10;</span><span class="lnt">1005&#10;</span><span class="lnt">1006&#10;</span><span class="lnt">1007&#10;</span><span class="lnt">1008&#10;</span><span class="lnt">1009&#10;</span><span class="lnt">1010&#10;</span><span class="lnt">1011&#10;</span><span class="lnt">1012&#10;</span><span class="lnt">1013&#10;</span><span class="lnt">1014&#10;</span><span class="lnt">1015&#10;</span><span class="lnt">1016&#10;</span><span class="lnt">1017&#10;</span><span class="lnt">1018&#10;</span><span class="lnt">1019&#10;</span><span class="lnt">1020&#10;</span><span class="lnt">1021&#10;</span><span class="lnt">1022&#10;</span><span class="lnt">1023&#10;</span><span class="lnt">1024&#10;</span><span class="lnt">1025&#10;</span><span class="lnt">1026&#10;</span><span class="lnt">1027&#10;</span><span class="lnt">1028&#10;</span><span class="lnt">1029&#10;</span><span class="lnt">1030&#10;</span><span class="lnt">1031&#10;</span><span class="lnt">1032&#10;</span><span class="lnt">1033&#10;</span><span class="lnt">1034&#10;</span><span class="lnt">1035&#10;</span><span class="lnt">1036&#10;</span><span class="lnt">1037&#10;</span><span class="lnt">1038&#10;</span><span class="lnt">1039&#10;</span><span class="lnt">1040&#10;</span><span class="lnt">1041&#10;</span><span class="lnt">1042&#10;</span><span class="lnt">1043&#10;</span><span class="lnt">1044&#10;</span><span class="lnt">1045&#10;</span><span class="lnt">1046&#10;</span><span class="lnt">1047&#10;</span><span class="lnt">1048&#10;</span><span class="lnt">1049&#10;</span><span class="lnt">1050&#10;</span><span class="lnt">1051&#10;</span><span class="lnt">1052&#10;</span><span class="lnt">1053&#10;</span><span class="lnt">1054&#10;</span><span class="lnt">1055&#10;</span><span class="lnt">1056&#10;</span><span class="lnt">1057&#10;</span><span class="lnt">1058&#10;</span><span class="lnt">1059&#10;</span><span class="lnt">1060&#10;</span><span class="lnt">1061&#10;</span><span class="lnt">1062&#10;</span><span class="lnt">1063&#10;</span><span class="lnt">1064&#10;</span><span class="lnt">1065&#10;</span><span class="lnt">1066&#10;</span><span class="lnt">1067&#10;</span><span class="lnt">1068&#10;</span><span class="lnt">1069&#10;</span><span class="lnt">1070&#10;</span><span class="lnt">1071&#10;</span><span class="lnt">1072&#10;</span><span class="lnt">1073&#10;</span><span class="lnt">1074&#10;</span><span class="lnt">1075&#10;</span><span class="lnt">1076&#10;</span><span class="lnt">1077&#10;</span><span class="lnt">1078&#10;</span><span class="lnt">1079&#10;</span><span class="lnt">1080&#10;</span><span class="lnt">1081&#10;</span><span class="lnt">1082&#10;</span><span class="lnt">1083&#10;</span><span class="lnt">1084&#10;</span><span class="lnt">1085&#10;</span><span class="lnt">1086&#10;</span><span class="lnt">1087&#10;</span><span class="lnt">1088&#10;</span><span class="lnt">1089&#10;</span><span class="lnt">1090&#10;</span><span class="lnt">1091&#10;</span><span class="lnt">1092&#10;</span><span class="lnt">1093&#10;</span><span class="lnt">1094&#10;</span><span class="lnt">1095&#10;</span><span class="lnt">1096&#10;</span><span class="lnt">1097&#10;</span><span class="lnt">1098&#10;</span><span class="lnt">1099&#10;</span><span class="lnt">1100&#10;</span><span class="lnt">1101&#10;</span><span class="lnt">1102&#10;</span><span class="lnt">1103&#10;</span><span class="lnt">1104&#10;</span><span class="lnt">1105&#10;</span><span class="lnt">1106&#10;</span><span class="lnt">1107&#10;</span><span class="lnt">1108&#10;</span><span class="lnt">1109&#10;</span><span class="lnt">1110&#10;</span><span class="lnt">1111&#10;</span><span class="lnt">1112&#10;</span><span class="lnt">1113&#10;</span><span class="lnt">1114&#10;</span><span class="lnt">1115&#10;</span><span class="lnt">1116&#10;</span><span class="lnt">1117&#10;</span><span class="lnt">1118&#10;</span><span class="lnt">1119&#10;</span><span class="lnt">1120&#10;</span><span class="lnt">1121&#10;</span><span class="lnt">1122&#10;</span><span class="lnt">1123&#10;</span><span class="lnt">1124&#10;</span><span class="lnt">1125&#10;</span><span class="lnt">1126&#10;</span><span class="lnt">1127&#10;</span><span class="lnt">1128&#10;</span><span class="lnt">1129&#10;</span><span class="lnt">1130&#10;</span><span class="lnt">1131&#10;</span><span class="lnt">1132&#10;</span><span class="lnt">1133&#10;</span><span class="lnt">1134&#10;</span><span class="lnt">1135&#10;</span><span class="lnt">1136&#10;</span><span class="lnt">1137&#10;</span><span class="lnt">1138&#10;</span><span class="lnt">1139&#10;</span><span class="lnt">1140&#10;</span><span class="lnt">1141&#10;</span><span class="lnt">1142&#10;</span><span class="lnt">1143&#10;</span><span class="lnt">1144&#10;</span><span class="lnt">1145&#10;</span><span class="lnt">1146&#10;</span><span class="lnt">1147&#10;</span><span class="lnt">1148&#10;</span><span class="lnt">1149&#10;</span><span class="lnt">1150&#10;</span><span class="lnt">1151&#10;</span><span class="lnt">1152&#10;</span><span class="lnt">1153&#10;</span><span class="lnt">1154&#10;</span><span class="lnt">1155&#10;</span><span class="lnt">1156&#10;</span><span class="lnt">1157&#10;</span><span class="lnt">1158&#10;</span><span class="lnt">1159&#10;</span><span class="lnt">1160&#10;</span><span class="lnt">1161&#10;</span><span class="lnt">1162&#10;</span><span class="lnt">1163&#10;</span><span class="lnt">1164&#10;</span><span class="lnt">1165&#10;</span><span class="lnt">1166&#10;</span><span class="lnt">1167&#10;</span><span class="lnt">1168&#10;</span><span class="lnt">1169&#10;</span><span class="lnt">1170&#10;</span><span class="lnt">1171&#10;</span><span class="lnt">1172&#10;</span><span class="lnt">1173&#10;</span><span class="lnt">1174&#10;</span><span class="lnt">1175&#10;</span><span class="lnt">1176&#10;</span><span class="lnt">1177&#10;</span><span class="lnt">1178&#10;</span><span class="lnt">1179&#10;</span><span class="lnt">1180&#10;</span><span class="lnt">1181&#10;</span><span class="lnt">1182&#10;</span><span class="lnt">1183&#10;</span><span class="lnt">1184&#10;</span><span class="lnt">1185&#10;</span><span class="lnt">1186&#10;</span><span class="lnt">1187&#10;</span><span class="lnt">1188&#10;</span><span class="lnt">1189&#10;</span><span class="lnt">1190&#10;</span><span class="lnt">1191&#10;</span><span class="lnt">1192&#10;</span><span class="lnt">1193&#10;</span><span class="lnt">1194&#10;</span><span class="lnt">1195&#10;</span><span class="lnt">1196&#10;</span><span class="lnt">1197&#10;</span><span class="lnt">1198&#10;</span><span class="lnt">1199&#10;</span><span class="lnt">1200&#10;</span><span class="lnt">1201&#10;</span><span class="lnt">1202&#10;</span><span class="lnt">1203&#10;</span><span class="lnt">1204&#10;</span><span class="lnt">1205&#10;</span><span class="lnt">1206&#10;</span><span class="lnt">1207&#10;</span><span class="lnt">1208&#10;</span><span class="lnt">1209&#10;</span><span class="lnt">1210&#10;</span><span class="lnt">1211&#10;</span><span class="lnt">1212&#10;</span><span class="lnt">1213&#10;</span><span class="lnt">1214&#10;</span><span class="lnt">1215&#10;</span><span class="lnt">1216&#10;</span><span class="lnt">1217&#10;</span><span class="lnt">1218&#10;</span><span class="lnt">1219&#10;</span><span class="lnt">1220&#10;</span><span class="lnt">1221&#10;</span><span class="lnt">1222&#10;</span><span class="lnt">1223&#10;</span><span class="lnt">1224&#10;</span><span class="lnt">1225&#10;</span><span class="lnt">1226&#10;</span><span class="lnt">1227&#10;</span><span class="lnt">1228&#10;</span><span class="lnt">1229&#10;</span><span class="lnt">1230&#10;</span><span class="lnt">1231&#10;</span><span class="lnt">1232&#10;</span><span class="lnt">1233&#10;</span><span class="lnt">1234&#10;</span><span class="lnt">1235&#10;</span><span class="lnt">1236&#10;</span><span class="lnt">1237&#10;</span><span class="lnt">1238&#10;</span><span class="lnt">1239&#10;</span><span class="lnt">1240&#10;</span><span class="lnt">1241&#10;</span><span class="lnt">1242&#10;</span><span class="lnt">1243&#10;</span><span class="lnt">1244&#10;</span><span class="lnt">1245&#10;</span><span class="lnt">1246&#10;</span><span class="lnt">1247&#10;</span><span class="lnt">1248&#10;</span><span class="lnt">1249&#10;</span><span class="lnt">1250&#10;</span><span class="lnt">1251&#10;</span><span class="lnt">1252&#10;</span><span class="lnt">1253&#10;</span><span class="lnt">1254&#10;</span><span class="lnt">1255&#10;</span><span class="lnt">1256&#10;</span><span class="lnt">1257&#10;</span><span class="lnt">1258&#10;</span><span class="lnt">1259&#10;</span><span class="lnt">1260&#10;</span><span class="lnt">1261&#10;</span><span class="lnt">1262&#10;</span><span class="lnt">1263&#10;</span><span class="lnt">1264&#10;</span><span class="lnt">1265&#10;</span><span class="lnt">1266&#10;</span><span class="lnt">1267&#10;</span><span class="lnt">1268&#10;</span><span class="lnt">1269&#10;</span><span class="lnt">1270&#10;</span><span class="lnt">1271&#10;</span><span class="lnt">1272&#10;</span><span class="lnt">1273&#10;</span><span class="lnt">1274&#10;</span><span class="lnt">1275&#10;</span><span class="lnt">1276&#10;</span><span class="lnt">1277&#10;</span><span class="lnt">1278&#10;</span><span class="lnt">1279&#10;</span><span class="lnt">1280&#10;</span><span class="lnt">1281&#10;</span><span class="lnt">1282&#10;</span><span class="lnt">1283&#10;</span><span class="lnt">1284&#10;</span><span class="lnt">1285&#10;</span><span class="lnt">1286&#10;</span><span class="lnt">1287&#10;</span><span class="lnt">1288&#10;</span><span class="lnt">1289&#10;</span><span class="lnt">1290&#10;</span><span class="lnt">1291&#10;</span><span class="lnt">1292&#10;</span><span class="lnt">1293&#10;</span><span class="lnt">1294&#10;</span><span class="lnt">1295&#10;</span><span class="lnt">1296&#10;</span><span class="lnt">1297&#10;</span><span class="lnt">1298&#10;</span><span class="lnt">1299&#10;</span><span class="lnt">1300&#10;</span><span class="lnt">1301&#10;</span><span class="lnt">1302&#10;</span><span class="lnt">1303&#10;</span><span class="lnt">1304&#10;</span><span class="lnt">1305&#10;</span><span class="lnt">1306&#10;</span><span class="lnt">1307&#10;</span><span class="lnt">1308&#10;</span><span class="lnt">1309&#10;</span><span class="lnt">1310&#10;</span><span class="lnt">1311&#10;</span><span class="lnt">1312&#10;</span><span class="lnt">1313&#10;</span><span class="lnt">1314&#10;</span><span class="lnt">1315&#10;</span><span class="lnt">1316&#10;</span><span class="lnt">1317&#10;</span><span class="lnt">1318&#10;</span><span class="lnt">1319&#10;</span><span class="lnt">1320&#10;</span><span class="lnt">1321&#10;</span><span class="lnt">1322&#10;</span><span class="lnt">1323&#10;</span><span class="lnt">1324&#10;</span><span class="lnt">1325&#10;</span><span class="lnt">1326&#10;</span><span class="lnt">1327&#10;</span><span class="lnt">1328&#10;</span><span class="lnt">1329&#10;</span><span class="lnt">1330&#10;</span><span class="lnt">1331&#10;</span><span class="lnt">1332&#10;</span><span class="lnt">1333&#10;</span><span class="lnt">1334&#10;</span><span class="lnt">1335&#10;</span><span class="lnt">1336&#10;</span><span class="lnt">1337&#10;</span><span class="lnt">1338&#10;</span><span class="lnt">1339&#10;</span><span class="lnt">1340&#10;</span><span class="lnt">1341&#10;</span><span class="lnt">1342&#10;</span><span class="lnt">1343&#10;</span><span class="lnt">1344&#10;</span><span class="lnt">1345&#10;</span><span class="lnt">1346&#10;</span><span class="lnt">1347&#10;</span><span class="lnt">1348&#10;</span><span class="lnt">1349&#10;</span><span class="lnt">1350&#10;</span><span class="lnt">1351&#10;</span><span class="lnt">1352&#10;</span><span class="lnt">1353&#10;</span><span class="lnt">1354&#10;</span><span class="lnt">1355&#10;</span><span class="lnt">1356&#10;</span><span class="lnt">1357&#10;</span><span class="lnt">1358&#10;</span><span class="lnt">1359&#10;</span><span class="lnt">1360&#10;</span><span class="lnt">1361&#10;</span><span class="lnt">1362&#10;</span><span class="lnt">1363&#10;</span><span class="lnt">1364&#10;</span><span class="lnt">1365&#10;</span><span class="lnt">1366&#10;</span><span class="lnt">1367&#10;</span><span class="lnt">1368&#10;</span><span class="lnt">1369&#10;</span><span class="lnt">1370&#10;</span><span class="lnt">1371&#10;</span><span class="lnt">1372&#10;</span><span class="lnt">1373&#10;</span><span class="lnt">1374&#10;</span><span class="lnt">1375&#10;</span><span class="lnt">1376&#10;</span><span class="lnt">1377&#10;</span><span class="lnt">1378&#10;</span><span class="lnt">1379&#10;</span><span class="lnt">1380&#10;</span><span class="lnt">1381&#10;</span><span class="lnt">1382&#10;</span><span class="lnt">1383&#10;</span><span class="lnt">1384&#10;</span><span class="lnt">1385&#10;</span><span class="lnt">1386&#10;</span><span class="lnt">1387&#10;</span><span class="lnt">1388&#10;</span><span class="lnt">1389&#10;</span><span class="lnt">1390&#10;</span><span class="lnt">1391&#10;</span><span class="lnt">1392&#10;</span><span class="lnt">1393&#10;</span><span class="lnt">1394&#10;</span><span class="lnt">1395&#10;</span><span class="lnt">1396&#10;</span><span class="lnt">1397&#10;</span><span class="lnt">1398&#10;</span><span class="lnt">1399&#10;</span><span class="lnt">1400&#10;</span><span class="lnt">1401&#10;</span><span class="lnt">1402&#10;</span><span class="lnt">1403&#10;</span><span class="lnt">1404&#10;</span><span class="lnt">1405&#10;</span><span class="lnt">1406&#10;</span><span class="lnt">1407&#10;</span><span class="lnt">1408&#10;</span><span class="lnt">1409&#10;</span><span class="lnt">1410&#10;</span><span class="lnt">1411&#10;</span><span class="lnt">1412&#10;</span><span class="lnt">1413&#10;</span><span class="lnt">1414&#10;</span><span class="lnt">1415&#10;</span><span class="lnt">1416&#10;</span><span class="lnt">1417&#10;</span><span class="lnt">1418&#10;</span><span class="lnt">1419&#10;</span><span class="lnt">1420&#10;</span><span class="lnt">1421&#10;</span><span class="lnt">1422&#10;</span><span class="lnt">1423&#10;</span><span class="lnt">1424&#10;</span><span class="lnt">1425&#10;</span><span class="lnt">1426&#10;</span><span class="lnt">1427&#10;</span><span class="lnt">1428&#10;</span><span class="lnt">1429&#10;</span><span class="lnt">1430&#10;</span><span class="lnt">1431&#10;</span><span class="lnt">1432&#10;</span><span class="lnt">1433&#10;</span><span class="lnt">1434&#10;</span><span class="lnt">1435&#10;</span><span class="lnt">1436&#10;</span><span class="lnt">1437&#10;</span><span class="lnt">1438&#10;</span><span class="lnt">1439&#10;</span><span class="lnt">1440&#10;</span><span class="lnt">1441&#10;</span><span class="lnt">1442&#10;</span><span class="lnt">1443&#10;</span><span class="lnt">1444&#10;</span><span class="lnt">1445&#10;</span><span class="lnt">1446&#10;</span><span class="lnt">1447&#10;</span><span class="lnt">1448&#10;</span><span class="lnt">1449&#10;</span><span class="lnt">1450&#10;</span><span class="lnt">1451&#10;</span><span class="lnt">1452&#10;</span><span class="lnt">1453&#10;</span><span class="lnt">1454&#10;</span><span class="lnt">1455&#10;</span><span class="lnt">1456&#10;</span><span class="lnt">1457&#10;</span><span class="lnt">1458&#10;</span><span class="lnt">1459&#10;</span><span class="lnt">1460&#10;</span><span class="lnt">1461&#10;</span><span class="lnt">1462&#10;</span><span class="lnt">1463&#10;</span><span class="lnt">1464&#10;</span><span class="lnt">1465&#10;</span><span class="lnt">1466&#10;</span><span class="lnt">1467&#10;</span><span class="lnt">1468&#10;</span><span class="lnt">1469&#10;</span><span class="lnt">1470&#10;</span><span class="lnt">1471&#10;</span><span class="lnt">1472&#10;</span><span class="lnt">1473&#10;</span><span class="lnt">1474&#10;</span><span class="lnt">1475&#10;</span><span class="lnt">1476&#10;</span><span class="lnt">1477&#10;</span><span class="lnt">1478&#10;</span><span class="lnt">1479&#10;</span><span class="lnt">1480&#10;</span><span class="lnt">1481&#10;</span><span class="lnt">1482&#10;</span><span class="lnt">1483&#10;</span><span class="lnt">1484&#10;</span><span class="lnt">1485&#10;</span><span class="lnt">1486&#10;</span><span class="lnt">1487&#10;</span><span class="lnt">1488&#10;</span><span class="lnt">1489&#10;</span><span class="lnt">1490&#10;</span><span class="lnt">1491&#10;</span><span class="lnt">1492&#10;</span><span class="lnt">1493&#10;</span><span class="lnt">1494&#10;</span><span class="lnt">1495&#10;</span><span class="lnt">1496&#10;</span><span class="lnt">1497&#10;</span><span class="lnt">1498&#10;</span><span class="lnt">1499&#10;</span><span class="lnt">1500&#10;</span><span class="lnt">1501&#10;</span><span class="lnt">1502&#10;</span><span class="lnt">1503&#10;</span><span class="lnt">1504&#10;</span><span class="lnt">1505&#10;</span><span class="lnt">1506&#10;</span><span class="lnt">1507&#10;</span><span class="lnt">1508&#10;</span><span class="lnt">1509&#10;</span><span class="lnt">1510&#10;</span><span class="lnt">1511&#10;</span><span class="lnt">1512&#10;</span><span class="lnt">1513&#10;</span><span class="lnt">1514&#10;</span><span class="lnt">1515&#10;</span><span class="lnt">1516&#10;</span><span class="lnt">1517&#10;</span><span class="lnt">1518&#10;</span><span class="lnt">1519&#10;</span><span class="lnt">1520&#10;</span><span class="lnt">1521&#10;</span><span class="lnt">1522&#10;</span><span class="lnt">1523&#10;</span><span class="lnt">1524&#10;</span><span class="lnt">1525&#10;</span><span class="lnt">1526&#10;</span><span class="lnt">1527&#10;</span><span class="lnt">1528&#10;</span><span class="lnt">1529&#10;</span><span class="lnt">1530&#10;</span><span class="lnt">1531&#10;</span><span class="lnt">1532&#10;</span><span class="lnt">1533&#10;</span><span class="lnt">1534&#10;</span><span class="lnt">1535&#10;</span><span class="lnt">1536&#10;</span><span class="lnt">1537&#10;</span><span class="lnt">1538&#10;</span><span class="lnt">1539&#10;</span><span class="lnt">1540&#10;</span><span class="lnt">1541&#10;</span><span class="lnt">1542&#10;</span><span class="lnt">1543&#10;</span><span class="lnt">1544&#10;</span><span class="lnt">1545&#10;</span><span class="lnt">1546&#10;</span><span class="lnt">1547&#10;</span><span class="lnt">1548&#10;</span><span class="lnt">1549&#10;</span><span class="lnt">1550&#10;</span><span class="lnt">1551&#10;</span><span class="lnt">1552&#10;</span><span class="lnt">1553&#10;</span><span class="lnt">1554&#10;</span><span class="lnt">1555&#10;</span><span class="lnt">1556&#10;</span><span class="lnt">1557&#10;</span><span class="lnt">1558&#10;</span><span class="lnt">1559&#10;</span><span class="lnt">1560&#10;</span><span class="lnt">1561&#10;</span><span class="lnt">1562&#10;</span><span class="lnt">1563&#10;</span><span class="lnt">1564&#10;</span><span class="lnt">1565&#10;</span><span class="lnt">1566&#10;</span><span class="lnt">1567&#10;</span><span class="lnt">1568&#10;</span><span class="lnt">1569&#10;</span><span class="lnt">1570&#10;</span><span class="lnt">1571&#10;</span><span class="lnt">1572&#10;</span><span class="lnt">1573&#10;</span><span class="lnt">1574&#10;</span><span class="lnt">1575&#10;</span><span class="lnt">1576&#10;</span><span class="lnt">1577&#10;</span><span class="lnt">1578&#10;</span><span class="lnt">1579&#10;</span><span class="lnt">1580&#10;</span><span class="lnt">1581&#10;</span><span class="lnt">1582&#10;</span><span class="lnt">1583&#10;</span><span class="lnt">1584&#10;</span><span class="lnt">1585&#10;</span><span class="lnt">1586&#10;</span><span class="lnt">1587&#10;</span><span class="lnt">1588&#10;</span><span class="lnt">1589&#10;</span><span class="lnt">1590&#10;</span><span class="lnt">1591&#10;</span><span class="lnt">1592&#10;</span><span class="lnt">1593&#10;</span><span class="lnt">1594&#10;</span><span class="lnt">1595&#10;</span><span class="lnt">1596&#10;</span><span class="lnt">1597&#10;</span><span class="lnt">1598&#10;</span><span class="lnt">1599&#10;</span><span class="lnt">1600&#10;</span><span class="lnt">1601&#10;</span><span class="lnt">1602&#10;</span><span class="lnt">1603&#10;</span><span class="lnt">1604&#10;</span><span class="lnt">1605&#10;</span><span class="lnt">1606&#10;</span><span class="lnt">1607&#10;</span><span class="lnt">1608&#10;</span><span class="lnt">1609&#10;</span><span class="lnt">1610&#10;</span><span class="lnt">1611&#10;</span><span class="lnt">1612&#10;</span><span class="lnt">1613&#10;</span><span class="lnt">1614&#10;</span><span class="lnt">1615&#10;</span><span class="lnt">1616&#10;</span><span class="lnt">1617&#10;</span><span class="lnt">1618&#10;</span><span class="lnt">1619&#10;</span><span class="lnt">1620&#10;</span><span class="lnt">1621&#10;</span><span class="lnt">1622&#10;</span><span class="lnt">1623&#10;</span><span class="lnt">1624&#10;</span><span class="lnt">1625&#10;</span><span class="lnt">1626&#10;</span><span class="lnt">1627&#10;</span><span class="lnt">1628&#10;</span><span class="lnt">1629&#10;</span><span class="lnt">1630&#10;</span><span class="lnt">1631&#10;</span><span class="lnt">1632&#10;</span><span class="lnt">1633&#10;</span><span class="lnt">1634&#10;</span><span class="lnt">1635&#10;</span><span class="lnt">1636&#10;</span><span class="lnt">1637&#10;</span><span class="lnt">1638&#10;</span><span class="lnt">1639&#10;</span><span class="lnt">1640&#10;</span><span class="lnt">1641&#10;</span><span class="lnt">1642&#10;</span><span class="lnt">1643&#10;</span><span class="lnt">1644&#10;</span><span class="lnt">1645&#10;</span><span class="lnt">1646&#10;</span><span class="lnt">1647&#10;</span><span class="lnt">1648&#10;</span><span class="lnt">1649&#10;</span><span class="lnt">1650&#10;</span><span class="lnt">1651&#10;</span><span class="lnt">1652&#10;</span><span class="lnt">1653&#10;</span><span class="lnt">1654&#10;</span><span class="lnt">1655&#10;</span><span class="lnt">1656&#10;</span><span class="lnt">1657&#10;</span><span class="lnt">1658&#10;</span><span class="lnt">1659&#10;</span><span class="lnt">1660&#10;</span><span class="lnt">1661&#10;</span><span class="lnt">1662&#10;</span><span class="lnt">1663&#10;</span><span class="lnt">1664&#10;</span><span class="lnt">1665&#10;</span><span class="lnt">1666&#10;</span><span class="lnt">1667&#10;</span><span class="lnt">1668&#10;</span><span class="lnt">1669&#10;</span><span class="lnt">1670&#10;</span><span class="lnt">1671&#10;</span><span class="lnt">1672&#10;</span><span class="lnt">1673&#10;</span><span class="lnt">1674&#10;</span><span class="lnt">1675&#10;</span><span class="lnt">1676&#10;</span><span class="lnt">1677&#10;</span><span class="lnt">1678&#10;</span><span class="lnt">1679&#10;</span><span class="lnt">1680&#10;</span><span class="lnt">1681&#10;</span><span class="lnt">1682&#10;</span><span class="lnt">1683&#10;</span><span class="lnt">1684&#10;</span><span class="lnt">1685&#10;</span><span class="lnt">1686&#10;</span><span class="lnt">1687&#10;</span><span class="lnt">1688&#10;</span><span class="lnt">1689&#10;</span><span class="lnt">1690&#10;</span><span class="lnt">1691&#10;</span><span class="lnt">1692&#10;</span><span class="lnt">1693&#10;</span><span class="lnt">1694&#10;</span><span class="lnt">1695&#10;</span><span class="lnt">1696&#10;</span><span class="lnt">1697&#10;</span><span class="lnt">1698&#10;</span><span class="lnt">1699&#10;</span><span class="lnt">1700&#10;</span><span class="lnt">1701&#10;</span><span class="lnt">1702&#10;</span><span class="lnt">1703&#10;</span><span class="lnt">1704&#10;</span><span class="lnt">1705&#10;</span><span class="lnt">1706&#10;</span><span class="lnt">1707&#10;</span><span class="lnt">1708&#10;</span><span class="lnt">1709&#10;</span><span class="lnt">1710&#10;</span><span class="lnt">1711&#10;</span><span class="lnt">1712&#10;</span><span class="lnt">1713&#10;</span><span class="lnt">1714&#10;</span><span class="lnt">1715&#10;</span><span class="lnt">1716&#10;</span><span class="lnt">1717&#10;</span><span class="lnt">1718&#10;</span><span class="lnt">1719&#10;</span><span class="lnt">1720&#10;</span><span class="lnt">1721&#10;</span><span class="lnt">1722&#10;</span><span class="lnt">1723&#10;</span><span class="lnt">1724&#10;</span><span class="lnt">1725&#10;</span><span class="lnt">1726&#10;</span><span class="lnt">1727&#10;</span><span class="lnt">1728&#10;</span><span class="lnt">1729&#10;</span><span class="lnt">1730&#10;</span><span class="lnt">1731&#10;</span><span class="lnt">1732&#10;</span><span class="lnt">1733&#10;</span><span class="lnt">1734&#10;</span><span class="lnt">1735&#10;</span><span class="lnt">1736&#10;</span><span class="lnt">1737&#10;</span><span class="lnt">1738&#10;</span><span class="lnt">1739&#10;</span><span class="lnt">1740&#10;</span><span class="lnt">1741&#10;</span><span class="lnt">1742&#10;</span><span class="lnt">1743&#10;</span><span class="lnt">1744&#10;</span><span class="lnt">1745&#10;</span><span class="lnt">1746&#10;</span><span class="lnt">1747&#10;</span><span class="lnt">1748&#10;</span><span class="lnt">1749&#10;</span><span class="lnt">1750&#10;</span><span class="lnt">1751&#10;</span><span class="lnt">1752&#10;</span><span class="lnt">1753&#10;</span><span class="lnt">1754&#10;</span><span class="lnt">1755&#10;</span><span class="lnt">1756&#10;</span><span class="lnt">1757&#10;</span><span class="lnt">1758&#10;</span><span class="lnt">1759&#10;</span><span class="lnt">1760&#10;</span><span class="lnt">1761&#10;</span><span class="lnt">1762&#10;</span><span class="lnt">1763&#10;</span><span class="lnt">1764&#10;</span><span class="lnt">1765&#10;</span><span class="lnt">1766&#10;</span><span class="lnt">1767&#10;</span><span class="lnt">1768&#10;</span><span class="lnt">1769&#10;</span><span class="lnt">1770&#10;</span><span class="lnt">1771&#10;</span><span class="lnt">1772&#10;</span><span class="lnt">1773&#10;</span><span class="lnt">1774&#10;</span><span class="lnt">1775&#10;</span><span class="lnt">1776&#10;</span><span class="lnt">1777&#10;</span><span class="lnt">1778&#10;</span><span class="lnt">1779&#10;</span><span class="lnt">1780&#10;</span><span class="lnt">1781&#10;</span><span class="lnt">1782&#10;</span><span class="lnt">1783&#10;</span><span class="lnt">1784&#10;</span><span class="lnt">1785&#10;</span><span class="lnt">1786&#10;</span><span class="lnt">1787&#10;</span><span class="lnt">1788&#10;</span><span class="lnt">1789&#10;</span><span class="lnt">1790&#10;</span><span class="lnt">1791&#10;</span><span class="lnt">1792&#10;</span><span class="lnt">1793&#10;</span><span class="lnt">1794&#10;</span><span class="lnt">1795&#10;</span><span class="lnt">1796&#10;</span><span class="lnt">1797&#10;</span><span class="lnt">1798&#10;</span><span class="lnt">1799&#10;</span><span class="lnt">1800&#10;</span><span class="lnt">1801&#10;</span><span class="lnt">1802&#10;</span><span class="lnt">1803&#10;</span><span class="lnt">1804&#10;</span><span class="lnt">1805&#10;</span><span class="lnt">1806&#10;</span><span class="lnt">1807&#10;</span><span class="lnt">1808&#10;</span><span class="lnt">1809&#10;</span><span class="lnt">1810&#10;</span><span class="lnt">1811&#10;</span><span class="lnt">1812&#10;</span><span class="lnt">1813&#10;</span><span class="lnt">1814&#10;</span><span class="lnt">1815&#10;</span><span class="lnt">1816&#10;</span><span class="lnt">1817&#10;</span><span class="lnt">1818&#10;</span><span class="lnt">1819&#10;</span><span class="lnt">1820&#10;</span><span class="lnt">1821&#10;</span><span class="lnt">1822&#10;</span><span class="lnt">1823&#10;</span><span class="lnt">1824&#10;</span><span class="lnt">1825&#10;</span><span class="lnt">1826&#10;</span><span class="lnt">1827&#10;</span><span class="lnt">1828&#10;</span><span class="lnt">1829&#10;</span><span class="lnt">1830&#10;</span><span class="lnt">1831&#10;</span><span class="lnt">1832&#10;</span><span class="lnt">1833&#10;</span><span class="lnt">1834&#10;</span><span class="lnt">1835&#10;</span><span class="lnt">1836&#10;</span><span class="lnt">1837&#10;</span><span class="lnt">1838&#10;</span><span class="lnt">1839&#10;</span><span class="lnt">1840&#10;</span><span class="lnt">1841&#10;</span><span class="lnt">1842&#10;</span><span class="lnt">1843&#10;</span><span class="lnt">1844&#10;</span><span class="lnt">1845&#10;</span><span class="lnt">1846&#10;</span><span class="lnt">1847&#10;</span><span class="lnt">1848&#10;</span><span class="lnt">1849&#10;</span><span class="lnt">1850&#10;</span><span class="lnt">1851&#10;</span><span class="lnt">1852&#10;</span><span class="lnt">1853&#10;</span><span class="lnt">1854&#10;</span><span class="lnt">1855&#10;</span><span class="lnt">1856&#10;</span><span class="lnt">1857&#10;</span><span class="lnt">1858&#10;</span><span class="lnt">1859&#10;</span><span class="lnt">1860&#10;</span><span class="lnt">1861&#10;</span><span class="lnt">1862&#10;</span><span class="lnt">1863&#10;</span><span class="lnt">1864&#10;</span><span class="lnt">1865&#10;</span><span class="lnt">1866&#10;</span><span class="lnt">1867&#10;</span><span class="lnt">1868&#10;</span><span class="lnt">1869&#10;</span><span class="lnt">1870&#10;</span></code></pre></td>&#10;<td class="lntd">&#10;<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/env bash&#10;</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nb">set</span> -e&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># Arch Linux Install Script (alis) installs unattended, automated</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># and customized Arch Linux system.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># Copyright (C) 2021 picodotdev</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># This program is free software: you can redistribute it and/or modify</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># it under the terms of the GNU General Public License as published by</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># (at your option) any later version.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">#</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># This program is distributed in the hope that it will be useful,</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># GNU General Public License for more details.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">#</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># You should have received a copy of the GNU General Public License</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># along with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># This script is hosted at https://github.com/picodotdev/alis. For new features,</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># improvements and bugs fill an issue in GitHub or make a pull request.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># Pull Request are welcome!</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">#</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># If you test it in real hardware please send me an email to pico.dev@gmail.com with</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># the machine description and tell me if somethig goes wrong or all works fine.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">#</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># Please, don&#39;t ask for support for this script in Arch Linux forums, first read</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># the Arch Linux wiki [1], the Installation Guide [2] and the General</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># Recomendations [3], later compare the commands with those of this script.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">#</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># [1] https://wiki.archlinux.org</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># [2] https://wiki.archlinux.org/index.php/Installation_guide</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># [3] https://wiki.archlinux.org/index.php/General_recommendations</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># Usage:</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># # loadkeys es</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># # iwctl --passphrase &#34;[WIFI_KEY]&#34; station [WIFI_INTERFACE] connect &#34;[WIFI_ESSID]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  # (Optional) Connect to WIFI network. _ip link show_ to know WIFI_INTERFACE.</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># # curl https://raw.githubusercontent.com/picodotdev/alis/master/download.sh | bash, curl https://raw.githubusercontent.com/picodotdev/alis/master/download.sh | bash -s -- -u [github user], or with URL shortener curl -sL https://bit.ly/2F3CATp | bash</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># # vim alis.conf</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1"># # ./alis.sh</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="c1"># global variables (no configuration, don&#39;t edit)</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">ASCIINEMA</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">BIOS_TYPE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">PARTITION_BOOT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">PARTITION_ROOT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">PARTITION_BOOT_NUMBER</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">PARTITION_ROOT_NUMBER</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">DEVICE_ROOT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">DEVICE_LVM</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">LUKS_DEVICE_NAME</span><span class="o">=</span><span class="s2">&#34;cryptroot&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">LVM_VOLUME_GROUP</span><span class="o">=</span><span class="s2">&#34;vg&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">LVM_VOLUME_LOGICAL</span><span class="o">=</span><span class="s2">&#34;root&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">SWAPFILE</span><span class="o">=</span><span class="s2">&#34;/swapfile&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">BOOT_DIRECTORY</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">ESP_DIRECTORY</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">#PARTITION_BOOT_NUMBER=0</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">UUID_BOOT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">UUID_ROOT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">PARTUUID_BOOT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">PARTUUID_ROOT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">DEVICE_SATA</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">DEVICE_NVME</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">DEVICE_MMC</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">CPU_VENDOR</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">VIRTUALBOX</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">CMDLINE_LINUX_ROOT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">CMDLINE_LINUX</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="nv">CONF_FILE</span><span class="o">=</span><span class="s2">&#34;alis.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">GLOBALS_FILE</span><span class="o">=</span><span class="s2">&#34;alis-globals.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">LOG_FILE</span><span class="o">=</span><span class="s2">&#34;alis.log&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">ASCIINEMA_FILE</span><span class="o">=</span><span class="s2">&#34;alis.asciinema&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="nv">RED</span><span class="o">=</span><span class="s1">&#39;\033[0;31m&#39;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">GREEN</span><span class="o">=</span><span class="s1">&#39;\033[0;32m&#39;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">LIGHT_BLUE</span><span class="o">=</span><span class="s1">&#39;\033[1;34m&#39;</span>&#10;</span></span><span class="line"><span class="cl"><span class="nv">NC</span><span class="o">=</span><span class="s1">&#39;\033[0m&#39;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> configuration_install<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">source</span> <span class="s2">&#34;</span><span class="nv">$CONF_FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> sanitize_variables<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$DEVICE</span><span class="s2">&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_MODE</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$PARTITION_MODE</span><span class="s2">&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_CUSTOM_PARTED_UEFI</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$PARTITION_CUSTOM_PARTED_UEFI</span><span class="s2">&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_CUSTOM_PARTED_BIOS</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$PARTITION_CUSTOM_PARTED_BIOS</span><span class="s2">&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_CUSTOMMANUAL_BOOT</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$PARTITION_CUSTOMMANUAL_BOOT</span><span class="s2">&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_CUSTOMMANUAL_ROOT</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$PARTITION_CUSTOMMANUAL_ROOT</span><span class="s2">&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">FILE_SYSTEM_TYPE</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">SWAP_SIZE</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$SWAP_SIZE</span><span class="s2">&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">KERNELS</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$KERNELS</span><span class="s2">&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">KERNELS_COMPRESSION</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$KERNELS_COMPRESSION</span><span class="s2">&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">SYSTEMD_HOMED_STORAGE</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$SYSTEMD_HOMED_STORAGE</span><span class="s2">&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">BOOTLOADER</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$BOOTLOADER</span><span class="s2">&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CUSTOM_SHELL</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$CUSTOM_SHELL</span><span class="s2">&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DESKTOP_ENVIRONMENT</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$DESKTOP_ENVIRONMENT</span><span class="s2">&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DISPLAY_DRIVER</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER</span><span class="s2">&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DISPLAY_DRIVER_HARDWARE_ACCELERATION_INTEL</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER_HARDWARE_ACCELERATION_INTEL</span><span class="s2">&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">SYSTEMD_UNITS</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$SYSTEMD_UNITS</span><span class="s2">&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> sanitize_variable<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VARIABLE</span><span class="o">=</span><span class="nv">$1</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VARIABLE</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$VARIABLE</span> <span class="p">|</span> sed <span class="s2">&#34;s/![^ ]*//g&#34;</span><span class="k">)</span> <span class="c1"># remove disabled</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VARIABLE</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$VARIABLE</span> <span class="p">|</span> sed <span class="s2">&#34;s/ {2,}/ /g&#34;</span><span class="k">)</span> <span class="c1"># remove unnecessary white spaces</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VARIABLE</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$VARIABLE</span> <span class="p">|</span> sed <span class="s1">&#39;s/^[[:space:]]*//&#39;</span><span class="k">)</span> <span class="c1"># trim leading</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VARIABLE</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$VARIABLE</span> <span class="p">|</span> sed <span class="s1">&#39;s/[[:space:]]*$//&#39;</span><span class="k">)</span> <span class="c1"># trim trailing</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$VARIABLE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> check_variables<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;KEYS&#34;</span> <span class="s2">&#34;</span><span class="nv">$KEYS</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;LOG&#34;</span> <span class="s2">&#34;</span><span class="nv">$LOG</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;DEVICE&#34;</span> <span class="s2">&#34;</span><span class="nv">$DEVICE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;DEVICE_TRIM&#34;</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_TRIM</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;LVM&#34;</span> <span class="s2">&#34;</span><span class="nv">$LVM</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_equals <span class="s2">&#34;LUKS_PASSWORD&#34;</span> <span class="s2">&#34;LUKS_PASSWORD_RETYPE&#34;</span> <span class="s2">&#34;</span><span class="nv">$LUKS_PASSWORD</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$LUKS_PASSWORD_RETYPE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;FILE_SYSTEM_TYPE&#34;</span> <span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> <span class="s2">&#34;ext4 btrfs xfs f2fs reiserfs&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;PARTITION_MODE&#34;</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_MODE</span><span class="s2">&#34;</span> <span class="s2">&#34;auto custom manual&#34;</span> <span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_MODE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;custom&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;PARTITION_CUSTOM_PARTED_UEFI&#34;</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_CUSTOM_PARTED_UEFI</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;PARTITION_CUSTOM_PARTED_BIOS&#34;</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_CUSTOM_PARTED_BIOS</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_MODE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;custom&#34;</span> -o <span class="s2">&#34;</span><span class="nv">$PARTITION_MODE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;manual&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;PARTITION_CUSTOMMANUAL_BOOT&#34;</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_CUSTOMMANUAL_BOOT</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;PARTITION_CUSTOMMANUAL_ROOT&#34;</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_CUSTOMMANUAL_ROOT</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LVM</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;PARTITION_MODE&#34;</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_MODE</span><span class="s2">&#34;</span> <span class="s2">&#34;auto&#34;</span> <span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_equals <span class="s2">&#34;WIFI_KEY&#34;</span> <span class="s2">&#34;WIFI_KEY_RETYPE&#34;</span> <span class="s2">&#34;</span><span class="nv">$WIFI_KEY</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$WIFI_KEY_RETYPE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;PING_HOSTNAME&#34;</span> <span class="s2">&#34;</span><span class="nv">$PING_HOSTNAME</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;PACMAN_MIRROR&#34;</span> <span class="s2">&#34;</span><span class="nv">$PACMAN_MIRROR</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;KERNELS&#34;</span> <span class="s2">&#34;</span><span class="nv">$KERNELS</span><span class="s2">&#34;</span> <span class="s2">&#34;linux-lts linux-lts-headers linux-hardened linux-hardened-headers linux-zen linux-zen-headers&#34;</span> <span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;KERNELS_COMPRESSION&#34;</span> <span class="s2">&#34;</span><span class="nv">$KERNELS_COMPRESSION</span><span class="s2">&#34;</span> <span class="s2">&#34;gzip bzip2 lzma xz lzop lz4 zstd&#34;</span> <span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;DISPLAY_DRIVER&#34;</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER</span><span class="s2">&#34;</span> <span class="s2">&#34;intel amdgpu ati nvidia nvidia-lts nvidia-dkms nvidia-390xx nvidia-390xx-lts nvidia-390xx-dkms nouveau&#34;</span> <span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;KMS&#34;</span> <span class="s2">&#34;</span><span class="nv">$KMS</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;FASTBOOT&#34;</span> <span class="s2">&#34;</span><span class="nv">$FASTBOOT</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;FRAMEBUFFER_COMPRESSION&#34;</span> <span class="s2">&#34;</span><span class="nv">$FRAMEBUFFER_COMPRESSION</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;DISPLAY_DRIVER_DDX&#34;</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER_DDX</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;DISPLAY_DRIVER_HARDWARE_ACCELERATION&#34;</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER_HARDWARE_ACCELERATION</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;DISPLAY_DRIVER_HARDWARE_ACCELERATION_INTEL&#34;</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER_HARDWARE_ACCELERATION_INTEL</span><span class="s2">&#34;</span> <span class="s2">&#34;intel-media-driver libva-intel-driver&#34;</span> <span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;TIMEZONE&#34;</span> <span class="s2">&#34;</span><span class="nv">$TIMEZONE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;REFLECTOR&#34;</span> <span class="s2">&#34;</span><span class="nv">$REFLECTOR</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;PACMAN_MIRROR&#34;</span> <span class="s2">&#34;</span><span class="nv">$PACMAN_MIRROR</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;LOCALES&#34;</span> <span class="s2">&#34;</span><span class="nv">$LOCALES</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;LOCALE_CONF&#34;</span> <span class="s2">&#34;</span><span class="nv">$LOCALE_CONF</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;LANG&#34;</span> <span class="s2">&#34;</span><span class="nv">$LANG</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;KEYMAP&#34;</span> <span class="s2">&#34;</span><span class="nv">$KEYMAP</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;HOSTNAME&#34;</span> <span class="s2">&#34;</span><span class="nv">$HOSTNAME</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;USER_NAME&#34;</span> <span class="s2">&#34;</span><span class="nv">$USER_NAME</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;USER_PASSWORD&#34;</span> <span class="s2">&#34;</span><span class="nv">$USER_PASSWORD</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_equals <span class="s2">&#34;ROOT_PASSWORD&#34;</span> <span class="s2">&#34;ROOT_PASSWORD_RETYPE&#34;</span> <span class="s2">&#34;</span><span class="nv">$ROOT_PASSWORD</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$ROOT_PASSWORD_RETYPE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_equals <span class="s2">&#34;USER_PASSWORD&#34;</span> <span class="s2">&#34;USER_PASSWORD_RETYPE&#34;</span> <span class="s2">&#34;</span><span class="nv">$USER_PASSWORD</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$USER_PASSWORD_RETYPE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;SYSTEMD_HOMED&#34;</span> <span class="s2">&#34;</span><span class="nv">$SYSTEMD_HOMED</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$SYSTEMD_HOMED</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;SYSTEMD_HOMED_STORAGE&#34;</span> <span class="s2">&#34;</span><span class="nv">$SYSTEMD_HOMED_STORAGE</span><span class="s2">&#34;</span> <span class="s2">&#34;directory fscrypt luks cifs subvolume&#34;</span> <span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$SYSTEMD_HOMED_STORAGE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;fscrypt&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;FILE_SYSTEM_TYPE&#34;</span> <span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> <span class="s2">&#34;ext4 f2fs&#34;</span> <span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$SYSTEMD_HOMED_STORAGE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;cifs&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;SYSTEMD_HOMED_CIFS_DOMAIN&#34;</span> <span class="s2">&#34;</span><span class="nv">$SYSTEMD_HOMED_CIFS_DOMAIN</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;SYSTEMD_HOMED_CIFS_SERVICE&#34;</span> <span class="s2">&#34;</span><span class="nv">$SYSTEMD_HOMED_CIFS_SERVICE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;HOOKS&#34;</span> <span class="s2">&#34;</span><span class="nv">$HOOKS</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;BOOTLOADER&#34;</span> <span class="s2">&#34;</span><span class="nv">$BOOTLOADER</span><span class="s2">&#34;</span> <span class="s2">&#34;grub refind systemd&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;CUSTOM_SHELL&#34;</span> <span class="s2">&#34;</span><span class="nv">$CUSTOM_SHELL</span><span class="s2">&#34;</span> <span class="s2">&#34;bash zsh dash fish&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;DESKTOP_ENVIRONMENT&#34;</span> <span class="s2">&#34;</span><span class="nv">$DESKTOP_ENVIRONMENT</span><span class="s2">&#34;</span> <span class="s2">&#34;gnome kde xfce mate cinnamon lxde i3-wm i3-gaps&#34;</span> <span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;PACKAGES_MULTILIB&#34;</span> <span class="s2">&#34;</span><span class="nv">$PACKAGES_MULTILIB</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;PACKAGES_INSTALL&#34;</span> <span class="s2">&#34;</span><span class="nv">$PACKAGES_INSTALL</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;VAGRANT&#34;</span> <span class="s2">&#34;</span><span class="nv">$VAGRANT</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_boolean <span class="s2">&#34;REBOOT&#34;</span> <span class="s2">&#34;</span><span class="nv">$REBOOT</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> check_variables_value<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">NAME</span><span class="o">=</span><span class="nv">$1</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VALUE</span><span class="o">=</span><span class="nv">$2</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -z <span class="s2">&#34;</span><span class="nv">$VALUE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$NAME</span><span class="s2"> environment variable must have a value.&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exit</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> check_variables_boolean<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">NAME</span><span class="o">=</span><span class="nv">$1</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VALUE</span><span class="o">=</span><span class="nv">$2</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;</span><span class="nv">$NAME</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$VALUE</span><span class="s2">&#34;</span> <span class="s2">&#34;true false&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> check_variables_list<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">NAME</span><span class="o">=</span><span class="nv">$1</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VALUE</span><span class="o">=</span><span class="nv">$2</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VALUES</span><span class="o">=</span><span class="nv">$3</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">REQUIRED</span><span class="o">=</span><span class="nv">$4</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$REQUIRED</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;&#34;</span> -o <span class="s2">&#34;</span><span class="nv">$REQUIRED</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_value <span class="s2">&#34;</span><span class="nv">$NAME</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$VALUE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$VALUE</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;&#34;</span> -a -z <span class="s2">&#34;</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$VALUES</span><span class="s2">&#34;</span> <span class="p">|</span> grep -F -w <span class="s2">&#34;</span><span class="nv">$VALUE</span><span class="s2">&#34;</span><span class="k">)</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$NAME</span><span class="s2"> environment variable value [</span><span class="nv">$VALUE</span><span class="s2">] must be in [</span><span class="nv">$VALUES</span><span class="s2">].&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exit</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> check_variables_equals<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">NAME1</span><span class="o">=</span><span class="nv">$1</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">NAME2</span><span class="o">=</span><span class="nv">$2</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VALUE1</span><span class="o">=</span><span class="nv">$3</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VALUE2</span><span class="o">=</span><span class="nv">$4</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$VALUE1</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;</span><span class="nv">$VALUE2</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$NAME1</span><span class="s2"> and </span><span class="nv">$NAME2</span><span class="s2"> must be equal [</span><span class="nv">$VALUE1</span><span class="s2">, </span><span class="nv">$VALUE2</span><span class="s2">].&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exit</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> check_variables_size<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">NAME</span><span class="o">=</span><span class="nv">$1</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">SIZE_EXPECT</span><span class="o">=</span><span class="nv">$2</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">SIZE</span><span class="o">=</span><span class="nv">$3</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$SIZE_EXPECT</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;</span><span class="nv">$SIZE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$NAME</span><span class="s2"> array size [</span><span class="nv">$SIZE</span><span class="s2">] must be [</span><span class="nv">$SIZE_EXPECT</span><span class="s2">].&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exit</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> warning<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LIGHT_BLUE</span><span class="si">}</span><span class="s2">Welcome to Arch Linux Install Script</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">Warning&#34;</span><span class="s1">&#39;!&#39;</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">This script deletes all partitions of the persistent</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">storage and continuing all your data in it will be lost.</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">read</span> -p <span class="s2">&#34;Do you want to continue? [y/N] &#34;</span> yn&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="nv">$yn</span> in&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">[</span>Yy<span class="o">]</span>* <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">[</span>Nn<span class="o">]</span>* <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exit</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exit</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> init<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;print_step <span class="s2">&#34;init()&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;init_log&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;loadkeys <span class="nv">$KEYS</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> init_log<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LOG</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exec</span> &gt; &gt;<span class="o">(</span>tee -a <span class="nv">$LOG_FILE</span><span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exec</span> 2&gt; &gt;<span class="o">(</span>tee -a <span class="nv">$LOG_FILE</span> &gt;<span class="p">&amp;</span>2<span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">set</span> -o xtrace&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> facts<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;print_step <span class="s2">&#34;facts()&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -d /sys/firmware/efi <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">BIOS_TYPE</span><span class="o">=</span><span class="s2">&#34;uefi&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">BIOS_TYPE</span><span class="o">=</span><span class="s2">&#34;bios&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -f <span class="s2">&#34;</span><span class="nv">$ASCIINEMA_FILE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">ASCIINEMA</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">ASCIINEMA</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_SATA</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_NVME</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_MMC</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$DEVICE</span> <span class="p">|</span> grep <span class="s2">&#34;^/dev/[a-z]d[a-z]&#34;</span><span class="k">)</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_SATA</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">elif</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$DEVICE</span> <span class="p">|</span> grep <span class="s2">&#34;^/dev/nvme&#34;</span><span class="k">)</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_NVME</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">elif</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$DEVICE</span> <span class="p">|</span> grep <span class="s2">&#34;^/dev/mmc&#34;</span><span class="k">)</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_MMC</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="k">$(</span>lscpu <span class="p">|</span> grep GenuineIntel<span class="k">)</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CPU_VENDOR</span><span class="o">=</span><span class="s2">&#34;intel&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">elif</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="k">$(</span>lscpu <span class="p">|</span> grep AuthenticAMD<span class="k">)</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CPU_VENDOR</span><span class="o">=</span><span class="s2">&#34;amd&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="k">$(</span>lspci <span class="p">|</span> grep -i virtualbox<span class="k">)</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VIRTUALBOX</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> checks<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;print_step <span class="s2">&#34;checks()&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;check_facts&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> check_facts<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$BIOS_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;bios&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_variables_list <span class="s2">&#34;BOOTLOADER&#34;</span> <span class="s2">&#34;</span><span class="nv">$BOOTLOADER</span><span class="s2">&#34;</span> <span class="s2">&#34;grub&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> prepare<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;print_step <span class="s2">&#34;prepare()&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;configure_reflector&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;configure_time&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;prepare_partition&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;ask_passwords&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;configure_network&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> configure_reflector<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$REFLECTOR</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;false&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;systemctl stop reflector.service&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> configure_time<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;timedatectl set-ntp <span class="nb">true</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> prepare_partition<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -d /mnt/boot <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;umount /mnt/boot&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;umount /mnt&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -e <span class="s2">&#34;/dev/mapper/</span><span class="nv">$LVM_VOLUME_GROUP</span><span class="s2">-</span><span class="nv">$LVM_VOLUME_LOGICAL</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;umount <span class="s2">&#34;/dev/mapper/</span><span class="nv">$LVM_VOLUME_GROUP</span><span class="s2">-</span><span class="nv">$LVM_VOLUME_LOGICAL</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -e <span class="s2">&#34;/dev/mapper/</span><span class="nv">$LUKS_DEVICE_NAME</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cryptsetup close <span class="nv">$LUKS_DEVICE_NAME</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> ask_passwords<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LUKS_PASSWORD</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;ask&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PASSWORD_TYPED</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">while</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$PASSWORD_TYPED</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">read</span> -sp <span class="s1">&#39;Type LUKS password: &#39;</span> LUKS_PASSWORD&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">read</span> -sp <span class="s1">&#39;Retype LUKS password: &#39;</span> LUKS_PASSWORD_RETYPE&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LUKS_PASSWORD</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;</span><span class="nv">$LUKS_PASSWORD_RETYPE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PASSWORD_TYPED</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;LUKS password don&#39;t match. Please, type again.&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$WIFI_INTERFACE</span><span class="s2">&#34;</span> -a <span class="s2">&#34;</span><span class="nv">$WIFI_KEY</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;ask&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PASSWORD_TYPED</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">while</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$PASSWORD_TYPED</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">read</span> -sp <span class="s1">&#39;Type WIFI key: &#39;</span> WIFI_KEY&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">read</span> -sp <span class="s1">&#39;Retype WIFI key: &#39;</span> WIFI_KEY_RETYPE&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$WIFI_KEY</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;</span><span class="nv">$WIFI_KEY_RETYPE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PASSWORD_TYPED</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;WIFI key don&#39;t match. Please, type again.&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$ROOT_PASSWORD</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;ask&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PASSWORD_TYPED</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">while</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$PASSWORD_TYPED</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">read</span> -sp <span class="s1">&#39;Type root password: &#39;</span> ROOT_PASSWORD&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">read</span> -sp <span class="s1">&#39;Retype root password: &#39;</span> ROOT_PASSWORD_RETYPE&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$ROOT_PASSWORD</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;</span><span class="nv">$ROOT_PASSWORD_RETYPE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PASSWORD_TYPED</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;Root password don&#39;t match. Please, type again.&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$USER_PASSWORD</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;ask&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PASSWORD_TYPED</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">while</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$PASSWORD_TYPED</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">read</span> -sp <span class="s1">&#39;Type user password: &#39;</span> USER_PASSWORD&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">read</span> -sp <span class="s1">&#39;Retype user password: &#39;</span> USER_PASSWORD_RETYPE&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$USER_PASSWORD</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;</span><span class="nv">$USER_PASSWORD_RETYPE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PASSWORD_TYPED</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;User password don&#39;t match. Please, type again.&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> I in <span class="si">${</span><span class="p">!ADDITIONAL_USERS[@]</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">VALUE</span><span class="o">=</span><span class="si">${</span><span class="nv">ADDITIONAL_USERS</span><span class="p">[</span><span class="si">${</span><span class="nv">I</span><span class="si">}</span><span class="p">]</span><span class="si">}</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">IFS</span><span class="o">=</span><span class="s1">&#39;=&#39;</span> <span class="nv">S</span><span class="o">=(</span><span class="nv">$VALUE</span><span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">USER</span><span class="o">=</span><span class="si">${</span><span class="nv">S</span><span class="p">[0]</span><span class="si">}</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PASSWORD</span><span class="o">=</span><span class="si">${</span><span class="nv">S</span><span class="p">[1]</span><span class="si">}</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PASSWORD_RETYPE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$PASSWORD</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;ask&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PASSWORD_TYPED</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">while</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$PASSWORD_TYPED</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">read</span> -sp <span class="s2">&#34;Type user (</span><span class="nv">$USER</span><span class="s2">) password: &#34;</span> PASSWORD&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">read</span> -sp <span class="s2">&#34;Retype user (</span><span class="nv">$USER</span><span class="s2">) password: &#34;</span> PASSWORD_RETYPE&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$PASSWORD</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;</span><span class="nv">$PASSWORD_RETYPE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PASSWORD_TYPED</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDITIONAL_USERS<span class="o">[</span><span class="si">${</span><span class="nv">I</span><span class="si">}</span><span class="o">]=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">USER</span><span class="si">}</span><span class="s2">=</span><span class="si">${</span><span class="nv">PASSWORD</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;User (</span><span class="nv">$USER</span><span class="s2">) password don&#39;t match. Please, type again.&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> configure_network<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$WIFI_INTERFACE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iwctl --passphrase <span class="s2">&#34;</span><span class="nv">$WIFI_KEY</span><span class="s2">&#34;</span> station <span class="nv">$WIFI_INTERFACE</span> connect <span class="s2">&#34;</span><span class="nv">$WIFI_ESSID</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep <span class="m">10</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1"># only one ping -c 1, ping gets stuck if -c 5</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;ping -c <span class="m">1</span> -i <span class="m">2</span> -W <span class="m">5</span> -w <span class="m">30</span> <span class="nv">$PING_HOSTNAME</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -ne <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;Network ping check failed. Cannot continue.&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exit</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> partition<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;print_step <span class="s2">&#34;partition()&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;partprobe <span class="nv">$DEVICE</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1"># setup</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_MODE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;auto&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_PARTED_FILE_SYSTEM_TYPE</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_PARTED_FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;f2fs&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_PARTED_FILE_SYSTEM_TYPE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_PARTED_UEFI</span><span class="o">=</span><span class="s2">&#34;mklabel gpt mkpart ESP fat32 1MiB 512MiB mkpart root </span><span class="nv">$PARTITION_PARTED_FILE_SYSTEM_TYPE</span><span class="s2"> 512MiB 100% set 1 esp on&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_PARTED_BIOS</span><span class="o">=</span><span class="s2">&#34;mklabel msdos mkpart primary ext4 4MiB 512MiB mkpart primary </span><span class="nv">$PARTITION_PARTED_FILE_SYSTEM_TYPE</span><span class="s2"> 512MiB 100% set 1 boot on&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$BIOS_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;uefi&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_SATA</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_BOOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">1&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">2&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">2&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_NVME</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_BOOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p1&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p2&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p2&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_MMC</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_BOOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p1&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p2&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p2&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$BIOS_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;bios&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_SATA</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_BOOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">1&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">2&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">2&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_NVME</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_BOOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p1&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p2&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p2&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_MMC</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_BOOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p1&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p2&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DEVICE</span><span class="si">}</span><span class="s2">p2&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_MODE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;custom&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_PARTED_UEFI</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$PARTITION_CUSTOM_PARTED_UEFI</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_PARTED_BIOS</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$PARTITION_CUSTOM_PARTED_BIOS</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_MODE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;custom&#34;</span> -o <span class="s2">&#34;</span><span class="nv">$PARTITION_MODE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;manual&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_BOOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$PARTITION_CUSTOMMANUAL_BOOT</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$PARTITION_CUSTOMMANUAL_ROOT</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">PARTITION_ROOT</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_BOOT_NUMBER</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$PARTITION_BOOT</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_ROOT_NUMBER</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$PARTITION_ROOT</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_BOOT_NUMBER</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">PARTITION_BOOT_NUMBER</span><span class="p">//</span><span class="se">\/</span><span class="nv">dev</span><span class="se">\/</span><span class="nv">sda</span><span class="p">/</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_BOOT_NUMBER</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">PARTITION_BOOT_NUMBER</span><span class="p">//</span><span class="se">\/</span><span class="nv">dev</span><span class="se">\/</span><span class="nv">nvme0n1p</span><span class="p">/</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_BOOT_NUMBER</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">PARTITION_BOOT_NUMBER</span><span class="p">//</span><span class="se">\/</span><span class="nv">dev</span><span class="se">\/</span><span class="nv">mmcblk0p</span><span class="p">/</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_ROOT_NUMBER</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">PARTITION_ROOT_NUMBER</span><span class="p">//</span><span class="se">\/</span><span class="nv">dev</span><span class="se">\/</span><span class="nv">sda</span><span class="p">/</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_ROOT_NUMBER</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">PARTITION_ROOT_NUMBER</span><span class="p">//</span><span class="se">\/</span><span class="nv">dev</span><span class="se">\/</span><span class="nv">nvme0n1p</span><span class="p">/</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_ROOT_NUMBER</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">PARTITION_ROOT_NUMBER</span><span class="p">//</span><span class="se">\/</span><span class="nv">dev</span><span class="se">\/</span><span class="nv">mmcblk0p</span><span class="p">/</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1"># partition</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_MODE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;auto&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sgdisk --zap-all <span class="nv">$DEVICE</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wipefs -a -f <span class="nv">$DEVICE</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;partprobe <span class="nv">$DEVICE</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_MODE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;auto&#34;</span> -o <span class="s2">&#34;</span><span class="nv">$PARTITION_MODE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;custom&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$BIOS_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;uefi&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parted -s <span class="nv">$DEVICE</span> <span class="nv">$PARTITION_PARTED_UEFI</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$LUKS_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sgdisk -t<span class="o">=</span><span class="nv">$PARTITION_ROOT_NUMBER</span>:8309 <span class="nv">$DEVICE</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LVM</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sgdisk -t<span class="o">=</span><span class="nv">$PARTITION_ROOT_NUMBER</span>:8e00 <span class="nv">$DEVICE</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$BIOS_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;bios&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parted -s <span class="nv">$DEVICE</span> <span class="nv">$PARTITION_PARTED_BIOS</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;partprobe <span class="nv">$DEVICE</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1"># luks and lvm</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$LUKS_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -n <span class="s2">&#34;</span><span class="nv">$LUKS_PASSWORD</span><span class="s2">&#34;</span> <span class="p">|</span> cryptsetup --key-size<span class="o">=</span><span class="m">512</span> --key-file<span class="o">=</span>- luksFormat --type luks2 <span class="nv">$PARTITION_ROOT</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -n <span class="s2">&#34;</span><span class="nv">$LUKS_PASSWORD</span><span class="s2">&#34;</span> <span class="p">|</span> cryptsetup --key-file<span class="o">=</span>- open <span class="nv">$PARTITION_ROOT</span> <span class="nv">$LUKS_DEVICE_NAME</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep <span class="m">5</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LVM</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$LUKS_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_LVM</span><span class="o">=</span><span class="s2">&#34;/dev/mapper/</span><span class="nv">$LUKS_DEVICE_NAME</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_LVM</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$DEVICE_ROOT</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pvcreate <span class="nv">$DEVICE_LVM</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vgcreate <span class="nv">$LVM_VOLUME_GROUP</span> <span class="nv">$DEVICE_LVM</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lvcreate -l 100%FREE -n <span class="nv">$LVM_VOLUME_LOGICAL</span> <span class="nv">$LVM_VOLUME_GROUP</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$LUKS_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_ROOT</span><span class="o">=</span><span class="s2">&#34;/dev/mapper/</span><span class="nv">$LUKS_DEVICE_NAME</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LVM</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">DEVICE_ROOT</span><span class="o">=</span><span class="s2">&#34;/dev/mapper/</span><span class="nv">$LVM_VOLUME_GROUP</span><span class="s2">-</span><span class="nv">$LVM_VOLUME_LOGICAL</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1"># format</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;wipefs -a -f <span class="nv">$PARTITION_BOOT</span> <span class="o">||</span> <span class="nb">true</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;wipefs -a -f <span class="nv">$DEVICE_ROOT</span> <span class="o">||</span> <span class="nb">true</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$BIOS_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;uefi&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkfs.fat -n ESP -F32 <span class="nv">$PARTITION_BOOT</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$BIOS_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;bios&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkfs.ext4 -L boot <span class="nv">$PARTITION_BOOT</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;f2fs&#34;</span> -o <span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;reiserfs&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkfs.<span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> -l root <span class="nv">$DEVICE_ROOT</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkfs.<span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> -L root <span class="nv">$DEVICE_ROOT</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1"># options</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_OPTIONS_BOOT</span><span class="o">=</span><span class="s2">&#34;defaults&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_OPTIONS_ROOT</span><span class="o">=</span><span class="s2">&#34;defaults&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_TRIM</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_OPTIONS_BOOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$PARTITION_OPTIONS_BOOT</span><span class="s2">,noatime&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_OPTIONS_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$PARTITION_OPTIONS_ROOT</span><span class="s2">,noatime&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;f2fs&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTITION_OPTIONS_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$PARTITION_OPTIONS_ROOT</span><span class="s2">,nodiscard&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1"># mount</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;btrfs&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mount -o <span class="s2">&#34;</span><span class="nv">$PARTITION_OPTIONS</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_ROOT</span><span class="s2">&#34;</span> /mnt&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btrfs subvolume create /mnt/root&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btrfs subvolume create /mnt/home&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btrfs subvolume create /mnt/var&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btrfs subvolume create /mnt/snapshots&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;umount /mnt&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mount -o <span class="s2">&#34;subvol=root,</span><span class="nv">$PARTITION_OPTIONS</span><span class="s2">,compress=zstd&#34;</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_ROOT</span><span class="s2">&#34;</span> /mnt&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkdir /mnt/<span class="o">{</span>boot,home,var,snapshots<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mount -o <span class="s2">&#34;</span><span class="nv">$PARTITION_OPTIONS_BOOT</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_BOOT</span><span class="s2">&#34;</span> /mnt/boot&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mount -o <span class="s2">&#34;subvol=home,</span><span class="nv">$PARTITION_OPTIONS_ROOT</span><span class="s2">,compress=zstd&#34;</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_ROOT</span><span class="s2">&#34;</span> /mnt/home&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mount -o <span class="s2">&#34;subvol=var,</span><span class="nv">$PARTITION_OPTIONS_ROOT</span><span class="s2">,compress=zstd&#34;</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_ROOT</span><span class="s2">&#34;</span> /mnt/var&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mount -o <span class="s2">&#34;subvol=snapshots,</span><span class="nv">$PARTITION_OPTIONS_ROOT</span><span class="s2">,compress=zstd&#34;</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_ROOT</span><span class="s2">&#34;</span> /mnt/snapshots&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mount -o <span class="s2">&#34;</span><span class="nv">$PARTITION_OPTIONS_ROOT</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_ROOT</span><span class="s2">&#34;</span> /mnt&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkdir /mnt/boot&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mount -o <span class="s2">&#34;</span><span class="nv">$PARTITION_OPTIONS_BOOT</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$PARTITION_BOOT</span><span class="s2">&#34;</span> /mnt/boot&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1"># swap</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SWAP_SIZE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;btrfs&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;truncate -s <span class="m">0</span> /mnt<span class="nv">$SWAPFILE</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chattr +C /mnt<span class="nv">$SWAPFILE</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btrfs property <span class="nb">set</span> /mnt<span class="nv">$SWAPFILE</span> compression none&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dd <span class="k">if</span><span class="o">=</span>/dev/zero <span class="nv">of</span><span class="o">=</span>/mnt<span class="nv">$SWAPFILE</span> <span class="nv">bs</span><span class="o">=</span>1M <span class="nv">count</span><span class="o">=</span><span class="nv">$SWAP_SIZE</span> <span class="nv">status</span><span class="o">=</span>progress&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chmod <span class="m">600</span> /mnt<span class="nv">$SWAPFILE</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkswap /mnt<span class="nv">$SWAPFILE</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1"># set variables</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">BOOT_DIRECTORY</span><span class="o">=</span>/boot&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">ESP_DIRECTORY</span><span class="o">=</span>/boot&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">UUID_BOOT</span><span class="o">=</span><span class="k">$(</span>blkid -s UUID -o value <span class="nv">$PARTITION_BOOT</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">UUID_ROOT</span><span class="o">=</span><span class="k">$(</span>blkid -s UUID -o value <span class="nv">$PARTITION_ROOT</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTUUID_BOOT</span><span class="o">=</span><span class="k">$(</span>blkid -s PARTUUID -o value <span class="nv">$PARTITION_BOOT</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PARTUUID_ROOT</span><span class="o">=</span><span class="k">$(</span>blkid -s PARTUUID -o value <span class="nv">$PARTITION_ROOT</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> install<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;print_step <span class="s2">&#34;install()&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$PACMAN_MIRROR</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;Server = </span><span class="nv">$PACMAN_MIRROR</span><span class="s2">&#34;</span> &gt; /etc/pacman.d/mirrorlist&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$REFLECTOR</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">COUNTRIES</span><span class="o">=()</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> COUNTRY in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">REFLECTOR_COUNTRIES</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">COUNTRIES</span><span class="o">+=(</span>--country <span class="s2">&#34;</span><span class="si">${</span><span class="nv">COUNTRY</span><span class="si">}</span><span class="s2">&#34;</span><span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman -Sy --noconfirm reflector&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reflector <span class="s2">&#34;</span><span class="si">${</span><span class="nv">COUNTRIES</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span> --latest <span class="m">25</span> --age <span class="m">24</span> --protocol https --completion-percent <span class="m">100</span> --sort rate --save /etc/pacman.d/mirrorlist&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s1">&#39;s/#Color/Color/&#39;</span> /etc/pacman.conf&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s1">&#39;s/#ParallelDownloads/ParallelDownloads/&#39;</span> /etc/pacman.conf&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;pacstrap /mnt base base-devel linux linux-firmware&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s1">&#39;s/#Color/Color/&#39;</span> /mnt/etc/pacman.conf&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s1">&#39;s/#ParallelDownloads/ParallelDownloads/&#39;</span> /mnt/etc/pacman.conf&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$PACKAGES_MULTILIB</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span> &gt;&gt; /mnt/etc/pacman.conf&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;[multilib]&#34;</span> &gt;&gt; /mnt/etc/pacman.conf&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;Include = /etc/pacman.d/mirrorlist&#34;</span> &gt;&gt; /mnt/etc/pacman.conf&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span> &gt;&gt; /mnt/etc/pacman.conf&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> configuration<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;print_step <span class="s2">&#34;configuration()&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;genfstab -U /mnt &gt;&gt; /mnt/etc/fstab&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SWAP_SIZE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;# swap&#34;</span> &gt;&gt; /mnt/etc/fstab&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$SWAPFILE</span><span class="s2"> none swap defaults 0 0&#34;</span> &gt;&gt; /mnt/etc/fstab&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span> &gt;&gt; /mnt/etc/fstab&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_TRIM</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;f2fs&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s1">&#39;s/relatime/noatime,nodiscard/&#39;</span> /mnt/etc/fstab&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s1">&#39;s/relatime/noatime/&#39;</span> /mnt/etc/fstab&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> fstrim.timer&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt ln -s -f <span class="nv">$TIMEZONE</span> /etc/localtime&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt hwclock --systohc&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> LOCALE in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LOCALES</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s2">&#34;s/#</span><span class="nv">$LOCALE</span><span class="s2">/</span><span class="nv">$LOCALE</span><span class="s2">/&#34;</span> /etc/locale.gen&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s2">&#34;s/#</span><span class="nv">$LOCALE</span><span class="s2">/</span><span class="nv">$LOCALE</span><span class="s2">/&#34;</span> /mnt/etc/locale.gen&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> VARIABLE in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LOCALE_CONF</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">#localectl set-locale &#34;$VARIABLE&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$VARIABLE</span><span class="s2">&#34;</span> &gt;&gt; /mnt/etc/locale.conf&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;locale-gen&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt locale-gen&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$KEYMAP</span><span class="s2">\n</span><span class="nv">$FONT</span><span class="s2">\n</span><span class="nv">$FONT_MAP</span><span class="s2">&#34;</span> &gt; /mnt/etc/vconsole.conf&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="nv">$HOSTNAME</span> &gt; /mnt/etc/hostname&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">OPTIONS</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$KEYLAYOUT</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">OPTIONS</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$OPTIONS</span><span class="s2">&#34;</span><span class="s1">$&#39;\n&#39;</span><span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;Option \&#34;XkbLayout\&#34; \&#34;</span><span class="nv">$KEYLAYOUT</span><span class="s2">\&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$KEYMODEL</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">OPTIONS</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$OPTIONS</span><span class="s2">&#34;</span><span class="s1">$&#39;\n&#39;</span><span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;Option \&#34;XkbModel\&#34; \&#34;</span><span class="nv">$KEYMODEL</span><span class="s2">\&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$KEYVARIANT</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">OPTIONS</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$OPTIONS</span><span class="s2">&#34;</span><span class="s1">$&#39;\n&#39;</span><span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;Option \&#34;XkbVariant\&#34; \&#34;</span><span class="nv">$KEYVARIANT</span><span class="s2">\&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$KEYOPTIONS</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">OPTIONS</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$OPTIONS</span><span class="s2">&#34;</span><span class="s1">$&#39;\n&#39;</span><span class="s2">&#34;&nbsp;&nbsp;&nbsp;&nbsp;Option \&#34;XkbOptions\&#34; \&#34;</span><span class="nv">$KEYOPTIONS</span><span class="s2">\&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt mkdir -p <span class="s2">&#34;/etc/X11/xorg.conf.d/&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;cat <span class="s">&lt;&lt;EOT &gt; /mnt/etc/X11/xorg.conf.d/00-keyboard.conf&#10;</span></span></span><span class="line"><span class="cl"><span class="s"># Written by systemd-localed(8), read by systemd-localed and Xorg. It&#39;s&#10;</span></span></span><span class="line"><span class="cl"><span class="s"># probably wise not to edit this file manually. Use localectl(1) to&#10;</span></span></span><span class="line"><span class="cl"><span class="s"># instruct systemd-localed to update it.&#10;</span></span></span><span class="line"><span class="cl"><span class="s">Section &#34;InputClass&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;Identifier &#34;system-keyboard&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;MatchIsKeyboard &#34;on&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;$OPTIONS&#10;</span></span></span><span class="line"><span class="cl"><span class="s">EndSection&#10;</span></span></span><span class="line"><span class="cl"><span class="s">EOT</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SWAP_SIZE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;vm.swappiness=10&#34;</span> &gt; /mnt/etc/sysctl.d/99-sysctl.conf&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">printf</span> <span class="s2">&#34;</span><span class="nv">$ROOT_PASSWORD</span><span class="s2">\n</span><span class="nv">$ROOT_PASSWORD</span><span class="s2">&#34;</span> <span class="p">|</span> arch-chroot /mnt passwd&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> mkinitcpio_configuration<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;print_step <span class="s2">&#34;mkinitcpio_configuration()&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$KMS</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">MODULES</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER</span><span class="s2">&#34;</span> in&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;intel&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">MODULES</span><span class="o">=</span><span class="s2">&#34;i915&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia&#34;</span> <span class="p">|</span> <span class="s2">&#34;nvidia-lts&#34;</span>  <span class="p">|</span> <span class="s2">&#34;nvidia-dkms&#34;</span> <span class="p">|</span> <span class="s2">&#34;nvidia-390xx&#34;</span> <span class="p">|</span> <span class="s2">&#34;nvidia-390xx-lts&#34;</span> <span class="p">|</span> <span class="s2">&#34;nvidia-390xx-dkms&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">MODULES</span><span class="o">=</span><span class="s2">&#34;nvidia nvidia_modeset nvidia_uvm nvidia_drm&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;amdgpu&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">MODULES</span><span class="o">=</span><span class="s2">&#34;amdgpu&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;ati&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">MODULES</span><span class="o">=</span><span class="s2">&#34;radeon&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nouveau&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">MODULES</span><span class="o">=</span><span class="s2">&#34;nouveau&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s2">&#34;s/^MODULES=()/MODULES=(</span><span class="nv">$MODULES</span><span class="s2">)/&#34;</span> /etc/mkinitcpio.conf&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;intel&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">OPTIONS</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$FASTBOOT</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">OPTIONS</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$OPTIONS</span><span class="s2"> fastboot=1&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$FRAMEBUFFER_COMPRESSION</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">OPTIONS</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$OPTIONS</span><span class="s2"> enable_fbc=1&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$OPTIONS</span><span class="s2">&#34;</span><span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;options i915 </span><span class="nv">$OPTIONS</span><span class="s2">&#34;</span> &gt; /mnt/etc/modprobe.d/i915.conf&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LVM</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;lvm2&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;btrfs&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;btrfs-progs&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;f2fs&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;f2fs-tools&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;reiserfs&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;reiserfsprogs&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$BOOTLOADER</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;systemd&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">HOOKS</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$HOOKS</span> <span class="p">|</span> sed <span class="s1">&#39;s/!systemd/systemd/&#39;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">HOOKS</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$HOOKS</span> <span class="p">|</span> sed <span class="s1">&#39;s/!sd-vconsole/sd-vconsole/&#39;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LVM</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">HOOKS</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$HOOKS</span> <span class="p">|</span> sed <span class="s1">&#39;s/!sd-lvm2/sd-lvm2/&#39;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$LUKS_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">HOOKS</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$HOOKS</span> <span class="p">|</span> sed <span class="s1">&#39;s/!sd-encrypt/sd-encrypt/&#39;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">HOOKS</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$HOOKS</span> <span class="p">|</span> sed <span class="s1">&#39;s/!udev/udev/&#39;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">HOOKS</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$HOOKS</span> <span class="p">|</span> sed <span class="s1">&#39;s/!usr/usr/&#39;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">HOOKS</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$HOOKS</span> <span class="p">|</span> sed <span class="s1">&#39;s/!keymap/keymap/&#39;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">HOOKS</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$HOOKS</span> <span class="p">|</span> sed <span class="s1">&#39;s/!consolefont/consolefont/&#39;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LVM</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">HOOKS</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$HOOKS</span> <span class="p">|</span> sed <span class="s1">&#39;s/!lvm2/lvm2/&#39;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$LUKS_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">HOOKS</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$HOOKS</span> <span class="p">|</span> sed <span class="s1">&#39;s/!encrypt/encrypt/&#39;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">HOOKS</span><span class="o">=</span><span class="k">$(</span>sanitize_variable <span class="s2">&#34;</span><span class="nv">$HOOKS</span><span class="s2">&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s2">&#34;s/^HOOKS=(.*)</span>$<span class="s2">/HOOKS=(</span><span class="nv">$HOOKS</span><span class="s2">)/&#34;</span> /etc/mkinitcpio.conf&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$KERNELS_COMPRESSION</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/^#COMPRESSION=&#34;&#39;</span><span class="s2">&#34;</span><span class="nv">$KERNELS_COMPRESSION</span><span class="s2">&#34;</span><span class="s1">&#39;&#34;/COMPRESSION=&#34;&#39;</span><span class="s2">&#34;</span><span class="nv">$KERNELS_COMPRESSION</span><span class="s2">&#34;</span><span class="s1">&#39;&#34;/&#39;</span> /etc/mkinitcpio.conf&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$KERNELS_COMPRESSION</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;bzip2&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;bzip2&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$KERNELS_COMPRESSION</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;lzma&#34;</span> -o <span class="s2">&#34;</span><span class="nv">$KERNELS_COMPRESSION</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;xz&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;xz&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$KERNELS_COMPRESSION</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;lzop&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;lzop&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$KERNELS_COMPRESSION</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;lz4&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;lz4&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$KERNELS_COMPRESSION</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;zstd&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;zstd&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> display_driver<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;print_step <span class="s2">&#34;display_driver()&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER_MULTILIB</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DDX</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN_MULTILIB</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION_MULTILIB</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER</span><span class="s2">&#34;</span> in&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;intel&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-mesa&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;amdgpu&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-mesa&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;ati&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-mesa&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER</span><span class="o">=</span><span class="s2">&#34;nvidia&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-nvidia-utils&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-lts&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER</span><span class="o">=</span><span class="s2">&#34;nvidia-lts&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-nvidia-utils&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-dkms&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER</span><span class="o">=</span><span class="s2">&#34;nvidia-dkms&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-nvidia-utils&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-390xx&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER</span><span class="o">=</span><span class="s2">&#34;nvidia-390xx&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER_MULTILIB</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-390xx-lts&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER</span><span class="o">=</span><span class="s2">&#34;nvidia-390xx-lts&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER_MULTILIB</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-390xx-dkms&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER</span><span class="o">=</span><span class="s2">&#34;nvidia-390xx-dkms&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER_MULTILIB</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nouveau&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DRIVER_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-mesa&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER_DDX</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER</span><span class="s2">&#34;</span> in&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;intel&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DDX</span><span class="o">=</span><span class="s2">&#34;xf86-video-intel&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;amdgpu&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DDX</span><span class="o">=</span><span class="s2">&#34;xf86-video-amdgpu&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;ati&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DDX</span><span class="o">=</span><span class="s2">&#34;xf86-video-ati&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nouveau&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_DDX</span><span class="o">=</span><span class="s2">&#34;xf86-video-nouveau&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$VULKAN</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER</span><span class="s2">&#34;</span> in&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;intel&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN</span><span class="o">=</span><span class="s2">&#34;vulkan-icd-loader vulkan-intel&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-vulkan-icd-loader lib32-vulkan-intel&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;amdgpu&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN</span><span class="o">=</span><span class="s2">&#34;vulkan-radeon&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-vulkan-radeon&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;ati&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN</span><span class="o">=</span><span class="s2">&#34;vulkan-radeon&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-vulkan-radeon&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN</span><span class="o">=</span><span class="s2">&#34;nvidia-utils&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-nvidia-utils&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-lts&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN</span><span class="o">=</span><span class="s2">&#34;nvidia-utils&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-nvidia-utils&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-dkms&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN</span><span class="o">=</span><span class="s2">&#34;nvidia-utils&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-nvidia-utils&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-390xx&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN</span><span class="o">=</span><span class="s2">&#34;nvidia-utils&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN_MULTILIB</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-390xx-lts&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN</span><span class="o">=</span><span class="s2">&#34;nvidia-utils&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN_MULTILIB</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-390xx-dkms&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN</span><span class="o">=</span><span class="s2">&#34;nvidia-utils&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN_MULTILIB</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nouveau&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_VULKAN_MULTILIB</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER_HARDWARE_ACCELERATION</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER</span><span class="s2">&#34;</span> in&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;intel&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER_HARDWARE_ACCELERATION_INTEL</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="nv">$DISPLAY_DRIVER_HARDWARE_ACCELERATION_INTEL</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION_MULTILIB</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;amdgpu&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="s2">&#34;libva-mesa-driver&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-libva-mesa-driver&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;ati&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="s2">&#34;mesa-vdpau&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-mesa-vdpau&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="s2">&#34;libva-mesa-driver&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-libva-mesa-driver&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-lts&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="s2">&#34;libva-mesa-driver&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-libva-mesa-driver&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-dkms&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="s2">&#34;libva-mesa-driver&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-libva-mesa-driver&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-390xx&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="s2">&#34;libva-mesa-driver&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-libva-mesa-driver&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-390xx-lts&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="s2">&#34;libva-mesa-driver&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-libva-mesa-driver&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia-390xx-dkms&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="s2">&#34;libva-mesa-driver&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-libva-mesa-driver&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nouveau&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION</span><span class="o">=</span><span class="s2">&#34;libva-mesa-driver&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PACKAGES_HARDWARE_ACCELERATION_MULTILIB</span><span class="o">=</span><span class="s2">&#34;lib32-libva-mesa-driver&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;mesa </span><span class="nv">$PACKAGES_DRIVER</span><span class="s2"> </span><span class="nv">$PACKAGES_DDX</span><span class="s2"> </span><span class="nv">$PACKAGES_VULKAN</span><span class="s2"> </span><span class="nv">$PACKAGES_HARDWARE_ACCELERATION</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$PACKAGES_MULTILIB</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;</span><span class="nv">$PACKAGES_DRIVER_MULTILIB</span><span class="s2"> </span><span class="nv">$PACKAGES_VULKAN_MULTILIB</span><span class="s2"> </span><span class="nv">$PACKAGES_HARDWARE_ACCELERATION_MULTILIB</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> kernels<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;print_step <span class="s2">&#34;kernels()&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;linux-headers&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$KERNELS</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;</span><span class="nv">$KERNELS</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> mkinitcpio<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;print_step <span class="s2">&#34;mkinitcpio()&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt mkinitcpio -P&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> network<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;print_step <span class="s2">&#34;network()&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;networkmanager&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> NetworkManager.service&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> virtualbox<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;print_step <span class="s2">&#34;virtualbox()&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -z <span class="s2">&#34;</span><span class="nv">$KERNELS</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;virtualbox-guest-utils&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;virtualbox-guest-utils virtualbox-guest-dkms&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> users<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;print_step <span class="s2">&#34;users()&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;create_user <span class="s2">&#34;</span><span class="nv">$USER_NAME</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$USER_PASSWORD</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> U in <span class="si">${</span><span class="nv">ADDITIONAL_USERS</span><span class="p">[@]</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">IFS</span><span class="o">=</span><span class="s1">&#39;=&#39;</span> <span class="nv">S</span><span class="o">=(</span><span class="si">${</span><span class="nv">U</span><span class="si">}</span><span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">USER</span><span class="o">=</span><span class="si">${</span><span class="nv">S</span><span class="p">[0]</span><span class="si">}</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PASSWORD</span><span class="o">=</span><span class="si">${</span><span class="nv">S</span><span class="p">[1]</span><span class="si">}</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;create_user <span class="s2">&#34;</span><span class="si">${</span><span class="nv">USER</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">PASSWORD</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">	arch-chroot /mnt sed -i <span class="s1">&#39;s/# %wheel ALL=(ALL) ALL/%wheel ALL=(ALL) ALL/&#39;</span> /etc/sudoers&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;xdg-user-dirs&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$SYSTEMD_HOMED</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cat <span class="s">&lt;&lt;EOT &gt; &#34;/mnt/etc/pam.d/nss-auth&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">#%PAM-1.0&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&#10;</span></span></span><span class="line"><span class="cl"><span class="s">auth&nbsp;&nbsp;&nbsp;&nbsp; sufficient pam_unix.so try_first_pass nullok&#10;</span></span></span><span class="line"><span class="cl"><span class="s">auth&nbsp;&nbsp;&nbsp;&nbsp; sufficient pam_systemd_home.so&#10;</span></span></span><span class="line"><span class="cl"><span class="s">auth&nbsp;&nbsp;&nbsp;&nbsp; required   pam_deny.so&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&#10;</span></span></span><span class="line"><span class="cl"><span class="s">account  sufficient pam_unix.so&#10;</span></span></span><span class="line"><span class="cl"><span class="s">account  sufficient pam_systemd_home.so&#10;</span></span></span><span class="line"><span class="cl"><span class="s">account  required   pam_deny.so&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&#10;</span></span></span><span class="line"><span class="cl"><span class="s">password sufficient pam_unix.so try_first_pass nullok sha512 shadow&#10;</span></span></span><span class="line"><span class="cl"><span class="s">password sufficient pam_systemd_home.so&#10;</span></span></span><span class="line"><span class="cl"><span class="s">password required   pam_deny.so&#10;</span></span></span><span class="line"><span class="cl"><span class="s">EOT</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cat <span class="s">&lt;&lt;EOT &gt; &#34;/mnt/etc/pam.d/system-auth&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">#%PAM-1.0&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&#10;</span></span></span><span class="line"><span class="cl"><span class="s">auth&nbsp;&nbsp;&nbsp;&nbsp;  substack   nss-auth&#10;</span></span></span><span class="line"><span class="cl"><span class="s">auth&nbsp;&nbsp;&nbsp;&nbsp;  optional   pam_permit.so&#10;</span></span></span><span class="line"><span class="cl"><span class="s">auth&nbsp;&nbsp;&nbsp;&nbsp;  required   pam_env.so&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&#10;</span></span></span><span class="line"><span class="cl"><span class="s">account   substack   nss-auth&#10;</span></span></span><span class="line"><span class="cl"><span class="s">account   optional   pam_permit.so&#10;</span></span></span><span class="line"><span class="cl"><span class="s">account   required   pam_time.so&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&#10;</span></span></span><span class="line"><span class="cl"><span class="s">password  substack   nss-auth&#10;</span></span></span><span class="line"><span class="cl"><span class="s">password  optional   pam_permit.so&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&#10;</span></span></span><span class="line"><span class="cl"><span class="s">session   required  pam_limits.so&#10;</span></span></span><span class="line"><span class="cl"><span class="s">session   optional  pam_systemd_home.so&#10;</span></span></span><span class="line"><span class="cl"><span class="s">session   required  pam_unix.so&#10;</span></span></span><span class="line"><span class="cl"><span class="s">session   optional  pam_permit.so&#10;</span></span></span><span class="line"><span class="cl"><span class="s">EOT</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> create_user<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">USER</span><span class="o">=</span><span class="nv">$1</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PASSWORD</span><span class="o">=</span><span class="nv">$2</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$SYSTEMD_HOMED</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> systemd-homed.service&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;create_user_homectl <span class="nv">$USER</span> <span class="nv">$PASSWORD</span>&#10;</span></span><span class="line"><span class="cl"><span class="c1">#&nbsp;&nbsp;&nbsp;&nbsp;   create_user_useradd $USER $PASSWORD</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;create_user_useradd <span class="nv">$USER</span> <span class="nv">$PASSWORD</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> create_user_homectl<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">USER</span><span class="o">=</span><span class="nv">$1</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PASSWORD</span><span class="o">=</span><span class="nv">$2</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">STORAGE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CIFS_DOMAIN</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CIFS_USERNAME</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CIFS_SERVICE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">TZ</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="si">${</span><span class="nv">TIMEZONE</span><span class="si">}</span> <span class="p">|</span> sed <span class="s2">&#34;s/\/usr\/share\/zoneinfo\///g&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">L</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="si">${</span><span class="nv">LOCALE_CONF</span><span class="p">[0]</span><span class="si">}</span> <span class="p">|</span> sed <span class="s2">&#34;s/LANG=//g&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">IMAGE_PATH</span><span class="o">=</span><span class="s2">&#34;/home/</span><span class="nv">$USER</span><span class="s2">.homedir&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">HOME_PATH</span><span class="o">=</span><span class="s2">&#34;/home/</span><span class="nv">$USER</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_HOMED_STORAGE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">STORAGE</span><span class="o">=</span><span class="s2">&#34;--storage=</span><span class="nv">$SYSTEMD_HOMED_STORAGE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$SYSTEMD_HOMED_STORAGE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;cifs&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CIFS_DOMAIN</span><span class="o">=</span><span class="s2">&#34;--cifs-domain=</span><span class="nv">$SYSTEMD_HOMED_CIFS_DOMAIN</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CIFS_USERNAME</span><span class="o">=</span><span class="s2">&#34;--cifs-user-name=</span><span class="nv">$USER</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CIFS_SERVICE</span><span class="o">=</span><span class="s2">&#34;--cifs-service=</span><span class="nv">$SYSTEMD_HOMED_CIFS_SERVICE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$SYSTEMD_HOMED_STORAGE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;luks&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">IMAGE_PATH</span><span class="o">=</span><span class="s2">&#34;/home/</span><span class="nv">$USER</span><span class="s2">.home&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">### something missing, inside alis this not works, after install the user is in state infixated</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">### after install and reboot this commands work</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;systemctl start systemd-homed.service&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">set</span> +e&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;homectl create <span class="s2">&#34;</span><span class="nv">$USER</span><span class="s2">&#34;</span> --enforce-password-policy<span class="o">=</span>no --timezone<span class="o">=</span><span class="nv">$TZ</span> --language<span class="o">=</span><span class="nv">$L</span> <span class="nv">$STORAGE</span> <span class="nv">$CIFS_DOMAIN</span> <span class="nv">$CIFS_USERNAME</span> <span class="nv">$CIFS_SERVICE</span> -G wheel,storage,optical&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;homectl activate <span class="s2">&#34;</span><span class="nv">$USER</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">set</span> -e&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;cp -a <span class="s2">&#34;</span><span class="nv">$IMAGE_PATH</span><span class="s2">/.&#34;</span> <span class="s2">&#34;/mnt</span><span class="nv">$IMAGE_PATH</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;cp -a <span class="s2">&#34;</span><span class="nv">$HOME_PATH</span><span class="s2">/.&#34;</span> <span class="s2">&#34;/mnt</span><span class="nv">$HOME_PATH</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;cp -a <span class="s2">&#34;/var/lib/systemd/home/.&#34;</span> <span class="s2">&#34;/mnt/var/lib/systemd/home/&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> create_user_useradd<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">USER</span><span class="o">=</span><span class="nv">$1</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">PASSWORD</span><span class="o">=</span><span class="nv">$2</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt useradd -m -G wheel,storage,optical -s /bin/bash <span class="nv">$USER</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">printf</span> <span class="s2">&#34;</span><span class="nv">$PASSWORD</span><span class="s2">\n</span><span class="nv">$PASSWORD</span><span class="s2">&#34;</span> <span class="p">|</span> arch-chroot /mnt passwd <span class="nv">$USER</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> bootloader<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;print_step <span class="s2">&#34;bootloader()&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">BOOTLOADER_ALLOW_DISCARDS</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$VIRTUALBOX</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$CPU_VENDOR</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;intel&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;intel-ucode&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$CPU_VENDOR</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;amd&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;amd-ucode&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LVM</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CMDLINE_LINUX_ROOT</span><span class="o">=</span><span class="s2">&#34;root=</span><span class="nv">$DEVICE_ROOT</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CMDLINE_LINUX_ROOT</span><span class="o">=</span><span class="s2">&#34;root=PARTUUID=</span><span class="nv">$PARTUUID_ROOT</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$LUKS_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$DEVICE_TRIM</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">BOOTLOADER_ALLOW_DISCARDS</span><span class="o">=</span><span class="s2">&#34;:allow-discards&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CMDLINE_LINUX</span><span class="o">=</span><span class="s2">&#34;cryptdevice=PARTUUID=</span><span class="nv">$PARTUUID_ROOT</span><span class="s2">:</span><span class="nv">$LUKS_DEVICE_NAME$BOOTLOADER_ALLOW_DISCARDS</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$FILE_SYSTEM_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;btrfs&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CMDLINE_LINUX</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> rootflags=subvol=root&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$KMS</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER</span><span class="s2">&#34;</span> in&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;nvidia&#34;</span> <span class="p">|</span> <span class="s2">&#34;nvidia-390xx&#34;</span> <span class="p">|</span> <span class="s2">&#34;nvidia-390xx-lts&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CMDLINE_LINUX</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> nvidia-drm.modeset=1&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$KERNELS_PARAMETERS</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CMDLINE_LINUX</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> </span><span class="nv">$KERNELS_PARAMETERS</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$BOOTLOADER</span><span class="s2">&#34;</span> in&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;grub&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bootloader_grub&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;refind&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bootloader_refind&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;systemd&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bootloader_systemd&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl set-default multi-user.target&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> bootloader_grub<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;grub dosfstools&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/GRUB_DEFAULT=0/GRUB_DEFAULT=saved/&#39;</span> /etc/default/grub&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/#GRUB_SAVEDEFAULT=&#34;true&#34;/GRUB_SAVEDEFAULT=&#34;true&#34;/&#39;</span> /etc/default/grub&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i -E <span class="s1">&#39;s/GRUB_CMDLINE_LINUX_DEFAULT=&#34;(.*) quiet&#34;/GRUB_CMDLINE_LINUX_DEFAULT=&#34;\1&#34;/&#39;</span> /etc/default/grub&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/GRUB_CMDLINE_LINUX=&#34;&#34;/GRUB_CMDLINE_LINUX=&#34;&#39;</span><span class="s2">&#34;</span><span class="nv">$CMDLINE_LINUX</span><span class="s2">&#34;</span><span class="s1">&#39;&#34;/&#39;</span> /etc/default/grub&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span> &gt;&gt; /mnt/etc/default/grub&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;# alis&#34;</span> &gt;&gt; /mnt/etc/default/grub&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;GRUB_DISABLE_SUBMENU=y&#34;</span> &gt;&gt; /mnt/etc/default/grub&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$BIOS_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;uefi&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;efibootmgr&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt grub-install --target<span class="o">=</span>x86_64-efi --bootloader-id<span class="o">=</span>grub --efi-directory<span class="o">=</span><span class="nv">$ESP_DIRECTORY</span> --recheck&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">#arch-chroot /mnt efibootmgr --create --disk $DEVICE --part $PARTITION_BOOT_NUMBER --loader /EFI/grub/grubx64.efi --label &#34;GRUB Boot Manager&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$BIOS_TYPE</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;bios&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt grub-install --target<span class="o">=</span>i386-pc --recheck <span class="nv">$DEVICE</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt grub-mkconfig -o <span class="s2">&#34;</span><span class="nv">$BOOT_DIRECTORY</span><span class="s2">/grub/grub.cfg&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$VIRTUALBOX</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -n <span class="s2">&#34;\EFI\grub\grubx64.efi&#34;</span> &gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/startup.nsh&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> bootloader_refind<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;refind&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt refind-install&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt rm /boot/refind_linux.conf&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/^timeout.*/timeout 5/&#39;</span> <span class="s2">&#34;</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sed -i <span class="s1">&#39;s/^#scan_all_linux_kernels.*/scan_all_linux_kernels false/&#39;</span> <span class="s2">&#34;</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/EFI/refind/refind.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">#arch-chroot /mnt sed -i &#39;s/^#default_selection &#34;+,bzImage,vmlinuz&#34;/default_selection &#34;+,bzImage,vmlinuz&#34;/&#39; &#34;$ESP_DIRECTORY/EFI/refind/refind.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">REFIND_MICROCODE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$VIRTUALBOX</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$CPU_VENDOR</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;intel&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">REFIND_MICROCODE</span><span class="o">=</span><span class="s2">&#34;initrd=/intel-ucode.img&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$CPU_VENDOR</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;amd&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">REFIND_MICROCODE</span><span class="o">=</span><span class="s2">&#34;initrd=/amd-ucode.img&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;cat <span class="s">&lt;&lt;EOT &gt;&gt; &#34;/mnt$ESP_DIRECTORY/EFI/refind/refind.conf&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s"># alis&#10;</span></span></span><span class="line"><span class="cl"><span class="s">menuentry &#34;Arch Linux&#34; {&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;volume   $PARTUUID_BOOT&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;loader   /vmlinuz-linux&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;initrd   /initramfs-linux.img&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;icon&nbsp;&nbsp;&nbsp;&nbsp; /EFI/refind/icons/os_arch.png&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;options  &#34;$REFIND_MICROCODE $CMDLINE_LINUX_ROOT rw $CMDLINE_LINUX&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;submenuentry &#34;Boot using fallback initramfs&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">	&nbsp;&nbsp;&nbsp;&nbsp;  initrd /initramfs-linux-fallback.img&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;submenuentry &#34;Boot to terminal&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">	&nbsp;&nbsp;&nbsp;&nbsp;  add_options &#34;systemd.unit=multi-user.target&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span></span><span class="line"><span class="cl"><span class="s">}&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&#10;</span></span></span><span class="line"><span class="cl"><span class="s">EOT</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[[</span> <span class="nv">$KERNELS</span> <span class="o">=</span>~ .*linux-lts.* <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cat <span class="s">&lt;&lt;EOT &gt;&gt; &#34;/mnt$ESP_DIRECTORY/EFI/refind/refind.conf&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">menuentry &#34;Arch Linux (lts)&#34; {&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;volume   $PARTUUID_BOOT&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;loader   /vmlinuz-linux-lts&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;initrd   /initramfs-linux-lts.img&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;icon&nbsp;&nbsp;&nbsp;&nbsp; /EFI/refind/icons/os_arch.png&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;options  &#34;$REFIND_MICROCODE $CMDLINE_LINUX_ROOT rw $CMDLINE_LINUX&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;submenuentry &#34;Boot using fallback initramfs&#34; {&#10;</span></span></span><span class="line"><span class="cl"><span class="s">	&nbsp;&nbsp;&nbsp;&nbsp;  initrd /initramfs-linux-lts-fallback.img&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;submenuentry &#34;Boot to terminal&#34; {&#10;</span></span></span><span class="line"><span class="cl"><span class="s">	&nbsp;&nbsp;&nbsp;&nbsp;  add_options &#34;systemd.unit=multi-user.target&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span></span><span class="line"><span class="cl"><span class="s">}&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&#10;</span></span></span><span class="line"><span class="cl"><span class="s">EOT</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[[</span> <span class="nv">$KERNELS</span> <span class="o">=</span>~ .*linux-hardened.* <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cat <span class="s">&lt;&lt;EOT &gt;&gt; &#34;/mnt$ESP_DIRECTORY/EFI/refind/refind.conf&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">menuentry &#34;Arch Linux (hardened)&#34; {&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;volume   $PARTUUID_BOOT&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;loader   /vmlinuz-linux-hardened&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;initrd   /initramfs-linux-hardened.img&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;icon&nbsp;&nbsp;&nbsp;&nbsp; /EFI/refind/icons/os_arch.png&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;options  &#34;$REFIND_MICROCODE $CMDLINE_LINUX_ROOT rw $CMDLINE_LINUX&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;submenuentry &#34;Boot using fallback initramfs&#34; {&#10;</span></span></span><span class="line"><span class="cl"><span class="s">	&nbsp;&nbsp;&nbsp;&nbsp;  initrd /initramfs-linux-lts-fallback.img&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;submenuentry &#34;Boot to terminal&#34; {&#10;</span></span></span><span class="line"><span class="cl"><span class="s">	&nbsp;&nbsp;&nbsp;&nbsp;  add_options &#34;systemd.unit=multi-user.target&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span></span><span class="line"><span class="cl"><span class="s">}&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&#10;</span></span></span><span class="line"><span class="cl"><span class="s">EOT</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[[</span> <span class="nv">$KERNELS</span> <span class="o">=</span>~ .*linux-zen.* <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cat <span class="s">&lt;&lt;EOT &gt;&gt; &#34;/mnt$ESP_DIRECTORY/EFI/refind/refind.conf&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">menuentry &#34;Arch Linux (zen)&#34; {&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;volume   $PARTUUID_BOOT&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;loader   /vmlinuz-linux-zen&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;initrd   /initramfs-linux-zen.img&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;icon&nbsp;&nbsp;&nbsp;&nbsp; /EFI/refind/icons/os_arch.png&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;options  &#34;$REFIND_MICROCODE $CMDLINE_LINUX_ROOT rw $CMDLINE_LINUX&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;submenuentry &#34;Boot using fallback initramfs&#34; {&#10;</span></span></span><span class="line"><span class="cl"><span class="s">	&nbsp;&nbsp;&nbsp;&nbsp;  initrd /initramfs-linux-lts-fallback.img&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;submenuentry &#34;Boot to terminal&#34; {&#10;</span></span></span><span class="line"><span class="cl"><span class="s">	&nbsp;&nbsp;&nbsp;&nbsp;  add_options &#34;systemd.unit=multi-user.target&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&nbsp;&nbsp;&nbsp;&nbsp;}&#10;</span></span></span><span class="line"><span class="cl"><span class="s">}&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&#10;</span></span></span><span class="line"><span class="cl"><span class="s">EOT</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$VIRTUALBOX</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -n <span class="s2">&#34;\EFI\refind\refind_x64.efi&#34;</span> &gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/startup.nsh&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> bootloader_systemd<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemd-machine-id-setup&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt bootctl --path<span class="o">=</span><span class="s2">&#34;</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">&#34;</span> install&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt mkdir -p <span class="s2">&#34;</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt mkdir -p <span class="s2">&#34;</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;cat <span class="s">&lt;&lt;EOT &gt; &#34;/mnt$ESP_DIRECTORY/loader/loader.conf&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s"># alis&#10;</span></span></span><span class="line"><span class="cl"><span class="s">timeout 5&#10;</span></span></span><span class="line"><span class="cl"><span class="s">default archlinux&#10;</span></span></span><span class="line"><span class="cl"><span class="s">editor 0&#10;</span></span></span><span class="line"><span class="cl"><span class="s">EOT</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt mkdir -p <span class="s2">&#34;/etc/pacman.d/hooks/&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;cat <span class="s">&lt;&lt;EOT &gt; &#34;/mnt/etc/pacman.d/hooks/systemd-boot.hook&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">[Trigger]&#10;</span></span></span><span class="line"><span class="cl"><span class="s">Type = Package&#10;</span></span></span><span class="line"><span class="cl"><span class="s">Operation = Upgrade&#10;</span></span></span><span class="line"><span class="cl"><span class="s">Target = systemd&#10;</span></span></span><span class="line"><span class="cl"><span class="s">&#10;</span></span></span><span class="line"><span class="cl"><span class="s">[Action]&#10;</span></span></span><span class="line"><span class="cl"><span class="s">Description = Updating systemd-boot&#10;</span></span></span><span class="line"><span class="cl"><span class="s">When = PostTransaction&#10;</span></span></span><span class="line"><span class="cl"><span class="s">Exec = /usr/bin/bootctl update&#10;</span></span></span><span class="line"><span class="cl"><span class="s">EOT</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">SYSTEMD_MICROCODE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">SYSTEMD_OPTIONS</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$VIRTUALBOX</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$CPU_VENDOR</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;intel&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">SYSTEMD_MICROCODE</span><span class="o">=</span><span class="s2">&#34;/intel-ucode.img&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$CPU_VENDOR</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;amd&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">SYSTEMD_MICROCODE</span><span class="o">=</span><span class="s2">&#34;/amd-ucode.img&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$LUKS_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;   <span class="nv">SYSTEMD_OPTIONS</span><span class="o">=</span><span class="s2">&#34;luks.name=</span><span class="nv">$UUID_ROOT</span><span class="s2">=</span><span class="nv">$LUKS_DEVICE_NAME</span><span class="s2"> luks.options=discard&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux.img&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;options initrd=initramfs-linux.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux (terminal)&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux.img&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;options initrd=initramfs-linux.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> systemd.unit=multi-user.target </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux (fallback)&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux-fallback.img&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;options initrd=initramfs-linux-fallback.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[[</span> <span class="nv">$KERNELS</span> <span class="o">=</span>~ .*linux-lts.* <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux (lts)&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux-lts&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux-lts.img&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;options initrd=initramfs-linux-lts.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux (lts, terminal)&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux-lts&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux-lts.img&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;options initrd=initramfs-linux-lts.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> systemd.unit=multi-user.target </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux (lts-fallback)&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux-lts&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$CPU_INTEL</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> -a <span class="s2">&#34;</span><span class="nv">$VIRTUALBOX</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux-lts-fallback.img&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;options initrd=initramfs-linux-lts-fallback.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-lts-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[[</span> <span class="nv">$KERNELS</span> <span class="o">=</span>~ .*linux-hardened.* <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux (hardened)&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux-hardened&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux-hardened.img&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;options initrd=initramfs-linux-hardened.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux (hardened, terminal)&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux-hardened&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux-hardened.img&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;options initrd=initramfs-linux-hardened.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> systemd.unit=multi-user.target </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux (hardened-fallback)&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux-hardened&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux-hardened-fallback.img&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;options initrd=initramfs-linux-hardened-fallback.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-hardened-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[[</span> <span class="nv">$KERNELS</span> <span class="o">=</span>~ .*linux-zen.* <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux (zen)&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux-zen&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux-zen.img&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;options initrd=initramfs-linux-zen.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux (zen, terminal)&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux-zen&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux-zen.img&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;options initrd=initramfs-linux-zen.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> systemd.unit=multi-user.target </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen-terminal.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;title Arch Linux (zen-fallback)&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;efi /vmlinuz-linux-zen&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd </span><span class="nv">$SYSTEMD_MICROCODE</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;initrd /initramfs-linux-zen-fallback.img&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;options initrd=initramfs-linux-zen-fallback.img </span><span class="nv">$CMDLINE_LINUX_ROOT</span><span class="s2"> rw </span><span class="nv">$CMDLINE_LINUX</span><span class="s2"> </span><span class="nv">$SYSTEMD_OPTIONS</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/loader/entries/archlinux-zen-fallback.conf&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$VIRTUALBOX</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -n <span class="s2">&#34;\EFI\systemd\systemd-bootx64.efi&#34;</span> &gt; <span class="s2">&#34;/mnt</span><span class="nv">$ESP_DIRECTORY</span><span class="s2">/startup.nsh&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> custom_shell<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;print_step <span class="s2">&#34;custom_shell()&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CUSTOM_SHELL_PATH</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$CUSTOM_SHELL</span><span class="s2">&#34;</span> in&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;zsh&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;zsh&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CUSTOM_SHELL_PATH</span><span class="o">=</span><span class="s2">&#34;/usr/bin/zsh&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;dash&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;dash&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CUSTOM_SHELL_PATH</span><span class="o">=</span><span class="s2">&#34;/usr/bin/dash&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;fish&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;fish&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CUSTOM_SHELL_PATH</span><span class="o">=</span><span class="s2">&#34;/usr/bin/fish&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$CUSTOM_SHELL_PATH</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;custom_shell_user <span class="s2">&#34;root&#34;</span> <span class="nv">$CUSTOM_SHELL_PATH</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;custom_shell_user <span class="s2">&#34;</span><span class="nv">$USER_NAME</span><span class="s2">&#34;</span> <span class="nv">$CUSTOM_SHELL_PATH</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> U in <span class="si">${</span><span class="nv">ADDITIONAL_USERS</span><span class="p">[@]</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">IFS</span><span class="o">=</span><span class="s1">&#39;=&#39;</span> <span class="nv">S</span><span class="o">=(</span><span class="si">${</span><span class="nv">U</span><span class="si">}</span><span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">USER</span><span class="o">=</span><span class="si">${</span><span class="nv">S</span><span class="p">[0]</span><span class="si">}</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;custom_shell_user <span class="s2">&#34;</span><span class="nv">$USER</span><span class="s2">&#34;</span> <span class="nv">$CUSTOM_SHELL_PATH</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> custom_shell_user<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">USER</span><span class="o">=</span><span class="nv">$1</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">CUSTOM_SHELL_PATH</span><span class="o">=</span><span class="nv">$2</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$SYSTEMD_HOMED</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;homectl update --shell<span class="o">=</span><span class="nv">$CUSTOM_SHELL_PATH</span> <span class="nv">$USER</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt chsh -s <span class="nv">$CUSTOM_SHELL_PATH</span> <span class="nv">$USER</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> desktop_environment<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;print_step <span class="s2">&#34;desktop_environment()&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$DESKTOP_ENVIRONMENT</span><span class="s2">&#34;</span> in&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;gnome&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desktop_environment_gnome&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;kde&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desktop_environment_kde&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;xfce&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desktop_environment_xfce&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;mate&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desktop_environment_mate&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;cinnamon&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desktop_environment_cinnamon&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;lxde&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desktop_environment_lxde&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;i3-wm&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desktop_environment_i3_wm&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="s2">&#34;i3-gaps&#34;</span> <span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desktop_environment_i3_gaps&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">;;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">esac</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl set-default graphical.target&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> desktop_environment_gnome<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;gnome&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> gdm.service&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> desktop_environment_kde<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;plasma-meta plasma-wayland-session kde-applications-meta&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> sddm.service&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> desktop_environment_xfce<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;xfce4 xfce4-goodies lightdm lightdm-gtk-greeter xorg-server&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> lightdm.service&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> desktop_environment_mate<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;mate mate-extra lightdm lightdm-gtk-greeter xorg-server&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> lightdm.service&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> desktop_environment_cinnamon<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;cinnamon lightdm lightdm-gtk-greeter xorg-server&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> lightdm.service&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> desktop_environment_lxde<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;lxde lxdm&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> lxdm.service&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> desktop_environment_i3_wm<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;i3-wm i3blocks i3lock i3status dmenu rxvt-unicode lightdm lightdm-gtk-greeter xorg-server&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> lightdm.service&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> desktop_environment_i3_gaps<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;i3-gaps i3blocks i3lock i3status dmenu rxvt-unicode lightdm lightdm-gtk-greeter xorg-server&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> lightdm.service&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> packages<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$PACKAGES_INSTALL</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">(</span><span class="nv">USER_NAME</span><span class="o">=</span><span class="nv">$USER_NAME</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="nv">USER_PASSWORD</span><span class="o">=</span><span class="nv">$USER_PASSWORD</span> <span class="se">\&#10;</span></span></span><span class="line"><span class="cl"><span class="se"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;./alis-packages.sh<span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> vagrant<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;pacman_install <span class="s2">&#34;openssh&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;create_user <span class="s2">&#34;vagrant&#34;</span> <span class="s2">&#34;vagrant&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nb">enable</span> sshd.service&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt ssh-keygen -A&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt sshd -t&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> systemd_units<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">IFS</span><span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="nv">UNITS</span><span class="o">=(</span><span class="nv">$SYSTEMD_UNITS</span><span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> U in <span class="si">${</span><span class="nv">UNITS</span><span class="p">[@]</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">ACTION</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">UNIT</span><span class="o">=</span><span class="si">${</span><span class="nv">U</span><span class="si">}</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[[</span> <span class="nv">$UNIT</span> <span class="o">==</span> -* <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">ACTION</span><span class="o">=</span><span class="s2">&#34;disable&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">UNIT</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$UNIT</span> <span class="p">|</span> sed <span class="s2">&#34;s/^-//g&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">elif</span> <span class="o">[[</span> <span class="nv">$UNIT</span> <span class="o">==</span> +* <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">ACTION</span><span class="o">=</span><span class="s2">&#34;enable&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">UNIT</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$UNIT</span> <span class="p">|</span> sed <span class="s2">&#34;s/^+//g&#34;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">elif</span> <span class="o">[[</span> <span class="nv">$UNIT</span> <span class="o">=</span>~ ^<span class="o">[</span>a-zA-Z0-9<span class="o">]</span>+ <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">ACTION</span><span class="o">=</span><span class="s2">&#34;enable&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">UNIT</span><span class="o">=</span><span class="nv">$UNIT</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$ACTION</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt systemctl <span class="nv">$ACTION</span> <span class="nv">$UNIT</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> end<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">GREEN</span><span class="si">}</span><span class="s2">Arch Linux installed successfully&#34;</span><span class="s1">&#39;!&#39;</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$REBOOT</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">REBOOT</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">set</span> +e&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> <span class="o">((</span> <span class="nv">i</span> <span class="o">=</span> 15<span class="p">;</span> i &gt;<span class="o">=</span> 1<span class="p">;</span> i-- <span class="o">))</span><span class="p">;</span> <span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">read</span> -r -s -n <span class="m">1</span> -t <span class="m">1</span> -p <span class="s2">&#34;Rebooting in </span><span class="nv">$i</span><span class="s2"> seconds... Press any key to abort.&#34;</span><span class="s1">$&#39;\n&#39;</span> KEY&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -eq <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">REBOOT</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">break</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">set</span> -e&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$REBOOT</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;Rebooting...&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copy_logs&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do_reboot&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$ASCIINEMA</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;Reboot aborted. You will must terminate asciinema recording and do a explicit reboot (exit, ./alis-reboot.sh).&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;Reboot aborted. You will must do a explicit reboot (./alis-reboot.sh).&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$ASCIINEMA</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;No reboot. You will must terminate asciinema recording and do a explicit reboot (exit, ./alis-reboot.sh).&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;No reboot. You will must do a explicit reboot (./alis-reboot.sh).&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> pacman_install<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">ERROR</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">set</span> +e&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">IFS</span><span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="nv">PACKAGES</span><span class="o">=(</span><span class="nv">$1</span><span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> VARIABLE in <span class="o">{</span>1..5<span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arch-chroot /mnt pacman -Syu --noconfirm --needed <span class="si">${</span><span class="nv">PACKAGES</span><span class="p">[@]</span><span class="si">}</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> <span class="o">==</span> <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">ERROR</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">break</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep <span class="m">10</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">set</span> -e&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$ERROR</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">exit</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> copy_logs<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">ESCAPED_LUKS_PASSWORD</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LUKS_PASSWORD</span><span class="si">}</span><span class="s2">&#34;</span> <span class="p">|</span> sed <span class="s1">&#39;s/[.[\*^$()+?{|]/[\\&amp;]/g&#39;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">ESCAPED_ROOT_PASSWORD</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">ROOT_PASSWORD</span><span class="si">}</span><span class="s2">&#34;</span> <span class="p">|</span> sed <span class="s1">&#39;s/[.[\*^$()+?{|]/[\\&amp;]/g&#39;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">ESCAPED_USER_PASSWORD</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">USER_PASSWORD</span><span class="si">}</span><span class="s2">&#34;</span> <span class="p">|</span> sed <span class="s1">&#39;s/[.[\*^$()+?{|]/[\\&amp;]/g&#39;</span><span class="k">)</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -f <span class="s2">&#34;</span><span class="nv">$CONF_FILE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">SOURCE_FILE</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$CONF_FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">FILE</span><span class="o">=</span><span class="s2">&#34;/mnt/var/log/alis/</span><span class="nv">$CONF_FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkdir -p /mnt/var/log/alis&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cp <span class="s2">&#34;</span><span class="nv">$SOURCE_FILE</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chown root:root <span class="s2">&#34;</span><span class="nv">$FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chmod <span class="m">600</span> <span class="s2">&#34;</span><span class="nv">$FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$ESCAPED_LUKS_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s2">&#34;s/</span><span class="si">${</span><span class="nv">ESCAPED_LUKS_PASSWORD</span><span class="si">}</span><span class="s2">/******/g&#34;</span> <span class="s2">&#34;</span><span class="nv">$FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$ESCAPED_ROOT_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s2">&#34;s/</span><span class="si">${</span><span class="nv">ESCAPED_ROOT_PASSWORD</span><span class="si">}</span><span class="s2">/******/g&#34;</span> <span class="s2">&#34;</span><span class="nv">$FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$ESCAPED_USER_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s2">&#34;s/</span><span class="si">${</span><span class="nv">ESCAPED_USER_PASSWORD</span><span class="si">}</span><span class="s2">/******/g&#34;</span> <span class="s2">&#34;</span><span class="nv">$FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -f <span class="s2">&#34;</span><span class="nv">$LOG_FILE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">SOURCE_FILE</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$LOG_FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">FILE</span><span class="o">=</span><span class="s2">&#34;/mnt/var/log/alis/</span><span class="nv">$LOG_FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkdir -p /mnt/var/log/alis&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cp <span class="s2">&#34;</span><span class="nv">$SOURCE_FILE</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chown root:root <span class="s2">&#34;</span><span class="nv">$FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chmod <span class="m">600</span> <span class="s2">&#34;</span><span class="nv">$FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$ESCAPED_LUKS_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s2">&#34;s/</span><span class="si">${</span><span class="nv">ESCAPED_LUKS_PASSWORD</span><span class="si">}</span><span class="s2">/******/g&#34;</span> <span class="s2">&#34;</span><span class="nv">$FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$ESCAPED_ROOT_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s2">&#34;s/</span><span class="si">${</span><span class="nv">ESCAPED_ROOT_PASSWORD</span><span class="si">}</span><span class="s2">/******/g&#34;</span> <span class="s2">&#34;</span><span class="nv">$FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$ESCAPED_USER_PASWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s2">&#34;s/</span><span class="si">${</span><span class="nv">ESCAPED_USER_PASSWORD</span><span class="si">}</span><span class="s2">/******/g&#34;</span> <span class="s2">&#34;</span><span class="nv">$FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -f <span class="s2">&#34;</span><span class="nv">$ASCIINEMA_FILE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">SOURCE_FILE</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$ASCIINEMA_FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">FILE</span><span class="o">=</span><span class="s2">&#34;/mnt/var/log/alis/</span><span class="nv">$ASCIINEMA_FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkdir -p /mnt/var/log/alis&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cp <span class="s2">&#34;</span><span class="nv">$SOURCE_FILE</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chown root:root <span class="s2">&#34;</span><span class="nv">$FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chmod <span class="m">600</span> <span class="s2">&#34;</span><span class="nv">$FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$ESCAPED_LUKS_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s2">&#34;s/</span><span class="si">${</span><span class="nv">ESCAPED_LUKS_PASSWORD</span><span class="si">}</span><span class="s2">/******/g&#34;</span> <span class="s2">&#34;</span><span class="nv">$FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$ESCAPED_ROOT_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s2">&#34;s/</span><span class="si">${</span><span class="nv">ESCAPED_ROOT_PASSWORD</span><span class="si">}</span><span class="s2">/******/g&#34;</span> <span class="s2">&#34;</span><span class="nv">$FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$ESCAPED_USER_PASSWORD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sed -i <span class="s2">&#34;s/</span><span class="si">${</span><span class="nv">ESCAPED_USER_PASSWORD</span><span class="si">}</span><span class="s2">/******/g&#34;</span> <span class="s2">&#34;</span><span class="nv">$FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> do_reboot<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;umount -R /mnt/boot&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;umount -R /mnt&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;reboot&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> print_step<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">STEP</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LIGHT_BLUE</span><span class="si">}</span><span class="s2"># </span><span class="si">${</span><span class="nv">STEP</span><span class="si">}</span><span class="s2"> step</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> execute_step<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">STEP</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">STEPS</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$2</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[[</span> <span class="s2">&#34; </span><span class="nv">$STEPS</span><span class="s2"> &#34;</span> <span class="o">=</span>~ <span class="s2">&#34; </span><span class="nv">$STEP</span><span class="s2"> &#34;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">eval</span> <span class="nv">$STEP</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;save_globals&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">else</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;Skipping </span><span class="nv">$STEP</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> load_globals<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -f <span class="s2">&#34;</span><span class="nv">$GLOBALS_FILE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">source</span> <span class="s2">&#34;</span><span class="nv">$GLOBALS_FILE</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> save_globals<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;cat <span class="s">&lt;&lt;EOT &gt; $GLOBALS_FILE&#10;</span></span></span><span class="line"><span class="cl"><span class="s">ASCIINEMA=&#34;$ASCIINEMA&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">BIOS_TYPE=&#34;$BIOS_TYPE&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">PARTITION_BOOT=&#34;$PARTITION_BOOT&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">PARTITION_ROOT=&#34;$PARTITION_ROOT&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">PARTITION_BOOT_NUMBER=&#34;$PARTITION_BOOT_NUMBER&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">PARTITION_ROOT_NUMBER=&#34;$PARTITION_ROOT_NUMBER&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">DEVICE_ROOT=&#34;$DEVICE_ROOT&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">DEVICE_LVM=&#34;$DEVICE_LVM&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">LUKS_DEVICE_NAME=&#34;$LUKS_DEVICE_NAME&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">LVM_VOLUME_GROUP=&#34;$LVM_VOLUME_GROUP&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">LVM_VOLUME_LOGICAL=&#34;$LVM_VOLUME_LOGICAL&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">SWAPFILE=&#34;$SWAPFILE&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">BOOT_DIRECTORY=&#34;$BOOT_DIRECTORY&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">ESP_DIRECTORY=&#34;$ESP_DIRECTORY&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">UUID_BOOT=&#34;$UUID_BOOT&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">UUID_ROOT=&#34;$UUID_ROOT&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">PARTUUID_BOOT=&#34;$PARTUUID_BOOT&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">PARTUUID_ROOT=&#34;$PARTUUID_ROOT&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">DEVICE_SATA=&#34;$DEVICE_SATA&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">DEVICE_NVME=&#34;$DEVICE_NVME&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">DEVICE_MMC=&#34;$DEVICE_MMC&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">CPU_VENDOR=&#34;$CPU_VENDOR&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">VIRTUALBOX=&#34;$VIRTUALBOX&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">CMDLINE_LINUX_ROOT=&#34;$CMDLINE_LINUX_ROOT&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">CMDLINE_LINUX=&#34;$CMDLINE_LINUX&#34;&#10;</span></span></span><span class="line"><span class="cl"><span class="s">EOT</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl"><span class="k">function</span> main<span class="o">()</span> <span class="o">{</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">ALL_STEPS</span><span class="o">=(</span><span class="s2">&#34;configuration_install&#34;</span> <span class="s2">&#34;sanitize_variables&#34;</span> <span class="s2">&#34;check_variables&#34;</span> <span class="s2">&#34;warning&#34;</span> <span class="s2">&#34;init&#34;</span> <span class="s2">&#34;facts&#34;</span> <span class="s2">&#34;checks&#34;</span> <span class="s2">&#34;prepare&#34;</span> <span class="s2">&#34;partition&#34;</span> <span class="s2">&#34;install&#34;</span> <span class="s2">&#34;configuration&#34;</span> <span class="s2">&#34;mkinitcpio_configuration&#34;</span> <span class="s2">&#34;display_driver&#34;</span> <span class="s2">&#34;kernels&#34;</span> <span class="s2">&#34;mkinitcpio&#34;</span> <span class="s2">&#34;network&#34;</span> <span class="s2">&#34;virtualbox&#34;</span> <span class="s2">&#34;users&#34;</span> <span class="s2">&#34;bootloader&#34;</span> <span class="s2">&#34;custom_shell&#34;</span> <span class="s2">&#34;desktop_environment&#34;</span> <span class="s2">&#34;packages&#34;</span> <span class="s2">&#34;vagrant&#34;</span> <span class="s2">&#34;systemd_units&#34;</span> <span class="s2">&#34;end&#34;</span><span class="o">)</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">STEP</span><span class="o">=</span><span class="s2">&#34;configuration_install&#34;</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">STEP</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$STEP</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;steps&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">echo</span> <span class="s2">&#34;Steps: </span><span class="nv">$ALL_STEPS</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="m">0</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1"># get step execute from</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">FOUND</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">STEPS</span><span class="o">=</span><span class="s2">&#34;&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> S in <span class="si">${</span><span class="nv">ALL_STEPS</span><span class="p">[@]</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="nv">$FOUND</span> <span class="o">=</span> <span class="s2">&#34;true&#34;</span> -o <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEP</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">S</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">FOUND</span><span class="o">=</span><span class="s2">&#34;true&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">STEPS</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$STEPS</span><span class="s2"> </span><span class="nv">$S</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">done</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1"># execute steps</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;load_globals&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;configuration_install&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;sanitize_variables&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;check_variables&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;warning&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;init&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;facts&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;checks&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;prepare&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;partition&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;install&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;configuration&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;mkinitcpio_configuration&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$DISPLAY_DRIVER</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;display_driver&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;kernels&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;mkinitcpio&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;network&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$VIRTUALBOX</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;virtualbox&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;users&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;bootloader&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$CUSTOM_SHELL</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;custom_shell&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$DESKTOP_ENVIRONMENT</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;desktop_environment&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;packages&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$VAGRANT</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;vagrant&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">fi</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;systemd_units&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl">&nbsp;&nbsp;&nbsp;&nbsp;execute_step <span class="s2">&#34;end&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">STEPS</span><span class="si">}</span><span class="s2">&#34;</span>&#10;</span></span><span class="line"><span class="cl"><span class="o">}</span>&#10;</span></span><span class="line"><span class="cl">&#10;</span></span><span class="line"><span class="cl">main <span class="nv">$@</span>&#10;</span></span></code></pre></td></tr></table>&#10;</div>&#10;</div>
    <div class="highlight-meta">
        <span>alis.sh</span>
    </div>
</div>
<div class="alert alert-secondary sourcecode">
    <img src="https://picodotdev.github.io/blog-bitix/assets/images/icons/terminal.svg" width="64" height="64" alt="Terminal" title="Terminal" class="lozad sourcecode-icon">
    <p>
            El <a href="https://github.com/picodotdev/alis/tree/master/">código fuente completo del ejemplo</a> puedes descargarlo del repositorio de ejemplos de Blog Bitix alojado en GitHub.</p>
</div>
]]>
        </content>
        
            
                <category term="gnu-linux"/>
            
                <category term="planeta-codigo"/>
            
                <category term="software-libre"/>
            
        
    </entry>
    <entry>
        <id>https://picodotdev.github.io/blog-bitix/2017/01/articulo-3-de-yo-apoyo-al-software-libre/</id>
        <title>Artículo #3 de Yo apoyo al software libre</title>
        <updated>2017-01-06T22:00:00+01:00</updated>
        <published>2017-01-06T12:00:00+01:00</published>
        <link rel="alternate" type="text/html" href="https://picodotdev.github.io/blog-bitix/2017/01/articulo-3-de-yo-apoyo-al-software-libre/"/>
        <author><name>picodotdev</name></author>
        <content type="html">
        
        <![CDATA[<p>Los últimos meses me han sido bastante buenos en cuanto a los ingresos por la publicidad <a href="https://www.google.com/adsense/">AdSense</a> y los enlaces de afiliado de <a href="https://amzn.to/2flFhHA">Amazon</a> que incluyo en el blog con el objetivo de monetizarlo un poco. Desde luego esos pequeños ingresos no compensan la enorme cantidad de tiempo que requiere escribir un artículo, y no es solo escribirlo sino también editarlo, crear el ejemplo de código si el artículo es sobre programación, sacar las capturas de pantalla e investigar la materia de la que habla el artículo. Otra forma de monetizar el blog que estoy evaluando es escribir artículos patrocinados con la plataforma <a href="https://www.publisuites.com/">Publisuites</a>, sin embargo, aún no he recibido ninguna propuesta ya que quizá haya puesto el precio demasiado alto pero escribir un artículo cuesta unas horas de trabajo.</p>
<p>Por la publicidad de AdSense he notado un significativo aumento de ingresos durante los últimos meses del 2016 superando los 20 € mensuales cuando hasta no hace mucho la cifra estaba en unos 10 €. En proporción al aumento de número de visitas que ha experimentado este blog en 2016 como comento en el artículo <a href="https://picodotdev.github.io/blog-bitix/2016/12/hemeroteca-10/">Hemeroteca #10</a> donde hago un repaso de ese año. Esto ha hecho que en poco menos de cinco meses Google me haya hecho otra transferencia por importe de unos 75 €. Por los enlaces de afiliado también he recibido otro ingreso por parte de Amazon de unos 35 €.</p>
<p>Como me he propuesto en anteriores veces que he recibido algún ingreso por el blog he hecho unas pequeñas donaciones a algunos proyectos de software libre. En anteriores ocasiones han sido a la <a href="https://fsfe.org/index.en.html">FSFE</a>, <a href="https://www.mozilla.org/">Mozilla</a>, <a href="https://es.wikipedia.org/wiki/Wikipedia:Portada">Wikipedia</a> y ahora los proyectos que he elegido a los que hacer una donación han sido <a href="https://elementary.io/es/">Elementary OS</a>, <a href="https://www.libreoffice.org/">LibreOffice</a> (The Document Foundation) y <a href="https://archlinuxarm.org/">Arch Linux ARM</a>. Aunque muchos usuarios hagan donaciones la viabilidad de estos proyectos no deberían depender de ellas ya que seguro que no cubren los gastos en los que incurran estos proyectos. Algunos de estos gastos son los servidores para prestar el servicio y páginas web, conferencias a las que asisten sus desarrolladores y los viajes de estos, seguro que hay unos cuantos más.</p>
<h3 id="elementary-os">Elementary OS</h3>
<p>Aunque la distribución <a href="https://www.gnu.org/">GNU</a>/<a href="https://www.linux.com/">Linux</a> que uso es <a href="https://www.archlinux.org/">Arch Linux</a> he elegido donar a Elementary OS porque me parece una distribución interesante por ofrecer algo distinto a las otras muchas distribuciones que existen y no tienen algo diferenciador. Elementary tiene un diseño, estética y usabilidad de interfaz muy cuidada. Arch Linux es la distribución <em>rolling release</em> que se mantiene siempre actualizada y con una gran <a href="https://wiki.archlinux.org/">documentación en forma de wiki</a>. Las versiones LTS de <a href="https://www.ubuntu.com/">Ubuntu</a> ofrecen soporte durante un periodo largo de tiempo pero cuya interfaz Unity no convence a muchos. <a href="https://www.debian.org/">Debian</a>, <a href="https://www.opensuse.org/">openSUSE</a> y <a href="https://fedoraproject.org/">Fedora</a> son otras de las distribuciones grandes y junto con <a href="https://www.linuxmint.com/">Linux Mint</a> también a tener en cuenta para los usuarios que quieren dar el cambio a Linux. Pero para un recién llegado a GNU/Linux o que simplemente quiere un sistema para trabajar en mi opinión Elementary OS o Linux Mint o una versión LTS de Ubuntu si nos convence su interfaz Unity sea lo recomendable por lo que usar en un primer momento, desde luego no Arch Linux y posiblemente tampoco Debian, openSUSE o Fedora. Espero que Elementary siga desarrollándose y no sea una de las muchas distribuciones que al cabo de unos años es abandonada por falta de interés de sus desarrolladores, falta de éxito o ingresos.</p>
<div class="media">
<figure>
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/elementary.svg" width="200" height="200" alt="Elementary OS" title="Elementary OS"  class="lozad "></p>
</figure>
</div>
<h3 id="libre-office">Libre Office</h3>
<p>LibreOffice es el proyecto ofimático que se postula como una de las mejores alternativas ofimáticas a <a href="https://products.office.com/es-es/">Microsoft Office</a>. Su interfaz, en mi opinión, está saturada de opciones en menús donde es difícil encontrar la funcionalidad que uno necesita siendo parecida a versiones antiguas de Microsoft Office. Sin embargo, en GNU/Linux no hay muchas alternativas ofimáticas tan completas de software libre. Otra alternativa es <a href="https://www.wps.com/">WPS Office</a> con una interfaz mas cuidada y parecida a Microsoft Office con su interfaz de caja de herramientas <em>ribbon</em> donde es más fácil encontrar las opciones en vez de interminables menús y diálogos de configuración. En LibreOffice me parece tan importante añadir nuevas funcionalidades como mejorar las existentes pero me gustaría que la interfaz fuese mejor, más parecida a la de Microsoft Office si fuese necesario. Parece que están dando los <a href="https://es.blog.documentfoundation.org/evolucionando-mas-alla-de-las-restricciones-de-las-barras-de-herramientas/">primeros pasos en LibreOffice para evolucionar la barra de herramientas</a>.</p>
<div class="media">
<figure>
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/libreoffice.svg" width="350" height="350" alt="LibreOffice" title="LibreOffice"  class="lozad "></p>
</figure>
</div>
<h3 id="arch-linux-arm">Arch Linux ARM</h3>
<p>El tercer proyecto al que he donado ha sido a Arch Linux ARM ya que lo uso en la <a href="https://www.raspberrypi.org/">Raspberry Pi</a> con la que hago la descarga de imágenes de alguna distribución que quiera probar, series, películas y libros mediante P2P. Solo tiene 256MiB de memoria y una CPU de un único núcleo pero son más que suficientes para en una noche descargar cualquier contenido que necesite.</p>
<div class="media">
<figure>
<p><img src="https://picodotdev.github.io/blog-bitix/assets/images/logotypes/archlinuxarm.svg" width="350" height="350" alt="Arch Linux ARM" title="Arch Linux ARM"  class="lozad "></p>
</figure>
</div>
<h3 id="comprobantes-de-las-donaciones">Comprobantes de las donaciones</h3>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/01/articulo-3-de-yo-apoyo-al-software-libre/images/donacion-elementary_hu0df059866615535ddfb50a097f65a44e_133489_2560x1440_fit_box_3.png" data-gallery="" title="Donación Elementary OS"><img src="https://picodotdev.github.io/blog-bitix/2017/01/articulo-3-de-yo-apoyo-al-software-libre/images/donacion-elementary_hu0df059866615535ddfb50a097f65a44e_133489_300x200_fit_box_3.png" width="143" height="200" alt="Donación Elementary OS" title="Donación Elementary OS"  class="lozad "></a></p>
<figcaption>Donación Elementary OS</figcaption>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/01/articulo-3-de-yo-apoyo-al-software-libre/images/donacion-thedocumentfoundation_hu08f6ea48f5d5f904d7d2b2b2501aa08b_158363_2560x1440_fit_box_3.png" data-gallery="" title="Donación The Document Foundation"><img src="https://picodotdev.github.io/blog-bitix/2017/01/articulo-3-de-yo-apoyo-al-software-libre/images/donacion-thedocumentfoundation_hu08f6ea48f5d5f904d7d2b2b2501aa08b_158363_300x200_fit_box_3.png" width="143" height="200" alt="Donación The Document Foundation" title="Donación The Document Foundation"  class="lozad "></a></p>
<figcaption>Donación The Document Foundation</figcaption>
</figure>
</div>
<div class="media">
<figure>
<p><a href="https://picodotdev.github.io/blog-bitix/2017/01/articulo-3-de-yo-apoyo-al-software-libre/images/donacion-archlinuxarm_hu00634553cac095e32f664ad032164c21_159278_2560x1440_fit_box_3.png" data-gallery="" title="Donación Arch Linux ARM"><img src="https://picodotdev.github.io/blog-bitix/2017/01/articulo-3-de-yo-apoyo-al-software-libre/images/donacion-archlinuxarm_hu00634553cac095e32f664ad032164c21_159278_300x200_fit_box_3.png" width="143" height="200" alt="Donación Arch Linux ARM" title="Donación Arch Linux ARM"  class="lozad "></a></p>
<figcaption>Donación Arch Linux ARM</figcaption>
</figure>
</div>
<p>Otros proyectos que me planteo hacer una donación en el futuro son a algún proyecto relacionado con las <a href="https://es.wikipedia.org/wiki/Berkeley_Software_Distribution">distribuciones BSD</a>, <a href="https://www.gnome.org/">GNOME</a> o el <a href="https://www.videolan.org/vlc/">reproductor multimedia VLC</a>. Desde luego no es mucho ni todo lo que recibo como ingresos por la publicidad, sin embargo, espero que ayude a que estos grandes proyectos de software libre sigan mejorando y yo como usuario junto con otros muchos de algunos de ellos disfrutándolos en la totalidad de ellos sin coste alguno en licencias de software.</p>
<p>Hay muchas formas de colaborar con el software libre, donar dinero solo es una de ellas.</p>
<p><a href="http://www.gnu.org/">Yo apoyo al software libre</a></p>
<table class="table">
    <thead>
        <tr class="thead-dark">
            <th colspan="4">Donaciones que he realizado hasta la última fecha</th>
        </tr>
        <tr class="thead-light">
            <th>#</th>
            <th>Fecha</th>
            <th>Proyecto</th>
            <th>Donación</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1</td>
            <td>2015/12</td>
            <td>Free Software Foundation Europe (FSFE)</td>
            <td>40 €</td>
        </tr>
        <tr>
            <td>2</td>
            <td>2016/09</td>
            <td>Wikipedia, Mozilla/Firefox</td>
            <td>10 €, 10 €</td>
        </tr>
        <tr>
            <td>3</td>
            <td>2017/01</td>
            <td>elementaryOS, Libre Office, Arch Linux ARM</td>
            <td>10 €, 10 €, 10 €</td>
        </tr>
        <tr>
            <td>4</td>
            <td>2017/05</td>
            <td>GNOME, VideoLAN (VLC), Arch Linux</td>
            <td>15,31 €, 10 €, 0,31 €</td>
        </tr>
        <tr>
            <td>5</td>
            <td>2018/01</td>
            <td>LineageOS, Replicant</td>
            <td>15 €, 15 €</td>
        </tr>
        <tr>
            <td>6</td>
            <td>2018/12</td>
            <td>Wine</td>
            <td>$20</td>
        </tr>
        <tr>
            <td>7</td>
            <td>2019/12</td>
            <td>Calibre</td>
            <td>$10</td>
        </tr>
        <tr>
            <td>8</td>
            <td>2020/12</td>
            <td>Phoronix, Mozilla/Firefox, GnuPG</td>
            <td>$12, 10 €, 10 €</td>
        </tr>
        <tr>
            <td>9</td>
            <td>2022/01</td>
            <td>KeePassXC</td>
            <td>15 €</td>
        </tr>
        <tr>
            <td colspan="3">Total</td>
            <td>180 €, $42</td>
        </tr>
    </tbody>
</table>
]]>
        </content>
        
            
                <category term="planeta-codigo"/>
            
                <category term="software-libre"/>
            
        
    </entry>
    
</feed>